# Exploit Title: Php Inventory & Invoice Management System - Arbitrary File Upload
# Dork: N/A
# Date: 30.10.2017
# Vendor Homepage: http://savsofteproducts.com/
# Software Link: http://www.phpinventory.com/
# Demo: http://phpinventory.com/phpinventory_demo/ 
# Version: N/A
# Category: Webapps
# Tested on: WiN7_x64/KaLiLinuX_x64
# CVE: CVE-2017-15990
# # # # #
# Exploit Author: Ihsan Sencan
# Author Web: http://ihsan.net
# Author Social: @ihsansencan
# # # # #
# Description:
# 
# The vulnerability allows an users upload arbitrary file....
# 
# Vulnerable Source:
#
# .............1
# if($_FILES[&#039;userfile&#039;][&#039;name&#039;]!=&#039;&#039;){  
#   $target = &#039;images/user_pics/&#039;;
#   $targets = $target . basename( $_FILES[&#039;userfile&#039;][&#039;name&#039;]);
#   $docadd=($_FILES[&#039;userfile&#039;][&#039;name&#039;]);
#   if(move_uploaded_file($_FILES[&#039;userfile&#039;][&#039;tmp_name&#039;], $targets))
#       {
#           $pfilename=$_FILES[&#039;userfile&#039;][&#039;name&#039;];
#           $filename=time().$pfilename;
#           $new_path=$target.$filename;
#           rename($targets,$new_path);
#       }
#
#}else{
#$filename=$_POST[&#039;user_picname&#039;];
#}
# .............2,3,4
# $target = &#039;images/logo/&#039;;
# $target = &#039;images/product_images/&#039;;
# $target = &#039;images/service_providers/&#039;;
# Etc..
# .............
#
# Proof of Concept: 
# 
# http://localhost/[PATH]/index.php/dashboard/edit_myaccountdetail/
# 
# http://localhost/[PATH]/images/user_pics/[...].php
# 
# Etc..
# # # # #

