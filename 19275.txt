mieric addressBook 1.0 <= SQL Injection Vulnerability
-----------------------------------------------------

Discovered by: Jean Pascal Pereira <pereira@secbiz.de>

Vendor information:

"MieRic address book is wrote in PERL and holds data via a MYSQL database.
Users can add multiple EMAIL, ADDRESS, PHONE, CONTACTS, IMAGE AVATAR and
PGP keys as they want. The addressBook is password protected using encrypted
cookies using Blowfish encrypt."

Vendor URI: http://sourceforge.net/projects/mieric/

----------------------------------------------------

Risk-level: High

The application is prone to a SQL injection vulnerability.

----------------------------------------------------

no.pl, line 256:

     if($type eq &#039;bio_action&#039;)
   {
$last = $input{&#039;last&#039;};
$first = $input{&#039;first&#039;};
$avatar = $input{&#039;avatar&#039;};
$age = $input{&#039;age&#039;};
$bio = $input{&#039;bio&#039;};
$web = $input{&#039;address&#039;};
$web1 = $input{&#039;address1&#039;};
$sub_action = $input{&#039;sub_action&#039;};

#  $sql = "INSERT INTO email_rollo (id,email,location) VALUES (&#039;$command&#039;,&#039;$email&#039;,&#039;$location&#039;)";
#UPDATE `phone_rollo` SET `p1` = &#039;243&#039; WHERE `id` = &#039;1&#039; AND `p1` = &#039;242&#039; AND `p2` = &#039;3118&#039; AND `area` = &#039;573&#039; AND `location` = &#039;country&#039; LIMIT 1 ;
  # $email =~ s/\@/\\@/;
  if($sub_action eq &#039;update&#039;){
$sql = "UPDATE stoli SET last = &#039;$last&#039;, first = &#039;$first&#039;, avatar=&#039;$avatar&#039;, bday=&#039;$age&#039;, bio=&#039;$bio&#039;, web=&#039;$web&#039;, web1=&#039;$web1&#039; WHERE id = &#039;$command&#039;"; 
     # executing the SQL statement.
   $sth->execute or die "executing: ", $dbh->errstr;

----------------------------------------------------

Solution:

Do some input validation.

----------------------------------------------------



