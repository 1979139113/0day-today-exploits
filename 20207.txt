# Date: 01/21/2013
# Google Dork: inurl:"wp-file-uploader.php"
# Version: 1.1 and probably prior

Vulnerable Code: (process-form.php)

97: $filepart = fileinformation( $_FILES[&#039;postimage&#039;][&#039;name&#039;] );
98: $filename = $filepart[&#039;basename&#039;];
99: // check if this filename already exist in the folder
100: $i = 2;
101: while ( in_array( $filename, $imageslist ) ) {
102: $filename = $filepart[&#039;filename&#039;] . &#039;_&#039; . $i++ . &#039;.&#039; .$filepart[&#039;extension&#039;];
103: }
104:  move_uploaded_file($_FILES["postimage"]["tmp_name"], $file_path.$filename);

Description:

Plugin simply upload the attachment with original name and extension to "wp-content/uploads/".
An attacker can upload php files and access them from remote.

Proof of Concept:

1. Visit vulnerable target and navigate to the "File Uploader" site.
2. Upload a file named shell.php
3. Access it with the browser on example.com/wp-content/uploads/shell.php

Done!

Proof Video: http://goo.gl/ogbsA

