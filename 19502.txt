[+] Date: 2/10/2012
[+] Author: Phizo
[+] Vendor: http://www.small-cms.com/
[+] Version: 1.0
[+] Category: webapps
[+] Google dork: intitle:"Find it yourself."
[+] Tested on: Windows 7 | Firefox 15.0.1



=================================
default.class.php ~ lines 220-230
=================================

    function checkCredentials($username, $password){     
        $obscure = $this->obscure($password);                
            $result = mysql_query($query) or die(mysql_error());
        $row = mysql_fetch_array($result);        
        if ($row) {
            return true;
        } else {
            return false;
        }
    }


=================================
default.class.php ~ lines 260-275
=================================

    function setSession($username,$password,$cookie){
    
            $result = mysql_query($query) or die(mysql_error());
            $row = mysql_fetch_array($result);
            
                    
        $values = array($username,$this->obscure($password),$row[&#039;id&#039;]);
        $session = implode(",",$values);
        if($cookie==&#039;on&#039;){
            //cookies
            setcookie("$this->session_name", $session, time()+60*60*24*100,&#039;/&#039;);
        } else {
            $_SESSION["$this->session_name"] = $session;
        }
    }


=======================
login.php ~ lines 27-33
=======================

if ($login->checkCredentials($_POST[&#039;username&#039;], $_POST[&#039;password&#039;])){
        $login->setSession($_POST[&#039;username&#039;],$_POST[&#039;password&#039;],$_POST[&#039;cookie&#039;]);
        $login->redirect(&#039;index.php?page=admincp&#039;);
        } else {
        $error = &#039;&#039;;  
        }
} 



