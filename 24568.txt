
Affected Product:    LiteCart 1.3.2
Fixed in:            1.3.3
Fixed Version Link:  https://www.litecart.net/downloading?version=1.3.3.1
Vendor Contact:      development@litecart.net
Vulnerability Type:  XSS
Remote Exploitable:  Yes
Reported to vendor:  09/07/2015
Disclosed to public: 11/13/2015
Release mode:        Coordinated release
CVE:                 n/a
Credits              Tim Coen of Curesec GmbH

2. XSS 1

Description

The query parameter of the search is vulnerable to XSS.

Proof of Concept


http://localhost/ecommerce/litecart-1.3.2/public_html/en/search?query="></title><script>alert(1)</script>

Code


        public_html/pages/search.inc.php
            document::$snippets[&#039;title&#039;][] = empty($_GET[&#039;query&#039;]) ? language::translate(&#039;title_search_results&#039;, &#039;Search Results&#039;) : sprintf(language::translate(&#039;title_search_results_for_s&#039;, &#039;Search Results for "%s"&#039;), $_GET[&#039;query&#039;]);

3. XSS 2

Description

The value of the GET parameter slide_id is passed to trigger_error if it is an
invalid id. trigger_error does not encode input, and as LiteCart shows errors
by default, this leads to an XSS vulnerability.

Proof of Concept


http://localhost/ecommerce/litecart-1.3.2/public_html/admin/?app=slides&doc=edit_slide&page=1&slide_id=<script>alert(1)</script>

Code


        includes/controllers/ctrl_slide.inc.php
            if (empty($this->data)) trigger_error(&#039;Could not find slide (&#039;. $slide_id .&#039;) in database.&#039;, E_USER_ERROR);

4. XSS 3

Description

The value of the GET parameter doc is passed to trigger_error if it is invalid.
trigger_error does not encode input, and as LiteCart shows errors by default,
this leads to an XSS vulnerability. Additionally, the accessing of non-existing
array values leads to a notice, which contains the index unsanitized. Because
of this, $app_config[&#039;docs&#039;][$_GET[&#039;doc&#039;]] can also lead to XSS.

Proof of Concept


http://localhost/ecommerce/litecart-1.3.2/public_html/admin/?app=appearance&doc=<script>alert(1)</script>

Code


        admin/index.php
            if (!empty($_GET[&#039;doc&#039;])) {
              if (empty($app_config[&#039;docs&#039;][$_GET[&#039;doc&#039;]]) || !file_exists(FS_DIR_HTTP_ROOT . WS_DIR_ADMIN . $_GET[&#039;app&#039;].&#039;.app/&#039; . $app_config[&#039;docs&#039;][$_GET[&#039;doc&#039;]])) trigger_error($_GET[&#039;app&#039;] .&#039;.app/&#039;. $_GET[&#039;doc&#039;] . &#039; is not a valid admin document&#039;, E_USER_ERROR);
              include vmod::check(FS_DIR_HTTP_ROOT . WS_DIR_ADMIN . $_GET[&#039;app&#039;].&#039;.app/&#039; . $app_config[&#039;docs&#039;][$_GET[&#039;doc&#039;]]);
            } else {
              include vmod::check(FS_DIR_HTTP_ROOT . WS_DIR_ADMIN . $_GET[&#039;app&#039;].&#039;.app/&#039; . $app_config[&#039;docs&#039;][$app_config[&#039;default&#039;]]);
            }

5. Solution

To mitigate this issue please upgrade at least to version 1.3.3:

https://www.litecart.net/downloading?version=1.3.3.1

Please note that a newer version might already be available.

6. Report Timeline

09/07/2015 Informed Vendor about Issue
10/05/2015 Vendor releases fix
11/13/2015 Disclosed to public

