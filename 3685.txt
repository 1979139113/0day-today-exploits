addalink <= 4 Write Approved Links Remote Vulnerability
=======================================================


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

$ Program: addalink
$ Version: <= 4 - beta
$ File affected: add_link.php
$ Download: http://sourceforge.net/projects/addalink/


Linklist is a miniwebsite that you can use in your webpage. Basically it 
manages a database of links using PHP+MySQL. Users can send links (url, 
description, etc) by a form and one admin has to approve or delete the 
links before the publication in the website.

One not very important problem is that add_link.php doesn&#039;t test the 
method used (GET or POST). But the real problem is the method to insert 
some values. 

Reading the code you can see the SQL sentence:

INSERT INTO $linktable VALUES(&#039;0&#039;,&#039;$url&#039;,&#039;$linkname&#039;,&#039;$approved=0&#039;,&#039;$email&#039;,
            &#039;$counter=0&#039;,&#039;$description&#039;,&#039;$ip&#039;,&#039;$date&#039;,&#039;$category_id&#039;,&#039;0&#039;)";

It asign values to approved and counter directly in the SQL sentence. For that,
you can enter links approved without moderation writing this:

http://domain/add_link.php?url=http://www.domain.com&linkname=name_of_the_link
&approved=1&email=my@email.com&description=blablablablablablabla&category_id=1

Also you can alter the counter of visits if you add &counter=XXXX to the GET


-= Solution =-


$approved = 0;
$counter = 0;

INSERT INTO $linktable VALUES(&#039;0&#039;,&#039;$url&#039;,&#039;$linkname&#039;,&#039;$approved&#039;,&#039;$email&#039;,
            &#039;$counter&#039;,&#039;$description&#039;,&#039;$ip&#039;,&#039;$date&#039;,&#039;$category_id&#039;,&#039;0&#039;)";




