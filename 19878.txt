# Google Dork: inurl:"kingchat.php"
# Date: 13.10.2012
# Exploit Author: Red_Hat [NullSec]
# Software Link: http://mods.mybb.com/view/kingchat
# Tested on: Windows & Linux.
 
Vulnerable code :
 
<?php
    $username=$_GET[&#039;username&#039;];
    $uid=$_GET[&#039;uid&#039;];
    $text=$_GET[&#039;text&#039;];
 
                    $users=$db->query("SELECT * FROM ".TABLE_PREFIX."users WHERE username=&#039;$username&#039;");
                    $users_info=$db->fetch_array($users);
                    $users_num=$db->num_rows($users);
                    $fusername=$users_info[&#039;uid&#039;];
?>
 
The variable &#039;$username&#039; remains unsanitized.
 
Usage : http://www.site.com/kingchat.php?send=Red_Hat&username=[SQLi]
 
Shoutout to Zixem <3 & NullSec :3

