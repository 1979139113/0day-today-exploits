# Google Dork: inurl:/wp-content/uploads/wp-security-audit-log/
# Exploit Author: Colette Chamberland, Defiant, Inc.
# Vendor Homepage: http://wpwhitesecurity.com
# Version: <=3.1.1
# CVE : CVE-2018-8719
 
Description:
No protection on the wp-content/uploads/wp-security-audit-log/*
which is indexed by google and allows for attackers to possibly find user information (bad login attempts)
 
/wp-security-audit-log/classes/Sensors/System.php&#039;:
$upload_dir = wp_upload_dir();
$uploads_dir_path = trailingslashit( $upload_dir[&#039;basedir&#039;] ) . &#039;wp-security-audit-log/404s/users/&#039;;
$uploads_url = trailingslashit( $upload_dir[&#039;baseurl&#039;] ) . &#039;wp-security-audit-log/404s/users/&#039;;
 
/wp-security-audit-log/classes/Sensors/LogInOut.php&#039;:
// Directory for logged in users log files.
        $user_upload_dir    = wp_upload_dir();
        $user_upload_path   = trailingslashit( $user_upload_dir[&#039;basedir&#039;] . &#039;/wp-security-audit-log/failed-logins/&#039; );
        if ( ! $this->CheckDirectory( $user_upload_path ) ) {
            wp_mkdir_p( $user_upload_path );
        }

