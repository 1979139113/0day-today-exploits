# Google Dork: inurl:"wp-content/plugins/sendit/submit.php"
# Date: 2011-08-25
# Author: evilsocket ( evilsocket [at] gmail [dot] com )
# Version: 1.5.9 (tested with magic quotes OFF)
 
 
---------------
Vulnerable code
---------------
 
[ submit.php line 27 ]
 
$user_count = $wpdb->get_var("SELECT COUNT(*) FROM $table_email where email =&#039;$_POST[email_add]&#039; and id_lista = &#039;$_POST[lista]&#039;;");
 
 
As you can see, $_POST[lista] parameter is nor validated neither escaped, so you can blind sql inject it using $user_count for the
boolean condition checking :
 
 
[ submit.php line 29 ]
 
if($user_count>0) :
 
---
PoC
---
 
POST:
 
email_add = some.random.regexp.valid.email@domain.ltd
lista = BLIND SQL INJECTION HERE
 
TO:
 
http://www.site.com/wp-content/plugins/sendit/submit.php



