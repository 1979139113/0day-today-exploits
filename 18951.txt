BookNux 0.2 <= Multiple Vulnerabilities
#################################################
 
Discovered by: Jean Pascal Pereira <pereira@secbiz.de>
 
Vendor information:
 
"This is an online bookmark manager. It&#039;s allow several user, share bookmark (private or public). It&#039;s use php and mysql."
 
Vendor URI: http://developer.berlios.de/projects/booknux/
 
#################################################
 
Issues: SQL Injection, Cross Site Scripting
 
Risk-level: High
 
-------------------------------------
 
1. SQL Injection:

cat.php, line 70:
  
  $lnsql="SELECT NCategorie, LibCategorie, PriveCategorie, NCategorieMereCategorieX FROM categorie WHERE IdUtilisateurCategorieX=&#039;$idutilisateur&#039; AND NCategorie=".$_GET[&#039;CatMere&#039;];

cat.php, line 75:

  $lnsql="SELECT NCategorie,LibCategorie,NCategorieMereCategorieX, PriveCategorie FROM categorie WHERE IdUtilisateurCategorieX=&#039;$idutilisateur&#039; AND NCategorieMereCategorieX=".$_GET[&#039;CatMere&#039;]." ORDER BY LibCategorie";

cat.php, line 92:

  $lnsql="SELECT LibCategorie, NCategorieMereCategorieX, PriveCategorie FROM categorie WHERE IdUtilisateurCategorieX=&#039;$idutilisateur&#039; AND NCategorie=".$_GET[&#039;NCat&#039;];

cat.php, line 117:

  $lnsql="SELECT NCategorie, LibCategorie FROM categorie WHERE IdUtilisateurCategorieX=&#039;$idutilisateur&#039; AND NCategorie<>".$_GET[&#039;NCat&#039;];

compte.php, line 152:

  $lnsql="SELECT PseudoUtilisateur, MotDePasseUtilisateur, IdUtilisateur FROM utilisateur WHERE IdUtilisateur=&#039;".$_GET[&#039;Compte&#039;]."&#039;";

liens.php, line 108: 

  $lnsql="SELECT NLiens,LibLiens, UrlLiens, IdCategorieLiensX, CommentaireLiens, PriveLiens, LibCategorie, LangueLiens FROM liens, categorie WHERE IdCategorieLiensX=NCategorie AND NLiens=".$_GET[&#039;NLiens&#039;];

liens.php, line 110:

  $lnsql="SELECT NLiens,LibLiens, UrlLiens, IdCategorieLiensX, CommentaireLiens, PriveLiens, LibCategorie, LangueLiens FROM liens, categorie WHERE IdCategorieLiensX=NCategorie AND NLiens=".$_GET[&#039;NLiens&#039;]." AND IdUtilisateurLiensX=&#039;$utilisateurcourant&#039;";

ouvrir.php, line 23:

  $lnsql="SELECT NLiens, UrlLiens FROM liens WHERE NLiens=".$_GET[&#039;NLiens&#039;]." AND IdUtilisateurLiensX=&#039;$utilisateurcourant&#039;";

ouvrir.php, line 25:

  $lnsql="SELECT NLiens, UrlLiens FROM liens WHERE NLiens=".$_GET[&#039;NLiens&#039;]." AND PriveLiens=&#039;N&#039;";
 
-------------------------------------

2. Cross Site Scripting:

cat.php, line 96:

  echo("<input type=\"hidden\" name=\"Act\" value=\"".$_GET[&#039;Act&#039;]."\">");

cat.php, line 102:

  echo("<input type=\"hidden\" name=\"CatMere\" value=\"".$_GET[&#039;CatMere&#039;]."\">");

cat.php, line 205:

  echo("<input type=\"hidden\" name=\"ncat\" value=\"".$_GET[&#039;NCat&#039;]."\">");

liens.php, line 80:

  echo("<input type=\"hidden\" name=\"Methode\" value=\"".$_GET[&#039;Methode&#039;]."\">");

liens.php, line 86: 

  echo("<tr><td>".$texte[&#039;LibLiens&#039;]."</td><td><input name=\"libliens\" value=\"".utf8_encode(stripslashes($_GET[&#039;Lib&#039;]))."\"></td></tr>");

liens.php, line 91:

  echo("<tr><td>".$texte[&#039;UrlLiens&#039;]."</td><td><input name=\"urlliens\" value=\"".$_GET[&#039;Url&#039;]."\"></td></tr>");

liens.php, line 119:

  echo("<input type=\"hidden\" name=\"nliens\" value=\"".$_GET[&#039;NLiens&#039;]."\">");

parcourir.php, line 28: 

  <input name="recherche" value="<?if(isset($_GET[&#039;recherche&#039;])){echo(stripslashes($_GET[&#039;recherche&#039;]));}?>">

proposerliens.php, line 39:

  echo("<input type=\"hidden\" name=\"idcatliens\" value=\"".$_GET[&#039;NCat&#039;]."\">");
 
-------------------------------------
 
Solution:
 
Do some input validation.
 
-------------------------------------
 
#################################################



