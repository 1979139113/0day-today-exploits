# Date: 21-11-2014
# Exploit Author: Kacper Szurek
# Contact: http://twitter.com/KacperSzurek
# Website: http://security.szurek.pl/
# Category: webapps
# CVE: CVE-2014-9262

1. Description
  
Every registered user can create and download backup files.

File: duplicator\duplicator.php
add_action(&#039;wp_ajax_duplicator_package_scan&#039;,		&#039;duplicator_package_scan&#039;);
add_action(&#039;wp_ajax_duplicator_package_build&#039;,		&#039;duplicator_package_build&#039;);
add_action(&#039;wp_ajax_duplicator_package_delete&#039;,		&#039;duplicator_package_delete&#039;);
add_action(&#039;wp_ajax_duplicator_package_report&#039;,		&#039;duplicator_package_report&#039;);

http://security.szurek.pl/duplicator-058-privilege-escalation.html

2. Proof of Concept

Login as regular user (created using wp-login.php?action=register) then start scan:


After that you can build backup:


This function will return json with backup name inside File key.

You can download backup using:


3. Solution:
  
Update to version 0.5.10

