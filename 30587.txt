
Vendor: Rockwell Automation, Inc.
Product web page: https://www.rockwellautomation.com
Affected version: Rockwell Automation RSLinx Classic 3.90.01
                  Rockwell Automation RSLinx Classic 3.73.00
                  Rockwell Automation RSLinx Classic 3.72.00
                  Rockwell Automation RSLinx Classic 2.58.00
                  Rockwell Automation FactoryTalk Linx Gateway 3.90.00

Summary: The FactoryTalk Linx Gateway adds a Classic OPC DA and OPC UA server
interface to deliver information collected by FactoryTalk Linx from Logix5000aC/
and other Allen-BradleyA(r) controllers to external OPC clients, permitting
third-party software to coexist with FactoryTalkA(r) software.

RSLinx Classic is the most widely-installed Communications software in
automation today. All editions of RSLinx Classic deliver the ability to
browse your automation networks, configure and diagnose network devices.
RSLinx Classic supports a wide range of applications through a scalable
offerings that provide both DDE and Classic OPC DA data servers to permit
3rd party software to access information within your control system.

Desc: The application suffers from an unquoted search path issue impacting
the service 'dnwhodisp' for Windows deployed as part of RSLinx and FactoryTalk.
This could potentially allow an authorized but non-privileged local user to
execute arbitrary code with elevated privileges on the system. A successful
attempt would require the local user to be able to insert their code in the
system root path undetected by the OS or other security applications where
it could potentially be executed during application startup or reboot. If
successful, the local user's code would execute with the elevated privileges
of the application.

Tested on: Microsoft Windows 7 Professional SP1 (EN)


Vulnerability discovered by Gjoko 'LiquidWorm' Krstic
                            @zeroscience


Advisory ID: ZSL-2018-5473
Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2018-5473.php

NCCIC ID: ICSA-18-158-01
NCCIC URL: https://ics-cert.us-cert.gov/advisories/ICSA-18-158-01

CVE ID: CVE-2018-10619
CVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-10619
         https://nvd.nist.gov/vuln/detail/CVE-2018-10619

Bugtraq ID: 104415
Bugtraq URL: https://www.securityfocus.com/bid/104415

11.12.2017

--


C:\>sc qc dnwhodisp
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: dnwhodisp
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 3   DEMAND_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Program Files (x86)\Rockwell Software\RSLINX\dnwhodisp.exe
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : dnWhoDisp
        DEPENDENCIES       : RPCSS
        SERVICE_START_NAME : LocalSystem

