

1. Vulnerability Details

     Affected Vendor: Barracuda
     Affected Product: Web Application Firewall V360
     Affected Version: Firmware v8.0.1.014
     Platform: Embedded Linux
     CWE Classification: CWE-200: Information Exposure
     Impact: Privileged Access
     Attack vector: HTTP

2. Vulnerability Description

     The Barracuda WAF management application transmits the current
     user and session identifier over HTTP GET.

3. Technical Description

     The HTTP URL shown below contains both the username and a md5 hash.
     This information is transmitted over a plaintext network connection.
     The password parameter can be seen more like a session identifier
     whose values are valid for a maximum of five days.

       GET
/cgi-bin/index.cgi?password=c12954a040d3a239f05ae63378131045&et=1480178788&auth_type=Local&locale=en_US&page_submitted=1&primary_tab=ADVANCED&secondary_tab=troubleshooting&user=admin
HTTP/1.1
       Host: 1.3.3.8:8000
       User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:50.0) Gecko/20100101 Firefox/50.0
       Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
       Accept-Language: en-US,en;q=0.5
       Accept-Encoding: gzip, deflate
       Referer:
http://1.3.3.8:8000/cgi-bin/index.cgi?&user=admin&password=d8bcadb76eb1f0c22423e1ec6264bc9c&et=1480178786&locale=en_US&primary_tab=ADVANCED&secondary_tab=troubleshooting&file=report_.tar.gz&refresh=1
       DNT: 1
       Connection: close
       Upgrade-Insecure-Requests: 1

       HTTP/1.1 200 OK
       Server: BarracudaHTTP 4.0
       Content-Type: text/html; charset=utf-8
       Connection: close
       Expires: Fri, 27 Nov 2015 16:26:42 GMT
       Date: Sat, 26 Nov 2016 16:26:42 GMT
       Content-length: 100997
       X-Frame-Options: SAMEORIGIN

       [snip]

4. Mitigation and Remediation Recommendation

     The vendor has patched this vulnerability in the lastest
     virtual appliance release.

5. Credit

     This vulnerability was discovered by Matt Bergin (@thatguylevel)
     of KoreLogic, Inc. and Joshua Hardin.

6. Disclosure Timeline

     2016.12.20 - KoreLogic sends vulnerability report and PoC to
                  Barracuda.
     2016.12.21 - Barracuda acknowledges receipt of the vulnerability
                  report.
     2017.01.09 - Barracuda informs KoreLogic that they are working
                  on remediation for this issue.
     2017.01.26 - Barracuda asks for additional time beyond the
                  standard 45 business day embargo to address this
                  and other issues reported by KoreLogic.
     2017.02.27 - 45 business days have elapsed since the issue was
                  reported.
     2017.04.10 - 75 business days have elapsed since the issue was
                  reported.
     2017.05.15 - 100 business days have elapsed since the issue was
                  reported.
     2017.05.24 - Barracuda updates KoreLogic on the status of the
                  remediation efforts.
     2017.06.13 - 120 business days have elapsed since the issue was
                  reported.
     2017.06.27 - Barracuda informs KoreLogic that the issue has
                  been fixed in the latest release of the WAF
                  virtual appliance.
     2017.07.06 - KoreLogic public disclosure.

7. Proof of Concept

     See 3. Technical Description

