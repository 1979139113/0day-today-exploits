AIMP 2.51 build 330 (ID3v1/ID3v2 Tag) Remote Stack BOF PoC (SEH)
================================================================



	                  _______________________________________________________
	                  |                                                      |
	             /    |      *  AIMP 2.51 build 330 (ID3v1/ID3v2 Tag)   *    |
	            /---, |      *  Remote Stack Buffer Overflow PoC (SEH)  *    |
	       -----# ==| |                                                      |
	       | :) # ==| |......................................................|
	  -----&#039;----#   | |______________________________________________________|
	  |)___()  &#039;#   |______====____   \___________________________________|
	 [_/,-,\"--"------ //,-,  ,-,\\\   |/             //,-,  ,-,  ,-,\\ __#
	   ( 0 )|===******||( 0 )( 0 )||-  o              &#039;( 0 )( 0 )( 0 )||
	----&#039;-&#039;--------------&#039;-&#039;--&#039;-&#039;-----------------------&#039;-&#039;--&#039;-&#039;--&#039;-&#039;---------------
	################################################################################


	*** Summary: Freeware audio player

	*** Product web page: http://www.aimp.ru/

	*** Desc: AIMP version 2.51 build 330 suffers from a stack based buffer overflow
		  vulnerability that can be exploited via malicious media file that
		  supports ID3 tags (mp3). EIP and ECX registers gets overwritten,
		  including the SE handler and the pointer to the next SEH record. The
		  issue is trigered by playing the file (crashes within 5 seconds) or
		  the ID3v1 or ID3v2 tab.

	*** Tested on Microsoft Windows XP Professional SP3 (English)

	*** Windbg log:

	--------------------------------------------------------------------------------

	(f3c.850): Access violation - code c0000005 (first chance)
	First chance exceptions are reported before any exception handling.
	This exception may be expected and handled.
	eax=00000000 ebx=00000000 ecx=41414141 edx=7c9032bc esi=00000000 edi=00000000
	eip=41414141 esp=0012d770 ebp=0012d790 iopl=0         nv up ei pl zr na pe nc
	cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210246
	*** WARNING: Unable to verify checksum for image00400000
	*** ERROR: Module load completed but symbols could not be loaded for image00400000
	image00400000+0x14141:
	41414141 0000            add     byte ptr [eax],al          ds:0023:00000000=??

	--------------------------------------------------------------------------------


	*** Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic

	*** liquidworm gmail com

	*** http://www.zeroscience.org/

	*** 29.05.2009


	################################################################################

>>>	*** PoC: http://www.zeroscience.org/codes/aimp2_evil.mp3 		~2.92 MB     <<<
>>>	*** PoC: http://milw0rm.com/sploits/2009-aimp2_evil.mp3 		~2.92 MB     <<<

	################################################################################




					   &#039;SHPA !!!
					 ###########
	          .                                                      .
	        .n                   .                 .                  n.
	  .   .dP                  dP                   9b                 9b.    .
	 4    qXb         .       dX                     Xb       .        dXp     t
	dX.    9Xb      .dXb    __                         __    dXb.     dXP     .Xb
	9XXb._       _.dXXXXb dXXXXbo.                 .odXXXXb dXXXXb._       _.dXXP
	 9XXXXXXXXXXXXXXXXXXXVXXXXXXXXOo.           .oOXXXXXXXXVXXXXXXXXXXXXXXXXXXXP
	  `9XXXXXXXXXXXXXXXXXXXXX&#039;~   ~`OOO8b   d8OOO&#039;~   ~`XXXXXXXXXXXXXXXXXXXXXP&#039;
	    `9XXXXXXXXXXXP&#039; `9XX&#039;   Yo!    `98v8P&#039;  Thricer `XXP&#039; `9XXXXXXXXXXXP&#039;
	        ~~~~~~~       9X.          .db|db.          .XP       ~~~~~~~
	                        )b.  .dbo.dP&#039;`v&#039;`9b.odb.  .dX(
	                      ,dXXXXXXXXXXXb     dXXXXXXXXXXXb.
	                     dXXXXXXXXXXXP&#039;   .   `9XXXXXXXXXXXb
	                    dXXXXXXXXXXXXb   d|b   dXXXXXXXXXXXXb
	                    9XXb&#039;   `XXXXXb.dX|Xb.dXXXXX&#039;   `dXXP
	                     `&#039;      9XXXXXX(   )XXXXXXP      `&#039;
	                              XXXX X.`v&#039;.X XXXX
	                              XP^X&#039;`b   d&#039;`X^XX
	                              X. 9  `   &#039;  P )X
	                              `b  `       &#039;  d&#039;
	                               `             &#039;





