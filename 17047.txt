Ajax File and Image Manager v1.0 Final Remote Code Execution Vulnerability
--------------------------------------------------------------------------
 
author...........: Egidio Romano aka EgiX
mail.............: n0b0d13s[at]gmail[dot]com
software link....: http://www.phpletter.com/
 
 
[-] Vulnerability explanation:
 
The vulnerable code is located into /ajaxfilemanager/ajax_create_folder.php:
 
11.   @ob_start();
12.   displayArray($_POST);
13.   writeInfo(@ob_get_clean());
 
this script start the output buffering at line 11 and then call the &#039;displayArray&#039;
function that simply displays the $_POST array content with the print_r() function,
and finally at line 13 is called the &#039;writeInfo&#039; function using the current buffer
contents as parameter (that is the $_POST array content). Now look at the &#039;writeInfo&#039;
function body defined into /ajaxfilemanager/inc/function.base.php:
 
228.  function writeInfo($data, $die = false)
229.  {
230.    $fp = @fopen(dirname(__FILE__) . DIRECTORY_SEPARATOR . &#039;data.php&#039;, &#039;w+&#039;);
231.    @fwrite($fp, $data);
232.    @fwrite($fp, "\n\n" . date(&#039;d/M/Y H:i:s&#039;) );
233.    @fclose($fp);
 
It writes the $data paramater into a file called &#039;data.php&#039; without any check,
so an attacker could be able to inject and execute arbitrary PHP code.
 
 
[-] Disclosure timeline:
 
[21/10/2011] - Vulnerability discovered
[24/10/2011] - Issue reported via e-mail
[25/10/2011] - Vendor replied that a fix will be released in the next version
[04/11/2011] - Public disclosure



