# Software      : Free Hosting Manager V2.0.2    Multiple SQLi                                                                                                          
# Author        : Saadat Ullah , saadi_linux@rocketmail.com                               
# Author home  : http://security-geeks.blogspot.com
# Date          : 23/3/13   
# Vendors  : http://www.fhm-script.com
# Download Link : http://www.fhm-script.com/download.php  
                                                                                     
-------------------------------------------------------------------------
+---+[ Multiple SQL injection]+---+
Its is vulnerable to SQLi on many file some of them are..

http://localhost/Free/clients/reset.php?code=[SQLi]
http://localhost/Free/clients/tickets.php?id=[SQLi]
http://localhost/free/clients/viewaccount.php?id=[SQLi]
Cookie based injeciton In 
http://localhost/free/clients/home.php
inject the cookie value clientuser
http://localhost/free/clients/register.php ---> SQLi on all POST Fields.

Proof Of Concept
In home.php
Calling a function auth() and what it is 

if ((isset($_COOKIE[&#039;clientuser&#039;])) && isset($_COOKIE[&#039;clientpass&#039;]) && isset($_COOKIE[&#039;clientid&#039;])) {

$clientuser = $_COOKIE[&#039;clientuser&#039;];
$clientpass = $_COOKIE[&#039;clientpass&#039;];
$clientid = $_COOKIE[&#039;clientid&#039;];
$this->clientuser = $_COOKIE[&#039;clientuser&#039;];
$this->clientpass = $_COOKIE[&#039;clientpass&#039;];
$this->clientid = $_COOKIE[&#039;clientid&#039;];
return true;

$dbquery = @mysql_query("SELECT * FROM clients WHERE id=&#039;$clientid&#039; AND username=&#039;$clientuser&#039; AND password=&#039;$clientpass&#039;") or die(mysql_error());


In Reset.php
http://localhost/Free/clients/reset.php?code=[SQLi]

elseif ((isset($code)) || ($_GET[&#039;do&#039;] == "code")) {

$details = mysql_query("SELECT * FROM clientpwactivation WHERE activationcode=&#039;$code&#039;") 
or die(mysql_error());

In tickets.php
http://localhost/Free/clients/tickets.php?id=[SQLi]
if ((isset($_GET[&#039;id&#039;])) && ($_GET[&#039;action&#039;] == "close") && ($_GET[&#039;confirm&#039;] == "true")) {
$fhm->closeticket($_GET[&#039;id&#039;]);
.
.
$checkticket = mysql_query("SELECT * FROM tickets WHERE id=&#039;$ticket&#039; AND clientid=&#039;$this->clientid&#039;") or die(mysql_error());

In Viewaccount.php
http://localhost/free/clients/viewaccount.php?id=[SQLi]

$id = $_GET[&#039;id&#039;];
.
$getacct = mysql_query("SELECT * FROM orders WHERE id=&#039;$id&#039; AND clientid=&#039;$fhm->clientid&#039;") or die(mysql_error());

In register.php

$firstname = stripslashes($_POST[&#039;first_name&#039;]);
$lastname = stripslashes($_POST[&#039;last_name&#039;]);
$company = stripslashes($_POST[&#039;company&#039;]);
$address = stripslashes($_POST[&#039;address&#039;]);
$address2 = stripslashes($_POST[&#039;address_2&#039;]);
$country = stripslashes($_POST[&#039;country&#039;]);
$city = stripslashes($_POST[&#039;city&#039;]);
$state = stripslashes($_POST[&#039;state_region&#039;]);
$postcode = stripslashes($_POST[&#039;postal_code&#039;]);
$telnumber = stripslashes($_POST[&#039;tel_number&#039;]);
$faxnumber = stripslashes($_POST[&#039;fax_number&#039;]);
$emailaddress = stripslashes($_POST[&#039;email_address&#039;]);
$username = stripslashes($_POST[&#039;username&#039;]);
$password1 = stripslashes($_POST[&#039;password&#039;]);
$password2 = stripslashes($_POST[&#039;confirm_password&#039;]);
.
.
.
.
.
.
$insertuser = mysql_query("INSERT INTO clients VALUES(&#039;&#039;, &#039;$username&#039;, &#039;$md5pass&#039;, &#039;$firstname&#039;, &#039;$lastname&#039;, &#039;$company&#039;, &#039;$address&#039;, &#039;$address2&#039;, &#039;$city&#039;, &#039;$country&#039;, &#039;$state&#039;, &#039;$postcode&#039;, &#039;$telnumber&#039;, &#039;$faxnumber&#039;, &#039;$emailaddress&#039;, &#039;$startingcredits&#039;, &#039;1&#039;, &#039;&#039;, &#039;&#039;, &#039;$timestamp&#039;) ") 

Only using stripslahes which will not protect against doing sql injection attack.

#independent Pakistani Security Researcher

