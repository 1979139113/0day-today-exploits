
# Exploit Author:  Eduardo Braun Prado

# Vendor Homepage: http://www.microsoft.com/

# Software Link: http://www.microsoft.com/

# Version: Windows 7 SP1, 8.1 with full patches up to July, 2018. both x86 and x64 architectures, all available OS specific versions like eg. Enterprise, Ultimate, Starter etc..

# Tested on: Windows 7 SP1, 8.1 with full patches up to July, 2018.

# CVE : n/a


Vendor contacted on: July 28, 2018.  Full details of vulnerability were given with a PoC.

Vendor replied on July 31, 2018 asking for specific OS versions and a PoC.

Again I sent the already sent PoC and told them the already witten versions, which as enlightened on the vulnerability title, doesn&#039;t affect latest Windows 10 release.

On August, 2, 2018 they replied: "We have concluded our investigation and determined the issue does not meet the bar for a security update."

Then I replied back asking as to why not release a patch since this could be abused with other exploits to potentially compromise affected OS versions. They replied, at the same day:

"The severity rating for this would normally warrant vnext consideration but testing this with MOTW tagging in RS4 shows correct behavior of a security warning."

So, to summarize, they are not patching it basicly because it doesn&#039;t affect latest build of Windows 10. This is strategic: "To get people to upgrade to Windows 10 ASAP" even though they are commited to release security related updates for all Windows versions in their extended life support, which is the case for 7 and 8.1.


PoC: To reproduce the issue, get a valid ".SCF" file and host on a web server. Then using an affected Windows version, download the file to disk using any web browser or E-mail Client software that appends the "Mark Of The Web" (MOTW) to downloaded files.

Upon trying to open the file, a security warning should be displayed because &#039;.SCF&#039; is considered a "high risk file type", for several ages, however the library responsible for checking the file type and the &#039;Security Zone&#039; it comes from, fails to display it, and the file is executed automatically.

Below is the link for some valid SCF files. Microsoft gives no documentation whatsoever on this particular file type, but given the few examples, it&#039;s likely that it can cause damage to the system:

https : // social . technet . microsoft . com/Forums/office/en-US/74b0e6f5-f90f-42b5-9658-3fe26f9db2d9/scf-files-windows-explorer-command-file-quotscriptingquot-documentation ? forum=ITCG

PS: Remove the spaces...this was done on purpose so some AVs and other security related software doesnt flag this article as "malicious".

For those who are curious about what this file type can do...so far we can do some neat stuff:

- Extension hiding (even when Windows is setup to show extensions) -> good on spoofing attacks
- Remote Icon retrieval -> good to force the OS and libraries responsible for displaying folders on Windows OSes to automatically attempt connection to SMB shares.
- Arbitrary icon set -> this can be used along the extension hiding issue to trick users into thinking this file is actually of another type like picture or text.

Researchers world wide: Feel free to dig this deeper; You may find even more obscure stuff "hiding" with this file type.

- Eduardo.


