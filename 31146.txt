================================================================

Author: Janek Vind "waraxe"
Date: 20. September 2018
Location: Estonia, Tartu
Web: http://www.waraxe.us/advisory-107.html

Target description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

FV Player is a free, easy-to-use, and complete solution for embedding FLV or MP4
videos into your posts or pages. With MP4 videos, FV Player offers 98% coverage
even on mobile devices.

https://foliovision.com/player

Vulnerable version: 7.2.0.727
Fixed version: 7.2.1.727
Active installations: 40 000+

###############################################################################
Reflected XSS in "models/flowplayer.php"
###############################################################################

Reason:
  * Insufficient sanitization of user-supplied data
Attack vector:
Preconditions:
  * Must be logged in as user with "manage_options" privileges (usually admin)


PHP script "models/flowplayer.php" line 2012:
------------------------[ source code start ]----------------------------------
    
    if( !is_user_logged_in() || !current_user_can(&#039;manage_options&#039;) ){
      wp_die(&#039;Please log in.&#039;);
    }
..
..
          echo do_shortcode($shortcode);          
------------------------[ source code end ]------------------------------------

to be as base64 encoded string. This parameter goes through base64 decoding and resulting
text string is used for output without additional checking or sanitization. As result
we have Reflected XSS vulnerability.

Testing:

privileges and then open following URL in web browser:


Javascript alert with "XSS" message pops up confirming Reflected XSS vulnerability.

"c3JjPSJ3YXJheGUiPHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4" string in URL is base64
encoded version of the string "src="waraxe"<script>alert(&#039;XSS&#039;)</script>" with
trailing "=" removed, because PHP function "base64_decode()" does not care about it.

By the way, this Reflected XSS vulnerability allows bypassing anti-XSS filters in
all modern web browsers thanks to base64 encoding.


Disclosure timeline:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
19.09.2018 -> First email sent to developers
19.09.2018 -> Got first response email from developers
19.09.2018 -> Sending detailed information to developers
20.09.2018 -> Found problems are fixed, new version available
20.09.2018 -> Waraxe advisory released
 
Contact:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
come2waraxe@yahoo.com
Janek Vind "waraxe"
 
Waraxe forum:  http://www.waraxe.us/
Personal homepage: http://www.janekvind.com/

