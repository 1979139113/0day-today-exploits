ATutor <= 2.2 (confirm.php) Session Variable Overloading Vulnerability
----------------------------------------------------------------------


[-] Software Link:

http://www.atutor.ca/


[-] Affected Versions:

Version 2.2 and prior versions.   


[-] Vulnerability Description:

The vulnerable code is located in the /confirm.php script:

140.  if (isset($_REQUEST[&#039;auto_login&#039;]))
141.  {
142.  
144.      $row = queryDB($sql, array(TABLE_PREFIX, $_REQUEST["member_id"]), TRUE);
145.  
146.      if ($row[&#039;member_id&#039;] != &#039;&#039;)
147.      {
148.          $_SESSION[&#039;valid_user&#039;] = true;
149.          $_SESSION[&#039;member_id&#039;]  = $_REQUEST["member_id"];
150.          $_SESSION[&#039;course_id&#039;]  = 0;
151.          $_SESSION[&#039;login&#039;]      = $row[login];

This script is intended to be used for the account confirmation. However, its "auto-login" feature
uses the same session variables used to authenticate the user in the whole application, and this
might enable unauthenticated attackers to bypass the authentication mechanism and impersonate
legitimate users by simply knowing their user IDs. Successful exploitation of this vulnerability
might allow an attacker to access the application with the most privileged user, leading to
achieve arbitrary PHP code execution by leveraging further vulnerabilities.


[-] Solution:

Apply the vendor patches.


[-] Disclosure Timeline:

[10/10/2014] - Vendor notified
[13/10/2014] - Vendor response stating this issue will be patched right away
[02/11/2014] - Vendor patch released: http://update.atutor.ca/patch/2_2/2_2-6/patch.xml
[09/11/2014] - Vendor notified about incompleteness of the patch
[10/11/2014] - Vendor released a further patch: http://update.atutor.ca/patch/2_2/2_2-7/patch.xml
[30/09/2015] - CVE number requested
[05/10/2015] - CVE number assigned
[04/11/2015] - Public disclosure


[-] CVE Reference:

The Common Vulnerabilities and Exposures project (cve.mitre.org)
has assigned the name CVE-2014-9753 to this vulnerability.

