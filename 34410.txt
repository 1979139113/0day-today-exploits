# Google Dork:unknown
# Exploit Author: Punt
# Vendor Homepage: https://www.librenms.org
# Software Link: https://www.librenms.org 
# Version:1.46 and less
# Tested on:Linux and Windows
# CVE: N/A 

#Affected Device: more than 4k found on Shodan and Censys. 

#Description about the bug
Vunlerable script /html/ajax_serarch.php

if (isset($_REQUEST[&#039;search&#039;])) {
    $search = mres($_REQUEST[&#039;search&#039;]);
    header(&#039;Content-type: application/json&#039;);
    if (strlen($search) > 0) {
        $found = 0;

        if ($_REQUEST[&#039;type&#039;] == &#039;group&#039;) {
            include_once &#039;../includes/device-groups.inc.php&#039;;
            foreach (dbFetchRows("SELECT id,name FROM device_groups WHERE name LIKE &#039;%".$search."%&#039;") as $group) {
                if ($_REQUEST[&#039;map&#039;]) {
                    $results[] = array(
                        &#039;name&#039;     => &#039;g:&#039;.$group[&#039;name&#039;],
                        &#039;group_id&#039; => $group[&#039;id&#039;],


as you can there is a search parameter $search = mres($_REQUEST[&#039;search&#039;]); which accepts a user input using $_REQUEST[&#039;&#039;]

dbFetchRows() used to exectute sql query

now lets check the mres() function 

the mres() fuction is located under /includes/common.php

function mres($string)
{
    return $string; // 
    global $database_link;
    return mysqli_real_escape_string($database_link, $string);

as you can see the mres() function call&#039;s the mysqli_real_escape_string() which can be bypassed by &#039;%&#039;                    


#POC:
1st lgoin to your LibreNMS
2nd go to this /ajax_search.php?search=%27&type=group or /ajax_search.php?search=%27&type=alert-rules 
3rd you will see an sql syntax error 

The Librenms team have applyed a patch .
Thanks
Punt (From Ethiopia)

