PHP Login Script v 2.3 SQL Injection vulnerability
==================================================

# Exploit Title: PHP Login Script v 2.3 SQL Injection vulnerability.
# Date: 23/7 2010
# Author: pimpim - pyscripter94@gmail.com
# Software Link: http://php-login-script.com/php_login_v2.3.zip
# Version: 2.3
# Google dork : intext:"Powered by PHP Login Script"
# Platform / Tested on: Ubuntu Linux
# Category: webapps/0day
# Vulnerable code: 

dbc.php lines 245-249, function logout()
-----------------------
if(isset($_SESSION[&#039;user_id&#039;]) || isset($_COOKIE[&#039;user_id&#039;])) {
mysql_query("update `users` 
			set `ckey`= &#039;&#039;, `ctime`= &#039;&#039; 
			where `id`=&#039;$_SESSION[user_id]&#039; OR  `id` = &#039;$_COOKIE[user_id]&#039;") or die(mysql_error());
}
-----------------------

logout.php
-----------------------
<?php
include &#039;dbc.php&#039;;
logout();
?> 
-----------------------

Set cookie to "user_id=&#039;[SQL]", and go to http://site.com/logout.php



