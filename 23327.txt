============
Beehive Forum v1.4.4 Stored XSS Vulnerability
 
Author:
==============
Halil Dalabasmaz
 
Release Date:
===========
23 Feb 2015
 
Product & Service Introduction:
========================
Beehive is an open-source project for creating a high-configurable
frame-based discussion forum.
 
Vendor Homepage:
=================
http://www.beehiveforum.co.uk
 
Abstract Advisory Information:
=======================
BGA Security Team discovered an Stored XSS vulnerability in
Beehive Forum v1.4.4
 
Vulnerability Disclosure Timeline:
=========================
20 Feb 2015 -   Contact with Vendor
21 Feb 2015 -   Vendor Response
22 Feb 2015 -   Vendor Fix
23 Feb 2015 -   Confirm Fix
23 Feb 2015 -   Public Disclosure
 
Discovery Status:
=============
Published
 
Affected Product(s):
===============
Beehive Forum v1.4.4
 
Exploitation Technique:
==================
Remote, Unauthenticated
 
Severity Level:
===========
High
 
Technical Details & Description:
========================
Stored XSS
 
Tested On:
============
Iceweasel & Chromium
 
Sample Payload:
=================
http://"><script>alert(&#039;XSS&#039;);</script>
 
Proof of Concept (PoC):
=======================
Proof of Concept
 
The vulnerable inputs are "Homepage URL", "Picture URL" and "Avatar URL" on Profile Section.
 
    if (isset($_POST[&#039;homepage_url&#039;])) {
 
 
 
                $error_msg_array[] = gettext("Homepage URL must include http:// schema.");
                $valid = false;
 
 
                $error_msg_array[] = sprintf(gettext("%s contains invalid characters!"), gettext("Homepage URL"));
                $valid = false;
            }
        }
    }
 
    if (isset($_POST[&#039;pic_url&#039;])) {
 
 
 
                $error_msg_array[] = gettext("Picture URL must include http:// schema.");
                $valid = false;
 
 
                $error_msg_array[] = sprintf(gettext("%s contains invalid characters!"), gettext("Picture URL"));
                $valid = false;
            }
        }
    }
 
 
         $error_msg_array[] = gettext("Avatar URL must include http:// schema.");
         $valid = false;
 
 
               $error_msg_array[] = sprintf(gettext("%s contains invalid characters!"), gettext("Avatar URL"));
               $valid = false;
            }
        }
 
Solution Fix & Patch:
================
Upgrade the the script.

