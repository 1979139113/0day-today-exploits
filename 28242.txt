# Date: August 4, 2017
# Software Link: https://www.cactusthemes.com/wp/gameplan/#secondary
# Exploit Author: Kushal Jaisingh
# Contact: https://ca.linkedin.com/in/kushaljaisingh
# Category: WebApps, XSS

1. Description

Reflected XSS is possible in all versions of the GamePlan WordPress theme because of insufficient input sanitization. Upon reviewing the webpage source (linked below) it appears the author made an effort to encode <> user input characters as &lt and &gt respectively to protect against possible XSS. However, this was not implemented fully throughout the webpage as half way through the source it can be seen that <> characters from user input begin to be reflected without being encoded thus enabling the possibility of XSS.

In the URL below our non URL encoded XSS payload was: <img src=x onerror=prompt(/OPENBUGBOUNTY/)>
Therefore, searching the page source for "src=x" returns 4 matches. The first 2 matches show the <> characters from our payload to be properly sanitized encoded as &lt and &lt respectively. However the latter 2 results show our complete XSS payload including the <> characters to be reflected back unencoded.

view-source:http://gameplan.cactusthemes.com/?s=%3Cimg+src%3Dx+onerror%3Dprompt%28%2FOPENBUGBOUNTY%2F%29%3E

2. Proof of Concept

The following URL will popup a javascript window. The URL was generated by typing <img src=x onerror=prompt(/OPENBUGBOUNTY/)> into the search box on the website.

http://gameplan.cactusthemes.com/?s=%3Cimg+src%3Dx+onerror%3Dprompt%28%2FOPENBUGBOUNTY%2F%29%3E

3. Solution:

Update to latest version by author once patched.

