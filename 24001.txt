# Date: 20-01-2015
# Exploit Author: Kacper Szurek
# Contact: http://twitter.com/KacperSzurek
# Website: http://security.szurek.pl/
# Category: webapps

1. Description
  
$_GET[&#039;vid&#039;] is not escaped.

google_adsense() is accessible for everyone.

File: contus-video-gallery\hdflvvideoshare.php

add_action(&#039;wp_ajax_googleadsense&#039; ,&#039;google_adsense&#039;);
add_action(&#039;wp_ajax_nonpriv_googleadsense&#039; ,&#039;google_adsense&#039;);
function google_adsense(){
	global $wpdb;
	$vid = $_GET[&#039;vid&#039;];
	$google_adsense = unserialize($query);
	echo $google_adsense[&#039;googleadsense_code&#039;];
	die();
}


2. Proof of Concept

  
3. Solution:
  
Update to version 2.8

