Vendor:     www.kajianwebsite.org
Vuln Type:  Arbitary file upload
Download link:  http://www.kajianwebsite.org/download/CMS%20versi%203.3.zip
Author:     eidelweiss
contact:    eidelweiss[at]windowslive[dot]com
Home:       www.eidelweiss.info
Gratz:  xx_user , kuris , and YOU !!!
   
References: http://eidelweiss-advisories.blogspot.com/2011/03/cms-balitbang-v-33-arbitary-file-upload.html
   
   
===================================================================
 
    description:
CMS balitbang is content management system for educational website.
Namanya sih bukan CMS Balitbang, cuma berhubungan CMS ini dikembangin oleh Balitbang Kemendiknas makanya lebih terkenal dengan sebutan CMS Balitbang. CMS Balitbang ini ditujukan untuk kepentingan dunia pendidikan Indonesia terutama untuk sekolah sekolah yang belum punya Website Sekolahnya. Harapannya kedepan Balitbang menginginkan semua sekolah di Indonesia punya Sistem Informasi Berbasis Website yang bisa diakses oleh banyak orang.
 
----------------------------------
    Vulnerability details:
 
CMS Balitbang is using the old version of FCKeditor for upload file to all user.And all know the old version of FCKeditor have a vulnerability and attacker might be able to upload arbitrary files containing malicious PHP code due to multiple file extensions isn&#039;t properly checked.
Here is the code:
 
    /webtemp/functions/editor/filemanager/connectors/php/config.php
 
global $Config ;
 
// SECURITY: You must explicitly enable this "connector". (Set it to "true").
// WARNING: don&#039;t just set "$Config[&#039;Enabled&#039;] = true ;", you must be sure that only
//      authenticated users can access this file or use some kind of session checking.
$Config[&#039;Enabled&#039;] = true ; // <= 1
 
---
 
// Path to user files relative to the document root.
$Config[&#039;UserFilesPath&#039;] = &#039;http://localhost/webtemp/userfiles/&#039; ;  // <= here is the path of attacker file or shell backdoor will be placed.
 
// following setting enabled.
$Config[&#039;ForceSingleExtension&#039;] = true ;    // <= 2
 
$Config[&#039;AllowedExtensions&#039;][&#039;File&#039;]    = array(&#039;7z&#039;, &#039;aiff&#039;, &#039;asf&#039;, &#039;avi&#039;, &#039;bmp&#039;, &#039;csv&#039;, &#039;doc&#039;, &#039;fla&#039;, &#039;flv&#039;, &#039;gif&#039;, &#039;gz&#039;, &#039;gzip&#039;, &#039;jpeg&#039;, &#039;jpg&#039;, &#039;mid&#039;, &#039;mov&#039;, &#039;mp3&#039;, &#039;mp4&#039;, &#039;mpc&#039;, &#039;mpeg&#039;, &#039;mpg&#039;, &#039;ods&#039;, &#039;odt&#039;, &#039;pdf&#039;, &#039;png&#039;, &#039;ppt&#039;, &#039;pxd&#039;, &#039;qt&#039;, &#039;ram&#039;, &#039;rar&#039;, &#039;rm&#039;, &#039;rmi&#039;, &#039;rmvb&#039;, &#039;rtf&#039;, &#039;sdc&#039;, &#039;sitd&#039;, &#039;swf&#039;, &#039;sxc&#039;, &#039;sxw&#039;, &#039;tar&#039;, &#039;tgz&#039;, &#039;tif&#039;, &#039;tiff&#039;, &#039;txt&#039;, &#039;vsd&#039;, &#039;wav&#039;, &#039;wma&#039;, &#039;wmv&#039;, &#039;xls&#039;, &#039;xml&#039;, &#039;zip&#039;) ;   // <= 3
 
---
 
with a default configuration of this script, an attacker might be able to upload arbitrary files containing malicious PHP code due to multiple file extensions isn&#039;t properly checked
 
 
----------------------------------
 
    exploit & p0c
   
[!] http://host//webtemp/functions/editor/filemanager/connectors/uploadtest.html    // upload your file here
    or
[!] http://host/path_to_CMSBalitbang/functions/editor/filemanager/connectors/uploadtest.html
 
    your shell or file will be placed here
 
[!] http://localhost/webtemp/userfiles/ <= here



