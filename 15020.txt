Digitalus 1.10.0 Alpha2 Arbitrary File Upload Vulnerability
===========================================================

[+]Script:  Digitalus
[+]Version: 1.10.0 Alpha2
[+]vendor:  http://digitaluscms.com/
[+]Download:    http://digitalus-cms.googlecode.com/files/digitalus_1.10.0_alpha2.zip
 ########################################################
   
[!]Author : eidelweiss
[!]Contact: eidelweiss[at]windowslive[dot]com
[!]Blog:    http://eidelweiss-advisories.blogspot.com
[!]Gratz  : DealCyber member`s , yogyacarderlink crew , and YOU !!!
 
[!]Dork: "Powered By Digitalus cms"
 
Original Advisories:
 
http://eidelweiss-advisories.blogspot.com/2010/12/digitalus-1100-alpha2-arbitrary-file.html
 
    -=[Advisories time]=-
 
[-] 25 desember 2010 (gmt+7)    vulnerability found
[-] 25 desember 2010 (gmt+7)    vulnerability analisys and testing
[-] 26 desember 2010 (gmt+7)    vulnerability report to vendor (first time report and no response)
[-] 28 desember 2010 (gmt+7)    vulnerability report to vendor (again still no response)
[!] 01 desember 2010 22:00 (gmt+7) vulnerability publish
 
########################################################
   
    -=[Description]=-
   
Digitalus CMS is a new kind of CMS. The focus of this open source project is usable software as opposed to endless lists of features.
We added a very flexible API to this base so you can customize virtually any aspect of the system.
This creates a simple and elegant platform that you can use for a wide range of sites and requirements.
  
########################################################
   
    -=[VUln Code]=-
 
    path/scripts/fckeditor/editor/filemanager/connectors/php/config.php
 
    [*] // SECURITY: You must explicitly enable this "connector". (Set it to "true").
    [*]
    [*] $Config[&#039;Enabled&#039;] = true ;
    [*]
    [*] // Path to user files relative to the document root.
    [*] $Config[&#039;UserFilesPath&#039;] = &#039;/media/&#039; ;
    [*]
    [*] // user files directory. Usefull if you are using a virtual directory, symbolic
    [*] // link or alias. Examples: &#039;C:\\MySite\\UserFiles\\&#039; or &#039;/root/mysite/UserFiles/&#039;.
    [*] // Attention: The above &#039;UserFilesPath&#039; must point to the same directory.
    [*]
    [*]
    [*] $Config[&#039;AllowedExtensions&#039;][&#039;File&#039;]    = array(&#039;7z&#039;, &#039;aiff&#039;, &#039;asf&#039;, &#039;avi&#039;, &#039;bmp&#039;, &#039;csv&#039;, &#039;doc&#039;, &#039;fla&#039;, &#039;flv&#039;, &#039;gif&#039;, &#039;gz&#039;, &#039;gzip&#039;, &#039;jpeg&#039;, &#039;jpg&#039;, &#039;mid&#039;, &#039;mov&#039;, &#039;mp3&#039;, &#039;mp4&#039;, &#039;mpc&#039;, &#039;mpeg&#039;, &#039;mpg&#039;, &#039;ods&#039;, &#039;odt&#039;, &#039;pdf&#039;, &#039;png&#039;, &#039;ppt&#039;, &#039;pxd&#039;, &#039;qt&#039;, &#039;ram&#039;, &#039;rar&#039;, &#039;rm&#039;, &#039;rmi&#039;, &#039;rmvb&#039;, &#039;rtf&#039;, &#039;sdc&#039;, &#039;sitd&#039;, &#039;swf&#039;, &#039;sxc&#039;, &#039;sxw&#039;, &#039;tar&#039;, &#039;tgz&#039;, &#039;tif&#039;, &#039;tiff&#039;, &#039;txt&#039;, &#039;vsd&#039;, &#039;wav&#039;, &#039;wma&#039;, &#039;wmv&#039;, &#039;xls&#039;, &#039;xml&#039;, &#039;zip&#039;) ;
    [*] $Config[&#039;DeniedExtensions&#039;][&#039;File&#039;]     = array() ;
    [*]
    [*] $Config[&#039;AllowedExtensions&#039;][&#039;Image&#039;]   = array(&#039;bmp&#039;,&#039;gif&#039;,&#039;jpeg&#039;,&#039;jpg&#039;,&#039;png&#039;) ;
    [*] $Config[&#039;DeniedExtensions&#039;][&#039;Image&#039;]    = array() ;
    [*]
    [*] $Config[&#039;AllowedExtensions&#039;][&#039;Flash&#039;]   = array(&#039;swf&#039;,&#039;flv&#039;) ;
    [*] $Config[&#039;DeniedExtensions&#039;][&#039;Flash&#039;]    = array() ;
    [*]
    [*] $Config[&#039;AllowedExtensions&#039;][&#039;Media&#039;]   = array(&#039;aiff&#039;, &#039;asf&#039;, &#039;avi&#039;, &#039;bmp&#039;, &#039;fla&#039;, &#039;flv&#039;, &#039;gif&#039;, &#039;jpeg&#039;, &#039;jpg&#039;, &#039;mid&#039;, &#039;mov&#039;, &#039;mp3&#039;, &#039;mp4&#039;, &#039;mpc&#039;, &#039;mpeg&#039;, &#039;mpg&#039;, &#039;png&#039;, &#039;qt&#039;, &#039;ram&#039;, &#039;rm&#039;, &#039;rmi&#039;, &#039;rmvb&#039;, &#039;swf&#039;, &#039;tif&#039;, &#039;tiff&#039;, &#039;wav&#039;, &#039;wma&#039;, &#039;wmv&#039;) ;
    [*] $Config[&#039;DeniedExtensions&#039;][&#039;Media&#039;]    = array() ;
       
    with a default configuration of this script, an attacker might be able to upload arbitrary
    files containing malicious PHP code due to multiple file extensions isn&#039;t properly checked
 
 
########################################################
   
    -=[ How To Exploit / P0C ]=-
 
1. attacker might be able to upload arbitrary files containing malicious PHP code due to multiple file extensions isn&#039;t properly checked using remode code execution.
2. Attacker also can exploit this vulnerability via browser by following this link
 
    http://127.0.0.1/scripts/fckeditor/editor/filemanager/connectors/test.html
 
        or
 
    http://127.0.0.1/scripts/fckeditor/editor/filemanager/connectors/uploadtest.html
 
[*] your file while be here
 
    http://127.0.0.1/media/yourfile.extension <= here
 
########################################################
 
     
    | -=[MERRY CHRISTMAS AND HAPPY NEW YEARS , Nothing impossible in this world even nobody`s perfect]=- |
  
=========================| -=[ E0F ]=- |============================



