download : schmoozecom.com
Author : i-Hmx
mail : n0p1337@gmail.com
Home : sec4ever.com , secarrays ltd

Freepbx is famous asterisk based distro used world wide , it suffer from many vulns actually
simple one is included here just as a "knock knock" for the "schmoozecom" team ;)
Here you will see damn obvious PHP code Execution vuln , which can be upgraded to RCE and also dump all box&#039;s data
You can have a look if you are interested

File : admin/libraries/view.functions.php

function fileRequestHandler($handler, $module = false, $file = false){
global $amp_conf;

switch ($handler) {
case &#039;reload&#039;:
// AJAX handler for reload event
$response = do_reload();
header("Content-type: application/json");
echo json_encode($response);
break;
case &#039;file&#039;:
/** Handler to pass-through file requests
* Looks for "module" and "file" variables, strips .. and only allows normal filename characters.
* Accepts only files of the type listed in $allowed_exts below, and sends the corresponding mime-type,
* including $db and $astman, and the user is authenticated.
*/
if (!$module || !$file) {
die_freepbx("unknown");
}
//TODO: this could probably be more efficient

$allowed_exts = array(
&#039;.js&#039; => &#039;text/javascript&#039;,
&#039;.js.php&#039; => &#039;text/javascript&#039;,
&#039;.css&#039; => &#039;text/css&#039;,
&#039;.css.php&#039; => &#039;text/css&#039;,
&#039;.html.php&#039; => &#039;text/html&#039;,
&#039;.php&#039; => &#039;text/html&#039;,
&#039;.jpg.php&#039; => &#039;image/jpeg&#039;,
&#039;.jpeg.php&#039; => &#039;image/jpeg&#039;,
&#039;.png.php&#039; => &#039;image/png&#039;,
&#039;.gif.php&#039; => &#039;image/gif&#039;,
);

