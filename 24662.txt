Author: Larry W. Cashdollar, @_larry0
Vendor Notified: 2015-11-30
Vendor Contact: 
eplies=1#post-7721994
Description: Cool Video Gallery is a Video Gallery plugin for WordPress with
option to upload videos, attach media files, add Youtube videos and manage
videos using FFMPEG library available. Option provided to upload images for
Vulnerability:
If any of the arguments being passed to $command are sourced from user
input, we can inject commands to be passed to the shell via exec() on line
714.

In cool-video-gallery/lib/core.php lines 703-714:

 703                 $gallery = videoDB::find_gallery($video->galleryid);
 704                 $video_input = $gallery->abspath . &#039;/&#039; .
$video->filename;
 705                 $new_target_filename = $video->alttext . &#039;.png&#039;;
 706                 $new_target_file = $gallery->abspath .
&#039;/thumbs/thumbs_&#039; . $new_target_filename;
 707 
 708                 if($video->video_type ==
$cool_video_gallery->video_type_media){
 709                         $command = $options[&#039;cvg_ffmpegpath&#039;] . " -i
&#039;$video->filename&#039; -vcodec mjpeg -vframes 1 -an -f rawvideo -ss 5      -s
".$thumb_width ."x".$thumb_height." &#039;$new_target_file&#039;";
 710                 }else {
 711                         $command = $options[&#039;cvg_ffmpegpath&#039;] . " -i
&#039;$video_input&#039; -vcodec mjpeg -vframes 1 -an -f rawvideo -ss 5 -s "
.$thumb_width ."x".$thumb_height." &#039;$new_target_file&#039;";
 712                 }
 713 
 714                 exec ( $command );
CVEID: 2015-7527
Exploit Code:
Screen shots are located at below URL.


