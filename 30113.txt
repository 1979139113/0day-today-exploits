
Vendor:
==========
www.sophos.com



Product:
===========
Sophos Endpoint Protection - Control Panel v10.7

Sophos Endpoint Protection is designed for workstations running Windows and macOS. It adds exploit technique mitigations, CryptoGuard anti-ransomware,
anti-malware, web security, malicious traffic detection, and deep system cleanup.



Vulnerability Type:
===================
Insecure Crypto



CVE Reference:
==============
CVE-2018-9233



Security Issue:
================
Sophos endpoint protection control panel authentication uses weak unsalted unicoded cryptographic hash (SHA1) function, not using salt allows attackers that gain access to hash 
changing of settings, whitelist or unquarantine files.

Password and config for Sophos endpoint protection control panel is stored here:
C:\ProgramData\Sophos\Sophos Anti-Virus\Config\machine.xml

e.g.

SHA1 (Unicode) encoding non salted pass = abc123

<TamperProtectionManagement><settings>
<enabled>true</enabled><password>689307D2FC53AF0FB941BC1BB42737CE4F3EF540</password></settings>
</TamperProtectionManagement>


Using PHP&#039;s sha1 function with "mb_convert_encoding" as UTF-16LE we can verify.

C:\>php -r "print sha1(mb_convert_encoding(&#039;abc123&#039;, &#039;UTF-16LE&#039;, &#039;UTF-8&#039;));"
689307d2fc53af0fb941bc1bb42737ce4f3ef540

