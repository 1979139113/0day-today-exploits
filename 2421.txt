CMS Made Simple <= 1.2.2 (TinyMCE module) SQL Injection Vuln
============================================================




-------------------------------------------------------------------------
CMS Made Simple <= 1.2.2 (TinyMCE module) - Remote SQL Injection Advisory
-------------------------------------------------------------------------

author...: EgiX
mail.....: n0b0d13s

link.....: http://www.cmsmadesimple.org/
dork.....: "This site is powered by CMS Made Simple version 1.2.2"

[-] Vulnerable code in /modules/TinyMCE/content_css.php :

 26.	$templateid = &#039;&#039;;
 27.	if (isset($_GET["templateid"])) $templateid = $_GET["templateid"]; <==
 28.
 29.	$mediatype = &#039;&#039;;
 30.	if (isset($_GET["mediatype"])) $mediatype = $_GET["mediatype"];
 31.
 32.	$name = &#039;&#039;;
 33.	if (isset($_GET[&#039;name&#039;])) $name = $_GET[&#039;name&#039;];

 64.		if ($name != &#039;&#039;)
 66.		else
 68.		$result=mysql_query($sql);
 69.	//		echo $sql;
 70.		while ($result && $row = mysql_fetch_assoc($result))
 71.		{
 72.			$css .= "/* Start of CMSMS style sheet &#039;{$row[&#039;css_name&#039;]}&#039; */\n{$row[&#039;css_text&#039;]}\n/* End of &#039;{$row[&#039;css_name&#039;]}&#039; */\n";
 73.		}
 
 $_GET["templateid"] isn&#039;t properly checked at line 27, this results in a sql injection at line 67
 
[*] An attacker can break database through browser! P.o.C. :





