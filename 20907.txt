3/27/2013
Larry W. Cashdollar
@_larry0

Hello,

The 147147-26 patch creates a CLEANUP file in /tmp that is vulnerable to symlink attacks:

The contents of the file created in /tmp are:

/sbin/sh:root@dev-unix-sec02# cat CLEANUP

EXISTING_FILE_PRESERVED: /var/run/.patchSafeMode/root/etc/security/audit_event /var/run/.patchSafeMode/root/etc/security/audit_event.new

EXISTING_FILE_RENAMED: /var/run/.patchSafeMode/root/etc/mail/sendmail.cf /var/run/.patchSafeMode/root/etc/mail/sendmail.cf.old EXISTING_FILE_RENAMED: /var/run/.patchSafeMode/root/etc/mail/submit.cf /var/run/.patchSafeMode/root/etc/mail/submit.cf.old

Sendmail has been upgraded to version 8.14.5 . After you reboot, you may want to run

/usr/sbin/check-hostname
and

/usr/sbin/check-permissions ALL

These two shell-scripts will check for common mis-configurations and recommend corrective action, or report if things are OK.

-rw-r--r-- 1 root other 662 Mar 27 13:03 CLEANUP

The vulnerable code can be found in ./SUNWsndmu/install/postinstall:

540 CLEANUP=/tmp/CLEANUP
541
542 if [ "x$UPDATE" = xyes ]; then

   543          VERSION=`grep &#039;^DZ&#039; $PKG_INSTALL_ROOT/etc/mail/sendmail.cf | \
   544                  sed -e s/DZ//`
   545          echo "\nSendmail has been upgraded to version $VERSION ." >>$CLE
ANUP
   546          echo "After you reboot, you may want to run" >>$CLEANUP
   547          echo "\t/usr/sbin/check-hostname" >>$CLEANUP
   548          echo "and" >>$CLEANUP
   549          echo "\t/usr/sbin/check-permissions ALL" >>$CLEANUP
   550          echo "These two shell-scripts will check for common" >>$CLEANUP
   551          echo "misconfigurations and recommend corrective" >>$CLEANUP
   552          echo "action, or report if things are OK.\n" >>$CLEANUP

553 fi

A simple attack in /tmp can clobber /etc/shadow:

[/tmp $] ln -s /etc/shadow CLEANUP

Will over write the contents of /etc/shadow.

Oracle has been notified 3/27ï»¿/2013 and they are working on a fix.

