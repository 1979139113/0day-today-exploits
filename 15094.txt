JE Messenger 1.0 Arbitrary File Upload Vulnerability
====================================================

JE Messenger 1.0 Arbitrary File Upload Vulnerability
 
 Name              JE Messenger
 Vendor            http://joomlaextensions.co.in
 Versions Affected 1.0
 
 Author            Salvatore Fresta aka Drosophila
 Website           http://www.salvatorefresta.net
 Contact           salvatorefresta [at] gmail [dot] com
 Date              2010-12-09
 
X. INDEX
 
 I.    ABOUT THE APPLICATION
 II.   DESCRIPTION
 III.  ANALYSIS
 IV.   SAMPLE CODE
 V.    FIX
  
 
I. ABOUT THE APPLICATION
________________________
 
JE Messenger is a Joomla&#039;s component.
 
 
II. DESCRIPTION
_______________
 
A parameter is not properly sanitised before  being used
from the native Joomla&#039;s upload function.
 
 
III. ANALYSIS
_____________
 
Summary:
 
 A) Arbitrary File Upload
  
 
A) Arbitrary File Upload
________________________
 
A logic error in the save function  (compose.php)  allows
to a registered user to upload a file with any extension.
The check for a valid file&#039;s extension is made  after the
upload and in the failure case, the file doesn&#039;t  removed
from the server. This   can   be   exploited  to  execute
arbitrary PHP code by uploading a PHP file.
 
The file&#039;s name is different after the upload:
 
$file[&#039;name&#039;] = time().&#039;in&#039;.$file[&#039;name&#039;];
 
Example:
 
Original file&#039;s name: shell.php
Uploaded file&#039;s name: 1291907399inshell.php
 
Where  1291907399  is  the  value returns from the time()
function.
 
The file will be uploaded to the following directory:
 
$dest = JPATH_ROOT.DS.&#039;components/&#039;.$option.&#039;/assets/images/&#039;.$file[&#039;name&#039;];
 
The default destination is:
 
http://site/path/components/com_jemessenger/assets/images/
 
 
IV. SAMPLE CODE
_______________
 
A) Arbitrary File Upload
 
1 - Login to target website&#039;s Joomla
2 - Go to http://site/path/index.php?option=com_jemessenger&view=compose
3 - Compile a valid form and select an arbitrary file
4 - Go to http://site/path/components/com_jemessenger/assets/images/filename
 
 
Try a little bruteforce to find the value  returned  from
the time() function.
 
 
V. FIX
______
 
No fix.



