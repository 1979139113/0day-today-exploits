

Vendor: Zend Technologies Ltd.
Product web page: http://www.zend.com

Affected version: 3.3.3* and 3.3.0*

* Note: The patch did not change the version number of the affected
product, so the updated version is still 3.3.3, but with proper permissions.

Summary: Zend Optimizer is a free application that runs the files
encoded using Zend Guard and enhances the overall performance of
your PHP applications.

Desc: The Zend Optimizer package for Windows is vulnerable to an
elevation of privileges vulnerability which can be used by a simple
user that can change the library file with a binary of choice. The
vulnerability exist due to the improper permissions, with the &#039;F&#039; flag
(full control) for the &#039;Everyone&#039; group, for the &#039;ZendExtensionManager.dll&#039;
library file and &#039;ZendOptimizer.dll&#039; which are bundled with the Zend
Optimizer (Runtime for PHP 5.2 and earlier) installation package.

Tested on: Microsoft Windows XP Professional SP3 (EN)


Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
                            @zeroscience


Vendor status:

[01.02.2012] Vulnerability discovered.
[23.02.2012] Contact with the vendor.
[23.02.2012] Vendor responds asking for details.
[24.02.2012] Sent detailed information to the vendor.
[24.02.2012] Vendor assigns appropriate team for coordination.
[27.02.2012] Vendor is analyzing the issue, working on a fix.
[27.02.2012] Asked vendor for confirmation and scheduled patch release date.
[28.02.2012] Vendor replies with confirmation of the issue.
[05.03.2012] Asked vendor for status update.
[06.03.2012] Vendor created fix for the issue, promising patch release date.
[07.03.2012] Sent coordination details to the vendor.
[14.03.2012] Asked vendor for status update.
[14.03.2012] Vendor replies.
[21.03.2012] Sent advisory release information to the vendor.
[21.03.2012] Vendor extends the patch release date.
[29.03.2012] Vendor publishes new version to address this issue.
[03.04.2012] Coordinated public security advisory released.



Advisory ID: ZSL-2012-5083
Advisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2012-5083.php

Zend Advisory: http://static.zend.com/topics/Zend-Optimizer-3.3.3-Release-Notes-V2.txt
               http://www.zend.com/en/products/guard/downloads



01.02.2012


---

C:\Program Files\Zend\ZendOptimizer-3.3.0\lib>cacls ZendExtensionManager.dll
C:\Program Files\Zend\ZendOptimizer-3.3.0\lib\ZendExtensionManager.dll Everyone:F
                                                                       BUILTIN\Users:R
                                                                       BUILTIN\Power Users:C
                                                                       BUILTIN\Administrators:F
                                                                       NT AUTHORITY\SYSTEM:F
                                                                       TESTPC\TESTUSER:F


C:\Program Files\Zend\ZendOptimizer-3.3.0\lib>cd Optimizer-3.3.0\php-5.2.x

C:\Program Files\Zend\ZendOptimizer-3.3.0\lib\Optimizer-3.3.0\php-5.2.x>cacls ZendOptimizer.dll
C:\Program Files\Zend\ZendOptimizer-3.3.0\lib\Optimizer-3.3.0\php-5.2.x\ZendOptimizer.dll Everyone:F
                                                                                          BUILTIN\Users:R
                                                                                          BUILTIN\Power Users:C
                                                                                          BUILTIN\Administrators:F
                                                                                          NT AUTHORITY\SYSTEM:F
                                                                                          TESTPC\TESTUSER:F


C:\Program Files\Zend\ZendOptimizer-3.3.0\lib\Optimizer-3.3.0\php-5.2.x>

---



