================
Software: Post Indexer
Version: 3.0.6.1
Advisory report: https://security.dxw.com/advisories/sql-injection-in-post-indexer-allows-super-admins-to-read-the-contents-of-the-database/
CVE: Awaiting assignment
CVSS: 4 (Medium; AV:N/AC:L/Au:S/C:P/I:N/A:N)

Description
================
SQL Injection in Post Indexer allows super admins to read the contents of the database

Vulnerability
================



In other places in the code it simply takes user controlled values and adds them to SQLA queries.
An example of this is remove_post_older_than:



// classes/class.model.php line 589
function remove_posts_older_than( $unit, $period ) {
    // ...
    $posts = $this->db->get_results( $sql );
    // ...
}




The value of $period is user-controlled and could easily be replaced with SQL:



// classes/cron.postindexerrebuild.php line 310
function process_tidy_agedposts($DEBUG = false) {
    // ...
    // The default is to remove posts from the index when they are over a year old
    $agedposts = get_site_option( \&#039;postindexer_agedposts\&#039;, array( \&#039;agedunit\&#039; => 1, \&#039;agedperiod\&#039; => \&#039;year\&#039; ) );
    // ...
    $this->model->remove_posts_older_than( $agedposts[\&#039;agedunit\&#039;], $agedposts[\&#039;agedperiod\&#039;] );
    // ...
}



To exploit this vulnerability you need to be a super admin.




Proof of concept
================

Mitigations
================
Upgrade to version 3.0.6.2 or later.

Disclosure policy
================
dxw believes in responsible disclosure. Your attention is drawn to our disclosure policy: https://security.dxw.com/disclosure/


This vulnerability will be published if we do not receive a response to this report with 14 days.

Timeline
================

2016-11-01: Discovered
2016-11-14:A Plugin author responded
2016-11-17: Confirmed that version 3.0.6.2 fixes the issue
2016-11-17:A Requested CVE
2016-11-17:A Advisory published

