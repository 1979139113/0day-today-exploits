Simple Ads Manager WordPress plugin unauthenticated PHP Object injection
vulnerability
------------------------------------------------------------------------
Yorick Koster, July 2016

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
A PHP Object injection vulnerability was found in the Simple Ads Manager
WordPress plugin. The unauthenticated PHP Object injection vulnerability
can be used by an unautenthicated user to instantiate arbitrary PHP
Objects. This issue can potentially result in arbitrary code execution,
but this has not been confirmed.

------------------------------------------------------------------------
OVE ID
------------------------------------------------------------------------
OVE-20160712-0041

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was succesfully tested on the Simple Ads Manager WordPress
plugin version 2.9.8.125.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
There is currently no fix available.

------------------------------------------------------------------------
Details
------------------------------------------------------------------------

This issue is possible due to two unsafe calls to unserialize() in the sam-ajax-loader.php file. The input is taken directly from the POST request as can be seen in the following code fragment:

sam-ajax-loader.php:

if ( in_array( $action, $allowed_actions ) ) {
   switch ( $action ) {
      case &#039;sam_ajax_load_place&#039;:
         break;
   
      case &#039;sam_ajax_load_ads&#039;:
         if ( ( isset( $_POST[&#039;ads&#039;] ) && is_array( $_POST[&#039;ads&#039;] ) ) && isset( $_POST[&#039;wc&#039;] ) ) {
            $clauses = unserialize( base64_decode( $_POST[&#039;wc&#039;] ) );

This issue can potentially result in arbitrary code execution, but this has not been confirmed.

