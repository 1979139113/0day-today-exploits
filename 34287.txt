# Author: Besim ALTINOK
# Vendor Homepage: https://phpgurukul.com/
# Software Link: https://phpgurukul.com/user-registration-login-and-user-management-system-with-admin-panel/
# Version: v2.0
# Tested on: Xampp
# Credit: Ä°smail BOZKURT

------ Details:

1- Vulnerable code is here:

Insert user registration information to the DB without filtering.

if(isset($_POST[&#039;signup&#039;]))
{
$fname=$_POST[&#039;fname&#039;];
$lname=$_POST[&#039;lname&#039;];
$email=$_POST[&#039;email&#039;];
$password=$_POST[&#039;password&#039;];
$contact=$_POST[&#039;contact&#039;];
$enc_password=$password;
$msg=mysqli_query($con,"insert into
users(fname,lname,email,password,contactno)
values(&#039;$fname&#039;,&#039;$lname&#039;,&#039;$email&#039;,&#039;$enc_password&#039;,&#039;$contact&#039;)");
if($msg)
{
echo "<script>alert(&#039;Register successfully&#039;);</script>";
}
}

2- In the admin dashboard:

Get fullName from DB and print it without any filtering

<?php $ret=mysqli_query($con,"select * from users");
$cnt=1;
while($row=mysqli_fetch_array($ret))
{?>
<tr>
<td><?php echo $cnt;?></td>
<td><?php echo $row[&#039;fname&#039;];?></td>
<td><?php echo $row[&#039;lname&#039;];?></td>
<td><?php echo $row[&#039;email&#039;];?></td>
<td><?php echo $row[&#039;contactno&#039;];?></td> <td><?php echo
$row[&#039;posting_date&#039;];?></td>
</tr>

4- If we insert value of the "fname" as "script>prompt(1)</script>", we can
perform this attack as "Stored XSS"

