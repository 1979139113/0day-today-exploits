MyPHP Forum <= 3.0 (Final) Multiple SQL Injection Vulnerabilities
=================================================================




Name            :  MyPHP Forum <= 3.0 (Final) Multiple Remote SQL Injection Vulnerability
Author          :  x0kster
Script Download :  http://www.myphp.ws/
Date            :  31/12/2007
Dork            :  "Powered by: MyPHP Forum"

Note: 
For work, magic_quotes_gpc must be turned off on the server.



Sql injection in faq.php

   <?php
    //faq.php
    [...]
    $id = $_GET[&#039;id&#039;];
    if($action == "view" && !empty($id)) {
	$result = mysql_query("SELECT * from $db_faq WHERE id=&#039;$id&#039;") or die(mysql_error()); // <-- So miss a control :-D
	$row = mysql_fetch_array($result);
	$row[answer] = postify($row[answer]);
    [...]
   ?>

So we can execute an sql injection thrught the bugged variable $id.

PoC:





Sql injection in member.php

   <?php
    //member.php
   [...]
    if($action == "viewpro") {
	$member = $HTTP_GET_VARS[&#039;member&#039;];
	$query = mysql_query("SELECT * FROM $db_member WHERE username=&#039;$member&#039;") or die(mysql_error());
   [...]
   ?>

So $member variable isn&#039;t controlled so we can exploit it.

PoC:




