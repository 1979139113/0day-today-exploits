# Exploit Author: Social Engineering Neo  -  @EngineeringNeo
# Software Link: https://www.metasploit.com/download
# Version: Metasploit Pro v4.17.67-dev
# Tested on: Linux & Windows


Metasploit Reverse Session Takeover by Social Engineering Neo.


Affected Platforms: - Windows & Linux


Tested On: - Metasploit Pro v4.17.67-dev


Summary: - Reverse Sessions "by-design" Beacon out from the Victim Machine therefore Potentially Leaking the IP Address & Port being used by the Attacker.


Short Description: - Another attacker with the knowledge of the reverse session taking place may have the ability to discover the local/remote IP address & port being used for the reverse connection.
                 : - This can be done by performing a MiTM attack and monitoring the traffic between the host and attacker.
                 : - This is a method of attack, not a vulnerability.


Proof of Concept: -
####
Setup 3 VMs.

&#039;Attacker1&#039; = Attacker Windows - 192.168.66.130
&#039;Attacker2&#039; = Attacker Linux - 192.168.66.135
&#039;Victim&#039; = Windows x86 - 192.168.66.154


&#039;Attacker1&#039; and &#039;Victim&#039; session started.

Upon post-exploitation &#039;Attacker2&#039; discovers &#039;Attacker1&#039; on the network.

&#039;Attacker2&#039; successfully takes &#039;Attacker1&#039; offline, then &#039;Attacker2&#039; masks their IP address with the IP address of &#039;Attacker1&#039; to view incoming traffic destined for &#039;Attacker1&#039;.

From inspecting the network traffic &#039;Attacker2&#039; discovers the port being used during the session between &#039;Attacker1&#039; and &#039;Victim&#039;.


&#039;Attacker2&#039; and &#039;Victim&#039; session started.
####


VIDEO: - https://youtu.be/BiaBkd34otY


Expected Result: - Session between &#039;Attacker1&#039; and &#039;Victim&#039; cannot be taken over by &#039;Attacker2&#039;.


Observed Result: - Session between &#039;Attacker1&#039; and &#039;Victim&#039; is easily taken over by &#039;Attacker2&#039;.


Our Recommendation: - Use reverse connections less often.


Useful scenarios: - Gaining knowledge of the IP address & Port of the attacker machine, theoretically you can create a reverse payload and execute inside a honeypot. If the attacker is actively listening for connections, they will automatically open a session, you are able to mess around with them as much as you like;)
                : - When a local machine in the network is infected with a reverse payload, it would be possible to modify local network routes so you are the remote machine and opening a session where it wouldn&#039;t otherwise be possible.
                : - BotNets, Information Gathering, BlueTeams & Law Enforcement.
                : - Stealing other sessions.
                

NOTE: - We are using Metasploit as an example because it&#039;s one of the most popular pentesting tools.

